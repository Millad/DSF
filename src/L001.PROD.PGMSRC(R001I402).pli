 /*   SIST ENDRET PÅ PROD   2004.02.20 12.49.24 AV   SPA2970          */        
 /*   SIST ENDRET PÅ TEST   2004.02.20 12.40.30 AV   SPA2970          */        
 /*   SIST ENDRET PÅ PROD   2002.09.19 10.09.55 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2002.01.15 11.51.06 AV   JDA2970          */        
 /*       SIST ENDRET 02/09-98 10.18.05 AV   SPA7339                  */        
 /* ***************************************************************** */        
 /*  PROGRAM NAME   : R001I402                                        */        
 /*  LANGUAGE       : PL/1                                            */        
 /* ***************************************************************** */        
 /*  ENDRET 3/10-90 AV TUYEN                                          */        
 /*     TAR BORT SPERRING I FORBINDELSEN MED REGISTRERING AV          */        
 /*     FORELØPIG INNTEKT.                                            */        
 /* ----------------------------------------------------------------- */        
 /*IDENTIFIKASJON:                                                    */        
 /*    R001I402 - PROGRAM I PLI                                       */        
 /*    PROGRAMMERT AV EDB-INGENIØR ROLF FARVIK.JULI 1983.             */        
 /*HENSIKT:                                                           */        
 /*    PROGRAMMET BEHANDLER SØKERDELEN.                               */        
 /*BRUK:                                                              */        
 /*    OVERFØR_SØKER     - OVERFØRING FRA MAP TIL ARBEIDSOMRÅDE       */        
 /*    KONTR_SØKER       - KONTROLL AV SØKER                          */        
 /*                                                                   */        
 /*                                                                   */        
 %PAGE;                                /*   */                                  
 /* ***************************************************************** */        
 /*                                                                   */        
 /* PROSEDYREN OVERFØRER OPPL. OM SØKER FRA SKJERMBILDET TIL          */        
 /*    NI_TRANS_OMR I KOM_OMR.                                        */        
 /* ENDRET 08.06.1998 AV O.GØYTIL ÅR2000                              */        
 /* ***************************************************************** */        
 OVERFØR_NI_SØKER:                                                              
   PROC;                                                                        
 %SKIP(2);                                                                      
                                                                                
   DCL (TELL1,TELL2) FIXED BIN(15);                                             
 %SKIP;                                                                         
      IF FNRL > 0 THEN                                                          
         NISF.FNR = FNRO;                                                       
                                                                                
                                                                                
      IF NAVNL > 0 THEN                                                         
         NISF.NAVN =                                                            
                    NAVNO;                                                      
                                                                                
                                                                                
      IF AVSENDERL > 0 THEN                                                     
         NISF.AVSENDER =                                                        
                    AVSENDERO;                                                  
                                                                                
                                                                                
      DO N = 1 TO 14;                                                           
                                                                                
        IF TYPEL (N) > 0 THEN                                                   
           NIS.TYPE(N) = TYPEO (N);                                             
                                                                                
        IF ETYPEL(N) > 0 THEN                                                   
           NIS.ETYPE(N) = ETYPEO (N);                                           
                                                                                
        IF ÅRL(N) > 0 THEN                                                      
           NIS.ÅR(N) =  KONV_ÅR_HÅ(ÅRO(N));                                     
                                                                                
        IF ARTL(N) > 0 THEN                                                     
           NIS.ART(N) =               ARTO(N) ;                                 
                                                                                
        IF MERKEL(N) > 0 THEN                                                   
           NIS.MERKE(N) =             MERKEO(N) ;                               
                                                                                
        IF KOMMNRL(N) > 0 THEN                                                  
           NIS.KOMMNR(N) =            KOMMNRO(N) ;                              
                                                                                
        IF INNTEKTL(N) > 0 THEN                                                 
           NIS.PG_INNTEKT(N) =        INNTEKTO(N) ;                             
                                                                                
        IF AGIVKODEL(N) > 0 THEN                                                
           NIS.AGIVKODE(N) =          AGIVKODEO(N) ;                            
                                                                                
      END;                                                                      
                                                                                
                                                                                
   /* HER NULLER EN TABELLEN ETTER DET FØRSTE ELEMENT SOM ER NULL */            
      DO TELL1 = 1 TO 7 UNTIL(NIS.ÅR(TELL1) = '0000');                          
      END;                                                                      
                                                                                
      DO TELL2 = TELL1 TO 7;                                                    
         NIS.ÅR        (TELL2) = 0;                                             
         NIS.TYPE      (TELL2) = ' ';                                           
         NIS.ETYPE     (TELL2) = ' ';                                           
         NIS.ART       (TELL2) = 0;                                             
         NIS.MERKE     (TELL2) = 0;                                             
         NIS.KOMMNR    (TELL2) = 0;                                             
         NIS.PG_INNTEKT(TELL2) = 0;                                             
         NIS.AGIVKODE  (TELL2) = 0;                                             
      END;                                                                      
                                                                                
                                                                                
      DO TELL1 = 8 TO 14 UNTIL(NIS.ÅR(TELL1) = '0000');                         
      END;                                                                      
                                                                                
      DO TELL2 = TELL1 TO 14;                                                   
         NIS.ÅR        (TELL2) = 0;                                             
         NIS.TYPE      (TELL2) = ' ';                                           
         NIS.ETYPE     (TELL2) = ' ';                                           
         NIS.ART       (TELL2) = 0;                                             
         NIS.MERKE     (TELL2) = 0;                                             
         NIS.KOMMNR    (TELL2) = 0;                                             
         NIS.PG_INNTEKT(TELL2) = 0;                                             
         NIS.AGIVKODE  (TELL2) = 0;                                             
      END;                                                                      
                                                                                
    END OVERFØR_NI_SØKER;                                                       
 %PAGE;                                /*  */                                   
 /* ***************************************************************** */        
 /*                                                                   */        
 /*    KONTROLL AV NI_SØKER.                                          */        
 /*                                                                   */        
 /* ***************************************************************** */        
 %SKIP(2);                                                                      
 KONTROLL_NI_SØKER:                                                             
   PROC (FEIL_FUNNET);                                                          
 %SKIP;                                                                         
   DCL START_LINJE   FIXED BIN(15);                                             
   DCL END_LINJE     FIXED BIN(15);                                             
                                                                                
   DCL                                                                          
      FEIL_FUNNET              BIT (1);                                         
   DCL                                                                          
      KEY_BIT                    BIT(32) BASED (KEY_PEKER),                     
      KEY_PEKER                  POINTER,                                       
      KOMMNR_RECL                CHAR (100);                                    
   DCL                                                                          
      KEY_BIT_ST                 BIT(32) BASED (KEY_PEKER_ST),                  
      KEY_PEKER_ST               POINTER,                                       
      STRYK_RECL                 CHAR (23),                                     
      KEY                        PIC '(15)9';                                   
  DCL HFELT                      PIC '(15)9';                                   
  /*                                                                            
   DCL                                                                          
      (       FEIL19,                                                           
              FEIL20,                                                           
              FEIL21,                                                           
              FEIL22,                                                           
              FEIL23,                                                           
              FEIL24,                                                           
              FEIL25)          BIT (1);                                         
   */                                                                           
                                                                                
   DCL                                                                          
      ANT_LINJER               FIXED BIN(15);                                   
                                                                                
   DCL                                                                          
      1 FNR_REG,                                                                
        2 FNR                                   FIXED DEC(11),                  
        2 FNR2                                  FIXED DEC(11),                  
        2 BRUKERID                              CHAR     ( 4),                  
                                                                                
      ALDER                                     FIXED DEC (5);                  
                                                                                
   DCL                                                                          
      1 FNR13,                                                                  
        2 DAG                                   PIC'(2)9',                      
        2 MND                                   PIC'(2)9',                      
        2 AAR                                   PIC'(4)9',                      
        2 ÅRHUNDRE                              PIC'9',                         
        2 REST                                  PIC'(4)9';                      
   DCL                                                                          
      W_FNR13 DEF FNR13                         PIC'(13)9';                     
                                                                                
   DCL                                                                          
      HJ_HÅMD                                   PIC'(8)9';                      
                                                                                
                                                                                
                                                                                
                                                                                
   FNR_REG.BRUKERID   =    DIV_PARAM_OMR.CICS_IND;                              
   /*                                                                           
   FEIL19             = '0'B;                                                   
   FEIL20             = '0'B;                                                   
   FEIL21             = '0'B;                                                   
   FEIL22             = '0'B;                                                   
   FEIL23             = '0'B;                                                   
   FEIL24             = '0'B;                                                   
   FEIL25             = '0'B;                                                   
   FEIL_FUNNET        = '0'B;                                                   
   */                                                                           
   W_FNR13            = KONV_FNR11_FNR13(NISF.FNR);                             
                                                                                
 %SKIP;                                                                         
                                                                                
    IF NISF.AVSENDER ^= '1Ø ' &                                                 
       NISF.AVSENDER ^= '1Ø ' &                                                 
       NISF.AVSENDER ^= '1BS' &    /*27.11.86 HL */                             
       NISF.AVSENDER ^= '1P ' &    /*05.03.87 AL */                             
       NISF.AVSENDER ^= 'FFU' &                                                 
       NISF.AVSENDER ^= 'DFS' &                                                 
       NISF.AVSENDER ^= 'LFS' &                                                 
       NISF.AVSENDER ^= 'SKD' &                                                 
       NISF.AVSENDER ^= 'OLK' &                                                 
       NISF.AVSENDER ^= 'RTV' &                                                 
       NISF.AVSENDER ^= 'SA ' THEN                                              
       DO;                                                                      
          FEIL_FUNNET     = '1'B;                                               
          NISF.AVSENDERNR = 284;                                                
       END;                                                                     
                                                                                
    IF ^F_NUMERISK (NISF.FNR)  THEN                                             
       DO;                                                                      
          FEIL_FUNNET = '1'B;                                                   
          NISF.FNRNR   = 200;                                                   
       END;                                                                     
    ELSE                                                                        
       IF ^F_GYLDIG_FNR(NISF.FNR) THEN                                          
          DO;                                                                   
             FEIL_FUNNET = '1'B;                                                
             NISF.FNRNR   = 1;                                                  
          END;                                                                  
       ELSE                                                                     
          DO;                                                                   
             FNR_REG.FNR = NISF.FNR;                                            
             EXEC CICS LINK PROGRAM('R0019906') COMMAREA(FNR_REG);              
             IF FNR_REG.FNR2 > 0 THEN                                           
                DO;                                                             
                   NISF.FNRNR   = 203;                                          
                   NISF.FNR     = FNR_REG.FNR2;                                 
                END;                                                            
          END;                                                                  
                                                                                
   DO K = 1 TO 2 ;                                                              
      IF K = 1 THEN                                                             
         DO;                                                                    
            START_LINJE = 1;                                                    
            END_LINJE   = 7;                                                    
         END;                                                                   
                                                                                
      IF K = 2 THEN                                                             
         DO;                                                                    
            START_LINJE = 8;                                                    
            END_LINJE   = 14;                                                   
         END;                                                                   
                                                                                
      HFELT     =      NIS.ÅR(START_LINJE)  ;                                   
                                                                                
      DO ANT_LINJER = START_LINJE TO END_LINJE   WHILE                          
                      ( FEIL_FUNNET = '0'B        &                             
                        NIS.ÅR(ANT_LINJER) > 0000   );                          
                                                                                
                                                                                
         KEY_PEKER = ADDR(NIS.KOMMNR(ANT_LINJER));                              
                                                                                
                                                                                
         IF VERIFY(NIS.TYPE(ANT_LINJER),'ABCDSUO') ^= 0 THEN                    
            DO;                                                                 
               IF ^FEIL_FUNNET THEN                                             
                  DO;                                                           
                     FEIL_FUNNET = '1'B;                                        
                     NIS.TYPENR(ANT_LINJER) = 245;                              
                  END;                                                          
               ELSE                                                             
                  NIS.TYPENR(ANT_LINJER)    = 999;                              
            END;                                                                
                                                                                
                                                                                
                                                                                
         IF VERIFY(NIS.ETYPE(ANT_LINJER),'019') ^= 0 THEN                       
            DO;                                                                 
               IF ^FEIL_FUNNET THEN                                             
                  DO;                                                           
                     FEIL_FUNNET = '1'B;                                        
                     NIS.ETYPENR(ANT_LINJER) = 258;                             
                  END;                                                          
               ELSE                                                             
                  NIS.ETYPENR(ANT_LINJER)    = 999;                             
            END;                                                                
                                                                                
                                                                                
                                                                                
                                                                                
         IF ^F_NUMERISK(NIS.ÅR(ANT_LINJER))  THEN                               
            DO;                                                                 
              IF ^FEIL_FUNNET THEN                                              
                 DO;                                                            
                    FEIL_FUNNET = '1'B;                                         
                    NIS.ÅRNR(ANT_LINJER) = 200;                                 
                 END;                                                           
              ELSE                                                              
                 NIS.ÅRNR(ANT_LINJER)    = 999;                                 
            END;                                                                
                                                                                
         ELSE                                                                   
            IF NIS.ÅR(ANT_LINJER) < 1963 THEN                                   
               DO;                                                              
                  IF ^FEIL_FUNNET THEN                                          
                     DO;                                                        
                        FEIL_FUNNET = '1'B;                                     
                        NIS.ÅRNR(ANT_LINJER) = 249;                             
                     END;                                                       
                  ELSE                                                          
                     NIS.ÅRNR(ANT_LINJER)    = 999;                             
               END;                                                             
                                                                                
                                                                                
            ELSE                                                                
               IF GV_TAB_ARRAY.INNTRAP_SPERREDATO                               
                                    (NIS.ÅR(ANT_LINJER)) = 99999999 THEN        
                  DO;                                                           
                     IF ^FEIL_FUNNET THEN                                       
                        DO;                                                     
                           FEIL_FUNNET = '1'B;                                  
                           NIS.ÅRNR(ANT_LINJER) = 249;                          
                        END;                                                    
                     ELSE                                                       
                        NIS.ÅRNR(ANT_LINJER) = 999;                             
                  END;                                                          
                                                                                
               ELSE                                                             
                  IF NIS.ÅR(ANT_LINJER) < 1967 THEN                             
                     DO;                                                        
                        IF ^FEIL_FUNNET THEN                                    
                           DO;                                                  
                              FEIL_FUNNET = '1'B;                               
                              NIS.ÅRNR(ANT_LINJER) = 251;                       
                           END;                                                 
                        ELSE                                                    
                           NIS.ÅRNR(ANT_LINJER) = 999;                          
                     END;                                                       
                  ELSE                                                          
                                                                                
                     IF NISF.FNRNR = 0 THEN                                     
                                                                                
                        DO;                                                     
                           HJ_HÅMD      = NIS.ÅR(ANT_LINJER) * 10000;           
                        /* ALDER        = F_ALDER(NISF.FNR,HJ_MÅ); */           
                                                                                
                           ALDER = F_ALDER(NISF.FNR,HJ_HÅMD);                   
                                                                                
                           IF ^(ALDER < 7000 &                                  
                                           ALDER > 1511) THEN                   
                              DO;                                               
                                 IF ^FEIL_FUNNET THEN                           
                                    DO;                                         
                                       FEIL_FUNNET = '1'B;                      
                                       NIS.ÅRNR(ANT_LINJER) = 252;              
                                    END;                                        
                                 ELSE                                           
                                    NIS.ÅRNR(ANT_LINJER) = 999;                 
                              END;                                              
                         END;                                                   
                                                                                
                                                                                
                                                                                
                                                                                
         IF ^F_NUMERISK(NIS.ART(ANT_LINJER))  THEN                              
            DO;                                                                 
               IF ^FEIL_FUNNET THEN                                             
                  DO;                                                           
                     FEIL_FUNNET = '1'B;                                        
                     NIS.ARTNR(ANT_LINJER) = 200;                               
                  END;                                                          
               ELSE                                                             
                  NIS.ARTNR(ANT_LINJER)    = 999;                               
            END;                                                                
         ELSE                                                                   
                                                                                
                                                                                
            IF VERIFY((NIS.ART(ANT_LINJER)),'0123456') ^= 0 THEN                
               DO;                                                              
                  IF ^FEIL_FUNNET THEN                                          
                     DO;                                                        
                        FEIL_FUNNET = '1'B;                                     
                        NIS.ARTNR(ANT_LINJER) = 246;                            
                     END;                                                       
                  ELSE                                                          
                     NIS.ARTNR(ANT_LINJER)    = 999;                            
               END;                                                             
                                                                                
            ELSE                                                                
             IF ( NIS.ART(ANT_LINJER) = 3 &                                     
                  NIS.TYPE(ANT_LINJER) ^= 'B' ) THEN                            
               DO;                                                              
                  IF ^FEIL_FUNNET THEN                                          
                     DO;                                                        
                        FEIL_FUNNET = '1'B;                                     
                        NIS.ARTNR(ANT_LINJER) = 285;                            
                     END;                                                       
                  ELSE                                                          
                     NIS.ARTNR(ANT_LINJER)    = 999;                            
               END;                                                             
                                                                                
                                                                                
         IF ^F_NUMERISK(NIS.MERKE(ANT_LINJER))  THEN                            
            DO;                                                                 
               IF ^FEIL_FUNNET THEN                                             
                  DO;                                                           
                     FEIL_FUNNET = '1'B;                                        
                     NIS.MERKENR(ANT_LINJER) = 200;                             
                  END;                                                          
               ELSE                                                             
                  NIS.MERKENR(ANT_LINJER)    = 999;                             
            END;                                                                
         ELSE                                                                   
            IF VERIFY((NIS.MERKE(ANT_LINJER)),'0123459') ^= 0 THEN              
               DO;                                                              
                  IF ^FEIL_FUNNET THEN                                          
                     DO;                                                        
                        FEIL_FUNNET = '1'B;                                     
                        NIS.MERKENR(ANT_LINJER) = 247;                          
                     END;                                                       
                  ELSE                                                          
                     NIS.MERKENR(ANT_LINJER)    = 999;                          
               END;                                                             
                                                                                
            ELSE                                                                
             IF (NIS.TYPE(ANT_LINJER) ^= 'A') THEN                              
              DO;                                                               
               IF (NISF.AVSENDER = 'FFU' &                                      
                  (NIS.MERKE(ANT_LINJER) ^= 2 !                                 
                   NIS.TYPE(ANT_LINJER) ^= 'D')) !                              
                                                                                
                  (NISF.AVSENDER = 'DFS' &                                      
                   NIS.TYPE(ANT_LINJER) ^= 'C' ) !                              
                                                                                
                  (NISF.AVSENDER = 'LFS' &                                      
                   NIS.TYPE(ANT_LINJER) ^= 'S' ) !                              
                                                                                
                  (NISF.AVSENDER = 'SKD' &                                      
                   NIS.TYPE(ANT_LINJER) ^= 'B' ) !                              
                                                                                
                  (NISF.AVSENDER = 'RTV' &                                      
                   NIS.TYPE(ANT_LINJER) ^= 'O' ) !                              
                                                                                
                  (NISF.AVSENDER = 'OLK' &                                      
                   NIS.TYPE(ANT_LINJER) ^= 'U' )  THEN                          
                  DO;                                                           
                     IF ^FEIL_FUNNET THEN                                       
                        DO;                                                     
                           FEIL_FUNNET = '1'B;                                  
                           NIS.TYPENR(ANT_LINJER) = 245;                        
                           NISF.AVSENDERNR        = 999;                        
                        END;                                                    
                     ELSE                                                       
                        NIS.TYPENR(ANT_LINJER)    = 999;                        
                  END;                                                          
              END;                                                              
                                                                                
                                                                                
          IF (NIS.TYPE(ANT_LINJER) = 'B' &                                      
              NIS.MERKE(ANT_LINJER) ^= 0   &                                    
              NIS.MERKE(ANT_LINJER) ^= 1   &                                    
              NIS.MERKE(ANT_LINJER) ^= 4)  THEN                                 
              DO;                                                               
                IF ^FEIL_FUNNET THEN                                            
                   DO;                                                          
                      FEIL_FUNNET = '1'B;                                       
                      NIS.MERKENR(ANT_LINJER) = 287;                            
                      NIS.TYPENR(ANT_LINJER)  = 999;                            
                   END;                                                         
                ELSE                                                            
                   NIS.MERKENR(ANT_LINJER)    = 999;                            
              END;                                                              
                                                                                
                                                                                
          IF (NIS.TYPE(ANT_LINJER) = 'C ' &                                     
              NIS.MERKE(ANT_LINJER) ^= 0)  !                                    
                                                                                
             (NIS.TYPE(ANT_LINJER) = 'S ' &                                     
              NIS.MERKE(ANT_LINJER) ^= 0)  !                                    
                                                                                
             (NIS.TYPE(ANT_LINJER) = 'U ' &                                     
              NIS.MERKE(ANT_LINJER) ^= 0)     THEN                              
                                                                                
              DO;                                                               
                IF ^FEIL_FUNNET THEN                                            
                   DO;                                                          
                      FEIL_FUNNET = '1'B;                                       
                      NIS.MERKENR(ANT_LINJER) = 286;                            
                      NIS.TYPENR(ANT_LINJER)  = 999;                            
                   END;                                                         
                ELSE                                                            
                   NIS.MERKENR(ANT_LINJER)    = 999;                            
              END;                                                              
                                                                                
                                                                                
          IF (NIS.TYPE(ANT_LINJER) = 'D ' &                                     
              NIS.MERKE(ANT_LINJER) ^= 0   &                                    
              NIS.MERKE(ANT_LINJER) ^= 1   &                                    
              NIS.MERKE(ANT_LINJER) ^= 2   &                                    
              NIS.MERKE(ANT_LINJER) ^= 3)  THEN                                 
                                                                                
              DO;                                                               
                IF ^FEIL_FUNNET THEN                                            
                   DO;                                                          
                      FEIL_FUNNET = '1'B;                                       
                      NIS.MERKENR(ANT_LINJER) = 288;                            
                      NIS.TYPENR(ANT_LINJER)  = 999;                            
                   END;                                                         
                ELSE                                                            
                   NIS.MERKENR(ANT_LINJER)    = 999;                            
              END;                                                              
                                                                                
                                                                                
         IF ^F_NUMERISK(NIS.KOMMNR(ANT_LINJER))  THEN                           
            DO;                                                                 
               IF ^FEIL_FUNNET THEN                                             
                  DO;                                                           
                     FEIL_FUNNET = '1'B;                                        
                     NIS.KOMMNRNR(ANT_LINJER) = 200;                            
                  END;                                                          
               ELSE                                                             
                  NIS.KOMMNRNR(ANT_LINJER)    = 999;                            
            END;                                                                
         ELSE                                                                   
            IF ^((NIS.TYPE(ANT_LINJER) = 'D'     &                              
                  NISF.AVSENDER        = 'FFU'   &                              
                  NIS.KOMMNR(ANT_LINJER) = 2101) !                              
                  (NIS.TYPE(ANT_LINJER) = 'A'  &                                
                   NIS.KOMMNR(ANT_LINJER) = 0000) )  THEN                       
                                                                                
 /* ************************************************************ */             
 /* ENDRET 260489 BF : DET REGISTRERTE KOMMNR SKAL BENYTTES.     */             
 /*                    IFØLGE LISTE OVER ENDR.I INNT.RUTINEN.    */             
 /*                                                              */             
 /*         IF NIS.TYPE(ANT_LINJER) = 'D' &                      */             
 /*                                                              */             
 /* ENDRET 27.11.86 - HL - FRAPP 398 OG 427                      */             
 /*                                                              */             
 /*                       (NISF.AVSENDER = 'FFU'   !             */             
 /*                        NISF.AVSENDER = '1Ø '   !             */             
 /*                        NISF.AVSENDER = '1ø '   !             */             
 /*                        NISF.AVSENDER = '1P '   !             */             
 /*                        NISF.AVSENDER = '1BS'   )  THEN       */             
 /*                                                              */             
 /* HIT 27.11.86 HL                                              */             
 /*                                                              */             
 /*            NIS.KOMMNR(ANT_LINJER) = 2101;                    */             
 /*         ELSE                                                 */             
 /*                                                              */             
 /* HIT    260489 BF                                             */             
 /* ************************************************************ */             
                                                                                
            IF NIS.TYPE(ANT_LINJER) = 'S' THEN                                  
               NIS.KOMMNR(ANT_LINJER) = 0000;                                   
            ELSE                                                                
               DO;                                                              
                  EXEC CICS HANDLE CONDITION NOTFND(NOTFND1);                   
                  EXEC CICS READ DATASET ('LIKNING') RIDFLD(KEY_BIT)            
                                                    INTO(KOMMNR_RECL);          
                  GOTO KOMM_UT1;                                                
              NOTFND1:                                                          
                                                                                
                                                                                
                  IF ^((NIS.KOMMNR(ANT_LINJER) > 6000 &                         
                        NIS.KOMMNR(ANT_LINJER) < 7001  ) !                      
                        NIS.KOMMNR(ANT_LINJER) = 9000      ) THEN               
                     DO;                                                        
                        IF ^FEIL_FUNNET THEN                                    
                           DO;                                                  
                              FEIL_FUNNET = '1'B;                               
                              NIS.KOMMNRNR(ANT_LINJER) = 248;                   
                           END;                                                 
                        ELSE                                                    
                           NIS.KOMMNRNR(ANT_LINJER) = 999;                      
                        LEAVE;                                                  
                     END;                                                       
              KOMM_UT1:                                                         
                  IF NIS.TYPE(ANT_LINJER)     = 'U' &                           
                     NIS.KOMMNR(ANT_LINJER)  ^= 0301   THEN                     
                     IF ^FEIL_FUNNET THEN                                       
                        DO;                                                     
                           FEIL_FUNNET = '1'B;                                  
                           NIS.KOMMNRNR(ANT_LINJER) = 248;                      
                        END;                                                    
               END;                                                             
                                                                                
                                                                                
    /* ************************************************** */                    
    /* KONTROLL AV ACF2 FOR TILLGANGE TIL TKNR            */                    
    /*                                                    */                    
    /* ************************************************** */                    
    /*                                                                          
    BO_TKNR  = KOMMNR(ANT_LINJER);                                              
    IF KOMMNRNR(ANT_LINJER)  = 0          &                                     
       SUBSTR(DIV_PARAM_OMR.CICS_NAVN,5,4) = 'P001'  ) THEN                     
       SUBSTR(DIV_PARAM_OMR.CICS_NAVN,5,4) = 'ACF2'  ) THEN                     
       DO;                                                                      
           CALL  KONTROLL_ACF2;                                                 
           IF FEIL_MELD_NR    >  0  THEN                                        
              DO;                                                               
                 FEIL_FUNNET = '1'B;                                            
                 KOMMNRNR (ANT_LINJER) = FEIL_MELD_NR;                          
                                                                                
             END;                                                               
       END;                                                                     
                                                                                
    */                                                                          
   /* ******************************************** */                           
   /* NY TESTING SP 15.11.93                       */                           
   /* ******************************************** */                           
         IF  NIS.ART(ANT_LINJER)         = 4   &                                
             NIS.PG_INNTEKT(ANT_LINJER)  > 0   THEN                             
             DO;                                                                
                IF ^FEIL_FUNNET THEN                                            
                    DO;                                                         
                       FEIL_FUNNET = '1'B;                                      
                       NIS.ARTNR(ANT_LINJER) = 248;                             
                    END;                                                        
                ELSE                                                            
                       NIS.ARTNR(ANT_LINJER) = 999;                             
            END;                                                                
                                                                                
         IF  (NIS.TYPE(ANT_LINJER) = 'J'     &                                  
              NIS.ART(ANT_LINJER)  ^= 4 )    !                                  
             (NIS.TYPE(ANT_LINJER) = 'K'     &                                  
              NIS.ART(ANT_LINJER)  ^= 5 )    !                                  
             (NIS.TYPE(ANT_LINJER) = 'L'     &                                  
              NIS.ART(ANT_LINJER)  ^= 6 )    THEN                               
            DO;                                                                 
                IF ^FEIL_FUNNET THEN                                            
                    DO;                                                         
                       FEIL_FUNNET = '1'B;                                      
                       NIS.ARTNR(ANT_LINJER) = 248;                             
                    END;                                                        
                ELSE                                                            
                       NIS.ARTNR(ANT_LINJER) = 999;                             
            END;                                                                
                                                                                
         IF (NIS.TYPE(ANT_LINJER) = 'J'     !                                   
             NIS.TYPE(ANT_LINJER) = 'K'     !                                   
             NIS.TYPE(ANT_LINJER) = 'L' )   &                                   
             NIS.ÅR(ANT_LINJER)  < 1992   THEN                                  
            DO;                                                                 
                IF ^FEIL_FUNNET THEN                                            
                    DO;                                                         
                       FEIL_FUNNET = '1'B;                                      
                       NIS.ÅRNR(ANT_LINJER) = 248;                              
                    END;                                                        
                ELSE                                                            
                       NIS.ÅRNR(ANT_LINJER) = 999;                              
            END;                                                                
                                                                                
   /* HIT TIL            ************************* */                           
                                                                                
                                                                                
         IF ^F_NUMERISK(NIS.AGIVKODE(ANT_LINJER)) THEN                          
            DO;                                                                 
               IF ^FEIL_FUNNET THEN                                             
                  DO;                                                           
                     FEIL_FUNNET = '1'B;                                        
                     NIS.AGIVKODENR(ANT_LINJER) = 200;                          
                  END;                                                          
               ELSE                                                             
                  NIS.AGIVKODENR(ANT_LINJER)    = 999;                          
            END;                                                                
         ELSE                                                                   
            IF NIS.AGIVKODE(ANT_LINJER) > 0  &                                  
               NIS.TYPE(ANT_LINJER) ^= 'D' THEN                                 
               DO;                                                              
                  IF ^FEIL_FUNNET THEN                                          
                     DO;                                                        
                        FEIL_FUNNET = '1'B;                                     
                        NIS.TYPENR(ANT_LINJER) = 257;                           
                     END;                                                       
                  ELSE                                                          
                     NIS.TYPENR(ANT_LINJER)    = 999;                           
               END;                                                             
                                                                                
               KEY          = NISF.FNR * 10000 + NIS.ÅR(ANT_LINJER);            
               KEY_PEKER_ST = ADDR(KEY);                                        
                                                                                
               EXEC CICS HANDLE CONDITION NOTFND(ALT_OK1);                      
               EXEC CICS READ DATASET ('STRYK') RIDFLD(KEY_BIT_ST)              
                                                INTO(STRYK_RECL);               
               IF ^FEIL_FUNNET THEN                                             
                  DO;                                                           
                     FEIL_FUNNET = '1'B;                                        
                     NIS.ÅRNR(ANT_LINJER) = 266;                                
                  END;                                                          
               ELSE                                                             
                  NIS.ÅRNR(ANT_LINJER)    = 999;                                
                                                                                
                                                                                
  ALT_OK1:                                                                      
      END;                                                                      
                                                                                
                                                                                
                                                                                
      IF FEIL_FUNNET = '1'B  THEN                                               
          K = 3;                                                                
  END;                         /*        END K = 1 TO 2           */            
                                                                                
      FØDSNUMMER  = NISF.FNR;                                                   
   /*                                                                           
      FEIL_FUNNET = FEIL_FUNNET ! FEIL19 ! FEIL20 ! FEIL21 ! FEIL22 !           
                                  FEIL23 ! FEIL24 ! FEIL25;                     
   */                                                                           
                                                                                
   END KONTROLL_NI_SØKER;                                                       
 %PAGE;                                /*  */                                   
 /* ***************************************************************** */        
 /*                                                                   */        
 /*    BLANKING AV MELDINGSNUMMER.                                    */        
 /*                                                                   */        
 /* ***************************************************************** */        
 %SKIP(2);                                                                      
 BLANK_MELDNR:                                                                  
   PROC;                                                                        
     NISF.FNRNR                = 0;                                             
     NISF.NAVNNR               = 0;                                             
     NISF.AVSENDERNR           = 0;                                             
     DO I = 1 TO 14;                                                            
        NIS.TYPENR      (I)    = 0;                                             
        NIS.ETYPENR     (I)    = 0;                                             
        NIS.ÅRNR        (I)    = 0;                                             
        NIS.ARTNR       (I)    = 0;                                             
        NIS.MERKENR     (I)    = 0;                                             
        NIS.KOMMNRNR    (I)    = 0;                                             
        NIS.PG_INNTEKTNR(I)    = 0;                                             
        NIS.AGIVKODENR  (I)    = 0;                                             
     END;                                                                       
   END BLANK_MELDNR;                                                            
 %SKIP;                                                                         
