 /*       SIST ENDRET 19/01-98 11.22.03 AV   SPA7339                  */00000000
 %SKIP;                                /*  */                           00000010
 /* ***************************************************************** */00000020
 /*                                                                   */00000030
 /* ***************************************************************** */00000040
 /*IDENTIFIKASJON:                                                    */00000050
 /* **********************                                            */00000060
 /*  PROGRAM-IDENT : R0010506   AP_TRANS_TIL_MAP   SUBPROGRAM         */00000070
 /*  PROGRAM-SPRÅK : PLI                                              */00000080
 /*  PROGRAMMERER  : INGER SLOTTE                                     */00000090
 /*  PROGRAMMET BLE LAGET : MARS 1981                                 */00000100
 /*  ENDRINGSDATO_ÅMD :                                               */00000110
 /*  ENDRINGEN GJELDER:                                               */00000120
 /*  ENDRINGEN BLE UTFØRT AV :                                        */00000130
 /*                                                                   */00000140
 /* ***************************************************************** */00000150
 /*HENSIKT:                                                           */00000160
 /* **********                                                        */00000170
 /*  BRUKES VED REGISTRERING AV GRUNNBLANKETT AP.                     */00000180
 /*  OVERFØRER DATA FRA AP_TRANS_OMR TIL SKJERMBILDET.                */00000190
 /*  BRUKER MAP S001051 MAPSET S001053.                               */00000200
 /*                                                                   */00000210
 /* ***************************************************************** */00000220
 /*PROGRAMTILKNYTTING:                                                */00000230
 /* ********************                                              */00000240
 /*  PROGRAMMET INCLUDES AV R0010501 - KONTROLL_GRUNNBLANKETT_AP.     */00000250
 /*  ALLE CICS-KOMMANDOS LIGGER I HOVEDPROG.                          */00000260
 /*  ARBEIDSOMRÅDET P0010501, OG MAPEN ER INCLUDET I HOVEDPROG.       */00000270
 /*  PROGRAMMET HAR CALL TIL :                                        */00000280
 /*    R0019944 - SKRIV_FEIL          INCLUDE I HOVEDPROG             */00000290
 /*    R0010507 - BLOKKERE_SPES                 " "                   */00000300
 /*    R0010507 - BLOKKERE_BARN                 " "                   */00000310
 /*                                                                   */00000320
 /*  PROGRAMMET BRUKER FUNKSJONEN :                                   */00000330
 /*    R0019912 - F_FELT_PIC_CHARNN   INCLUDE I HOVEDPROG             */00000340
 /*                                                                   */00000350
 /*  INTERNE PROSEDYRER :                                             */00000360
 /*    OVERFØR_APSØKER_MAP:    OVERFØRING AV APDELEN                  */00000370
 /*    OVERFØR_APSPES_MAP:     OVERFØRING AV SPESIELL DEL             */00000380
 /*    OVERFØR_BARN_MAP:       OVERFØRING BARNEDELEN                  */00000390
 /*                                                                   */00000400
 /* ***************************************************************** */00000410
 /*DATASETTOPPLYSNINGER:                                              */00000420
 /* ***********************                                           */00000430
 /*    INGEN                                                          */00000440
 /* ***************************************************************** */00000450
 /*FEILMELDINGER:                                                     */00000460
 /* *******************                                               */00000470
 /*    LEGGES UT PÅ SKJERMBILDET (MAP S001051) VED CALL               */00000480
 /*    TIL R0019944 - SKRIV_FEIL                                      */00000490
 /*                                                                   */00000500
 /* ***************************************************************** */00000510
 /*                                                                   */00000520
 %PAGE;                                /*   */                          00000530
 /* ***************************************************************** */00000540
 /*                                                                   */00000550
 /*   PROSEDYRA OVERFØRER DATA FRA AP_TRANS_OMR.APS TIL               */00000560
 /*   SKJERMBILDE AP_SØKER DELEN.                                     */00000570
 /*   MAP: S001051                                                    */00000580
 /*   MAPSET: S001053                                                 */00000590
 /*                                                                   */00000600
 /* ***************************************************************** */00000610
 %SKIP(2);                                                              00000620
 OVERFØR_APSØKER_MAP:                                                   00000630
   PROC;                                                                00000640
   DCL                                                                  00000650
      NORMAL  CHAR (1) INIT(' '),                                       00000660
      NOR_NUM CHAR (1) INIT('&'),                                       00000670
      BRI_NUM CHAR (1) INIT('Q');                                       00000680
                                                                        00000690
      S001051O.REGDATOO      = KONV_HÅMD_ÅMD(APS.REGDATO_ÅMD);          00000700
      S001051O.TERMIDO       = APS.TERMID;                              00000710
      S001051O.FNRO          = F_FELT_PIC_CHAR11 (APS.FNR);             00000720
      S001051O.NAVNO         = APS.NAVN;                                00000730
      S001051O.TKNRO         = F_FELT_PIC_CHAR4 (APS.TKNR);             00000740
      S001051O.TILL_EKO      = APS.TILL_EK;                             00000750
      S001051O.SIVILSTANDO   = APS.SIVILSTAND;                          00000760
      S001051O.SPRÅKO        = APS.SPRÅK;                               00000770
      IF F_FELT_PIC_CHAR2(APS.BT_ANT) ^= (2)'0' THEN                    00000780
         S001051O.BT_ANTO    = F_FELT_PIC_CHAR2 (APS.BT_ANT);           00000790
      S001051O.NORSK_BOSATTO = APS.NORSK_BOSATT;                        00000800
      S001051O.FAIO          = F_FELT_PIC_CHAR7 (APS.FAI);              00000810
      S001051O.APDO          = F_FELT_PIC_CHAR3 (APS.APD);              00000820
      S001051O.VIRK_DATO_MÅO  = KONV_HÅMD_MÅ (APS.VIRK_DATO_ÅMD);       00000830
      IF F_FELT_PIC_CHAR11 (APS.FNR_EK) ^= '00000000000' THEN           00000840
         S001051O.FNR_EKO    = F_FELT_PIC_CHAR11 (APS.FNR_EK);          00000850
      S001051O.NAVN_EKO      = APS.NAVN_EK;                             00000860
      S001051O.MINST4GO      = APS.EK_INNT;                             00000870
                                                                        00000880
 /* FEILMELDINGER MARKERING AV  FELT (ATTRIBUTTENE) */                  00000890
 %SKIP(2);                                                              00000900
      S001051O.DUMMYA = '_';                                            00000910
                                                                        00000920
  /*DERSOM FEIL FRA BEHANDLE-TRANS OVERFØRES FEIL HER,BARE FØRSTE GANG*/00000930
       IF ^ FRA_CICS THEN                                               00000940
          DO;                                                           00000950
            IF FEIL_MELD_NR > 0 THEN                                    00000960
               CALL SKRIV_FEIL(FEIL_MELD_NR);                           00000970
             FEIL_MELD_NR = 0;                                          00000980
          END;                                                          00000990
                                                                        00001000
         S001051O.REGDATOA = DFHBMASK;                                  00001010
         S001051O.TERMIDA  = DFHBMASK;                                  00001020
                                                                        00001030
      IF APS.FNRNR = 0 THEN                                             00001040
         S001051O.FNRA = NOR_NUM;                                       00001050
      ELSE                                                              00001060
         DO;                                                            00001070
            S001051O.FNRA = BRI_NUM;                                    00001080
            S001051I.FNRL = CURSOR_POS;                                 00001090
            IF APS.FNRNR ^= 999 THEN                                    00001100
               CALL SKRIV_FEIL(APS.FNRNR);                              00001110
         END;                                                           00001120
      IF APS.TKNRNR = 0 THEN                                            00001130
         S001051O.TKNRA      = NOR_NUM;                                 00001140
      ELSE                                                              00001150
         DO;                                                            00001160
            S001051O.TKNRA          = BRI_NUM;                          00001170
            S001051I.TKNRL          = CURSOR_POS;                       00001180
            IF APS.TKNRNR ^= 999 THEN                                   00001190
               CALL SKRIV_FEIL(APS.TKNRNR);                             00001200
         END;                                                           00001210
      IF APS.NAVNNR = 0 THEN                                            00001220
         S001051O.NAVNA      = NORMAL;                                  00001230
      ELSE                                                              00001240
         DO;                                                            00001250
            S001051O.NAVNA          = DFHBMBRY;                         00001260
            S001051I.NAVNL          = CURSOR_POS;                       00001270
            IF APS.NAVNNR ^= 999 THEN                                   00001280
               CALL SKRIV_FEIL(APS.NAVNNR);                             00001290
         END;                                                           00001300
      IF APS.SPRÅKNR = 0 THEN                                           00001310
         S001051O.SPRÅKA      = NORMAL;                                 00001320
      ELSE                                                              00001330
         DO;                                                            00001340
            S001051O.SPRÅKA          = DFHBMBRY;                        00001350
            S001051I.SPRÅKL          = CURSOR_POS;                      00001360
            IF APS.SPRÅKNR ^= 999 THEN                                  00001370
               CALL SKRIV_FEIL(APS.SPRÅKNR);                            00001380
         END;                                                           00001390
      IF APS.SIVILSTANDNR = 0 THEN                                      00001400
         S001051O.SIVILSTANDA      = NORMAL;                            00001410
      ELSE                                                              00001420
         DO;                                                            00001430
            S001051O.SIVILSTANDA          = DFHBMBRY;                   00001440
            S001051I.SIVILSTANDL          = CURSOR_POS;                 00001450
            IF APS.SIVILSTANDNR ^= 999 THEN                             00001460
               CALL SKRIV_FEIL(APS.SIVILSTANDNR);                       00001470
         END;                                                           00001480
      IF APS.TILL_EKNR = 0 THEN                                         00001490
         S001051O.TILL_EKA      = NORMAL;                               00001500
      ELSE                                                              00001510
         DO;                                                            00001520
            S001051O.TILL_EKA          = DFHBMBRY;                      00001530
            S001051I.TILL_EKL          = CURSOR_POS;                    00001540
            IF APS.TILL_EKNR ^= 999 THEN                                00001550
               CALL SKRIV_FEIL(APS.TILL_EKNR);                          00001560
         END;                                                           00001570
      IF APS.NORSK_BOSATTNR = 0 THEN                                    00001580
         S001051O.NORSK_BOSATTA      = NORMAL;                          00001590
      ELSE                                                              00001600
         DO;                                                            00001610
            S001051O.NORSK_BOSATTA          = DFHBMBRY;                 00001620
            S001051I.NORSK_BOSATTL          = CURSOR_POS;               00001630
            IF APS.NORSK_BOSATTNR ^= 999 THEN                           00001640
               CALL SKRIV_FEIL(APS.NORSK_BOSATTNR);                     00001650
         END;                                                           00001660
      IF APS.BT_ANTNR = 0 THEN                                          00001670
         S001051O.BT_ANTA    = NOR_NUM;                                 00001680
      ELSE                                                              00001690
         DO;                                                            00001700
            S001051O.BT_ANTA          = BRI_NUM;                        00001710
            S001051I.BT_ANTL          = CURSOR_POS;                     00001720
            IF APS.BT_ANTNR ^= 999 THEN                                 00001730
               CALL SKRIV_FEIL(APS.BT_ANTNR);                           00001740
         END;                                                           00001750
      IF APS.FAINR = 0 THEN                                             00001760
         S001051O.FAIA      = NOR_NUM;                                  00001770
      ELSE                                                              00001780
         DO;                                                            00001790
            S001051O.FAIA          = BRI_NUM;                           00001800
            S001051I.FAIL          = CURSOR_POS;                        00001810
            IF APS.FAINR ^= 999 THEN                                    00001820
               CALL SKRIV_FEIL(APS.FAINR);                              00001830
         END;                                                           00001840
      IF APS.APDNR = 0 THEN                                             00001850
         S001051O.APDA      = NOR_NUM;                                  00001860
      ELSE                                                              00001870
         DO;                                                            00001880
            S001051O.APDA          = BRI_NUM;                           00001890
            S001051I.APDL          = CURSOR_POS;                        00001900
            IF APS.APDNR ^= 999 THEN                                    00001910
               CALL SKRIV_FEIL(APS.APDNR);                              00001920
         END;                                                           00001930
      IF APS.VIRK_DATO_ÅMDNR = 0 THEN                                   00001940
         S001051O.VIRK_DATO_MÅA     = NOR_NUM;                          00001950
      ELSE                                                              00001960
         DO;                                                            00001970
            S001051O.VIRK_DATO_MÅA         = BRI_NUM;                   00001980
            S001051I.VIRK_DATO_MÅL         = CURSOR_POS;                00001990
            IF APS.VIRK_DATO_ÅMDNR ^= 999 THEN                          00002000
               CALL SKRIV_FEIL(APS.VIRK_DATO_ÅMDNR);                    00002010
         END;                                                           00002020
      IF APS.FNR_EKNR = 0 THEN                                          00002030
         S001051O.FNR_EKA      = NOR_NUM;                               00002040
      ELSE                                                              00002050
         DO;                                                            00002060
            S001051O.FNR_EKA          = BRI_NUM;                        00002070
            S001051I.FNR_EKL          = CURSOR_POS;                     00002080
            IF APS.FNR_EKNR ^= 999 THEN                                 00002090
               CALL SKRIV_FEIL(APS.FNR_EKNR);                           00002100
         END;                                                           00002110
      IF APS.NAVN_EKNR = 0 THEN                                         00002120
         S001051O.NAVN_EKA      = NORMAL;                               00002130
      ELSE                                                              00002140
         DO;                                                            00002150
            S001051O.NAVN_EKA          = DFHBMBRY;                      00002160
            S001051I.NAVN_EKL          = CURSOR_POS;                    00002170
            IF APS.NAVN_EKNR ^= 999 THEN                                00002180
               CALL SKRIV_FEIL(APS.NAVN_EKNR);                          00002190
         END;                                                           00002200
      IF APS.EK_INNTNR = 0 THEN                                         00002210
         S001051O.MINST4GA      = NORMAL;                               00002220
      ELSE                                                              00002230
         DO;                                                            00002240
            S001051O.MINST4GA          = DFHBMBRY;                      00002250
            S001051I.MINST4GL          = CURSOR_POS;                    00002260
            IF APS.EK_INNTNR ^= 999 THEN                                00002270
               CALL SKRIV_FEIL(APS.EK_INNTNR);                          00002280
         END;                                                           00002290
                                                                        00002300
      /* VED GAMLE TRANS SKAL FNR OG VIRKDATO_ÅMDBLOKKERES */           00002310
                                                                        00002320
     IF TRANS_OPPL_OMR.NY_GML_TRANS_IND = 'G' & FRA_MED_DIALOG THEN     00002330
        DO;                                                             00002340
          S001051O.FNRA          = DFHBMASK;       /* PROT AND ASKIP */ 00002350
          S001051O.VIRK_DATO_MÅA  = DFHBMASK;                           00002360
        END;                                                            00002370
                                                                        00002380
     ELSE IF FRA_UTEN_DIALOG THEN    /* BLOKKER ALT SAMMEN    */        00002390
                                                                        00002400
        DO;                                                             00002410
          S001051O.REGDATOA      = DFHBMASK;                            00002420
          S001051O.TERMIDA       = DFHBMASK;                            00002430
          S001051O.FNRA          = DFHBMASK;                            00002440
          S001051O.NAVNA         = DFHBMASK;                            00002450
          S001051O.TKNRA         = DFHBMASK;                            00002460
          S001051O.TILL_EKA      = DFHBMASK;                            00002470
          S001051O.SIVILSTANDA   = DFHBMASK;                            00002480
          S001051O.SPRÅKA        = DFHBMASK;                            00002490
          S001051O.BT_ANTA       = DFHBMASK;                            00002500
          S001051O.NORSK_BOSATTA = DFHBMASK;                            00002510
          S001051O.FAIA          = DFHBMASK;                            00002520
          S001051O.APDA          = DFHBMASK;                            00002530
          S001051O.VIRK_DATO_MÅA  = DFHBMASK;                           00002540
          S001051O.FNR_EKA       = DFHBMASK;                            00002550
          S001051O.NAVN_EKA      = DFHBMASK;                            00002560
          S001051O.MINST4GA      = DFHBMASK;                            00002570
          MELDING6O = 'TRYKK PF1 FOR OPPBEVAR, PF2 FOR FORKASTE.';      00002580
        END;                                                            00002590
                                                                        00002600
     IF ^ FRA_CICS THEN                                                 00002610
        DO;                                                             00002620
          S001051O.STYRE_KODEA    = DFHBMASK;                           00002630
          S001051O.FUNKSJONSKODEA = DFHBMASK;                           00002640
        END;                                                            00002650
                                                                        00002660
   END OVERFØR_APSØKER_MAP;                                             00002670
 %PAGE;                                /*    */                         00002680
 /* ***************************************************************** */00002690
 /*                                                                   */00002700
 /*   PROSEDYRA OVERFØRER DATA FRA AP_TRANS_OMR.APS TIL               */00002710
 /*   SKJERMBILDE AP_SPES. DELEN.                                     */00002720
 /*   MAP: S001051                                                    */00002730
 /*   MAPSET: S001053                                                 */00002740
 /*                                                                   */00002750
 /* ***************************************************************** */00002760
 %SKIP(2);                                                              00002770
 OVERFØR_APSPES_MAP:                                                    00002780
   PROC;                                                                00002790
   DCL                                                                  00002800
      NORMAL  CHAR (1) INIT(' '),                                       00002810
      NOR_NUM CHAR (1) INIT('&'),                                       00002820
      BRI_NUM CHAR (1) INIT('Q');                                       00002830
                                                                        00002840
 %SKIP;                                                                 00002850
      IF F_FELT_PIC_CHAR3(APSP.STATSBORGER) ^= '000' THEN               00002860
         S001051O.STATSBORGERO    = F_FELT_PIC_CHAR3(APSP.STATSBORGER); 00002870
      IF F_FELT_PIC_CHAR3(APSP.BOSATT)      ^= '000' THEN               00002880
         S001051O.BOSATTO            = F_FELT_PIC_CHAR3(APSP.BOSATT);   00002890
      S001051O.FRAVIK_19_3O          = APSP.FRAVIK_19_3;                00002900
      S001051O.FRAVIK_FLYKTO         = APSP.FRAVIK_FLYKT;               00002910
      S001051O.OVERKOMP_UTLO         = APSP.OVERKOMP_UTL;               00002920
      IF F_FELT_PIC_CHAR2(APSP.TT_F67)      ^= '00' THEN                00002930
         S001051O.TT_F67O            = F_FELT_PIC_CHAR2(APSP.TT_F67);   00002940
      IF F_FELT_PIC_CHAR2(APSP.TT_E66_Å)    ^= '00' THEN                00002950
         S001051O.TT_E66_ÅO          = F_FELT_PIC_CHAR2(APSP.TT_E66_Å); 00002960
      IF F_FELT_PIC_CHAR2(APSP.TT_E66_M)    ^= '00' THEN                00002970
         S001051O.TT_E66_MO          = F_FELT_PIC_CHAR2(APSP.TT_E66_M); 00002980
      IF F_FELT_PIC_CHAR2(APSP.TT_F67_EK)   ^= '00' THEN                00002990
         S001051O.TT_F67_EKO         = F_FELT_PIC_CHAR2(APSP.TT_F67_EK);00003000
      IF F_FELT_PIC_CHAR2(APSP.TT_E66_Å_EK) ^= '00' THEN                00003010
         S001051O.TT_E66_Å_EKO     = F_FELT_PIC_CHAR2(APSP.TT_E66_Å_EK);00003020
      IF F_FELT_PIC_CHAR2(APSP.TT_E66_M_EK) ^= '00' THEN                00003030
         S001051O.TT_E66_M_EKO     = F_FELT_PIC_CHAR2(APSP.TT_E66_M_EK);00003040
      IF F_FELT_PIC_CHAR2(APSP.TT_VENT_UTL) ^= '00' THEN                00003050
         S001051O.TT_VENT_UTLO     = F_FELT_PIC_CHAR2(APSP.TT_VENT_UTL);00003060
      S001051O.IKKE_GPO              = APSP.IKKE_GP;                    00003070
 %SKIP(3);                             /*  */                           00003080
 /*  MARKERING AV ATTRIBUTTER   */                                      00003090
 %SKIP;                                                                 00003100
      IF APSP.STATSBORGERNR = 0 THEN                                    00003110
         S001051O.STATSBORGERA       = NOR_NUM;                         00003120
      ELSE                                                              00003130
         DO;                                                            00003140
            S001051O.STATSBORGERA           = BRI_NUM;                  00003150
            S001051I.STATSBORGERL           = CURSOR_POS;               00003160
            IF APSP.STATSBORGERNR ^= 999 THEN                           00003170
               CALL SKRIV_FEIL(APSP.STATSBORGERNR);                     00003180
         END;                                                           00003190
      IF APSP.BOSATTNR = 0 THEN                                         00003200
         S001051O.BOSATTA       = NOR_NUM;                              00003210
      ELSE                                                              00003220
         DO;                                                            00003230
            S001051O.BOSATTA           = BRI_NUM;                       00003240
            S001051I.BOSATTL           = CURSOR_POS;                    00003250
            IF APSP.BOSATTNR ^= 999 THEN                                00003260
               CALL SKRIV_FEIL(APSP.BOSATTNR);                          00003270
         END;                                                           00003280
      IF APSP.FRAVIK_19_3NR = 0 THEN                                    00003290
         S001051O.FRAVIK_19_3A       = NORMAL;                          00003300
      ELSE                                                              00003310
         DO;                                                            00003320
            S001051O.FRAVIK_19_3A           = DFHBMBRY;                 00003330
            S001051I.FRAVIK_19_3L           = CURSOR_POS;               00003340
            IF APSP.FRAVIK_19_3NR ^= 999 THEN                           00003350
               CALL SKRIV_FEIL(APSP.FRAVIK_19_3NR);                     00003360
         END;                                                           00003370
      IF APSP.FRAVIK_FLYKTNR = 0 THEN                                   00003380
         S001051O.FRAVIK_FLYKTA       = NORMAL;                         00003390
      ELSE                                                              00003400
         DO;                                                            00003410
            S001051O.FRAVIK_FLYKTA           = DFHBMBRY;                00003420
            S001051I.FRAVIK_FLYKTL           = CURSOR_POS;              00003430
            IF APSP.FRAVIK_FLYKTNR ^= 999 THEN                          00003440
               CALL SKRIV_FEIL(APSP.FRAVIK_FLYKTNR);                    00003450
         END;                                                           00003460
      IF APSP.OVERKOMP_UTLNR = 0 THEN                                   00003470
         S001051O.OVERKOMP_UTLA       = NORMAL;                         00003480
      ELSE                                                              00003490
         DO;                                                            00003500
            S001051O.OVERKOMP_UTLA           = DFHBMBRY;                00003510
            S001051I.OVERKOMP_UTLL           = CURSOR_POS;              00003520
            IF APSP.OVERKOMP_UTLNR ^= 999 THEN                          00003530
               CALL SKRIV_FEIL(APSP.OVERKOMP_UTLNR);                    00003540
         END;                                                           00003550
      IF APSP.TT_F67NR = 0 THEN                                         00003560
         S001051O.TT_F67A       = NOR_NUM;                              00003570
      ELSE                                                              00003580
         DO;                                                            00003590
            S001051O.TT_F67A           = BRI_NUM;                       00003600
            S001051I.TT_F67L           = CURSOR_POS;                    00003610
            IF APSP.TT_F67NR ^= 999 THEN                                00003620
               CALL SKRIV_FEIL(APSP.TT_F67NR);                          00003630
         END;                                                           00003640
      IF APSP.TT_E66_ÅNR = 0 THEN                                       00003650
         S001051O.TT_E66_ÅA       = NOR_NUM;                            00003660
      ELSE                                                              00003670
         DO;                                                            00003680
            S001051O.TT_E66_ÅA           = BRI_NUM;                     00003690
            S001051I.TT_E66_ÅL           = CURSOR_POS;                  00003700
            IF APSP.TT_E66_ÅNR ^= 999 THEN                              00003710
               CALL SKRIV_FEIL(APSP.TT_E66_ÅNR);                        00003720
         END;                                                           00003730
      IF APSP.TT_E66_MNR = 0 THEN                                       00003740
         S001051O.TT_E66_MA       = NOR_NUM;                            00003750
      ELSE                                                              00003760
         DO;                                                            00003770
            S001051O.TT_E66_MA           = BRI_NUM;                     00003780
            S001051I.TT_E66_ML           = CURSOR_POS;                  00003790
            IF APSP.TT_E66_MNR ^= 999 THEN                              00003800
               CALL SKRIV_FEIL(APSP.TT_E66_MNR);                        00003810
         END;                                                           00003820
      IF APSP.TT_F67_EKNR = 0 THEN                                      00003830
         S001051O.TT_F67_EKA = NOR_NUM;                                 00003840
      ELSE                                                              00003850
         DO;                                                            00003860
            S001051O.TT_F67_EKA           = BRI_NUM;                    00003870
            S001051I.TT_F67_EKL           = CURSOR_POS;                 00003880
            IF APSP.TT_F67_EKNR ^= 999 THEN                             00003890
               CALL SKRIV_FEIL(APSP.TT_F67_EKNR);                       00003900
         END;                                                           00003910
      IF APSP.TT_E66_Å_EKNR = 0 THEN                                    00003920
         S001051O.TT_E66_Å_EKA       = NOR_NUM;                         00003930
      ELSE                                                              00003940
         DO;                                                            00003950
            S001051O.TT_E66_Å_EKA           = BRI_NUM;                  00003960
            S001051I.TT_E66_Å_EKL           = CURSOR_POS;               00003970
            IF APSP.TT_E66_Å_EKNR ^= 999 THEN                           00003980
               CALL SKRIV_FEIL(APSP.TT_E66_Å_EKNR);                     00003990
         END;                                                           00004000
      IF APSP.TT_E66_M_EKNR = 0 THEN                                    00004010
         S001051O.TT_E66_M_EKA       = NOR_NUM;                         00004020
      ELSE                                                              00004030
         DO;                                                            00004040
            S001051O.TT_E66_M_EKA           = BRI_NUM;                  00004050
            S001051I.TT_E66_M_EKL           = CURSOR_POS;               00004060
            IF APSP.TT_E66_M_EKNR ^= 999 THEN                           00004070
               CALL SKRIV_FEIL(APSP.TT_E66_M_EKNR);                     00004080
         END;                                                           00004090
      IF APSP.TT_VENT_UTLNR = 0 THEN                                    00004100
         S001051O.TT_VENT_UTLA       = NOR_NUM;                         00004110
      ELSE                                                              00004120
         DO;                                                            00004130
            S001051O.TT_VENT_UTLA           = BRI_NUM;                  00004140
            S001051I.TT_VENT_UTLL           = CURSOR_POS;               00004150
            IF APSP.TT_VENT_UTLNR ^= 999 THEN                           00004160
               CALL SKRIV_FEIL(APSP.TT_VENT_UTLNR);                     00004170
         END;                                                           00004180
      IF APSP.IKKE_GPNR = 0 THEN                                        00004190
         S001051O.IKKE_GPA       = NORMAL;                              00004200
      ELSE                                                              00004210
         DO;                                                            00004220
            S001051O.IKKE_GPA           = DFHBMBRY;                     00004230
            S001051I.IKKE_GPL           = CURSOR_POS;                   00004240
            IF APSP.IKKE_GPNR ^= 999 THEN                               00004250
               CALL SKRIV_FEIL(APSP.IKKE_GPNR);                         00004260
         END;                                                           00004270
                                                                        00004280
     IF FRA_UTEN_DIALOG THEN    /* BLOKKER ALT SAMMEN    */             00004290
        CALL BLOKKERE_SPES;                                             00004300
                                                                        00004310
   END OVERFØR_APSPES_MAP;                                              00004320
                                                                        00004330
                                                                        00004340
 /* ***************************************************************** */00004350
 /*                                                                   */00004360
 /*   OVERFØRING FRA WORKAREA TIL MAP FOR BARNEDELEN                  */00004370
 /*                                                                   */00004380
 /* ***************************************************************** */00004390
 %SKIP(2);                                                              00004400
 OVERFØR_APBARN_MAP:                                                    00004410
   PROC;                                                                00004420
   DCL                                                                  00004430
      ANT_BARN FIXED BIN (15);                                          00004440
   DCL                                                                  00004450
      NORMAL  CHAR (1) INIT(' '),                                       00004460
      NOR_NUM CHAR (1) INIT('&'),                                       00004470
      BRI_NUM CHAR (1) INIT('Q');                                       00004480
                                                                        00004490
 %SKIP;                                                                 00004500
      ANT_BARN = 1;                                                     00004510
                                                                        00004520
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00004530
         DO;                                                            00004540
            S001051O.FNR_BARN1O =                                       00004550
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00004560
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00004570
               S001051O.FNR_BARN1A = NOR_NUM;                           00004580
            ELSE                                                        00004590
               DO;                                                      00004600
                  S001051O.FNR_BARN1A = BRI_NUM;                        00004610
                  S001051I.FNR_BARN1L = CURSOR_POS;                     00004620
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00004630
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00004640
               END;                                                     00004650
            S001051O.RBT1O =                                            00004660
                         APB.RBT_BARN(ANT_BARN);                        00004670
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00004680
               S001051O.RBT1A = NORMAL;                                 00004690
            ELSE                                                        00004700
               DO;                                                      00004710
                  S001051O.RBT1A = DFHBMBRY;                            00004720
                  S001051I.RBT1L = CURSOR_POS;                          00004730
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00004740
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00004750
               END;                                                     00004760
            ANT_BARN = ANT_BARN +1;                                     00004770
         END;                                                           00004780
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00004790
         DO;                                                            00004800
            S001051O.FNR_BARN2O =                                       00004810
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00004820
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00004830
               S001051O.FNR_BARN2A = NOR_NUM;                           00004840
            ELSE                                                        00004850
               DO;                                                      00004860
                  S001051O.FNR_BARN2A = BRI_NUM;                        00004870
                  S001051I.FNR_BARN2L = CURSOR_POS;                     00004880
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00004890
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00004900
               END;                                                     00004910
            S001051O.RBT2O =                                            00004920
                         APB.RBT_BARN(ANT_BARN);                        00004930
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00004940
               S001051O.RBT2A = NORMAL;                                 00004950
            ELSE                                                        00004960
               DO;                                                      00004970
                  S001051O.RBT2A = DFHBMBRY;                            00004980
                  S001051I.RBT2L = CURSOR_POS;                          00004990
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00005000
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00005010
               END;                                                     00005020
            ANT_BARN = ANT_BARN +1;                                     00005030
         END;                                                           00005040
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00005050
         DO;                                                            00005060
            S001051O.FNR_BARN3O =                                       00005070
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00005080
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00005090
               S001051O.FNR_BARN3A = NOR_NUM;                           00005100
            ELSE                                                        00005110
               DO;                                                      00005120
                  S001051O.FNR_BARN3A = BRI_NUM;                        00005130
                  S001051I.FNR_BARN3L = CURSOR_POS;                     00005140
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00005150
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00005160
               END;                                                     00005170
            S001051O.RBT3O =                                            00005180
                         APB.RBT_BARN(ANT_BARN);                        00005190
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00005200
               S001051O.RBT3A = NORMAL;                                 00005210
            ELSE                                                        00005220
               DO;                                                      00005230
                  S001051O.RBT3A = DFHBMBRY;                            00005240
                  S001051I.RBT3L = CURSOR_POS;                          00005250
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00005260
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00005270
               END;                                                     00005280
            ANT_BARN = ANT_BARN +1;                                     00005290
         END;                                                           00005300
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00005310
         DO;                                                            00005320
            S001051O.FNR_BARN4O =                                       00005330
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00005340
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00005350
               S001051O.FNR_BARN4A = NOR_NUM;                           00005360
            ELSE                                                        00005370
               DO;                                                      00005380
                  S001051O.FNR_BARN4A = BRI_NUM;                        00005390
                  S001051I.FNR_BARN4L = CURSOR_POS;                     00005400
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00005410
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00005420
               END;                                                     00005430
            S001051O.RBT4O =                                            00005440
                         APB.RBT_BARN(ANT_BARN);                        00005450
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00005460
               S001051O.RBT4A = NORMAL;                                 00005470
            ELSE                                                        00005480
               DO;                                                      00005490
                  S001051O.RBT4A = DFHBMBRY;                            00005500
                  S001051I.RBT4L = CURSOR_POS;                          00005510
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00005520
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00005530
               END;                                                     00005540
            ANT_BARN = ANT_BARN +1;                                     00005550
         END;                                                           00005560
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00005570
         DO;                                                            00005580
            S001051O.FNR_BARN5O =                                       00005590
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00005600
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00005610
               S001051O.FNR_BARN5A = NOR_NUM;                           00005620
            ELSE                                                        00005630
               DO;                                                      00005640
                  S001051O.FNR_BARN5A = BRI_NUM;                        00005650
                  S001051I.FNR_BARN5L = CURSOR_POS;                     00005660
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00005670
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00005680
               END;                                                     00005690
            S001051O.RBT5O =                                            00005700
                         APB.RBT_BARN(ANT_BARN);                        00005710
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00005720
               S001051O.RBT5A = NORMAL;                                 00005730
            ELSE                                                        00005740
               DO;                                                      00005750
                  S001051O.RBT5A = DFHBMBRY;                            00005760
                  S001051I.RBT5L = CURSOR_POS;                          00005770
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00005780
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00005790
               END;                                                     00005800
            ANT_BARN = ANT_BARN +1;                                     00005810
         END;                                                           00005820
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00005830
         DO;                                                            00005840
            S001051O.FNR_BARN6O =                                       00005850
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00005860
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00005870
               S001051O.FNR_BARN6A = NOR_NUM;                           00005880
            ELSE                                                        00005890
               DO;                                                      00005900
                  S001051O.FNR_BARN6A = BRI_NUM;                        00005910
                  S001051I.FNR_BARN6L = CURSOR_POS;                     00005920
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00005930
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00005940
               END;                                                     00005950
            S001051O.RBT6O =                                            00005960
                         APB.RBT_BARN(ANT_BARN);                        00005970
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00005980
               S001051O.RBT6A = NORMAL;                                 00005990
            ELSE                                                        00006000
               DO;                                                      00006010
                  S001051O.RBT6A = DFHBMBRY;                            00006020
                  S001051I.RBT6L = CURSOR_POS;                          00006030
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00006040
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00006050
               END;                                                     00006060
            ANT_BARN = ANT_BARN +1;                                     00006070
         END;                                                           00006080
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00006090
         DO;                                                            00006100
            S001051O.FNR_BARN7O =                                       00006110
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00006120
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00006130
               S001051O.FNR_BARN7A = NOR_NUM;                           00006140
            ELSE                                                        00006150
               DO;                                                      00006160
                  S001051O.FNR_BARN7A = BRI_NUM;                        00006170
                  S001051I.FNR_BARN7L = CURSOR_POS;                     00006180
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00006190
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00006200
               END;                                                     00006210
            S001051O.RBT7O =                                            00006220
                         APB.RBT_BARN(ANT_BARN);                        00006230
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00006240
               S001051O.RBT7A = NORMAL;                                 00006250
            ELSE                                                        00006260
               DO;                                                      00006270
                  S001051O.RBT7A = DFHBMBRY;                            00006280
                  S001051I.RBT7L = CURSOR_POS;                          00006290
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00006300
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00006310
               END;                                                     00006320
            ANT_BARN = ANT_BARN +1;                                     00006330
         END;                                                           00006340
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00006350
         DO;                                                            00006360
            S001051O.FNR_BARN8O =                                       00006370
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00006380
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00006390
               S001051O.FNR_BARN8A = NOR_NUM;                           00006400
            ELSE                                                        00006410
               DO;                                                      00006420
                  S001051O.FNR_BARN8A = BRI_NUM;                        00006430
                  S001051I.FNR_BARN8L = CURSOR_POS;                     00006440
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00006450
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00006460
               END;                                                     00006470
            S001051O.RBT8O =                                            00006480
                         APB.RBT_BARN(ANT_BARN);                        00006490
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00006500
               S001051O.RBT8A = NORMAL;                                 00006510
            ELSE                                                        00006520
               DO;                                                      00006530
                  S001051O.RBT8A = DFHBMBRY;                            00006540
                  S001051I.RBT8L = CURSOR_POS;                          00006550
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00006560
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00006570
               END;                                                     00006580
            ANT_BARN = ANT_BARN +1;                                     00006590
         END;                                                           00006600
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00006610
         DO;                                                            00006620
            S001051O.FNR_BARN9O =                                       00006630
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00006640
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00006650
               S001051O.FNR_BARN9A = NOR_NUM;                           00006660
            ELSE                                                        00006670
               DO;                                                      00006680
                  S001051O.FNR_BARN9A = BRI_NUM;                        00006690
                  S001051I.FNR_BARN9L = CURSOR_POS;                     00006700
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00006710
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00006720
               END;                                                     00006730
            S001051O.RBT9O =                                            00006740
                         APB.RBT_BARN(ANT_BARN);                        00006750
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00006760
               S001051O.RBT9A = NORMAL;                                 00006770
            ELSE                                                        00006780
               DO;                                                      00006790
                  S001051O.RBT9A = DFHBMBRY;                            00006800
                  S001051I.RBT9L = CURSOR_POS;                          00006810
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00006820
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00006830
               END;                                                     00006840
            ANT_BARN = ANT_BARN +1;                                     00006850
         END;                                                           00006860
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00006870
         DO;                                                            00006880
            S001051O.FNR_BARN10O =                                      00006890
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00006900
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00006910
               S001051O.FNR_BARN10A = NOR_NUM;                          00006920
            ELSE                                                        00006930
               DO;                                                      00006940
                  S001051O.FNR_BARN10A = BRI_NUM;                       00006950
                  S001051I.FNR_BARN10L = CURSOR_POS;                    00006960
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00006970
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00006980
               END;                                                     00006990
            S001051O.RBT10O =                                           00007000
                         APB.RBT_BARN(ANT_BARN);                        00007010
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00007020
               S001051O.RBT10A = NORMAL;                                00007030
            ELSE                                                        00007040
               DO;                                                      00007050
                  S001051O.RBT10A = DFHBMBRY;                           00007060
                  S001051I.RBT10L = CURSOR_POS;                         00007070
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00007080
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00007090
               END;                                                     00007100
            ANT_BARN = ANT_BARN +1;                                     00007110
         END;                                                           00007120
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00007130
         DO;                                                            00007140
            S001051O.FNR_BARN11O =                                      00007150
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00007160
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00007170
               S001051O.FNR_BARN11A = NOR_NUM;                          00007180
            ELSE                                                        00007190
               DO;                                                      00007200
                  S001051O.FNR_BARN11A = BRI_NUM;                       00007210
                  S001051I.FNR_BARN11L = CURSOR_POS;                    00007220
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00007230
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00007240
               END;                                                     00007250
            S001051O.RBT11O =                                           00007260
                         APB.RBT_BARN(ANT_BARN);                        00007270
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00007280
               S001051O.RBT11A = NORMAL;                                00007290
            ELSE                                                        00007300
               DO;                                                      00007310
                  S001051O.RBT11A = DFHBMBRY;                           00007320
                  S001051I.RBT11L = CURSOR_POS;                         00007330
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00007340
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00007350
               END;                                                     00007360
            ANT_BARN = ANT_BARN +1;                                     00007370
         END;                                                           00007380
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00007390
         DO;                                                            00007400
            S001051O.FNR_BARN12O =                                      00007410
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00007420
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00007430
               S001051O.FNR_BARN12A = NOR_NUM;                          00007440
            ELSE                                                        00007450
               DO;                                                      00007460
                  S001051O.FNR_BARN12A = BRI_NUM;                       00007470
                  S001051I.FNR_BARN12L = CURSOR_POS;                    00007480
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00007490
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00007500
               END;                                                     00007510
            S001051O.RBT12O =                                           00007520
                         APB.RBT_BARN(ANT_BARN);                        00007530
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00007540
               S001051O.RBT12A = NORMAL;                                00007550
            ELSE                                                        00007560
               DO;                                                      00007570
                  S001051O.RBT12A = DFHBMBRY;                           00007580
                  S001051I.RBT12L = CURSOR_POS;                         00007590
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00007600
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00007610
               END;                                                     00007620
         END;                                                           00007630
                                                                        00007640
      IF FRA_UTEN_DIALOG THEN     /* BLOKKER ALT SAMMEN    */           00007650
         CALL BLOKKERE_BARN;                                            00007660
                                                                        00007670
   END OVERFØR_APBARN_MAP;                                              00007680
