 /*       SIST ENDRET 18/06-98 13.35.23 AV   JDA7339                  */00000000
 /*       SIST ENDRET 18/06-98 13.33.30 AV   JDA7339                  */00000010
 /*       SIST ENDRET 28/07-97 13.07.35 AV   HLA7339                  */00000020
 /*       SIST ENDRET 11/06-97 13.39.11 AV   HLA7339                  */00000030
 /*       SIST ENDRET 04/04-97 10.39.16 AV   JDA7339                  */00000040
 /*       SIST ENDRET 10/06-96 13.49.16 AV   TSB0310                  */00000050
 /*       SIST ENDRET 18/03-96 13.06.15 AV   JDA0310                  */00000060
 /*       SIST SISTET 12/02-96 14.26.35 AV   JDA0310                  */00000070
 /*       SIST ENDRET 31/01-95 10.04.29 AV   JDA0310                  */00000080
 /*       SIST ENDRET 27/06-94 14.54.05 AV   DYBVIK                   */00000090
 /*       SIST ENDRET 04/11-93 14.24.38 AV   DYBVIK                   */00000100
 /*       SIST ENDRET 08/07-93 14.02.32 AV   DYBVIK                   */00000110
 /*       SIST ENDRET 27/05-93 08.27.41 AV   DYBVIK                   */00000120
 /*       SIST ENDRET 17/07-92 13.47.06 AV   DYBVIK                   */00000130
 /*       SIST ENDRET 23/03-92 10.26.16 AV   DYBVIK                   */00000140
 /*       SIST ENDRET 19/02-92 14.59.21 AV   DYBVIK                   */00000150
 /*       SIST ENDRET 17/12-91 08.51.42 AV   TRUDE                    */00000160
 /*       SIST ENDRET 13/12-91 12.25.34 AV   DYBVIK                   */00000170
 /*       SIST ENDRET 13/06-91 11.50.44 AV   DYBVIK                   */00000180
 /*       SIST ENDRET 02/05-91 11.59.11 AV   DYBVIK                   */00000190
 /*       SIST ENDRET 26/04-91 11.42.47 AV   DYBVIK                   */00000200
 /*       SIST ENDRET 08/04-91 12.05.52 AV   DYBVIK                   */00000210
 /*       SIST ENDRET 05/04-91 08.24.10 AV   DYBVIK                   */00000220
 /*       SIST ENDRET 13/03-91 20.16.59 AV   LUNDEBY                  */00000230
 /*       SIST ENDRET 03/01-91 09.15.33 AV   DYBVIK                   */00000240
 /*       SIST ENDRET 27/11-90 15.04.24 AV   DYBVIK                   */00000250
 /*       SIST ENDRET 12/11-90 13.14.49 AV   DYBVIK                   */00000260
 /*       SIST ENDRET 10/09-90 14.07.53 AV   DYBVIK                   */00000270
 /*       SIST ENDRET 30/03-90 13.58.33 AV   DYBVIK                   */00000280
 /*       SIST ENDRET 19/11-84 16.59.21 AV   BREIVIK                  */00000290
 /*       SIST ENDRET 06/11-84 15.07.04 AV   BREIVIK                  */00000300
 /*********************************************************************/00000310
 /* IDENTIFIKASJON:                                                   */00000320
 /*    R0016022                                                       */00000330
 /*                                                                   */00000340
 /*    PROGRAMMERER: P. BREIVIK, NOV 1982.                            */00000350
 /*                                                                   */00000360
 /* HENSIKT:                                                          */00000370
 /*    OPPDATERER STAT_TRANS PÅ FORSKJELLEN MELLOM B01 OG B02.        */00000380
 /*    PROSEDYREN BEHANDLER BARE MOR OG FAR.                          */00000390
 /*                                                                   */00000400
 /* NB!!  NB!!:                                                       */00000410
 /*    VED UTREGNING AV FAKTORER AV G ): SUM-YTELSE * 12 / G , MÅ     */00000420
 /*                                      --------------------         */00000430
 /*    FØLGENDE PASSES PÅ: HVIS SUM-YTELSE ER ET REGNESTYKKE MED MER  */00000440
 /*    ENN 3 FELT, MÅ UTREGNINGEN DELES OPP OG HJELPEFELT BRUKES      */00000450
 /*    FORDI PL1'S ARBEIDSFELTER IKKE BLIR STORE NOK TIL SÅ MANGE     */00000460
 /*    REGNEOPERASJONER MED FELT DEFINERT SOM ANGJELDENDE ER.         */00000470
 /*    JFR. FORØVRIG KOMMENTAR KNYTTET TIL BT-SEGMENTET.  BØ9104.     */00000480
 /*                                                                   */00000490
 /* PROGRAMTILKNYTNING:                                               */00000500
 /*    LOKAL PROSEDYRE I R0016001                                     */00000510
 /*                                                                   */00000520
 /* BRUK:                                                             */00000530
 /*    INKLUDERES VED KOMPILERING AV R0016001                         */00000540
 /*                                                                   */00000550
 /* ENDRET : 10.06.96 AV S.LUNDEBY, DATA-UTVIKLING                    */00000560
 /*          VED UFT < 9200 HENTES BUP FRA POREKKE                    */00000570
 /*                                                                   */00000580
 /* ENDRET : 02.04.97 AV SVEIN B. OPSAHL                              */00000590
 /*          LAGT TIL KALL AV U3_OPPDAT                               */00000600
 /*                                                                   */00000610
 /* ENDRET :   .  .97 AV SVEIN B. OPSAHL (IKKE IMP.)                  */00000620
 /*          PENSJONS-SEGMENT SKRIVES OGSÅ HVIS BELØP I B01 OG B02    */00000630
 /*          ER 0                                                     */00000640
 /* ENDRET : UKE 25 1998 AV  SVERRE LUNDEBY, DATA-UTVIKLING AS       */ 00000650
 /*          DANNER IKKE TILKN VED OMREGNING ): TRANSKODE='RH01'      */00000660
 /*          TAR VARE PÅ PROGRAM_ID SOM KALLER 6001 FORDI TILKN.SEGM  */00000670
 /*          IKKE BEHØVER DANNER VED OMREGNING                        */00000680
 /*********************************************************************/00000690
                                                                        00000700
 OPPDAT_MOR_FAR: PROC OPTIONS (REENTRANT);                              00000710
                                                                        00000720
 /*-------------------------------------------------------------------*/00000730
 /*                                                                   */00000740
 /* ENDREDE DATA OM MOR OG FAR FRA B01 TIL B02 DANNER OPPDATERING     */00000750
 /* I ARBEIDS-OMRÅDET 'STAT_TRANS' SAMT SETTER EN BRYTER.             */00000760
 /* DENNE BRYTEREN AVGJØR OM DET SKAL DANNES SEGMENT ELLER IKKE.      */00000770
 /*                                                                   */00000780
 /*    MOR : I HAR VERDIEN 1                                          */00000790
 /*    FAR : I HAR VERDIEN 2                                          */00000800
 /*                                                                   */00000810
 /*-------------------------------------------------------------------*/00000820
                                                                        00000830
 DCL W01_CH_5 BASED (W01_CH_PTR) CHAR (5),                              00000840
     W02_CH_5 BASED (W02_CH_PTR) CHAR (5),                              00000850
                                                                        00000860
    (W01_CH_PTR  ,   W02_CH_PTR) POINTER ;                              00000870
                                                                        00000880
 DCL W01_ULIK_INNTEKTSÅR_EØS     BIT (1);                               00000890
                                                                        00000900
 DANN_TILKN_A: PROC;                                                    00000910
    SEGMENT_TABELL.TILKN             = TRUE;                            00000920
    TILKN.TKNYTT(1).TILKNYTNINGSKODE = 'A';                             00000930
    TILKN.TKNYTT(1).FNR_TILKN        =                                  00000940
                                       B02.PERSON(3-I).RF0PERSN.FNR;    00000950
 END; /* DANN_TILKN_A */                                                00000960
                                                                        00000970
                                                                        00000980
 DANN_TILKN_F: PROC;                                                    00000990
    SEGMENT_TABELL.TILKN             = TRUE;                            00001000
    TILKN.TKNYTT(6).TILKNYTNINGSKODE = 'F';                             00001010
    TILKN.TKNYTT(6).FNR_TILKN        =                                  00001020
                                       B02.PERSON(3-I).RF0PERSN.FNR;    00001030
 END; /* DANN_TILKN_F */                                                00001040
                                                                        00001050
                                                                        00001060
 DO I=1,2;                                                              00001070
    IF B02.PERSON(I).FNR > 0 THEN                                       00001080
    DO;                                                                 00001090
                                                                        00001100
 /*-------------------------------------------------------------------*/00001110
 /*                                                                   */00001120
 /*    CLEAR SEGMENT-TABELLEN OG ARBEIDSFELTENE FOR BASE-SEGMENTENE.  */00001130
 /*                                                                   */00001140
 /*-------------------------------------------------------------------*/00001150
                                                                        00001160
       DIV_PARAM_OMR.POS_I_B01 = I;                                     00001170
       SEGMENT_TABELL = '';                                             00001180
       TR0ROT         = '';                                             00001190
       REGTPKT        = '';                                             00001200
       PTYPE          = '';                                             00001210
       SIVILST        = '';                                             00001220
       APOPPL         = '';                                             00001230
       UPPER          = '';                                             00001240
       PENSJON        = '';                                             00001250
       KT             = '';                                             00001260
       VT             = '';                                             00001270
       ET             = '';                                             00001280
       BT             = '';                                             00001290
       TILKN          = '';                                             00001300
       ETTERL         = '';                                             00001310
       DIAGNOSE       = '';                                             00001320
       SPESOPPL       = '';                                             00001330
       YSKADE         = '';                                             00001340
       EØSINFO        = '';                                             00001350
       SAVE_B01_B02   = 0;                                              00001360
                                                                        00001370
 /* *-*-* NB!! REGTPKT.FILLER INNEHOLDER TRANSKODE + TRANSTYPE I TEST */00001380
 /*BØ-TEST                                                              00001390
          REGTPKT.FILLER             = TRANS_OPPL_OMR.TRANSKODE !!      00001400
                                       TRANS_OPPL_OMR.TRANSTYPE ;       00001410
   BØ-TEST                                                              00001420
       EXEC CICS ENTER TRACEID (61)  FROM  (REGTPKT.FILLER) ;           00001430
       EXEC CICS ENTER TRACEID (62)  FROM  (B02.PERSON(I).FNR) ;        00001440
       EXEC CICS ENTER TRACEID (63)  FROM                               00001450
                               (B02.PERSON(I).STATUS.VIRK_DATO_ÅM) ;    00001460
                                                                        00001470
       W_VIRKD = SUBSTR (TRANS_OPPL_OMR.VIRKNINGSDATO, 3, 2) !!         00001480
                 SUBSTR (TRANS_OPPL_OMR.VIRKNINGSDATO, 1, 2) ;          00001490
       EXEC CICS ENTER TRACEID (62)  FROM  (W_VIRKD) ;                  00001500
                                                                        00001510
   BØ-TEST                                                              00001520
 */                                                                     00001530
 /*    NULLSTILLER HJELPEVARIABLE TIL REGTPKT-SEGMENT                 */00001540
                                                                        00001550
       B01_PÅ      = 0;                                                 00001560
       B02_PÅ      = 0;                                                 00001570
       B01_SPT     = 0.0;                                               00001580
       B02_SPT     = 0.0;                                               00001590
       B01_OPT     = 0.0;                                               00001600
       B02_OPT     = 0.0;                                               00001610
       B01_YPT     = 0.0;                                               00001620
       B02_YPT     = 0.0;                                               00001630
 /*BØ9201:*/                                                            00001640
       B01_PÅ_E91  = 0;                                                 00001650
       B02_PÅ_E91  = 0;                                                 00001660
       B01_SPT_GML = 0.0;                                               00001670
       B02_SPT_GML = 0.0;                                               00001680
                                                                        00001690
       /* --------------------------------------------------------- */  00001700
       /* HVIS OPPHØR I B01 ELLER I B02 FOR LEVENDE PERSONER -      */  00001710
       /* HERUNDER OPPHØRTE UFØRHIST-/YRKEHIST-SEGMENTER:           */  00001720
       /* I ENDEL TILFELLER "BLANKES" B01 EVT. B02 OG/ELLER DEN ENE */  00001730
       /* STRUKTUREN LEGGES OVER I DEN ANDRE. DA TAS B01/B02 VARE   */  00001740
       /* PÅ I X01/X02 OG REETABLERES I SLUTTEN AV PROGRAMMET.      */  00001750
       /* --------------------------------------------------------- */  00001760
       ALLOCATE X01;                                                    00001770
       ALLOCATE X02;                                                    00001780
       X01.PERSON(I) = '';                                              00001790
       X02.PERSON(I) = '';                                              00001800
                                                                        00001810
                                                                        00001820
       IF B02.PERSON(I).STATUS.DØDSDATO_ÅMD = 0 THEN                    00001830
         DO;                                                            00001840
           CALL FINN_UP_YP_OPPHØR ;       /* R0016034 */                00001850
                                                                        00001860
           IF (B01.PERSON(I).STATUS.PENSJONSTYPE1 = 'A' !               00001870
               B01.PERSON(I).STATUS.PENSJONSTYPE1 = 'K' !               00001880
               B01.PERSON(I).STATUS.PENSJONSTYPE1 = 'Y' !               00001890
               B01.PERSON(I).STATUS.PENSJONSTYPE1 = 'U' ) &             00001900
               B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'G'   THEN          00001910
             CALL DANN_OPPHØR_GIFT ;      /* R0016035 */                00001920
                                                                        00001930
           /* ----------------------------------------------------- */  00001940
           /*  MULIG OPPHØR AV UP/YP PGA. UFØRHIST-OPPH.DATO ^= 0 - */  00001950
           /*  SAMT PERSONER MED "O"/"X" I STATUS_KODE_HIST         */  00001960
           /* ----------------------------------------------------- */  00001970
                                                                        00001980
           IF B02.PERSON(I).UFØRHIST(J).OPPHØRSDATO_ÅM ^= 0 &           00001990
                                                                        00002000
            ((B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'G' &                00002010
              B02.PERSON(I).UFØRHIST(J).OPPHØRSDATO_ÅM >                00002020
              B02.PERSON(I).UFØRHIST(K).UFT_ÅM)           !             00002030
                                                                        00002040
              /* --------------------------------------------------- */ 00002050
              /* UFØRHIST INNEHOLDER TILSTREKKELIGE OPPLYSNINGER -   */ 00002060
              /* OGSÅ FOR "REN" YP                                   */ 00002070
              /* --------------------------------------------------- */ 00002080
                                                                        00002090
            ((B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'U' !                00002100
              B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'Y' ) &              00002110
              B02.PERSON(I).UFØRHIST(J).OPPHØRSDATO_ÅM >                00002120
              B02.PERSON(I).UFØRHIST(K).UFT_ÅM)           !             00002130
                                                                        00002140
            ((B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'A' !                00002150
              B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'K') &               00002160
              B02.PERSON(I).UFØRHIST(J).OPPHØRSDATO_ÅM >                00002170
              B02.PERSON(I).STATUS.VIRK_DATO_ÅM)          !             00002180
                                                                        00002190
            ((B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'A' !                00002200
              B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'K') &               00002210
              B02.PERSON(I).UFØRHIST(J).OPPHØRSDATO_ÅM =                00002220
              B02.PERSON(I).STATUS.VIRK_DATO_ÅM)          ) !           00002230
                                                                        00002240
              B02.PERSON(I).STATUS.STATUS_KODE_HIST = 'O'   !           00002250
              B02.PERSON(I).STATUS.STATUS_KODE_HIST = 'X'   THEN        00002260
             CALL DANN_OPPHØR ;           /* R0016036 */                00002270
                                                                        00002280
           ELSE                                                         00002290
                                                                        00002300
             /* ----------------------------------------------- */      00002310
             /*  OPPHØR I NEST SISTE STATUS                     */      00002320
             /* ----------------------------------------------- */      00002330
             IF (B01.PERSON(I).STATUS.STATUS_KODE_HIST = 'O' !          00002340
                 B01.PERSON(I).STATUS.STATUS_KODE_HIST = 'X') THEN      00002350
               DO;                                                      00002360
                 IF ((B01.PERSON(1).STATUS.PENSJONSTYPE1 = 'U' &        00002370
                      B01.PERSON(1).STATUS.PENSJONSTYPE3 = 'A') !       00002380
                     (B01.PERSON(2).STATUS.PENSJONSTYPE1 = 'U' &        00002390
                      B01.PERSON(2).STATUS.PENSJONSTYPE3 = 'A')) !      00002400
                    ((B01.PERSON(1).STATUS.PENSJONSTYPE1 = 'Y' &        00002410
                      B01.PERSON(1).STATUS.PENSJONSTYPE3 = 'A') !       00002420
                     (B01.PERSON(2).STATUS.PENSJONSTYPE1 = 'Y' &        00002430
                      B01.PERSON(2).STATUS.PENSJONSTYPE3 = 'A')) THEN ; 00002440
                    /* -------------------------------- */              00002450
                    /* OPPHØR AV ATTFØRING ?   BØ.      */              00002460
                    /* -------------------------------- */              00002470
                                                                        00002480
                 ELSE                                                   00002490
                   CALL DANN_TILGANG ;    /* R0016037 */                00002500
                                                                        00002510
               END;           /* AV OPPHØRSMERKET NEST SISTE STATUS */  00002520
                                                                        00002530
         END;                 /* AV SJEKK OPPHØR - LEVENDE PERSON   */  00002540
                                                                        00002550
                                                                        00002560
       /* --------------------------------------------------------- */  00002570
       /* SÆRBEHANDLING AV OVERGANG FRA ATV TIL UP/YP FOR Å FÅ      */  00002580
       /* DANNET NYE SEGMENTER VED SIDEN AV ATV-SEGMENTET I SRMAIN  */  00002590
       /* --------------------------------------------------------- */  00002600
       IF (B01.PERSON(I).STATUS.STATUS_KODE_HIST = ' '  &               00002610
           B02.PERSON(I).STATUS.STATUS_KODE_HIST = ' ' )  &             00002620
         ((B01.PERSON(I).STATUS.PENSJONSTYPE1    = 'U' !                00002630
           B01.PERSON(I).STATUS.PENSJONSTYPE1    = 'Y') &               00002640
           B01.PERSON(I).STATUS.PENSJONSTYPE3    = 'A' )  &             00002650
         ((B02.PERSON(I).STATUS.PENSJONSTYPE1    = 'U' !                00002660
           B02.PERSON(I).STATUS.PENSJONSTYPE1    = 'Y') &               00002670
           B02.PERSON(I).STATUS.PENSJONSTYPE3    = ' ' )  &             00002680
           SAVE_B01_B02                          = 0      THEN          00002690
         DO;                                                            00002700
           /* ---------------------------------- */                     00002710
           /* "REN" OVERGANG FRA ATV TIL UP/YP   */                     00002720
           /* ---------------------------------- */                     00002730
                                                                        00002740
           ALLOCATE X01;                                                00002750
           SAVE_B01_B02   = 1;                                          00002760
           X01.PERSON(I)  = B01.PERSON(I);                              00002770
           B01.PERSON(I)  = '';                                         00002780
                                                                        00002790
         END;                                                           00002800
                                                                        00002810
       /*---------------------------------------------------*/          00002820
       /* FORBEREDELSE TIL PTYPE- OG APOPPL-SEGMENT. BØ9201 */          00002830
       /* - UTVIDET MED ALLE BELØPSFELT PENSJON      BØ9207 */          00002840
       /*---------------------------------------------------*/          00002850
                                                                        00002860
       B01_PENSJON = B01.PERSON(I).ALDERSP.AP_GP_NETTO  +               00002870
                     B01.PERSON(I).ETTEPENS.GP_NETTO    +               00002880
                     B01.PERSON(I).UFØRPENS.GP          +               00002890
                     B01.PERSON(I).YRKEPENS.GP          +               00002900
                     B01.PERSON(I).ALDERSP.ST           +               00002910
                     B01.PERSON(I).UFØRPENS.ST          +               00002920
                     B01.PERSON(I).ETTEPENS.ST          +               00002930
                     B01.PERSON(I).ALDERSP.AP_TP_NETTO  +               00002940
                     B01.PERSON(I).ETTEPENS.TP_NETTO    +               00002950
                     B01.PERSON(I).UFØRPENS.TP          +               00002960
                     B01.PERSON(I).YRKEPENS.TP          +               00002970
                     B01.PERSON(I).STATUS.GARANTI_TP    +               00002980
                     B01.PERSON(I).STATUS.GT_TILLEGG_LOV92 ;            00002990
                                                                        00003000
       B02_PENSJON = B02.PERSON(I).ALDERSP.AP_GP_NETTO  +               00003010
                     B02.PERSON(I).ETTEPENS.GP_NETTO    +               00003020
                     B02.PERSON(I).UFØRPENS.GP          +               00003030
                     B02.PERSON(I).YRKEPENS.GP          +               00003040
                     B02.PERSON(I).ALDERSP.ST           +               00003050
                     B02.PERSON(I).UFØRPENS.ST          +               00003060
                     B02.PERSON(I).ETTEPENS.ST          +               00003070
                     B02.PERSON(I).ALDERSP.AP_TP_NETTO  +               00003080
                     B02.PERSON(I).ETTEPENS.TP_NETTO    +               00003090
                     B02.PERSON(I).UFØRPENS.TP          +               00003100
                     B02.PERSON(I).YRKEPENS.TP          +               00003110
                     B02.PERSON(I).STATUS.GARANTI_TP    +               00003120
                     B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 ;            00003130
                                                                        00003140
 /*-------------------------------------------------------------------*/00003150
 /*    PTYPE-SEGMENT. SEP.93 PT1=Q/R UT. PT3 INNFØRES . SL,DU         */00003160
 /*-------------------------------------------------------------------*/00003170
                                                                        00003180
       B01_STAT_PT1 = B01.PERSON(I).STATUS.PENSJONSTYPE1;               00003190
       B02_STAT_PT1 = B02.PERSON(I).STATUS.PENSJONSTYPE1;               00003200
                                                                        00003210
       IF (B01_STAT_PT1  = 'U' !                                        00003220
           B01_STAT_PT1  = 'Y' )                    &                   00003230
           B01.PERSON(I).STATUS.PENSJONSTYPE3 = 'A' THEN                00003240
           B01_STAT_PT1  = 'V';                                         00003250
                                                                        00003260
       IF (B02_STAT_PT1 = 'U' !                                         00003270
           B02_STAT_PT1 = 'Y' )                     &                   00003280
           B02.PERSON(I).STATUS.PENSJONSTYPE3 = 'A' THEN                00003290
           B02_STAT_PT1 = 'V';                                          00003300
                                                                        00003310
       IF B02.PERSON(I).STATUS.DØDSDATO_ÅMD     =  0   &                00003320
         (B02.PERSON(I).STATUS.STATUS_KODE_HIST = 'O' !                 00003330
          B02.PERSON(I).STATUS.STATUS_KODE_HIST = 'X') THEN             00003340
                                                                        00003350
          IF B01.PERSON(I).STATUS.PENSJONSTYPE1 = 'U' !                 00003360
             B01.PERSON(I).STATUS.PENSJONSTYPE1 = 'Y' !                 00003370
             B01.PERSON(I).STATUS.PENSJONSTYPE1 = 'A' !                 00003380
             B01.PERSON(I).STATUS.PENSJONSTYPE1 = 'K' THEN              00003390
                                                                        00003400
             IF B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'G' THEN           00003410
                B02_STAT_PT1 = 'G';                                     00003420
             ELSE                                                       00003430
                B02_STAT_PT1 = ' ';                                     00003440
          ELSE                                                          00003450
             B02_STAT_PT1    = ' ';                                     00003460
                                                                        00003470
       IF  B01_STAT_PT1               = 'D'     &                       00003480
           B02_STAT_PT1               = 'D'     &                       00003490
                                                                        00003500
           /*BØ9012: UTVIDET MED NYE BLANKETTER */                      00003510
          (TRANS_OPPL_OMR.BLANKETTYPE = 'F5'  !                         00003520
           TRANS_OPPL_OMR.BLANKETTYPE = 'B6'  !                         00003530
           TRANS_OPPL_OMR.BLANKETTYPE = 'E3'  !                         00003540
                                                                        00003550
           TRANS_OPPL_OMR.BLANKETTYPE = 'FB'  !                         00003560
           TRANS_OPPL_OMR.BLANKETTYPE = 'BP'  !                         00003570
           TRANS_OPPL_OMR.BLANKETTYPE = 'EP'   )  THEN                  00003580
                                                                        00003590
           DO;                                                          00003600
              B01_STAT_PT1               = ' ';                         00003610
           END;                                                         00003620
                                                                        00003630
                                                                        00003640
       ENDRET = (B01_STAT_PT1 ^= B02_STAT_PT1) !                        00003650
                (B01.PERSON(I).STATUS.PENSJONSTYPE2 ^=                  00003660
                 B02.PERSON(I).STATUS.PENSJONSTYPE2) !                  00003670
                (B01.PERSON(I).STATUS.PENSJONSTYPE3 ^=                  00003680
                 B02.PERSON(I).STATUS.PENSJONSTYPE3) !                  00003690
                (B01_PENSJON = 0 & B02_PENSJON > 0) !                   00003700
                (B01_PENSJON > 0 & B02_PENSJON = 0);                    00003710
                                                                        00003720
                                                                        00003730
       IF ENDRET THEN                                                   00003740
       DO;                                                              00003750
          SEGMENT_TABELL.PTYPE = TRUE;                                  00003760
          PTYPE.PT1 = B02_STAT_PT1;                                     00003770
          PTYPE.PT2 = B02.PERSON(I).STATUS.PENSJONSTYPE2;               00003780
          PTYPE.PT3 = B02.PERSON(I).STATUS.PENSJONSTYPE3;               00003790
                                                                        00003800
          IF PTYPE.PT1 = 'G' !                                          00003810
             PTYPE.PT1 = 'D' !                                          00003820
             PTYPE.PT1 = 'F' !                                          00003830
             PTYPE.PT1 = ' '      THEN                                  00003840
             DO;                                                        00003850
                PTYPE.PT2 = ' ';                                        00003860
                PTYPE.PT3 = ' ';                                        00003870
             END;                                                       00003880
          ELSE IF B02_PENSJON = 0 THEN PTYPE.PT2 = 'N';                 00003890
       END;                                                             00003900
                                                                        00003910
 /*-------------------------------------------------------------------*/00003920
 /*    SIVILST_SEGMENT                                                */00003930
 /*-------------------------------------------------------------------*/00003940
                                                                        00003950
       IF B02.PERSON (I).STATUS.SIVILSTAND                   ^= ' ' THEN00003960
          DO;                                                           00003970
             ENDRET =    (B01.PERSON(I).STATUS.SIVILSTAND    ^=         00003980
                          B02.PERSON(I).STATUS.SIVILSTAND)             ;00003990
                                                                        00004000
             IF ^ENDRET & B02.PERSON(I).STATUS.SIVILSTAND     = 'G' THEN00004010
                DO;                                                     00004020
                   ENDRET =    (B01.PERSON(I).STATUS.PENSJONSTYPE1 ^=   00004030
                                B02.PERSON(I).STATUS.PENSJONSTYPE1)  ;  00004040
                   IF ^ENDRET    THEN                                   00004050
                     ENDRET =    (B01.PERSON(I).STATUS.PENSJONSTYPE2 ^= 00004060
                                  B02.PERSON(I).STATUS.PENSJONSTYPE2)  ;00004070
                END;                                                    00004080
                                                                        00004090
             IF ^ENDRET THEN                                            00004100
                DO;                                                     00004110
                   ENDRET =  (B01.PERSON(3-I).STATUS.PENSJONSTYPE1 ^=   00004120
                              B02.PERSON(3-I).STATUS.PENSJONSTYPE1)  ;  00004130
                   IF ^ENDRET    THEN                                   00004140
                     ENDRET =  (B01.PERSON(3-I).STATUS.PENSJONSTYPE2 ^= 00004150
                                B02.PERSON(3-I).STATUS.PENSJONSTYPE2)  ;00004160
                END;                                                    00004170
                                                                        00004180
             IF ENDRET &                                                00004190
                B02.PERSON(I).STATUS.PENSJONSTYPE1 ^= 'D' THEN          00004200
                DO;                                                     00004210
                   SEGMENT_TABELL.SIVILST                     =  TRUE  ;00004220
  /* R0016031 */   SIVILST.SIVILSTAND                         =         00004230
                   F_KONV_SIVILSTAND (B02.PERSON(I).STATUS.SIVILSTAND) ;00004240
                   IF SIVILST.SIVILSTAND = '30' THEN                    00004250
                      DO;                                               00004260
                         W_FNR   = TRANS_OPPL_OMR.FØDSNUMMER;           00004270
                         W_VIRKD = TRANS_OPPL_OMR.VIRKNINGSDATO;        00004280
                         TRANS_OPPL_OMR.FØDSNUMMER = B02.PERSON(I).FNR; 00004290
                         TRANS_OPPL_OMR.VIRKNINGSDATO =                 00004300
                                     B02.PERSON(I).STATUS.VIRK_DATO_ÅM; 00004310
                         EXEC CICS LINK PROGRAM                         00004320
                                    ('R0016601') COMMAREA(KOM_OMR);     00004330
                         TRANS_OPPL_OMR.FØDSNUMMER    = W_FNR;          00004340
                         TRANS_OPPL_OMR.VIRKNINGSDATO = W_VIRKD;        00004350
                      END;                                              00004360
                END;                                                    00004370
          END;                                                          00004380
                                                                        00004390
 /*-------------------------------------------------------------------*/00004400
 /*                                                                   */00004410
 /*    APOPPL-SEGMENT                                                 */00004420
 /*    I FORBINDELSE MED LOVENDRING 1.1.92 BYTTES FAI_MAX UT MED      */00004430
 /*    TAI_FAK, FAI OMGJØRES TIL G-FAKTOR (FAI_FAK) SAMT AT NYTT      */00004440
 /*    FELT: BEREGN_ALT SKAL SI BENYTTET BEREGNINGSALTERNATIV. BØ9201 */00004450
 /*-------------------------------------------------------------------*/00004460
                                                                        00004470
       ENDRET = (B01.PERSON(I).ALDERSP.APD ^=                           00004480
                 B02.PERSON(I).ALDERSP.APD)        !                    00004490
                (B01.PERSON(I).ALDERSP.FAI ^=                           00004500
                 B02.PERSON(I).ALDERSP.FAI)        !                    00004510
 /*BØ9201:*/  (((B02.PERSON(I).STATUS.PENSJONSTYPE1  = 'A' !            00004520
                 B02.PERSON(I).STATUS.PENSJONSTYPE1  = 'K' ) !          00004530
                (B01.PERSON(I).STATUS.PENSJONSTYPE1  = 'A' !            00004540
                 B01.PERSON(I).STATUS.PENSJONSTYPE1  = 'K' ) ) &        00004550
               ((B01.PERSON(I).STATUS.PENSJONSTYPE1 ^=                  00004560
                 B02.PERSON(I).STATUS.PENSJONSTYPE1        ) !          00004570
                (B01.PERSON(I).STATUS.PENSJONSTYPE2 ^=                  00004580
                 B02.PERSON(I).STATUS.PENSJONSTYPE2        ) ) ) ;      00004590
                                                                        00004600
                                                                        00004610
       /*BØ9201:*/                                                      00004620
       IF ^ENDRET                                      &                00004630
          (B02.PERSON(I).STATUS.PENSJONSTYPE1  = 'A' !                  00004640
           B02.PERSON(I).STATUS.PENSJONSTYPE1  = 'K' ) &                00004650
          /* SØRGE FOR TEST PE=0 (AN) TIL PE>0.            BØ9207*/     00004660
          (B02_PENSJON > 0)                            & /*BØ9207*/     00004670
          (B02.PERSON(I).ALDERSP.APD   = 0)            THEN             00004680
          ENDRET = F_REGN_APD_B01_B02 ;        /* R0016053 */           00004690
                                                                        00004700
       IF ENDRET THEN                                                   00004710
       DO;                                                              00004720
          SEGMENT_TABELL.APOPPL = TRUE;                                 00004730
 /*BØ9201-START: */                                                     00004740
          IF B02.PERSON(I).STATUS.PENSJONSTYPE1    = 'A' !              00004750
             B02.PERSON(I).STATUS.PENSJONSTYPE1    = 'K' THEN           00004760
            DO;                                                         00004770
              CALL FASTSETT_AP_BEREGN ;   /* R0016038 */                00004780
                                                                        00004790
              /*--------------------------------------------------*/    00004800
              /* PROSEDYREN GIR APOPPL.FAI_FAK, -.TAI_FAK, -.APD  */    00004810
              /* OG -.BEREGN_ALT. FOR DE 2 SISTE FELTENE ER       */    00004820
              /* LOGIKKEN AVHENGIG AV OM TILFELLET "TILHØRER"     */    00004830
              /* LOVENDRING FRA 1.1.92 ELLER IKKE.   BØ9201       */    00004840
              /*--------------------------------------------------*/    00004850
                                                                        00004860
            END;                                                        00004870
 /*BØ9201-SLUTT*/                                                       00004880
                                                                        00004890
       END;                                                             00004900
                                                                        00004910
 /*-------------------------------------------------------------------*/00004920
 /*                                                                   */00004930
 /*    PENSJON-SEGMENT,                                               */00004940
 /*    ET-SEGMENT OG                                                  */00004950
 /*    KT-SEGMENT ER AVHENGIG AV 'PENSJONSTYPE1'                      */00004960
 /*                                                                   */00004970
 /*-------------------------------------------------------------------*/00004980
                                                                        00004990
       TEST_B02_PT1 = B02.PERSON(I).STATUS.PENSJONSTYPE1;               00005000
       IF TEST_B02_PT1 = ' ' THEN                                       00005010
          TEST_B02_PT1 = B01.PERSON(I).STATUS.PENSJONSTYPE1;            00005020
                                                                        00005030
       SELECT(TEST_B02_PT1);                                            00005040
          WHEN ('D')                                                    00005050
            DO;                                                         00005060
              /*-----------------------------------------------------*/ 00005070
              /* IKKE PENSJON- OG KT-SEGMENT UTEN TIDL. YTELSE.      */ 00005080
              /* YPT MÅ HENTES HVIS AKTUELT (GJØRES ENKLERE??).BØ9011*/ 00005090
              /*-----------------------------------------------------*/ 00005100
                                                                        00005110
              IF B01_STAT_PT1   ^= 'D'  &                               00005120
                 B01_STAT_PT1   ^= ' '  &                               00005130
                 B01_STAT_PT1   ^= 'G'  &                               00005140
                 B01_STAT_PT1   ^= 'F'  &                               00005150
                 B01_STAT_PT1   ^= 'L'  THEN                            00005160
                DO;                                                     00005170
                  SEGMENT_TABELL.PENSJON = TRUE;                        00005180
                  SEGMENT_TABELL.KT      = TRUE;                        00005190
                END;                                                    00005200
                                                                        00005210
              IF B01.PERSON(I).STATUS.DØD_AV_YRKESSKADE = 'J' THEN      00005220
                 B01_YPT = B01.PERSON(I).YRKEPENS.YPT;                  00005230
              IF B02.PERSON(I).STATUS.DØD_AV_YRKESSKADE = 'J' THEN      00005240
                 B02_YPT = B02.PERSON(I).YRKEPENS.YPT;                  00005250
            END;                                                        00005260
                                                                        00005270
                                                                        00005280
          WHEN ('A','K')                                                00005290
          DO;                                                           00005300
             /*------------------------------------------------------*/ 00005310
             /*FORBEREDELSE TIL REGTPKT-SEGMENT                      */ 00005320
             /*------------------------------------------------------*/ 00005330
             B01_PÅ      = B01.PERSON(I).ALDERSP.PÅ;                    00005340
             B02_PÅ      = B02.PERSON(I).ALDERSP.PÅ;                    00005350
             B01_SPT     = B01.PERSON(I).ALDERSP.SPT;                   00005360
             B02_SPT     = B02.PERSON(I).ALDERSP.SPT;                   00005370
             B01_OPT     = B01.PERSON(I).ALDERSP.OPT;                   00005380
             B02_OPT     = B02.PERSON(I).ALDERSP.OPT;                   00005390
             B01_YPT     = B01.PERSON(I).YRKEPENS.YPT;                  00005400
             B02_YPT     = B02.PERSON(I).YRKEPENS.YPT;                  00005410
 /*BØ9201:*/                                                            00005420
             B01_PÅ_E91  = B01.PERSON(I).ALDERSP.PÅ_ETTER91;            00005430
             B02_PÅ_E91  = B02.PERSON(I).ALDERSP.PÅ_ETTER91;            00005440
             B01_SPT_GML = B01.PERSON(I).ALDERSP.SPT_1291;              00005450
             B02_SPT_GML = B02.PERSON(I).ALDERSP.SPT_1291;              00005460
 /*-------------------------------------------------------------------*/00005470
 /*          PENSJON-SEGMENT  ( PT1 = A / K )                         */00005480
 /*-------------------------------------------------------------------*/00005490
 /*BØ9201:*/ ENDRET = (B01.PERSON(I).ALDERSP.AP_GP_NETTO ^=             00005500
                       B02.PERSON(I).ALDERSP.AP_GP_NETTO) !             00005510
                      (B01.PERSON(I).ALDERSP.ST ^=                      00005520
                       B02.PERSON(I).ALDERSP.ST) !                      00005530
                      (B01.PERSON(I).ALDERSP.AP_TP_NETTO +              00005540
                       B01.PERSON(I).ETTEPENS.TP_NETTO ^=               00005550
                       B02.PERSON(I).ALDERSP.AP_TP_NETTO +              00005560
                       B02.PERSON(I).ETTEPENS.TP_NETTO)   !             00005570
                      (B01.PERSON(I).STATUS.GT_TILLEGG_LOV92 ^=         00005580
                       B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 )  !       00005590
                      (B01_PENSJON ^= B02_PENSJON )  ;        /*BØ9207*/00005600
                                                                        00005610
 /*SOB0000 FRA */                                                       00005620
 /*                                                                  */ 00005630
 /*          IF ^ENDRET THEN                                         */ 00005640
 /*            ENDRET = (B01.PERSON(I).ALDERSP.AP_GP_NETTO     = 0 & */ 00005650
 /*                      B01.PERSON(I).ALDERSP.ST              = 0 & */ 00005660
 /*                      B01.PERSON(I).ALDERSP.AP_TP_NETTO     = 0 & */ 00005670
 /*                      B01.PERSON(I).ETTEPENS.TP_NETTO       = 0 & */ 00005680
 /*                      B01.PERSON(I).STATUS.GT_TILLEGG_LOV92 = 0 & */ 00005690
 /*                      B01_PENSJON                           = 0); */ 00005700
 /*SOB0000 TIL */                                                       00005710
                                                                        00005720
                      /*----------------------------------------------*/00005730
                      /*V/ALDERSKONV-P67 (RED.YT) PE>0 TIL PE=0. NÅR  */00005740
                      /*UP/YP EVT. EP > 0 OG AP = 0, HOLDER DET IKKE Å*/00005750
                      /*TESTE PÅ AP-FELTER FORDI DE ALLE ER 0.  BØ9207*/00005760
               /*---------------------------------------------------*/  00005770
               /* AFP-STATSPENSJON HAR BELØP I RF, SKAL IKKE HA DET */  00005780
               /* DET I SR. FJERNER DANNING AV BELØPSSEGM. 9009 BØ  */  00005790
               /* AFP KREVER OPPHØRSTRANS PÅ ANNEN YTELSE FØRST. SL */  00005800
               /*---------------------------------------------------*/  00005810
                                                                        00005820
             IF ENDRET &                                                00005830
               ^(B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'K' &             00005840
                 B02.PERSON(I).STATUS.PENSJONSTYPE2 = 'N' ) THEN        00005850
             DO;                                                        00005860
                SEGMENT_TABELL.PENSJON = TRUE;                          00005870
                                                                        00005880
             /*------------------------------------*/                   00005890
             /* HER REGNES DET BARE UT VERDIER     */                   00005900
             /* HVIS TRANSTYPE < 50.                                    00005910
             /*------------------------------------*/                   00005920
                                                                        00005930
                IF TRANS_OPPL_OMR.TRANSTYPE < 50  THEN                  00005940
                  DO;                                                   00005950
  /*BØ9201:*/       PENSJON.GP_FAK =                                    00005960
                       B02.PERSON(I).ALDERSP.AP_GP_NETTO * 12 /         00005970
                                             DIV_PARAM_OMR.G;           00005980
                                                                        00005990
                    PENSJON.ST_FAK =                                    00006000
                       B02.PERSON(I).ALDERSP.ST * 12 /                  00006010
                                             DIV_PARAM_OMR.G;           00006020
                                                                        00006030
                  /*-------------------------------------------------*/ 00006040
                  /* TP-GARANTI 1:                                   */ 00006050
                  /* 1.GANG 9104 - RYDDING GAMLE INNTEKTER - GJELDER */ 00006060
                  /* PERSON 1 OG 2 FOR AP OG UP/YP, IKKE EP          */ 00006070
                  /* FELT:          STATUS.GARANTI_TP        BØ9104. */ 00006080
                  /* TP-GARANTI 2:                                   */ 00006090
                  /* LOVENDRING 9201 - FRYS FOR ENDRETE BEREGNETE    */ 00006100
                  /* FRAMTIDIGE PENSJONSPOENG                        */ 00006110
                  /* FULL GARANTI:  STATUS.GT_LOV_92                 */ 00006120
                  /* REST-GARANTI:  STATUS.GT_TILLEGG_LOV92  BØ9201. */ 00006130
                  /*-------------------------------------------------*/ 00006140
                                                                        00006150
                    W_B02_SUM =                                         00006160
                       B02.PERSON(I).STATUS.GARANTI_TP       +          00006170
                       B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 +          00006180
                       B02.PERSON(I).ALDERSP.AP_TP_NETTO     +          00006190
                       B02.PERSON(I).ETTEPENS.TP_NETTO       ;          00006200
                                                                        00006210
                    PENSJON.TP_FAK = W_B02_SUM * 12 / DIV_PARAM_OMR.G;  00006220
                                                                        00006230
                    PENSJON.TP_GAR_FAK =                                00006240
                       B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 * 12 /     00006250
                                                      DIV_PARAM_OMR.G;  00006260
                                                                        00006270
                  END;                                                  00006280
             END;                                                       00006290
                                                                        00006300
 /*-------------------------------------------------------------------*/00006310
 /*          KT-SEGMENT  ( PT1 = A / K )                              */00006320
 /*-------------------------------------------------------------------*/00006330
                                                                        00006340
             ENDRET = (B01.PERSON(I).ALDERSP.KT ^=                      00006350
                       B02.PERSON(I).ALDERSP.KT)        !               00006360
   /*BØ9207-FRA -      DANNE KT=0 V/ALDERSKONV-P67 KT>0 TIL KT=0*/      00006370
                      (TRANS_OPPL_OMR.TRANSTYPE  = 74 &                 00006380
                       B01.PERSON(I).UFØRPENS.KT >  0)  !               00006390
                      (TRANS_OPPL_OMR.TRANSTYPE  = 69 &                 00006400
                       B01.PERSON(I).ETTEPENS.KT >  0)  ;               00006410
   /*BØ9207-TIL*/                                                       00006420
                                                                        00006430
                                                                        00006440
                /* SE KOM. OM AFP UNDER PENSJONS-SEGMENTET. 9009 BØ  */ 00006450
             IF ENDRET &                                                00006460
                ^(B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'K' &            00006470
                  B02.PERSON(I).STATUS.PENSJONSTYPE2 = 'N' ) THEN       00006480
             DO;                                                        00006490
                SEGMENT_TABELL.KT = TRUE;                               00006500
                IF B02.PERSON(I).ALDERSP.KT > 0 THEN                    00006510
                   KT.KT_KR = B02.PERSON(I).ALDERSP.KT*12;              00006520
             END;                                                       00006530
                                                                        00006540
                                                                        00006550
 /*-------------------------------------------------------------------*/00006560
 /*          VT-SEGMENT   ( PT1 = A / K)                              */00006570
 /*-------------------------------------------------------------------*/00006580
                                                                        00006590
             ENDRET = (B01.PERSON(I).ALDERSP.VT_GP ^=                   00006600
                       B02.PERSON(I).ALDERSP.VT_GP) !                   00006610
                      (B01.PERSON(I).ALDERSP.VT_TP ^=                   00006620
                       B02.PERSON(I).ALDERSP.VT_TP);                    00006630
                                                                        00006640
                                                                        00006650
             IF ENDRET THEN                                             00006660
             DO;                                                        00006670
                SEGMENT_TABELL.VT = TRUE;                               00006680
                                                                        00006690
             /*------------------------------------*/                   00006700
             /* HER REGNES DET BARE UT VERDIER     */                   00006710
             /* HVIS TRANSTYPE < 50.               */                   00006720
             /*------------------------------------*/                   00006730
                                                                        00006740
                IF TRANS_OPPL_OMR.TRANSTYPE < 50 THEN                   00006750
                DO;                                                     00006760
                                                                        00006770
                   VT.VT_GP_FAK =                                       00006780
                      B02.PERSON(I).ALDERSP.VT_GP * 12 /                00006790
                                            DIV_PARAM_OMR.G;            00006800
                                                                        00006810
                   VT.VT_TP_FAK =                                       00006820
                      B02.PERSON(I).ALDERSP.VT_TP * 12 /                00006830
                                            DIV_PARAM_OMR.G;            00006840
                END;                                                    00006850
             END;                                                       00006860
                                                                        00006870
                                                                        00006880
 /*-------------------------------------------------------------------*/00006890
 /*          ET-SEGMENT  ( PT1 = A / K )                              */00006900
 /*-------------------------------------------------------------------*/00006910
                                                                        00006920
             ENDRET = (B01.PERSON(I).ALDERSP.ET ^=                      00006930
                       B02.PERSON(I).ALDERSP.ET)  !                     00006940
  /*BØ9104*/          (B01.PERSON(I).FORSI.GARANTITILLEGG_EK ^=         00006950
                       B02.PERSON(I).FORSI.GARANTITILLEGG_EK)   !       00006960
   /*BØ9207 -          DANNE ET=0 V/ALDERSKONV-P67 ET>0 TIL ET=0.*/     00006970
                      (TRANS_OPPL_OMR.TRANSTYPE  = 74 &                 00006980
                       B01.PERSON(I).UFØRPENS.ET >  0)  ;               00006990
                                                                        00007000
                                                                        00007010
                /* SE KOM. OM AFP UNDER PENSJONS-SEGMENTET. 9009 BØ  */ 00007020
             IF ENDRET &                                                00007030
                ^(B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'K' &            00007040
                  B02.PERSON(I).STATUS.PENSJONSTYPE2 = 'N' ) THEN       00007050
                DO;                                                     00007060
                  SEGMENT_TABELL.ET = TRUE;                             00007070
                                                                        00007080
             /*------------------------------------*/                   00007090
             /* HER REGNES DET BARE UT VERDI       */                   00007100
             /* HVIS TRANSTYPE < 50.               */                   00007110
             /*------------------------------------*/                   00007120
                                                                        00007130
                  IF TRANS_OPPL_OMR.TRANSTYPE < 50 THEN                 00007140
                    DO;                                                 00007150
                    /*-----------------------------------------------*/ 00007160
                    /* "FRYS"-REGEL FOR FORS-TILL. FOM 1.5.91.       */ 00007170
                    /* GJELDER OGSÅ UFØREPENSJON PT=U/Y.    BØ9104.  */ 00007180
                    /*-----------------------------------------------*/ 00007190
                      ET.ET_FAK =                                       00007200
                        (B02.PERSON(I).FORSI.GARANTITILLEGG_EK +        00007210
                         B02.PERSON(I).ALDERSP.ET)                      00007220
                                          * 12 / DIV_PARAM_OMR.G;       00007230
                      ET.ET_GAR_FAK =                                   00007240
                         B02.PERSON(I).FORSI.GARANTITILLEGG_EK          00007250
                                          * 12 / DIV_PARAM_OMR.G;       00007260
                    END;                                                00007270
                END;                                                    00007280
                                                                        00007290
          END; /* OF WHEN ('A', 'K') */                                 00007300
                                                                        00007310
          WHEN ('E','J','B')                                            00007320
          DO;                                                           00007330
                                                                        00007340
 /*-------------------------------------------------------------------*/00007350
 /*          PENSJON-SEGMENT  ( PT1 = E/J/B )                         */00007360
 /*-------------------------------------------------------------------*/00007370
                                                                        00007380
             ENDRET = (B01.PERSON(I).ETTEPENS.GP_NETTO ^=               00007390
                       B02.PERSON(I).ETTEPENS.GP_NETTO) !               00007400
                      (B01.PERSON(I).ETTEPENS.ST ^=                     00007410
                       B02.PERSON(I).ETTEPENS.ST) !                     00007420
                      (B01.PERSON(I).ETTEPENS.TP_NETTO ^=               00007430
                       B02.PERSON(I).ETTEPENS.TP_NETTO) !               00007440
 /*BØ9201:*/          (B01.PERSON(I).STATUS.GT_TILLEGG_LOV92 ^=         00007450
                       B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 ) ;        00007460
                                                                        00007470
 /*SOB0000 FRA */                                                       00007480
 /*                                                                   */00007490
 /*          IF ^ENDRET THEN                                        */  00007500
 /*            ENDRET = (B01.PERSON(I).ETTEPENS.GP_NETTO       = 0 &*/  00007510
 /*                      B01.PERSON(I).ETTEPENS.ST             = 0 &*/  00007520
 /*                      B01.PERSON(I).ETTEPENS.TP_NETTO       = 0 &*/  00007530
 /*                      B01.PERSON(I).STATUS.GT_TILLEGG_LOV92 = 0);*/  00007540
 /*SOB0000 TIL */                                                       00007550
                                                                        00007560
             IF ENDRET THEN                                             00007570
             DO;                                                        00007580
                SEGMENT_TABELL.PENSJON = TRUE;                          00007590
                                                                        00007600
             /*------------------------------------*/                   00007610
             /* HER REGNES DET BARE UT VERDIER     */                   00007620
             /* HVIS TRANSTYPE < 50.               */                   00007630
             /*------------------------------------*/                   00007640
                                                                        00007650
                IF TRANS_OPPL_OMR.TRANSTYPE < 50 THEN                   00007660
                DO;                                                     00007670
                                                                        00007680
                   PENSJON.GP_FAK =                                     00007690
                      B02.PERSON(I).ETTEPENS.GP_NETTO * 12 /            00007700
                                             DIV_PARAM_OMR.G;           00007710
                                                                        00007720
                   PENSJON.ST_FAK =                                     00007730
                      B02.PERSON(I).ETTEPENS.ST * 12 /                  00007740
                                             DIV_PARAM_OMR.G;           00007750
                                                                        00007760
                    /*-----------------------------------------------*/ 00007770
                    /* TP-GARANTI 2 - JFR. KOMM. UNDER PT1=A.  BØ9201*/ 00007780
                    /*-----------------------------------------------*/ 00007790
                    PENSJON.TP_FAK =                                    00007800
                      (B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 +          00007810
                       B02.PERSON(I).ETTEPENS.TP_NETTO )  * 12 /        00007820
                                                      DIV_PARAM_OMR.G;  00007830
                                                                        00007840
                    PENSJON.TP_GAR_FAK =                                00007850
                       B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 * 12 /     00007860
                                                      DIV_PARAM_OMR.G;  00007870
                END;                                                    00007880
             END;                                                       00007890
                                                                        00007900
 /*-------------------------------------------------------------------*/00007910
 /*          KT-SEGMENT  ( PT1 = E/J/B )                              */00007920
 /*-------------------------------------------------------------------*/00007930
                                                                        00007940
             ENDRET = (B01.PERSON(I).ETTEPENS.KT ^=                     00007950
                       B02.PERSON(I).ETTEPENS.KT);                      00007960
                                                                        00007970
                                                                        00007980
             IF ENDRET THEN                                             00007990
             DO;                                                        00008000
                SEGMENT_TABELL.KT = TRUE;                               00008010
                IF B02.PERSON(I).ETTEPENS.KT > 0 THEN                   00008020
                   KT.KT_KR = B02.PERSON(I).ETTEPENS.KT*12;             00008030
             END;                                                       00008040
                                                                        00008050
          END; /* OF WHEN ('E','J','B') */                              00008060
                                                                        00008070
          WHEN ('U')                                                    00008080
          DO;                                                           00008090
                                                                        00008100
 /*          FORBEREDELSE TIL REGTPKT-SEGMENT                         */00008110
                                                                        00008120
             B01_PÅ      = B01.PERSON(I).UFØRPENS.PÅ;                   00008130
             B02_PÅ      = B02.PERSON(I).UFØRPENS.PÅ;                   00008140
             B01_SPT     = B01.PERSON(I).UFØRPENS.SPT;                  00008150
             B02_SPT     = B02.PERSON(I).UFØRPENS.SPT;                  00008160
             B01_OPT     = B01.PERSON(I).UFØRPENS.OPT;                  00008170
             B02_OPT     = B02.PERSON(I).UFØRPENS.OPT;                  00008180
 /*BØ9201:*/                                                            00008190
             B01_PÅ_E91  = B01.PERSON(I).UFØRPENS.PÅ_ETTER91 ;          00008200
             B02_PÅ_E91  = B02.PERSON(I).UFØRPENS.PÅ_ETTER91 ;          00008210
             B01_SPT_GML = B01.PERSON(I).UFØRPENS.SPT_1291 ;            00008220
             B02_SPT_GML = B02.PERSON(I).UFØRPENS.SPT_1291 ;            00008230
                                                                        00008240
 /*-------------------------------------------------------------------*/00008250
 /*          PENSJON-SEGMENT  ( PT1 = U )                             */00008260
 /*-------------------------------------------------------------------*/00008270
                                                                        00008280
             ENDRET = (B01.PERSON(I).UFØRPENS.GP +                      00008290
                       B01.PERSON(I).ETTEPENS.GP_NETTO ^=               00008300
                       B02.PERSON(I).UFØRPENS.GP +                      00008310
                       B02.PERSON(I).ETTEPENS.GP_NETTO) !               00008320
                      (B01.PERSON(I).UFØRPENS.ST +                      00008330
                       B01.PERSON(I).ETTEPENS.ST ^=                     00008340
                       B02.PERSON(I).UFØRPENS.ST +                      00008350
                       B02.PERSON(I).ETTEPENS.ST) !                     00008360
                      (B01.PERSON(I).UFØRPENS.TP +                      00008370
                       B01.PERSON(I).ETTEPENS.TP_NETTO ^=               00008380
                       B02.PERSON(I).UFØRPENS.TP +                      00008390
                       B02.PERSON(I).ETTEPENS.TP_NETTO) !               00008400
 /*BØ9201:*/          (B01.PERSON(I).STATUS.GT_TILLEGG_LOV92 ^=         00008410
                       B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 ) ;        00008420
                                                                        00008430
 /*SOB0000 FRA */                                                       00008440
 /*          IF ^ENDRET THEN                                        */  00008450
 /*            ENDRET = (B01.PERSON(I).UFØRPENS.GP             = 0 &*/  00008460
 /*                      B01.PERSON(I).ETTEPENS.GP_NETTO       = 0 &*/  00008470
 /*                      B01.PERSON(I).UFØRPENS.ST             = 0 &*/  00008480
 /*                      B01.PERSON(I).ETTEPENS.ST             = 0 &*/  00008490
 /*                      B01.PERSON(I).UFØRPENS.TP             = 0 &*/  00008500
 /*                      B01.PERSON(I).ETTEPENS.TP_NETTO       = 0 &*/  00008510
 /*                      B01.PERSON(I).STATUS.GT_TILLEGG_LOV92 = 0);*/  00008520
 /*SOB0000 TIL */                                                       00008530
                                                                        00008540
             IF ENDRET THEN                                             00008550
              DO;                                                       00008560
                SEGMENT_TABELL.PENSJON = TRUE;                          00008570
                                                                        00008580
             /*------------------------------------*/                   00008590
             /* HER REGNES DET BARE UT VERDIER     */                   00008600
             /* HVIS TRANSTYPE < 50.               */                   00008610
             /*------------------------------------*/                   00008620
                                                                        00008630
                IF TRANS_OPPL_OMR.TRANSTYPE < 50 THEN                   00008640
                DO;                                                     00008650
                                                                        00008660
                   PENSJON.GP_FAK =                                     00008670
                      (B02.PERSON(I).UFØRPENS.GP +                      00008680
                       B02.PERSON(I).ETTEPENS.GP_NETTO) * 12 /          00008690
                                              DIV_PARAM_OMR.G;          00008700
                                                                        00008710
                   PENSJON.ST_FAK =                                     00008720
                      (B02.PERSON(I).UFØRPENS.ST +                      00008730
                       B02.PERSON(I).ETTEPENS.ST) * 12 /                00008740
                                              DIV_PARAM_OMR.G;          00008750
                                                                        00008760
                    /*-----------------------------------------------*/ 00008770
                    /* TP-GARANTI 1 OG 2 JFR. KOMM. UNDER PT1=A      */ 00008780
                    /*                            BØ9104. BØ9201.    */ 00008790
                    /*-----------------------------------------------*/ 00008800
 /*BØ9201:*/        W_B02_SUM =                                         00008810
                       B02.PERSON(I).STATUS.GARANTI_TP       +          00008820
                       B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 +          00008830
                       B02.PERSON(I).UFØRPENS.TP             +          00008840
                       B02.PERSON(I).ETTEPENS.TP_NETTO       ;          00008850
                                                                        00008860
                    PENSJON.TP_FAK = W_B02_SUM * 12 / DIV_PARAM_OMR.G;  00008870
                                                                        00008880
 /*BØ9201:*/        PENSJON.TP_GAR_FAK =                                00008890
                       B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 * 12 /     00008900
                                                      DIV_PARAM_OMR.G;  00008910
                END;                                                    00008920
             END;                                                       00008930
                                                                        00008940
 /*-------------------------------------------------------------------*/00008950
 /*          KT-SEGMENT  ( PT1 = U )                                  */00008960
 /*-------------------------------------------------------------------*/00008970
                                                                        00008980
             ENDRET = (B01.PERSON(I).UFØRPENS.KT +                      00008990
                       B01.PERSON(I).ETTEPENS.KT ^=                     00009000
                       B02.PERSON(I).UFØRPENS.KT +                      00009010
                       B02.PERSON(I).ETTEPENS.KT);                      00009020
                                                                        00009030
                                                                        00009040
             IF ENDRET THEN                                             00009050
             DO;                                                        00009060
                SEGMENT_TABELL.KT = TRUE;                               00009070
                IF (B02.PERSON(I).UFØRPENS.KT > 0) !                    00009080
                   (B02.PERSON(I).ETTEPENS.KT > 0) THEN                 00009090
                   KT.KT_KR =                                           00009100
                      (B02.PERSON(I).UFØRPENS.KT +                      00009110
                       B02.PERSON(I).ETTEPENS.KT) * 12;                 00009120
             END;                                                       00009130
                                                                        00009140
 /*-------------------------------------------------------------------*/00009150
 /*          ET-SEGMENT  ( PT1 = U )                                  */00009160
 /*-------------------------------------------------------------------*/00009170
                                                                        00009180
             ENDRET = (B01.PERSON(I).UFØRPENS.ET ^=                     00009190
                       B02.PERSON(I).UFØRPENS.ET)  !                    00009200
                      (B01.PERSON(I).FORSI.GARANTITILLEGG_EK ^=         00009210
                       B02.PERSON(I).FORSI.GARANTITILLEGG_EK) ;         00009220
                                                                        00009230
                                                                        00009240
             IF ENDRET THEN                                             00009250
             DO;                                                        00009260
                SEGMENT_TABELL.ET = TRUE;                               00009270
                                                                        00009280
             /*------------------------------------*/                   00009290
             /* HER REGNES DET BARE UT VERDI       */                   00009300
             /* HVIS TRANSTYPE < 50.               */                   00009310
             /*------------------------------------*/                   00009320
                                                                        00009330
                IF TRANS_OPPL_OMR.TRANSTYPE < 50 THEN                   00009340
                  DO;                                                   00009350
                    ET.ET_FAK =                                         00009360
                      (B02.PERSON(I).FORSI.GARANTITILLEGG_EK +          00009370
                       B02.PERSON(I).UFØRPENS.ET)                       00009380
                                        * 12 / DIV_PARAM_OMR.G;         00009390
                    ET.ET_GAR_FAK =                                     00009400
                       B02.PERSON(I).FORSI.GARANTITILLEGG_EK            00009410
                                        * 12 / DIV_PARAM_OMR.G;         00009420
                  END;                                                  00009430
             END;                                                       00009440
                                                                        00009450
          END; /* OF WHEN ('U') */                                      00009460
                                                                        00009470
          WHEN ('Y')                                                    00009480
          DO;                                                           00009490
                                                                        00009500
 /*          FORBEREDELSE TIL REGTPKT-SEGMENT                         */00009510
                                                                        00009520
 /*BØ9201-START:*/                                                      00009530
             IF  B01.PERSON(I).UFØRPENS.PÅ > 0 THEN                     00009540
                 B01_PÅ  = B01.PERSON(I).UFØRPENS.PÅ;                   00009550
             ELSE                                                       00009560
                 B01_PÅ  = B01.PERSON(I).YRKEPENS.PÅ;                   00009570
                                                                        00009580
             IF  B02.PERSON(I).UFØRPENS.PÅ > 0 THEN                     00009590
                 B02_PÅ  = B02.PERSON(I).UFØRPENS.PÅ;                   00009600
             ELSE                                                       00009610
                 B02_PÅ  = B02.PERSON(I).YRKEPENS.PÅ;                   00009620
                                                                        00009630
             IF  B01.PERSON(I).UFØRPENS.SPT > 0 THEN                    00009640
                 B01_SPT = B01.PERSON(I).UFØRPENS.SPT;                  00009650
             ELSE                                                       00009660
                 B01_SPT = B01.PERSON(I).YRKEPENS.SPT;                  00009670
                                                                        00009680
             IF  B02.PERSON(I).UFØRPENS.SPT > 0 THEN                    00009690
                 B02_SPT = B02.PERSON(I).UFØRPENS.SPT;                  00009700
             ELSE                                                       00009710
                 B02_SPT = B02.PERSON(I).YRKEPENS.SPT;                  00009720
                                                                        00009730
             IF  B01.PERSON(I).UFØRPENS.PÅ_ETTER91 > 0 THEN             00009740
                 B01_PÅ_E91  = B01.PERSON(I).UFØRPENS.PÅ_ETTER91 ;      00009750
             ELSE                                                       00009760
                 B01_PÅ_E91  = B01.PERSON(I).YRKEPENS.PÅ_ETTER91 ;      00009770
                                                                        00009780
             IF  B02.PERSON(I).UFØRPENS.PÅ_ETTER91 > 0 THEN             00009790
                 B02_PÅ_E91  = B02.PERSON(I).UFØRPENS.PÅ_ETTER91 ;      00009800
             ELSE                                                       00009810
                 B02_PÅ_E91  = B02.PERSON(I).YRKEPENS.PÅ_ETTER91 ;      00009820
                                                                        00009830
             IF  B01.PERSON(I).UFØRPENS.SPT_1291 > 0 THEN               00009840
                 B01_SPT_GML = B01.PERSON(I).UFØRPENS.SPT_1291 ;        00009850
             IF  B02.PERSON(I).UFØRPENS.SPT_1291 > 0 THEN               00009860
                 B02_SPT_GML = B02.PERSON(I).UFØRPENS.SPT_1291 ;        00009870
 /*BØ9201-SLUTT */                                                      00009880
                                                                        00009890
             IF  B01.PERSON(I).UFØRPENS.OPT > 0 THEN                    00009900
                 B01_OPT = B01.PERSON(I).UFØRPENS.OPT;                  00009910
             IF  B02.PERSON(I).UFØRPENS.OPT > 0 THEN                    00009920
                 B02_OPT = B02.PERSON(I).UFØRPENS.OPT;                  00009930
             B01_YPT = B01.PERSON(I).YRKEPENS.YPT;                      00009940
             B02_YPT = B02.PERSON(I).YRKEPENS.YPT;                      00009950
                                                                        00009960
 /*-------------------------------------------------------------------*/00009970
 /*          PENSJON-SEGMENT  ( PT1 = Y )                             */00009980
 /*-------------------------------------------------------------------*/00009990
             ENDRET = (B01.PERSON(I).YRKEPENS.GP +                      00010000
                       B01.PERSON(I).UFØRPENS.GP +                      00010010
                       B01.PERSON(I).ETTEPENS.GP_NETTO ^=               00010020
                       B02.PERSON(I).YRKEPENS.GP +                      00010030
                       B02.PERSON(I).UFØRPENS.GP +                      00010040
                       B02.PERSON(I).ETTEPENS.GP_NETTO) !               00010050
                      (B01.PERSON(I).ETTEPENS.ST +                      00010060
                       B01.PERSON(I).UFØRPENS.ST ^=                     00010070
                       B02.PERSON(I).ETTEPENS.ST +                      00010080
                       B02.PERSON(I).UFØRPENS.ST) !                     00010090
                      (B01.PERSON(I).YRKEPENS.TP +                      00010100
                       B01.PERSON(I).UFØRPENS.TP +                      00010110
                       B01.PERSON(I).ETTEPENS.TP_NETTO ^=               00010120
                       B02.PERSON(I).YRKEPENS.TP +                      00010130
                       B02.PERSON(I).UFØRPENS.TP +                      00010140
                       B02.PERSON(I).ETTEPENS.TP_NETTO) !               00010150
 /*BØ9201:*/          (B01.PERSON(I).STATUS.GT_TILLEGG_LOV92 ^=         00010160
                       B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 ) ;        00010170
                                                                        00010180
 /*SOB0000 FRA */                                                       00010190
 /*          IF ^ENDRET THEN                                          */00010200
 /*            ENDRET = (B01.PERSON(I).YRKEPENS.GP             = 0 &  */00010210
 /*                      B01.PERSON(I).UFØRPENS.GP             = 0 &  */00010220
 /*                      B01.PERSON(I).ETTEPENS.GP_NETTO       = 0 &  */00010230
 /*                      B01.PERSON(I).ETTEPENS.ST             = 0 &  */00010240
 /*                      B01.PERSON(I).UFØRPENS.ST             = 0 &  */00010250
 /*                      B01.PERSON(I).YRKEPENS.TP             = 0 &  */00010260
 /*                      B01.PERSON(I).UFØRPENS.TP             = 0 &  */00010270
 /*                      B01.PERSON(I).ETTEPENS.TP_NETTO       = 0 &  */00010280
 /*                      B01.PERSON(I).STATUS.GT_TILLEGG_LOV92 = 0);  */00010290
 /*SOB0000 TIL */                                                       00010300
                                                                        00010310
             IF ENDRET THEN                                             00010320
              DO;                                                       00010330
                 SEGMENT_TABELL.PENSJON = TRUE;                         00010340
                                                                        00010350
              /*------------------------------------*/                  00010360
              /* HER REGNES DET BARE UT VERDIER     */                  00010370
              /* HVIS TRANSTYPE < 50.               */                  00010380
              /*------------------------------------*/                  00010390
                                                                        00010400
                 IF TRANS_OPPL_OMR.TRANSTYPE < 50 THEN                  00010410
                 DO;                                                    00010420
                    PENSJON.GP_FAK =                                    00010430
                      (B02.PERSON(I).YRKEPENS.GP +                      00010440
                       B02.PERSON(I).UFØRPENS.GP +                      00010450
                       B02.PERSON(I).ETTEPENS.GP_NETTO) * 12 /          00010460
                                              DIV_PARAM_OMR.G;          00010470
                                                                        00010480
                    PENSJON.ST_FAK =                                    00010490
                      (B02.PERSON(I).UFØRPENS.ST +                      00010500
                       B02.PERSON(I).ETTEPENS.ST) * 12 /                00010510
                                              DIV_PARAM_OMR.G;          00010520
                                                                        00010530
                    /*-----------------------------------------------*/ 00010540
                    /* TP-GARANTI 1 OG 2 JFR. KOMM. UNDER PT1=A      */ 00010550
                    /*                            BØ9104. BØ9201.    */ 00010560
                    /*-----------------------------------------------*/ 00010570
                                                                        00010580
 /*BØ9201:*/        W_B02_SUM =                                         00010590
                       B02.PERSON(I).STATUS.GARANTI_TP       +          00010600
                       B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 +          00010610
                       B02.PERSON(I).YRKEPENS.TP             +          00010620
                       B02.PERSON(I).UFØRPENS.TP             +          00010630
                       B02.PERSON(I).ETTEPENS.TP_NETTO       ;          00010640
                                                                        00010650
                    PENSJON.TP_FAK = W_B02_SUM * 12 / DIV_PARAM_OMR.G;  00010660
                                                                        00010670
 /*BØ9201:*/        PENSJON.TP_GAR_FAK =                                00010680
                       B02.PERSON(I).STATUS.GT_TILLEGG_LOV92 * 12 /     00010690
                                                      DIV_PARAM_OMR.G;  00010700
                 END;                                                   00010710
              END;                                                      00010720
                                                                        00010730
 /*-------------------------------------------------------------------*/00010740
 /*          KT-SEGMENT  ( PT1 = Y )                                  */00010750
 /*-------------------------------------------------------------------*/00010760
                                                                        00010770
             ENDRET = (B01.PERSON(I).ETTEPENS.KT +                      00010780
                       B01.PERSON(I).UFØRPENS.KT ^=                     00010790
                       B02.PERSON(I).ETTEPENS.KT +                      00010800
                       B02.PERSON(I).UFØRPENS.KT);                      00010810
                                                                        00010820
                                                                        00010830
             IF ENDRET THEN                                             00010840
                DO;                                                     00010850
                   SEGMENT_TABELL.KT = TRUE;                            00010860
                   IF (B02.PERSON(I).ETTEPENS.KT +                      00010870
                       B02.PERSON(I).UFØRPENS.KT) > 0 THEN              00010880
                      KT.KT_KR =                                        00010890
                                (B02.PERSON(I).ETTEPENS.KT +            00010900
                                 B02.PERSON(I).UFØRPENS.KT) * 12;       00010910
                END;                                                    00010920
                                                                        00010930
                                                                        00010940
                                                                        00010950
 /*-------------------------------------------------------------------*/00010960
 /*          ET-SEGMENT  ( PT1 = Y )                                  */00010970
 /*-------------------------------------------------------------------*/00010980
                                                                        00010990
             ENDRET = (B01.PERSON(I).UFØRPENS.ET ^=                     00011000
                       B02.PERSON(I).UFØRPENS.ET)  !                    00011010
                      (B01.PERSON(I).FORSI.GARANTITILLEGG_EK ^=         00011020
                       B02.PERSON(I).FORSI.GARANTITILLEGG_EK) ;         00011030
                                                                        00011040
                                                                        00011050
             IF ENDRET THEN                                             00011060
             DO;                                                        00011070
                SEGMENT_TABELL.ET = TRUE;                               00011080
                                                                        00011090
             /*------------------------------------*/                   00011100
             /* HER REGNES DET BARE UT VERDI       */                   00011110
             /* HVIS TRANSTYPE < 50.               */                   00011120
             /*------------------------------------*/                   00011130
                                                                        00011140
                IF TRANS_OPPL_OMR.TRANSTYPE < 50 THEN                   00011150
                  DO;                                                   00011160
                    ET.ET_FAK =                                         00011170
                      (B02.PERSON(I).FORSI.GARANTITILLEGG_EK +          00011180
                       B02.PERSON(I).UFØRPENS.ET)                       00011190
                                        * 12 / DIV_PARAM_OMR.G;         00011200
                    ET.ET_GAR_FAK =                                     00011210
                       B02.PERSON(I).FORSI.GARANTITILLEGG_EK            00011220
                                        * 12 / DIV_PARAM_OMR.G;         00011230
                  END;                                                  00011240
             END;                                                       00011250
                                                                        00011260
          END; /* OF WHEN ('Y') */                                      00011270
                                                                        00011280
          OTHERWISE ;                                                   00011290
                                                                        00011300
       END; /* OF SELECT */                                             00011310
                                                                        00011320
                                                                        00011330
 /*-------------------------------------------------------------------*/00011340
 /*    UPPER-SEGMENT                                                  */00011350
 /*    UFG = TOTAL UFØREGRAD PÅ LØPENDE PENSJON  (KAP. 8 / KAP. 11)   */00011360
 /*-------------------------------------------------------------------*/00011370
                                                                        00011380
       ENDRET = (B01.PERSON(I).UFØRPENS.UFG ^=                          00011390
                 B02.PERSON(I).UFØRPENS.UFG) !                          00011400
                (B01.PERSON(I).UFØRPENS.VILKÅR_8_1B ^=                  00011410
                 B02.PERSON(I).UFØRPENS.VILKÅR_8_1B);                   00011420
                                                                        00011430
                                                                        00011440
       /* ------------------------------------------------------ */     00011450
       /* I DEN SISTE UTFYLTE UFØREHIST ER GJELDENDE UFT OG BUP  */     00011460
       /* ------------------------------------------------------ */     00011470
                                                                        00011480
       K = 7;                             /*SOA9707: 5->7 */            00011490
       DO WHILE (B02.PERSON(I).UFØRHIST(K).UFT_ÅM = 0) UNTIL (K = 0);   00011500
          K = K - 1;                                                    00011510
       END;                                                             00011520
                                                                        00011530
       IF K = 0 THEN                                                    00011540
          DO;                                                           00011550
             K = 7;                       /*SOA9707: 5->7 */            00011560
             DO WHILE                                                   00011570
                  (X02.PERSON(I).UFØRHIST(K).UFT_ÅM = 0) UNTIL (K = 0); 00011580
                K = K - 1;                                              00011590
             END;                                                       00011600
          END;                                                          00011610
       /* ------------------------------------------------------ */     00011620
       /* SL 10.06.96 TESTER PÅ UFT < 9200 OG BUP > 5            */     00011630
       /* ------------------------------------------------------ */     00011640
       IF K > 0 THEN                                                    00011650
          ENDRET = ENDRET !                                             00011660
                   (B02.PERSON(I).UFØRHIST(K).UFT_ÅM  < 9200 &          00011670
                    B02.PERSON(I).UFØRHIST(K).BUP     > 5     ) !       00011680
                                                                        00011690
                   (B01.PERSON(I).UFØRHIST(K).UFT_ÅM ^=                 00011700
                    B02.PERSON(I).UFØRHIST(K).UFT_ÅM) !                 00011710
                   (B01.PERSON(I).UFØRHIST(K).BUP ^=                    00011720
                    B02.PERSON(I).UFØRHIST(K).BUP) !                    00011730
                   (B01.PERSON(I).UFØRHIST(K).OPPHØRSDATO_ÅM ^=         00011740
                    B02.PERSON(I).UFØRHIST(K).OPPHØRSDATO_ÅM);          00011750
                                                                        00011760
                                                                        00011770
       /* ------------------------------------------------------ */     00011780
       /* UPPER SKAL IKKE DANNES VED ENGANGSUTLØSNING YSKADE     */     00011790
       /* ------------------------------------------------------ */     00011800
       IF ENDRET  &  K > 0    &                                         00011810
          DIV_PARAM_OMR.ENGANGSBELØP_11_7(I)        >  0     THEN       00011820
         ENDRET = FALSE;                                                00011830
                                                                        00011840
       IF ENDRET & K > 0 THEN                                           00011850
          DO;                                                           00011860
             SEGMENT_TABELL.UPPER = TRUE;                               00011870
                                                                        00011880
             IF X02.PERSON(I).UFØRHIST(K).OPPHØRSDATO_ÅM ^= 0 THEN      00011890
                UPPER.UFG = 0;                                          00011900
             ELSE                                                       00011910
                DO;                                                     00011920
                   UPPER.UFG         = B02.PERSON(I).UFØRPENS.UFG;      00011930
                   UPPER.VILKÅR_8_1B =                                  00011940
                                 B02.PERSON(I).UFØRPENS.VILKÅR_8_1B;    00011950
                END;                                                    00011960
                                                                        00011970
             IF UPPER.UFG > 0 THEN                                      00011980
                DO;                                                     00011990
                   IF B02.PERSON(I).UFØRHIST(K).UFT_ÅM  > 9200  THEN    00012000
                        UPPER.BUP  = B02.PERSON(I).UFØRHIST(K).BUP;     00012010
                   ELSE UPPER.BUP  = POREKKE.BUP_FPP (I,92);            00012020
                   UPPER.UFT       = B02.PERSON(I).UFØRHIST(K).UFT_ÅM;  00012030
                   UPPER.BUPÅR_RED = B02.PERSON(I).UFØRHIST(K).         00012040
                                         REDUSERT_ANT_BUP_ÅR;           00012050
                END;                                                    00012060
             ELSE                                                       00012070
                DO;                                                     00012080
                   IF B02.PERSON(I).UFØRHIST(K).UFT_ÅM  > 9200  THEN    00012090
                        UPPER.BUP  = X02.PERSON(I).UFØRHIST(K).BUP;     00012100
                   ELSE UPPER.BUP  = POREKKE.BUP_FPP (I,92);            00012110
                   UPPER.UFT       = X02.PERSON(I).UFØRHIST(K).UFT_ÅM;  00012120
                   UPPER.BUPÅR_RED = X02.PERSON(I).UFØRHIST(K).         00012130
                                         REDUSERT_ANT_BUP_ÅR;           00012140
                END;                                                    00012150
          END;                                                          00012160
                                                                        00012170
 /*-------------------------------------------------------------------*/00012180
 /*                                                                   */00012190
 /*    BT-SEGMENT                                                     */00012200
 /*                                                                   */00012210
 /*-------------------------------------------------------------------*/00012220
                                                                        00012230
       ENDRET = (B01.PERSON(I).STATUS.ANTALL_BARN     ^=                00012240
                 B02.PERSON(I).STATUS.ANTALL_BARN)      !               00012250
                (B01.PERSON(I).ALDERSP.BT      +                        00012260
                 B01.PERSON(I).UFØRPENS.BT     +                        00012270
                 B01.PERSON(I).YRKEPENS.BT)           ^=                00012280
                (B02.PERSON(I).ALDERSP.BT      +                        00012290
                 B02.PERSON(I).UFØRPENS.BT     +                        00012300
                 B02.PERSON(I).YRKEPENS.BT)             !               00012310
                (B01.PERSON(I).FORSI.BT_SÆRBARN       ^=                00012320
                 B02.PERSON(I).FORSI.BT_SÆRBARN)        !               00012330
                (B01.PERSON(I).FORSI.GARANTITILLEGG_BARN    ^=          00012340
                 B02.PERSON(I).FORSI.GARANTITILLEGG_BARN)     !         00012350
                (B01.PERSON(I).FORSI.GARANTITILLEGG_SÆRBARN ^=          00012360
                 B02.PERSON(I).FORSI.GARANTITILLEGG_SÆRBARN)  !         00012370
  /*BØ9207-FRA - DANNE BT V/OMREGNING SÆRBARN  PR. 9205     */          00012380
  /*             DANNE BT=0 V/ALDERSKONV-P67 BT>0 TIL BT=0. */          00012390
                (TRANS_OPPL_OMR.TRANSTYPE          = 99 &               00012400
                 B02.PERSON(I).STATUS.ANTALL_BARN  >  0 ) !             00012410
                (TRANS_OPPL_OMR.TRANSTYPE          = 74 &               00012420
                (B01.PERSON(I).UFØRPENS.BT  +                           00012430
                 B01.PERSON(I).YRKEPENS.BT)        >  0 ) ;             00012440
  /*BØ9207-TIL*/                                                        00012450
                                                                        00012460
                                                                        00012470
          /* SE KOM. OM AFP UNDER PENSJONS-SEGMENTET.  BØ9009  */       00012480
          /* UNØDVENDIG? AFP HAR IKKE BARNETILLEGG.    BØ9207  */       00012490
       IF ENDRET &                                                      00012500
          ^(B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'K' &                  00012510
            B02.PERSON(I).STATUS.PENSJONSTYPE2 = 'N' ) THEN             00012520
       DO;                                                              00012530
          SEGMENT_TABELL.BT    = TRUE;                                  00012540
          BT.BT_ANT = B02.PERSON(I).STATUS.ANTALL_BARN;                 00012550
          /*------------------------------------*/                      00012560
          /* HER REGNES DET BARE UT VERDI       */                      00012570
          /* HVIS TRANSTYPE < 50 ELLER 99. BØ.  */                      00012580
          /*------------------------------------*/                      00012590
                                                                        00012600
          IF TRANS_OPPL_OMR.TRANSTYPE < 50 !                            00012610
             TRANS_OPPL_OMR.TRANSTYPE = 99 THEN     /*BØ9207-SE OVENF*/ 00012620
            DO;                                                         00012630
              /*---------------------------------------------------*/   00012640
              /* "FRYS"-REGEL FOR FORS-TILL. FOM 1.5.91.  GJELDER  */   00012650
              /* ALDERS-/UFØRE-PENSJON.                            */   00012660
              /* OPPDAGET HER EN BEGRENSNING I PL1:                */   00012670
              /* NÅR 6 FELT (DEC FIXED 5) LEGGES SAMMEN, GANGES MED*/   00012680
              /* 12, DELES PÅ G OG TILORDNES FELT (DEC FIXED 7,5) -*/   00012690
              /* KLARER IKKE ARBEIDSFELTENE MER ENN 2 DECIMALER    */   00012700
              /* SLIK AT INNTIL 0,01G MISTES. HVIS ISTEDET F.EKS.  */   00012710
              /* I TILSVARENDE REGNESTYKKE 4 FELT LEGGES SAMMEN VIL*/   00012720
              /* 4 DECIMALER BLI MED. Å DELE PÅ G FØRST BLIR LITT  */   00012730
              /* UNØYAKTIG - DERFOR EKSTRA HJELPE-FELT.  BØ9104.   */   00012740
              /*---------------------------------------------------*/   00012750
              W_B02_SUM = (B02.PERSON(I).ALDERSP.BT                +    00012760
                           B02.PERSON(I).UFØRPENS.BT               +    00012770
                           B02.PERSON(I).YRKEPENS.BT               +    00012780
                           B02.PERSON(I).FORSI.BT_SÆRBARN          +    00012790
                           B02.PERSON(I).FORSI.GARANTITILLEGG_BARN +    00012800
                           B02.PERSON(I).FORSI.GARANTITILLEGG_SÆRBARN); 00012810
                                                                        00012820
              BT.BT_FAK =  W_B02_SUM * 12 / DIV_PARAM_OMR.G ;           00012830
                                                                        00012840
              BT.BT_FAK_SÆRBARN =                                       00012850
                          (B02.PERSON(I).FORSI.BT_SÆRBARN          +    00012860
                           B02.PERSON(I).FORSI.GARANTITILLEGG_SÆRBARN)  00012870
                                      * 12 / DIV_PARAM_OMR.G;           00012880
              BT.BT_GAR_FAK_F_BARN =                                    00012890
                           B02.PERSON(I).FORSI.GARANTITILLEGG_BARN      00012900
                                      * 12 / DIV_PARAM_OMR.G;           00012910
              BT.BT_GAR_FAK_SÆRBARN =                                   00012920
                           B02.PERSON(I).FORSI.GARANTITILLEGG_SÆRBARN   00012930
                                      * 12 / DIV_PARAM_OMR.G;           00012940
            END;                                                        00012950
       END;                                                             00012960
                                                                        00012970
 /*-------------------------------------------------------------------*/00012980
 /*    TILKN-SEGMENT                                                  */00012990
 /*-------------------------------------------------------------------*/00013000
 /* DET SKAL BARE VÆRE TILKNYTNING TIL EKTEFELLE                      */00013010
 /* OBS: DØDE KAN HA TILKNYTNING TIL YNGSTE BARN                      */00013020
 /*-------------------------------------------------------------------*/00013030
     IF   TRANS_OPPL_OMR.TRANSKODE    ^= 'AUTO'     & /*9806 SL OMR*/   00013040
          W_KALL_FRA_PROGRAM_ID       ^= 'R0019H01' & /*9806 SL OMR*/   00013050
                                                                        00013060
          B02.PERSON(I).RF0PERSN.FNR   > 0 &                            00013070
          B02.PERSON(3-I).RF0PERSN.FNR > 0 THEN                         00013080
       DO;                                                              00013090
       /*-----------------*/                                            00013100
       /* HOVEDBETINGELSE */                                            00013110
       /*-----------------*/                                            00013120
                                                                        00013130
         IF  ((B01.PERSON(I).RF0PERSN.FNR =                             00013140
               B02.PERSON(I).RF0PERSN.FNR) &                            00013150
                                                                        00013160
              (B01.PERSON(3-I).RF0PERSN.FNR =                           00013170
               B02.PERSON(3-I).RF0PERSN.FNR) &                          00013180
                                                                        00013190
              (B01.PERSON(I).STATUS.VIRK_DATO_ÅM > 0  &                 00013200
               B01.PERSON(I).STATUS.SIVILSTAND ^= 'E' &                 00013210
               B01.PERSON(I).STATUS.SIVILSTAND ^= 'U' &                 00013220
               B01.PERSON(I).STATUS.SIVILSTAND ^= 'S') &                00013230
                                                                        00013240
              (B01.PERSON(3-I).STATUS.VIRK_DATO_ÅM > 0  &               00013250
               B01.PERSON(3-I).STATUS.SIVILSTAND ^= 'E' &               00013260
               B01.PERSON(3-I).STATUS.SIVILSTAND ^= 'U' &               00013270
               B01.PERSON(3-I).STATUS.SIVILSTAND ^= 'S')) THEN          00013280
                                                                        00013290
                  /* HVIS STATUS EKSISTERER,ER TILKN. DANNET. */        00013300
               ;                                                        00013310
          ELSE                                                          00013320
             DO;                                                        00013330
                /* DANNE TILKN-SEGMENT FOR ETTERLATT SAMBOER - OG -  */ 00013340
                /* FOR DEN DØDE SOM UTLØSER STØNADEN (YSKADE). BØ9012*/ 00013350
                IF ((B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'E' !         00013360
                     B02.PERSON(I).STATUS.PENSJONSTYPE2 = 'E') &        00013370
                     B02.PERSON(I).STATUS.SIVILSTAND    = 'U' ) !       00013380
                    (B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'D'  &        00013390
                     B02.PERSON(3-I).STATUS.SIVILSTAND  = 'U' ) THEN    00013400
                    CALL DANN_TILKN_F;                                  00013410
                ELSE                                                    00013420
                /* DANNE TILKN-SEGMENT FOR EKTEFELLER,DØDE OG LEVENDE*/ 00013430
                IF (B01.PERSON(I).RF0PERSN.FNR = 0 !                    00013440
                    B01.PERSON(3-I).RF0PERSN.FNR = 0) THEN              00013450
                    CALL DANN_TILKN_A;   /* NYTT TILFELLE */            00013460
                ELSE                                                    00013470
                    CALL DANN_TILKN_A;   /* GJENGIFTE, NYTT EKTESKAP */ 00013480
             END;                                                       00013490
                                                                        00013500
       /* VED SKILLSMISSE ELLER DØD BEHOLDES DEN GAMLE    */            00013510
       /* TILKNYTNING TIL EVENTUELT NYTT EKTESKAP INNGÅS. */            00013520
                                                                        00013530
       END;                                                             00013540
                                                                        00013550
                                                                        00013560
 /*-------------------------------------------------------------------*/00013570
 /*                                                                   */00013580
 /*    ETTERL-SEGMENT                                                 */00013590
 /*                                                                   */00013600
 /*-------------------------------------------------------------------*/00013610
                                                                        00013620
    /* STARTER MED Å SJEKKE OM VEDKOMMENDE ER ETTERLATT */              00013630
                                                                        00013640
       IF B02.PERSON(3-I).STATUS.DØDSDATO_ÅMD > 0 !                     00013650
          B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'J' !                    00013660
          B01.PERSON(I).STATUS.PENSJONSTYPE1 = 'J' THEN                 00013670
       DO;                                                              00013680
                                                                        00013690
          /* REGNER UT AVDØDES TRYGDETID I ANTALL MÅNEDER  */           00013700
          /* FRA 1991 TAS ET NYTT TT-FELT I BRUK.   BØ9012 */           00013710
                                                                        00013720
          IF B01.PERSON(3-I).STATUS.TT_16_66  > 0   THEN                00013730
             B01_TT_AVD =                                               00013740
                        B01.PERSON(3-I).STATUS.TT_16_66         +       00013750
                        B01.PERSON(3-I).STATUS.TT_FRAMT         +       00013760
                        B01.PERSON(3-I).STATUS.TT_67_TIL_70 * 12;       00013770
          ELSE                                                          00013780
             B01_TT_AVD =                                               00013790
                        B01.PERSON(3-I).STATUS.TT_ETTER_1966    +       00013800
                        B01.PERSON(3-I).STATUS.TT_FRAMT         +       00013810
                       (B01.PERSON(3-I).STATUS.TT_FØR_1967  +           00013820
                        B01.PERSON(3-I).STATUS.TT_67_TIL_70) * 12;      00013830
                                                                        00013840
          IF B02.PERSON(3-I).STATUS.TT_16_66  > 0   THEN                00013850
             B02_TT_AVD =                                               00013860
                        B02.PERSON(3-I).STATUS.TT_16_66         +       00013870
                        B02.PERSON(3-I).STATUS.TT_FRAMT         +       00013880
                        B02.PERSON(3-I).STATUS.TT_67_TIL_70 * 12;       00013890
          ELSE                                                          00013900
             B02_TT_AVD =                                               00013910
                        B02.PERSON(3-I).STATUS.TT_ETTER_1966    +       00013920
                        B02.PERSON(3-I).STATUS.TT_FRAMT         +       00013930
                       (B02.PERSON(3-I).STATUS.TT_FØR_1967  +           00013940
                        B02.PERSON(3-I).STATUS.TT_67_TIL_70) * 12;      00013950
                                                                        00013960
       /* REGNER UT TP-VERDIER */                                       00013970
                                                                        00013980
          SELECT (B02.PERSON(I).STATUS.PENSJONSTYPE1);                  00013990
             WHEN ('A','K') DO;                                         00014000
             /*BØ9201- FELTET HAR TIDLIGERE INNEHOLDT EGEN TP  */       00014010
             /*I FORHOLD TIL UFG/APD. DETTE OPPRETTHOLDES SELV */       00014020
             /*OM BRUTTO EGENTLIG VAR MENINGEN.                */       00014030
                           B01_TP = B01.PERSON(I).ALDERSP.AP_TP_NETTO ; 00014040
                           B02_TP = B02.PERSON(I).ALDERSP.AP_TP_NETTO ; 00014050
                        END;                                            00014060
             WHEN ('U') DO;                                             00014070
                           B01_TP = B01.PERSON(I).UFØRPENS.TP;          00014080
                           B02_TP = B02.PERSON(I).UFØRPENS.TP;          00014090
                        END;                                            00014100
             WHEN ('Y') DO;                                             00014110
                           B01_TP = B01.PERSON(I).UFØRPENS.TP +         00014120
                                    B01.PERSON(I).YRKEPENS.TP;          00014130
                           B02_TP = B02.PERSON(I).UFØRPENS.TP +         00014140
                                    B02.PERSON(I).YRKEPENS.TP;          00014150
                        END;                                            00014160
             OTHERWISE  DO;                                             00014170
                           B01_TP = 0;                                  00014180
                           B02_TP = 0;                                  00014190
                        END;                                            00014200
          END; /* OF SELECT */                                          00014210
                                                                        00014220
       /* EKTEFELLENS DØDSDATO KAN VÆRE ENDRET */                       00014230
                                                                        00014240
          IF B02.PERSON(3-I).RF0PERSN.FNR > 0 THEN                      00014250
             ENDRET = B01.PERSON(3-I).STATUS.DØDSDATO_ÅMD ^=            00014260
                      B02.PERSON(3-I).STATUS.DØDSDATO_ÅMD;              00014270
          ELSE ENDRET = FALSE;                                          00014280
                                                                        00014290
       /* ANDRE OPPLYSNINGER PÅ EKTEFELLEN KAN VÆRE ENDRET */           00014300
                                                                        00014310
                                                                        00014320
          ENDRET = ENDRET !                                             00014330
                   (B01_TT_AVD ^= B02_TT_AVD) !                         00014340
                   (B01.PERSON(I).ETTEPENS.HJEMMEL_10_8 ^=              00014350
                    B02.PERSON(I).ETTEPENS.HJEMMEL_10_8) !              00014360
                   (B01.PERSON(I).ETTEPENS.PÅ_AVD ^=                    00014370
                    B02.PERSON(I).ETTEPENS.PÅ_AVD) !                    00014380
                   (B01.PERSON(I).ETTEPENS.SPT_AVD ^=                   00014390
                    B02.PERSON(I).ETTEPENS.SPT_AVD) !                   00014400
                   (B01.PERSON(I).ETTEPENS.OPT_AVD ^=                   00014410
                    B02.PERSON(I).ETTEPENS.OPT_AVD) !                   00014420
                   (B01.PERSON(I).ETTEPENS.FORVENTET ^=                 00014430
                    B02.PERSON(I).ETTEPENS.FORVENTET) !                 00014440
                   (B01.PERSON(I).ETTEPENS.TP_BRUTTO ^=                 00014450
                    B02.PERSON(I).ETTEPENS.TP_BRUTTO) !                 00014460
                   (B01.PERSON(I).ETTEPENS.TP_NETTO ^=                  00014470
                    B02.PERSON(I).ETTEPENS.TP_NETTO) !                  00014480
                   (B01.PERSON(I).ETTEPENS.GP_BRUTTO ^=                 00014490
                    B02.PERSON(I).ETTEPENS.GP_BRUTTO) !                 00014500
                   (B01.PERSON(I).ETTEPENS.GP_NETTO ^=                  00014510
                    B02.PERSON(I).ETTEPENS.GP_NETTO) !                  00014520
                   (B01_TP ^= B02_TP) !                                 00014530
 /*BØ9201:*/       (B01.PERSON(I).ETTEPENS.PÅ_ETTER91 ^=                00014540
                    B02.PERSON(I).ETTEPENS.PÅ_ETTER91) !                00014550
                   (B01.PERSON(I).ETTEPENS.SPT_1291 ^=                  00014560
                    B02.PERSON(I).ETTEPENS.SPT_1291) ;                  00014570
                                                                        00014580
                 /* FAR DØDSDATO ER UAKTUELL                */          00014590
                 /* MOR      "        "                     */          00014600
                                                                        00014610
                                                                        00014620
          IF ENDRET THEN                                                00014630
          DO;                                                           00014640
             SEGMENT_TABELL.ETTERL     = TRUE;                          00014650
                                                                        00014660
             ETTERL.TT_AVD             = B02_TT_AVD;                    00014670
             ETTERL.PÅ_AVD             =                                00014680
                B02.PERSON(I).ETTEPENS.PÅ_AVD;                          00014690
 /*BØ9201:*/ ETTERL.PÅ_AVD_ETTER91     =                                00014700
                B02.PERSON(I).ETTEPENS.PÅ_ETTER91 ;                     00014710
                                                                        00014720
             ETTERL.SPT_AVD =                                           00014730
                B02.PERSON(I).ETTEPENS.SPT_AVD;                         00014740
                                                                        00014750
             ETTERL.OPT_AVD =                                           00014760
                B02.PERSON(I).ETTEPENS.OPT_AVD;                         00014770
 /*BØ9201:*/ ETTERL.SPT_AVD_GML        =                                00014780
                B02.PERSON(I).ETTEPENS.SPT_1291 ;                       00014790
                                                                        00014800
          /*------------------------------------*/                      00014810
          /* HER REGNES DET BARE UT VERDIER     */                      00014820
          /* HVIS TRANSTYPE < 50.               */                      00014830
          /*------------------------------------*/                      00014840
                                                                        00014850
             IF TRANS_OPPL_OMR.TRANSTYPE < 50 THEN                      00014860
             DO;                                                        00014870
                                                                        00014880
                ETTERL.FORVENTET_FAK =                                  00014890
                   B02.PERSON(I).ETTEPENS.FORVENTET * 100 /             00014900
                                            DIV_PARAM_OMR.G;            00014910
                                                                        00014920
                /* SE KOMM. OM HJELPEFELT ØVERST I PGM. BØ9104  */      00014930
                W_B02_SUM =                                             00014940
                  (B02.PERSON(I).ETTEPENS.TP_BRUTTO  -                  00014950
                   B02.PERSON(I).ETTEPENS.TP_NETTO   +                  00014960
                   B02.PERSON(I).ETTEPENS.GP_BRUTTO  -                  00014970
                   B02.PERSON(I).ETTEPENS.GP_NETTO)  ;                  00014980
                                                                        00014990
                ETTERL.FRADRAG_F_FAK = W_B02_SUM * 12 /                 00015000
                                                   DIV_PARAM_OMR.G;     00015010
                                                                        00015020
                   IF ETTERL.FRADRAG_F_FAK < 0 THEN                     00015030
                      ETTERL.FRADRAG_F_FAK = 0;                         00015040
                                                                        00015050
             /* ETTERL TILLEGGS-PENSJONS-OPPLYSNINGER  */               00015060
                                                                        00015070
                ETTERL.TP_FAK =                                         00015080
                   B02_TP * 12 / DIV_PARAM_OMR.G;                       00015090
                                                                        00015100
                /* SE KOMM. OM HJELPEFELT ØVERST I PGM. ENDRER  */      00015110
                /* DENNE FOR SIKKERHETS SKYLD.          BØ9104  */      00015120
                IF B02.PERSON(I).ETTEPENS.TP_PROSENT > 0 THEN           00015130
                   IF B02.PERSON(I).ETTEPENS.TP_BRUTTO > 0 THEN         00015140
                      DO;                                               00015150
                         W_B02_SUM =                                    00015160
                           (B02.PERSON(I).ETTEPENS.TP_BRUTTO * 100 /    00015170
                            B02.PERSON(I).ETTEPENS.TP_PROSENT) ;        00015180
                         ETTERL.TP_AVD_FAK = W_B02_SUM * 12 /           00015190
                                                       DIV_PARAM_OMR.G; 00015200
                      END;                                              00015210
                                                                        00015220
                ELSE                                                    00015230
                   IF B02.PERSON(I).ETTEPENS.TP_BRUTTO > 0 THEN         00015240
                      ETTERL.TP_AVD_FAK =                               00015250
                      (B02.PERSON(I).ETTEPENS.TP_BRUTTO * 100 / 55) *   00015260
                                     12 / DIV_PARAM_OMR.G;              00015270
                                                                        00015280
                ETTERL.HJEMMEL_10_8 =                                   00015290
                            B02.PERSON(I).ETTEPENS.HJEMMEL_10_8;        00015300
                                                                        00015310
                /*BØ9201:*/                                             00015320
                IF B02.PERSON(I).ETTEPENS.TP_NETTO > 0 THEN             00015330
                   IF (B02.PERSON(I).ALDERSP.AP_TP_NETTO > 0  !         00015340
                       B02.PERSON(I).YRKEPENS.TP         > 0  !         00015350
                       B02.PERSON(I).UFØRPENS.TP         > 0) THEN      00015360
                      ETTERL.TP_ANV = '3';                              00015370
                   ELSE                                                 00015380
                      ETTERL.TP_ANV = '2';                              00015390
                ELSE                                                    00015400
                   IF (B02.PERSON(I).ALDERSP.AP_TP_NETTO > 0  !         00015410
                       B02.PERSON(I).YRKEPENS.TP         > 0  !         00015420
                       B02.PERSON(I).UFØRPENS.TP         > 0) THEN      00015430
                      ETTERL.TP_ANV = '1';                              00015440
                   ELSE                                                 00015450
                      ETTERL.TP_ANV = '0';                              00015460
             END;                                                       00015470
                                                                        00015480
          /* DØDSDATO MÅ KONVERTERES TIL ÅR-MND        */               00015490
                                                                        00015500
             DATO = B02.PERSON(3-I).DØDSDATO_ÅMD;                       00015510
             ETTERL.EK_DØDSDATO = DATO_ÅM;                              00015520
                                                                        00015530
             ETTERL.FAR_DØDSDATO = '0000';                              00015540
             ETTERL.MOR_DØDSDATO = '0000';                              00015550
                                                                        00015560
          END;                                                          00015570
       END;                                                             00015580
                                                                        00015590
                                                                        00015600
 /*-------------------------------------------------------------------*/00015610
 /*                                                                   */00015620
 /*    YSKADE-SEGMENT                                                 */00015630
 /*                                                                   */00015640
 /*-------------------------------------------------------------------*/00015650
                                                                        00015660
       /* OPPHØRSSEG. HITTIL IKKE DANNET F.EKS. V/OVERGANG AP, BØ 9003*/00015670
                                                                        00015680
       ENDRET = (B01.PERSON(I).YRKEPENS.YUG             ^=              00015690
                 B02.PERSON(I).YRKEPENS.YUG)                  !         00015700
                (B01.PERSON(I).YRKEPENS.GP              ^=              00015710
                 B02.PERSON(I).YRKEPENS.GP )                  !         00015720
                (B01.PERSON(I).YRKEPENS.TP              ^=              00015730
                 B02.PERSON(I).YRKEPENS.TP )                  !         00015740
                (B01.PERSON(I).YRKEPENS.BT              ^=              00015750
                 B02.PERSON(I).YRKEPENS.BT )                  !         00015760
                (B01.PERSON(I).YRKEPENS.YPT_KODE        ^=              00015770
                 B02.PERSON(I).YRKEPENS.YPT_KODE)             !         00015780
                 DIV_PARAM_OMR.ENGANGSBELØP_11_7(I)     ^= 0  !         00015790
                (B01.PERSON(I).STATUS.DØD_AV_YRKESSKADE ^= 'J' &        00015800
                 B02.PERSON(I).STATUS.DØD_AV_YRKESSKADE  = 'J' );       00015810
                                                                        00015820
                                                                        00015830
       /* ------------------------------------------------ */           00015840
       /*  I DEN SISTE UTFYLTE YRKEHIST ER GJELDENDE YUFT. */           00015850
       /* ------------------------------------------------ */           00015860
       K1 = 5;                                                          00015870
       DO WHILE (B02.PERSON(I).YRKEHIST(K1).YUFT_ÅM = 0)                00015880
                                                    UNTIL (K1 = 0);     00015890
          K1 = K1 - 1;                                                  00015900
       END;                                                             00015910
                                                                        00015920
       IF K1 = 0 THEN                                                   00015930
          DO;                                                           00015940
             K1 = 5;                                                    00015950
             DO WHILE                                                   00015960
               (X02.PERSON(I).YRKEHIST(K1).YUFT_ÅM = 0) UNTIL (K1 = 0); 00015970
               K1 = K1 - 1;                                             00015980
             END;                                                       00015990
          END;                                                          00016000
                                                                        00016010
                                                                        00016020
       IF K1 > 0 THEN                                                   00016030
          ENDRET = ENDRET !                                             00016040
                   (B01.PERSON(I).YRKEHIST(K1).YUFT_ÅM ^=               00016050
                    B02.PERSON(I).YRKEHIST(K1).YUFT_ÅM) !               00016060
                   (B01.PERSON(I).YRKEHIST(K1).AÅI ^=                   00016070
                    B02.PERSON(I).YRKEHIST(K1).AÅI) !                   00016080
                   (B01.PERSON(I).YRKEHIST(K1).YRKE11 ^=                00016090
                    B02.PERSON(I).YRKEHIST(K1).YRKE11);                 00016100
                                                                        00016110
       IF ENDRET  &  K1 > 0  THEN                                       00016120
          SEGMENT_TABELL.YSKADE = TRUE;                                 00016130
                                                                        00016140
       IF ENDRET & K1 > 0 THEN                                          00016150
          DO;                                                           00016160
                                                                        00016170
 /*SOB9706*/ YSKADE.YSYKDOM  =  B02.PERSON(I).YRKEPENS.YSYKDOM;         00016180
                                                                        00016190
             IF X02.PERSON(I).YRKEHIST(K1).OPPH_DATO_ÅM ^= 0   THEN     00016200
                                                                        00016210
               IF B02.PERSON(I).STATUS.PENSJONSTYPE1    ^= 'A' &        00016220
                  B02.PERSON(I).STATUS.PENSJONSTYPE1    ^= 'D' THEN     00016230
                  YSKADE.YFG        = 0;                                00016240
               ELSE                                                     00016250
                  YSKADE.YFG        = B02.PERSON(I).YRKEPENS.YUG;       00016260
                                                                        00016270
             ELSE                                                       00016280
               IF DIV_PARAM_OMR.ENGANGSBELØP_11_7(I)         >  0  &    00016290
                  B02.PERSON(I).YRKEHIST(K1).KAP_11_7_UTLØST = 'J' THEN 00016300
                  YSKADE.YFG        = B02.PERSON(I).YRKEHIST(K1).YUG;   00016310
                                                                        00016320
               ELSE                                                     00016330
                  YSKADE.YFG        = B02.PERSON(I).YRKEPENS.YUG;       00016340
                                                                        00016350
             IF YSKADE.YFG > 0 THEN                                     00016360
                DO;                                                     00016370
                   YSKADE.SKADETP        =                              00016380
                                  B02.PERSON(I).YRKEHIST(K1).YST_ÅM;    00016390
                   YSKADE.ANTATT_INNTEKT =                              00016400
                                  B02.PERSON(I).YRKEHIST(K1).AÅI;       00016410
                   YSKADE.YFT =                                         00016420
                                  B02.PERSON(I).YRKEHIST(K1).YUFT_ÅM;   00016430
                   YSKADE.YRKE11 =                                      00016440
                                  B02.PERSON(I).YRKEHIST(K1).YRKE11;    00016450
                END;                                                    00016460
             ELSE                                                       00016470
                DO;                                                     00016480
                   YSKADE.SKADETP        =                              00016490
                                  X02.PERSON(I).YRKEHIST(K1).YST_ÅM;    00016500
                   YSKADE.ANTATT_INNTEKT =                              00016510
                                  X02.PERSON(I).YRKEHIST(K1).AÅI;       00016520
                   YSKADE.YFT =                                         00016530
                               X02.PERSON(I).YRKEHIST(K1).YUFT_ÅM;      00016540
                   YSKADE.YRKE11 =                                      00016550
                               X02.PERSON(I).YRKEHIST(K1).YRKE11;       00016560
                                                                        00016570
                END;                                                    00016580
          END;                                                          00016590
                                                                        00016600
       IF ENDRET  &  K1 > 0  THEN                                       00016610
          IF TRANS_OPPL_OMR.TRANSTYPE < 50 THEN                         00016620
                                                                        00016630
            DO;                                                         00016640
               /*-------------------------------- */                    00016650
               /*  IKKE I BRUK I RF-SYSTEMET - OG */                    00016660
               /*  FJERNET FRA SR/TR_BASENE:      */                    00016670
               /* YSKADE.Y_ST_FAK =               */                    00016680
               /* YSKADE.Y_ET_FAK =               */                    00016690
               /*-------------------------------- */                    00016700
                                                                        00016710
               YSKADE.Y_GP_FAK    =  B02.PERSON(I).YRKEPENS.GP * 12 /   00016720
                                            DIV_PARAM_OMR.G;            00016730
                                                                        00016740
               /*-------------------------------------------------- */  00016750
               /* AD. TP-GARANTI 2:(SE KOMM. TIL PENSJON M/PT1=A(Y))*/  00016760
               /* PGA. PROBLEMET MED OM NOE - EVT. HELE - GARANTIEN */  00016770
               /* SKYLDES YSKADE, BRUKES DEN IKKE HER.   BØ9201.    */  00016780
               /*-------------------------------------------------- */  00016790
               YSKADE.Y_TP_FAK    =  B02.PERSON(I).YRKEPENS.TP * 12 /   00016800
                                            DIV_PARAM_OMR.G;            00016810
                                                                        00016820
               YSKADE.Y_BT_FAK    =  B02.PERSON(I).YRKEPENS.BT * 12 /   00016830
                                            DIV_PARAM_OMR.G;            00016840
                                                                        00016850
               /*-------------------------------------------------- */  00016860
               /*  FELTET FOREKOMMER BARE V/BARNEPENSJON (R0026023):*/  00016870
               /* YSKADE.PLEIEBARN =                                */  00016880
               /*-------------------------------------------------- */  00016890
                                                                        00016900
 /* SOB9706    IF B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'Y' THEN     */  00016910
 /*               YSKADE.YSYKDOM  =  DIV_PARAM_OMR.YSYKDOM;         */  00016920
                                                                        00016930
               YSKADE.ENGUTB      =                                     00016940
                           DIV_PARAM_OMR.ENGANGSBELØP_11_7(I);          00016950
                                                                        00016960
               YSKADE.YPTKODE     =  B02.PERSON(I).YRKEPENS.YPT_KODE;   00016970
            END;                                                        00016980
                                                                        00016990
 /*-------------------------------------------------------------------*/00017000
 /*    SPESOPPL-SEGMENT                                               */00017010
 /*-------------------------------------------------------------------*/00017020
          ENDRET =                                                      00017030
                   (B01.PERSON(I).SPESOPPL.KONVENSJON          ^=       00017040
                    B02.PERSON(I).SPESOPPL.KONVENSJON)            !     00017050
                   (B01.PERSON(I).SPESOPPL.FRAVIK_FLYKTN       ^=       00017060
                    B02.PERSON(I).SPESOPPL.FRAVIK_FLYKTN)         !     00017070
                   (B01.PERSON(I).SPESOPPL.FRAVIK_BOSATT       ^=       00017080
                    B02.PERSON(I).SPESOPPL.FRAVIK_BOSATT)         !     00017090
                   (B01.PERSON(I).SPESOPPL.FRAVIK_TRYGDET_3ÅR  ^=       00017100
                    B02.PERSON(I).SPESOPPL.FRAVIK_TRYGDET_3ÅR)    !     00017110
                   (B01.PERSON(I).SPESOPPL.FRAVIK_19_3         ^=       00017120
                    B02.PERSON(I).SPESOPPL.FRAVIK_19_3)           !     00017130
                   (B01.PERSON(I).SPESOPPL.FRAVIK_8_1          ^=       00017140
                    B02.PERSON(I).SPESOPPL.FRAVIK_8_1)            !     00017150
                   (B01.PERSON(I).SPESOPPL.FRAVIK_10_1         ^=       00017160
                    B02.PERSON(I).SPESOPPL.FRAVIK_10_1)           !     00017170
  /*BØ9012*/                                                            00017180
                   (B01.PERSON(I).SPESOPPL.PENSJONSTRYGDET     ^=       00017190
                    B02.PERSON(I).SPESOPPL.PENSJONSTRYGDET)       !     00017200
                   (B01.PERSON(I).SPESOPPL.MINST_20ÅR_BOTID    ^=       00017210
                    B02.PERSON(I).SPESOPPL.MINST_20ÅR_BOTID)      !     00017220
                   (B01.PERSON(I).SPESOPPL.FRAVIK_BOSATT_KONVENSJON ^=  00017230
                    B02.PERSON(I).SPESOPPL.FRAVIK_BOSATT_KONVENSJON)  ! 00017240
  /*BØ9104*/                                                            00017250
                   (B01.PERSON(I).FORSI.ARBEIDSINNTEKT       ^=         00017260
                    B02.PERSON(I).FORSI.ARBEIDSINNTEKT)         !       00017270
                   (B01.PERSON(I).FORSI.PENSJONSINNTEKT      ^=         00017280
                    B02.PERSON(I).FORSI.PENSJONSINNTEKT)        !       00017290
                   (B01.PERSON(I).FORSI.ARBEIDSINNTEKT_EK    ^=         00017300
                    B02.PERSON(I).FORSI.ARBEIDSINNTEKT_EK)      !       00017310
                   (B01.PERSON(I).FORSI.PENSJONSINNTEKT_EK   ^=         00017320
                    B02.PERSON(I).FORSI.PENSJONSINNTEKT_EK)  ;          00017330
                                                                        00017340
                                                                        00017350
          IF K1 > 0 THEN                                                00017360
             ENDRET = ENDRET !                                          00017370
                     (B01.PERSON(I).YRKEHIST(K1).VILKÅR_1_2_2 ^=        00017380
                      B02.PERSON(I).YRKEHIST(K1).VILKÅR_1_2_2);         00017390
          IF ENDRET &                                                   00017400
             TRANS_OPPL_OMR.TRANSTYPE < 50 THEN                         00017410
             DO;                                                        00017420
                SEGMENT_TABELL.SPESOPPL = TRUE;                         00017430
                SPESOPPL.KONVENSJON          =                          00017440
                    B02.PERSON(I).SPESOPPL.KONVENSJON;                  00017450
                SPESOPPL.FRAVIK_FLYKTN       =                          00017460
                    B02.PERSON(I).SPESOPPL.FRAVIK_FLYKTN;               00017470
                SPESOPPL.FRAVIK_BOSATT       =                          00017480
                    B02.PERSON(I).SPESOPPL.FRAVIK_BOSATT;               00017490
                SPESOPPL.FRAVIK_TRYGDET_3ÅR  =                          00017500
                    B02.PERSON(I).SPESOPPL.FRAVIK_TRYGDET_3ÅR;          00017510
                SPESOPPL.FRAVIK_19_3         =                          00017520
                    B02.PERSON(I).SPESOPPL.FRAVIK_19_3;                 00017530
                SPESOPPL.FRAVIK_8_1          =                          00017540
                    B02.PERSON(I).SPESOPPL.FRAVIK_8_1;                  00017550
                SPESOPPL.FRAVIK_10_1         =                          00017560
                    B02.PERSON(I).SPESOPPL.FRAVIK_10_1;                 00017570
                IF K1 > 0 THEN                                          00017580
                  IF INDEX                                              00017590
                     (B02.PERSON(I).YRKEHIST(K1).VILKÅR_1_2_2, 'J') > 0 00017600
                                                                 THEN   00017610
                    SPESOPPL.VILKÅR_1_2_2    = 'J';                     00017620
                SPESOPPL.PENSJONSTRYGDET     =                          00017630
                    B02.PERSON(I).SPESOPPL.PENSJONSTRYGDET;             00017640
                SPESOPPL.MINST_20ÅR_BOTID    =                          00017650
                    B02.PERSON(I).SPESOPPL.MINST_20ÅR_BOTID;            00017660
                SPESOPPL.FRAVIK_BOSATT_KONV  =                          00017670
                    B02.PERSON(I).SPESOPPL.FRAVIK_BOSATT_KONVENSJON;    00017680
                SPESOPPL.ARB_INNT_FAK        =                          00017690
                    B02.PERSON(I).FORSI.ARBEIDSINNTEKT * 100            00017700
                                           / DIV_PARAM_OMR.G ;          00017710
                SPESOPPL.PENSJONS_FAK        =                          00017720
                    B02.PERSON(I).FORSI.PENSJONSINNTEKT * 100           00017730
                                           / DIV_PARAM_OMR.G ;          00017740
                SPESOPPL.ARB_INNT_FAK_EK     =                          00017750
                    B02.PERSON(I).FORSI.ARBEIDSINNTEKT_EK * 100         00017760
                                           / DIV_PARAM_OMR.G ;          00017770
                SPESOPPL.PENSJONS_FAK_EK     =                          00017780
                    B02.PERSON(I).FORSI.PENSJONSINNTEKT_EK * 100        00017790
                                           / DIV_PARAM_OMR.G ;          00017800
             END;                                                       00017810
                                                                        00017820
                                                                        00017830
 /*-------------------------------------------------------------------*/00017840
 /*    EØSINFO-SEGMENT                                                */00017850
 /*-------------------------------------------------------------------*/00017860
                                                                        00017870
          W01_ULIK_INNTEKTSÅR_EØS  = FALSE;                             00017880
                                                                        00017890
          DO IX=67 TO 106;                                              00017900
             IF B01.PERSON(I).EØSINFO.INNTEKTSÅR_EØS(IX)      ^=        00017910
                B02.PERSON(I).EØSINFO.INNTEKTSÅR_EØS(IX)         THEN   00017920
                W01_ULIK_INNTEKTSÅR_EØS  = TRUE;                        00017930
          END;                                                          00017940
                                                                        00017950
          ENDRET =                                                      00017960
                (B01.PERSON(I).EØSINFO.BEREGN_FOLKETRYGD       ^=       00017970
                 B02.PERSON(I).EØSINFO.BEREGN_FOLKETRYGD          ) !   00017980
                (B01.PERSON(I).EØSINFO.PRO_RATA_BEREGNING      ^=       00017990
                 B02.PERSON(I).EØSINFO.PRO_RATA_BEREGNING         ) !   00018000
                (B01.PERSON(I).EØSINFO.TT_PRO_RATA_MND         ^=       00018010
                 B02.PERSON(I).EØSINFO.TT_PRO_RATA_MND            ) !   00018020
                (B01.PERSON(I).EØSINFO.TT_TEORETISK_EØS_MND    ^=       00018030
                 B02.PERSON(I).EØSINFO.TT_TEORETISK_EØS_MND       ) !   00018040
                 W01_ULIK_INNTEKTSÅR_EØS !                              00018050
                (B01.PERSON(I).EØSINFO.ALTERNATIV_GP           ^=       00018060
                 B02.PERSON(I).EØSINFO.ALTERNATIV_GP              ) !   00018070
                (B01.PERSON(I).EØSINFO.ALTERNATIV_ST           ^=       00018080
                 B02.PERSON(I).EØSINFO.ALTERNATIV_ST              ) !   00018090
                (B01.PERSON(I).EØSINFO.ALTERNATIV_TP           ^=       00018100
                 B02.PERSON(I).EØSINFO.ALTERNATIV_TP              ) !   00018110
                (B01.PERSON(I).EØSINFO.ALTERNATIV_BT           ^=       00018120
                 B02.PERSON(I).EØSINFO.ALTERNATIV_BT              ) !   00018130
                (B01.PERSON(I).EØSINFO.ALTERNATIV_ET           ^=       00018140
                 B02.PERSON(I).EØSINFO.ALTERNATIV_ET              ) !   00018150
                (B01.PERSON(I).EØSINFO.ANTALL_NORSKE_PÅ         ^=      00018160
                 B02.PERSON(I).EØSINFO.ANTALL_NORSKE_PÅ            ) !  00018170
                (B01.PERSON(I).EØSINFO.ANTALL_NORSKE_PÅ_ETTER91 ^=      00018180
                 B02.PERSON(I).EØSINFO.ANTALL_NORSKE_PÅ_ETTER91    ) !  00018190
                (B01.PERSON(I).EØSINFO.SPT_EØS                 ^=       00018200
                 B02.PERSON(I).EØSINFO.SPT_EØS                    ) !   00018210
                (B01.PERSON(I).EØSINFO.OPT_EØS ^=                       00018220
                 B02.PERSON(I).EØSINFO.OPT_EØS) !                       00018230
                (B01.PERSON(I).EØSINFO.PENSJON_EØS             ^=       00018240
                 B02.PERSON(I).EØSINFO.PENSJON_EØS                 ) !  00018250
                (B01.PERSON(I).EØSINFO.EØS_8_4_3A              ^=       00018260
                 B02.PERSON(I).EØSINFO.EØS_8_4_3A                  );   00018270
                                                                        00018280
                                                                        00018290
          IF ENDRET                                         &           00018300
             B02.PERSON(I).EØSINFO.BEREGN_FOLKETRYGD ^= ' ' &           00018310
             TRANS_OPPL_OMR.TRANSTYPE                 < 50  THEN        00018320
             DO;                                                        00018330
                SEGMENT_TABELL.EØSINFO = TRUE;                          00018340
                                                                        00018350
                EØSINFO.BEREGN_FOLKETRYGD                      =        00018360
                    B02.PERSON(I).EØSINFO.BEREGN_FOLKETRYGD       ;     00018370
                EØSINFO.PRO_RATA                               =        00018380
                    B02.PERSON(I).EØSINFO.PRO_RATA_BEREGNING      ;     00018390
                EØSINFO.TT_PRO_RATA_MND                        =        00018400
                    B02.PERSON(I).EØSINFO.TT_PRO_RATA_MND         ;     00018410
                EØSINFO.TT_EØS_MND                             =        00018420
                    B02.PERSON(I).EØSINFO.TT_TEORETISK_EØS_MND    ;     00018430
                EØSINFO.INNTEKTSÅR_EØS (*)                     =        00018440
                    B02.PERSON(I).EØSINFO.INNTEKTSÅR_EØS (*)      ;     00018450
                EØSINFO.GP_FAK_ALT                             =        00018460
                    B02.PERSON(I).EØSINFO.ALTERNATIV_GP * 12 / G  ;     00018470
                EØSINFO.ST_FAK_ALT                             =        00018480
                    B02.PERSON(I).EØSINFO.ALTERNATIV_ST * 12 / G  ;     00018490
                EØSINFO.TP_FAK_ALT                             =        00018500
                    B02.PERSON(I).EØSINFO.ALTERNATIV_TP * 12 / G  ;     00018510
                EØSINFO.BT_FAK_ALT                             =        00018520
                    B02.PERSON(I).EØSINFO.ALTERNATIV_BT * 12 / G  ;     00018530
                EØSINFO.ET_FAK_ALT                             =        00018540
                    B02.PERSON(I).EØSINFO.ALTERNATIV_ET * 12 / G  ;     00018550
                EØSINFO.PÅ_NORSKE                              =        00018560
                    B02.PERSON(I).EØSINFO.ANTALL_NORSKE_PÅ         ;    00018570
                EØSINFO.PÅ_ETTER91                             =        00018580
                    B02.PERSON(I).EØSINFO.ANTALL_NORSKE_PÅ_ETTER91 ;    00018590
                EØSINFO.SPT_EØS                                =        00018600
                    B02.PERSON(I).EØSINFO.SPT_EØS                 ;     00018610
                EØSINFO.OPT_EØS                                =        00018620
                  B02.PERSON(I).EØSINFO.OPT_EØS;                        00018630
                EØSINFO.PENSJON_EØS_FAK                        =        00018640
                    B02.PERSON(I).EØSINFO.PENSJON_EØS        / G  ;     00018650
                EØSINFO.EØS_8_4_3A                             =        00018660
                    B02.PERSON(I).EØSINFO.EØS_8_4_3A              ;     00018670
            END;                                                        00018680
                                                                        00018690
 /*-------------------------------------------------------------------*/00018700
 /*    REGTPKT-SEGMENT                                                */00018710
 /*-------------------------------------------------------------------*/00018720
 /*    HVIS NOEN AV DE UNDERLIGGENDE SEGMENTER NÅ ER DANNET,          */00018730
 /*    SKAL DET DANNES ET REGTPKT-SEGMENT, .....                      */00018740
 /*-------------------------------------------------------------------*/00018750
                                                                        00018760
       ENDRET = SEGMENT_TABELL.PTYPE !                                  00018770
                SEGMENT_TABELL.SIVILST !                                00018780
                SEGMENT_TABELL.APOPPL !                                 00018790
                SEGMENT_TABELL.PENSJON !                                00018800
                SEGMENT_TABELL.UPPER  !                                 00018810
                SEGMENT_TABELL.KT !                                     00018820
                SEGMENT_TABELL.VT !                                     00018830
                SEGMENT_TABELL.ET !                                     00018840
                SEGMENT_TABELL.BT !                                     00018850
                SEGMENT_TABELL.TILKN !                                  00018860
                SEGMENT_TABELL.ETTERL !                                 00018870
                SEGMENT_TABELL.DIAGNOSE !                               00018880
                SEGMENT_TABELL.YSKADE !                                 00018890
                SEGMENT_TABELL.EØSINFO!                                 00018900
                SEGMENT_TABELL.SPESOPPL;                                00018910
                                                                        00018920
 /*-------------------------------------------------------------------*/00018930
 /* ...ELLER HVIS NOEN AV FELTENE I REGTPKT-SEGMENTET ER ENDRET,      */00018940
 /*    SKAL DET DANNES ET REGTPKT-SEGMENT.                            */00018950
 /*-------------------------------------------------------------------*/00018960
 /* REGNER UT EGEN TRYGDETID I ANTALL MÅNEDER                         */00018970
 /* FRA 1991 TAS ET NYTT TT-FELT I BRUK.   BØ9012                     */00018980
 /*-------------------------------------------------------------------*/00018990
                                                                        00019000
       IF B01.PERSON(I).STATUS.TT_16_66  > 0   THEN                     00019010
          B01_TT_EGEN =                                                 00019020
                      B01.PERSON(I).STATUS.TT_16_66         +           00019030
                      B01.PERSON(I).STATUS.TT_FRAMT         +           00019040
                      B01.PERSON(I).STATUS.TT_67_TIL_70 * 12;           00019050
       ELSE                                                             00019060
          B01_TT_EGEN =                                                 00019070
                      B01.PERSON(I).STATUS.TT_ETTER_1966    +           00019080
                      B01.PERSON(I).STATUS.TT_FRAMT         +           00019090
                     (B01.PERSON(I).STATUS.TT_FØR_1967  +               00019100
                      B01.PERSON(I).STATUS.TT_67_TIL_70) * 12;          00019110
                                                                        00019120
                                                                        00019130
       IF B02.PERSON(I).STATUS.TT_16_66  > 0   THEN                     00019140
          B02_TT_EGEN =                                                 00019150
                      B02.PERSON(I).STATUS.TT_16_66         +           00019160
                      B02.PERSON(I).STATUS.TT_FRAMT         +           00019170
                      B02.PERSON(I).STATUS.TT_67_TIL_70 * 12;           00019180
       ELSE                                                             00019190
          B02_TT_EGEN =                                                 00019200
                      B02.PERSON(I).STATUS.TT_ETTER_1966    +           00019210
                      B02.PERSON(I).STATUS.TT_FRAMT         +           00019220
                     (B02.PERSON(I).STATUS.TT_FØR_1967  +               00019230
                      B02.PERSON(I).STATUS.TT_67_TIL_70) * 12;          00019240
                                                                        00019250
 /*BØ9201: */                                                           00019260
       ENDRET = ENDRET !                                                00019270
                (B01_TT_EGEN ^= B02_TT_EGEN ) !                         00019280
                (B01.PERSON(I).RF0PERSN.TKNR ^=                         00019290
                 B02.PERSON(I).RF0PERSN.TKNR) !                         00019300
                (B01.PERSON(I).SPESOPPL.STATSBORGER ^=                  00019310
                 B02.PERSON(I).SPESOPPL.STATSBORGER) !                  00019320
                (B01.PERSON(I).SPESOPPL.BOSATT      ^=                  00019330
                 B02.PERSON(I).SPESOPPL.BOSATT)      !                  00019340
                                                                        00019350
              /* KOMNR OPPDATERES FRA SSB I BATCH       */              00019360
                                                                        00019370
                (TRANS_OPPL_OMR.BLANKETTYPE = 'UP') !                   00019380
                (TRANS_OPPL_OMR.BLANKETTYPE = 'U2') !                   00019390
                (B01.PERSON(I).STATUS.TT_ANV ^=                         00019400
                 B02.PERSON(I).STATUS.TT_ANV) !                         00019410
                (B01_PÅ      ^= B02_PÅ)      !                          00019420
                (B01_SPT     ^= B02_SPT)     !                          00019430
                (B01_OPT     ^= B02_OPT)     !                          00019440
                (B01_YPT     ^= B02_YPT)     !                          00019450
                (B01.PERSON(I).ALDERSP.VENTEFAKTOR ^=                   00019460
                 B02.PERSON(I).ALDERSP.VENTEFAKTOR) !                   00019470
                (B01.PERSON(I).STATUS.DØDSDATO_ÅMD ^=                   00019480
                 B02.PERSON(I).STATUS.DØDSDATO_ÅMD) !                   00019490
                (B01.PERSON(I).STATUS.DØD_AV_YRKESSKADE ^=              00019500
                 B02.PERSON(I).STATUS.DØD_AV_YRKESSKADE) !              00019510
                (B01_PÅ_E91  ^= B02_PÅ_E91)  !                          00019520
                (B01_SPT_GML ^= B02_SPT_GML) ;                          00019530
                                                                        00019540
       IF ENDRET THEN                                                   00019550
       DO;                                                              00019560
          SEGMENT_TABELL.REGTPKT = TRUE;                                00019570
                                                                        00019580
          SELECT (TRANS_OPPL_OMR.TRANSTYPE);                            00019590
             WHEN (24,25,69,33,41,26,28,42,29,58,31,27)                 00019600
                REGTPKT.VIRKDATO =                                      00019610
                   SUBSTR(TRANS_OPPL_OMR.VIRKNINGSDATO,3,2) !!          00019620
                   SUBSTR(TRANS_OPPL_OMR.VIRKNINGSDATO,1,2);            00019630
             OTHERWISE                                                  00019640
                DO;                                                     00019650
                   IF B02.PERSON(I).STATUS.VIRK_DATO_ÅM > 0 THEN        00019660
                      HELP_DATO = B02.PERSON(I).STATUS.VIRK_DATO_ÅM;    00019670
                   ELSE                                                 00019680
                      HELP_DATO = B01.PERSON(I).STATUS.VIRK_DATO_ÅM;    00019690
                   REGTPKT.VIRKDATO = HELP_DATO;                        00019700
                END;                                                    00019710
          END; /* OF SELECT */                                          00019720
                                                                        00019730
       /*-------------------------------------------------------------*/00019740
       /* HVIS TRYGDEKONTOR-NUMMER = 0,                               */00019750
       /* HENTES DETTE FRA ET AV DE ANDRE FAMILIE-MEDLEMMENE.         */00019760
       /*-------------------------------------------------------------*/00019770
                                                                        00019780
          IF B02.PERSON(I).RF0PERSN.TKNR > 0 THEN                       00019790
             REGTPKT.TKNR = B02.PERSON(I).RF0PERSN.TKNR;                00019800
          ELSE                                                          00019810
          DO;                                                           00019820
             DO J=1 TO 14 UNTIL (B02.PERSON(J).RF0PERSN.TKNR > 0);      00019830
             END;                                                       00019840
             IF J <= 14 THEN                                            00019850
                REGTPKT.TKNR = B02.PERSON(J).RF0PERSN.TKNR;             00019860
          END;                                                          00019870
                                                                        00019880
          REGTPKT.STATSBORGER =                                         00019890
             B02.PERSON(I).SPESOPPL.STATSBORGER;                        00019900
                                                                        00019910
          IF (B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'F' !                00019920
              B02.PERSON(I).STATUS.PENSJONSTYPE1 = 'G') &               00019930
              B02.PERSON(I).STATUS.SIVILSTAND    = 'G'  &               00019940
              B02.PERSON(3-I).SPESOPPL.BOSATT   ^=  0   THEN            00019950
             REGTPKT.BOSATT_LAND = B02.PERSON(3-I).SPESOPPL.BOSATT;     00019960
          ELSE                                                          00019970
             REGTPKT.BOSATT_LAND = B02.PERSON(I).SPESOPPL.BOSATT;       00019980
                                                                        00019990
        /* KOMNR OPPDATERES EGENTLIG FRA SSB, MEN SETTES HER LIK      */00020000
        /* TKNR I TILFELLET SSB IKKE HAR NOEN VERDI PÅ KOMNR.         */00020010
                                                                        00020020
          IF REGTPKT.BOSATT_LAND = 0 THEN                               00020030
             DO;                                                        00020040
 /*BØ9203:*/    IF (REGTPKT.TKNR < 0300  !  REGTPKT.TKNR > 0399)  THEN  00020050
                   REGTPKT.KOMNR = REGTPKT.TKNR;                        00020060
                ELSE                                                    00020070
                   REGTPKT.KOMNR = 0301;                                00020080
             END;                                                       00020090
                                                                        00020100
        /* DIAG.GS OG DIAG.HSU FINNES PÅ US-TRANS        */             00020110
                                                                        00020120
          IF TRANS_OPPL_OMR.BLANKETTYPE = 'UP' THEN                     00020130
             CALL UP_OPPDAT;                   /* R0016032 */           00020140
                                                                        00020150
          IF TRANS_OPPL_OMR.BLANKETTYPE = 'U2' THEN                     00020160
             CALL U2_OPPDAT;                   /* R0016033 */           00020170
                                                                        00020180
 /*SOB9704:*/                                                           00020190
          IF TRANS_OPPL_OMR.BLANKETTYPE = 'U3' THEN                     00020200
             CALL U3_OPPDAT;                   /* R0016039 */           00020210
                                                                        00020220
          REGTPKT.TT_EGEN            = B02_TT_EGEN;                     00020230
          REGTPKT.TT_ANV             =                                  00020240
                                B02.PERSON(I).STATUS.TT_ANV * 12;       00020250
          REGTPKT.POENGTILL          =                                  00020260
                                B02.PERSON(I).STATUS.POENGTILLEGG_KODE; 00020270
          REGTPKT.PÅ                 = B02_PÅ;                          00020280
          REGTPKT.SPT                = B02_SPT;                         00020290
          REGTPKT.OPT                = B02_OPT;                         00020300
          REGTPKT.YPT                = B02_YPT;                         00020310
 /*BØ9201:*/                                                            00020320
          REGTPKT.PÅ_ETTER91         = B02_PÅ_E91 ;                     00020330
          REGTPKT.SPT_GML            = B02_SPT_GML ;                    00020340
                                                                        00020350
          REGTPKT.VENTEFAKTOR =                                         00020360
             B02.PERSON(I).ALDERSP.VENTEFAKTOR;                         00020370
                                                                        00020380
          REGTPKT.DØD_AV_YRKESSKADE =                                   00020390
             B02.PERSON(I).STATUS.DØD_AV_YRKESSKADE;                    00020400
                                                                        00020410
          REGTPKT.UTDANNING =                                           00020420
             B02.PERSON(I).UFØRPENS.UTDANNING;                          00020430
                                                                        00020440
          REGTPKT.YRKESM_ATTF =                                         00020450
             B02.PERSON(I).UFØRPENS.YRKESM_ATTF;                        00020460
                                                                        00020470
 /*BØ9012:*/                                                            00020480
                                                                        00020490
          IF K > 0  THEN                                                00020500
            IF (B02.PERSON(I).UFØRHIST(K).BUP_GARANTI >=                00020510
                              B02.PERSON(I).UFØRHIST(K).BUP)  &         00020520
              (B02.PERSON(I).UFØRHIST(K).BUP_GAR_KODE = 'B' !           00020530
               B02.PERSON(I).UFØRHIST(K).BUP_GAR_KODE = 'D' !           00020540
               B02.PERSON(I).UFØRHIST(K).BUP_GAR_KODE = 'E' ) THEN      00020550
              REGTPKT.BUP_GARANTI = 'J';                                00020560
                                                                        00020570
                                                                        00020580
       /* DØDSDATO KONVERTERES TIL ÅR-MND */                            00020590
                                                                        00020600
          IF B02.PERSON(I).STATUS.DØDSDATO_ÅMD > 0 THEN                 00020610
          DO;                                                           00020620
             DATO = B02.PERSON(I).STATUS.DØDSDATO_ÅMD;                  00020630
             REGTPKT.DØDSDATO     = DATO_ÅM;                            00020640
             REGTPKT.REGDATO_DØD  = SUBSTR (DATE,1,4);                  00020650
                                                                        00020660
             W_VIRKD_T = SUBSTR (TRANS_OPPL_OMR.VIRKNINGSDATO, 3, 2) !! 00020670
                         SUBSTR (TRANS_OPPL_OMR.VIRKNINGSDATO, 1, 2) ;  00020680
                                                                        00020690
  /*BØ9011   IF W_VIRKD_T = B02.PERSON(I).STATUS.VIRK_DATO_ÅM  THEN     00020700
               DO;                                                      00020710
    BØ9011*/                                                            00020720
                 W_TRANSKODE          = TRANS_OPPL_OMR.TRANSKODE;       00020730
                 W_FNR                = TRANS_OPPL_OMR.FØDSNUMMER;      00020740
                 W_VIRKD              = TRANS_OPPL_OMR.VIRKNINGSDATO;   00020750
                                                                        00020760
                 TRANS_OPPL_OMR.TRANSKODE     = 'DØD';                  00020770
                 TRANS_OPPL_OMR.FØDSNUMMER    = B02.PERSON(I).FNR;      00020780
                 TRANS_OPPL_OMR.VIRKNINGSDATO = W_VIRKD_T;              00020790
                                                                        00020800
                 EXEC CICS LINK PROGRAM                                 00020810
                                     ('R0016601') COMMAREA(KOM_OMR);    00020820
                 TRANS_OPPL_OMR.FØDSNUMMER    = W_FNR;                  00020830
                 TRANS_OPPL_OMR.VIRKNINGSDATO = W_VIRKD;                00020840
                 TRANS_OPPL_OMR.TRANSKODE     = W_TRANSKODE;            00020850
  /*BØ9011     END */                                                   00020860
          END;                                                          00020870
                                                                        00020880
 /*-------------------------------------------------------------------*/00020890
 /*       HVIS DET TIL NÅ ER DANNET ET SEGMENT PÅ DETTE FNR,          */00020900
 /*       SKAL DET OGSÅ DANNES ET ROT-SEGMENT.                        */00020910
 /*-------------------------------------------------------------------*/00020920
 /*  ***  DANNING AV DIVERSE ENDRINGSKODER I PENSJON, ET OG BT.       */00020930
 /*  ***  KODENE AVVIKLES OG FJERNES FRA BASENE FRA 1.5.91. BJØRG     */00020940
 /*-------------------------------------------------------------------*/00020950
 /*       SKRIV UT ALLE SEGMENTENE PÅ DETTE FNR TIL TRANS-STAT-BASEN. */00020960
 /*-------------------------------------------------------------------*/00020970
          TR0ROT.FNR = B02.PERSON(I).RF0PERSN.FNR;                      00020980
                                                                        00020990
          IF TR0ROT.FNR > 0 THEN CALL SKRIV_STAT_SEGM;  /* R0016024 */  00021000
       END;                                                             00021010
                                                                        00021020
    /*-------------------------------------------*/                     00021030
    /* EVENTUELL UNSAVE AV B01/B02               */                     00021040
    /*-------------------------------------------*/                     00021050
                                                                        00021060
       IF SAVE_B01_B02 = 2 THEN                                         00021070
       DO;                                                              00021080
          B01.PERSON(I) = X01.PERSON(I);                                00021090
          B02.PERSON(I) = X02.PERSON(I);                                00021100
          FREE X01;                                                     00021110
          FREE X02;                                                     00021120
       END;                                                             00021130
       IF SAVE_B01_B02 = 1 THEN                                         00021140
       DO;                                                              00021150
          B01.PERSON(I) = X01.PERSON(I);                                00021160
          FREE X01;                                                     00021170
       END;                                                             00021180
                                                                        00021190
    END; /* OF FNR > 0 */                                               00021200
                                                                        00021210
 END; /* OF DO I=1,2    ( MOR OG FAR ) */                               00021220
                                                                        00021230
 END; /* OPPDAT_MOR_FAR */                                              00021240
