 /*       SIST ENDRET 21/02-86 10.24.43 AV   FARVIK                   */00000000
 /*       SIST ENDRET 03/01-86 07.50.25 AV   FARVIK                   */00000010
 /*       SIST ENDRET 21/09-84 10.53.26 AV   FARVIK                   */00000020
 /*       SIST ENDRET 14/09-84 15.18.18 AV   FARVIK                   */00000030
 /*       SIST ENDRET 14/08-84 08.36.20 AV   FARVIK                   */00000040
 /*       SIST ENDRET 01/06-84 11.03.44 AV   FARVIK                   */00000050
 %SKIP;                                /*  */                           00000060
 /* ***************************************************************** */00000070
 /*                                                                   */00000080
 /* ***************************************************************** */00000090
 /*IDENTIFIKASJON:                                                    */00000100
 /* **********************                                            */00000110
 /*  PROGRAM-IDENT : R0010506   AP_TRANS_TIL_MAP   SUBPROGRAM         */00000120
 /*  PROGRAM-SPRÅK : PLI                                              */00000130
 /*  PROGRAMMERER  : INGER SLOTTE                                     */00000140
 /*  PROGRAMMET BLE LAGET : MARS 1981                                 */00000150
 /*  ENDRINGSDATO  :                                                  */00000160
 /*  ENDRINGEN GJELDER:                                               */00000170
 /*  ENDRINGEN BLE UTFØRT AV :                                        */00000180
 /*                                                                   */00000190
 /* ***************************************************************** */00000200
 /*HENSIKT:                                                           */00000210
 /* **********                                                        */00000220
 /*  BRUKES VED REGISTRERING AV GRUNNBLANKETT AP.                     */00000230
 /*  OVERFØRER DATA FRA AP_TRANS_OMR TIL SKJERMBILDET.                */00000240
 /*  BRUKER MAP S001051 MAPSET S001053.                               */00000250
 /*                                                                   */00000260
 /* ***************************************************************** */00000270
 /*PROGRAMTILKNYTTING:                                                */00000280
 /* ********************                                              */00000290
 /*  PROGRAMMET INCLUDES AV R0010501 - KONTROLL_GRUNNBLANKETT_AP.     */00000300
 /*  ALLE CICS-KOMMANDOS LIGGER I HOVEDPROG.                          */00000310
 /*  ARBEIDSOMRÅDET P0010501, OG MAPEN ER INCLUDET I HOVEDPROG.       */00000320
 /*  PROGRAMMET HAR CALL TIL :                                        */00000330
 /*    R0019944 - SKRIV_FEIL          INCLUDE I HOVEDPROG             */00000340
 /*    R0010507 - BLOKKERE_SPES                 " "                   */00000350
 /*    R0010507 - BLOKKERE_BARN                 " "                   */00000360
 /*                                                                   */00000370
 /*  PROGRAMMET BRUKER FUNKSJONEN :                                   */00000380
 /*    R0019912 - F_FELT_PIC_CHARNN   INCLUDE I HOVEDPROG             */00000390
 /*                                                                   */00000400
 /*  INTERNE PROSEDYRER :                                             */00000410
 /*    OVERFØR_APSØKER_MAP:    OVERFØRING AV APDELEN                  */00000420
 /*    OVERFØR_APSPES_MAP:     OVERFØRING AV SPESIELL DEL             */00000430
 /*    OVERFØR_BARN_MAP:       OVERFØRING BARNEDELEN                  */00000440
 /*                                                                   */00000450
 /* ***************************************************************** */00000460
 /*DATASETTOPPLYSNINGER:                                              */00000470
 /* ***********************                                           */00000480
 /*    INGEN                                                          */00000490
 /* ***************************************************************** */00000500
 /*FEILMELDINGER:                                                     */00000510
 /* *******************                                               */00000520
 /*    LEGGES UT PÅ SKJERMBILDET (MAP S001051) VED CALL               */00000530
 /*    TIL R0019944 - SKRIV_FEIL                                      */00000540
 /*                                                                   */00000550
 /* ***************************************************************** */00000560
 /*                                                                   */00000570
 %PAGE;                                /*   */                          00000580
 /* ***************************************************************** */00000590
 /*                                                                   */00000600
 /*   PROSEDYRA OVERFØRER DATA FRA AP_TRANS_OMR.APS TIL               */00000610
 /*   SKJERMBILDE AP_SØKER DELEN.                                     */00000620
 /*   MAP: S001051                                                    */00000630
 /*   MAPSET: S001053                                                 */00000640
 /*                                                                   */00000650
 /* ***************************************************************** */00000660
 %SKIP(2);                                                              00000670
 OVERFØR_APSØKER_MAP:                                                   00000680
   PROC;                                                                00000690
   DCL                                                                  00000700
      NORMAL  CHAR (1) INIT(' '),                                       00000710
      NOR_NUM CHAR (1) INIT('&'),                                       00000720
      BRI_NUM CHAR (1) INIT('Q');                                       00000730
                                                                        00000740
      S001051O.REGDATOO      = F_FELT_PIC_CHAR6 (APS.REGDATO);          00000750
      S001051O.TERMIDO       = APS.TERMID;                              00000760
      S001051O.FNRO          = F_FELT_PIC_CHAR11 (APS.FNR);             00000770
      S001051O.NAVNO         = APS.NAVN;                                00000780
      S001051O.TKNRO         = F_FELT_PIC_CHAR4 (APS.TKNR);             00000790
      S001051O.TILL_EKO      = APS.TILL_EK;                             00000800
      S001051O.SIVILSTANDO   = APS.SIVILSTAND;                          00000810
      S001051O.SPRÅKO        = APS.SPRÅK;                               00000820
      IF F_FELT_PIC_CHAR2(APS.BT_ANT) ^= (2)'0' THEN                    00000830
         S001051O.BT_ANTO    = F_FELT_PIC_CHAR2 (APS.BT_ANT);           00000840
      S001051O.NORSK_BOSATTO = APS.NORSK_BOSATT;                        00000850
      S001051O.FAIO          = F_FELT_PIC_CHAR7 (APS.FAI);              00000860
      S001051O.APDO          = F_FELT_PIC_CHAR3 (APS.APD);              00000870
      S001051O.VIRK_DATO_MÅO = APS.VIRK_DATO_MÅ;                        00000880
      IF F_FELT_PIC_CHAR11 (APS.FNR_EK) ^= '00000000000' THEN           00000890
         S001051O.FNR_EKO    = F_FELT_PIC_CHAR11 (APS.FNR_EK);          00000900
      S001051O.NAVN_EKO      = APS.NAVN_EK;                             00000910
      S001051O.MINST4GO      = APS.EK_INNT;                             00000920
                                                                        00000930
 /* FEILMELDINGER MARKERING AV  FELT (ATTRIBUTTENE) */                  00000940
 %SKIP(2);                                                              00000950
      S001051O.DUMMYA = '_';                                            00000960
                                                                        00000970
  /*DERSOM FEIL FRA BEHANDLE-TRANS OVERFØRES FEIL HER,BARE FØRSTE GANG*/00000980
       IF ^ FRA_CICS THEN                                               00000990
          DO;                                                           00001000
            IF FEIL_MELD_NR > 0 THEN                                    00001010
               CALL SKRIV_FEIL(FEIL_MELD_NR);                           00001020
             FEIL_MELD_NR = 0;                                          00001030
          END;                                                          00001040
                                                                        00001050
         S001051O.REGDATOA = DFHBMASK;                                  00001060
         S001051O.TERMIDA  = DFHBMASK;                                  00001070
                                                                        00001080
      IF APS.FNRNR = 0 THEN                                             00001090
         S001051O.FNRA = NOR_NUM;                                       00001100
      ELSE                                                              00001110
         DO;                                                            00001120
            S001051O.FNRA = BRI_NUM;                                    00001130
            S001051I.FNRL = CURSOR_POS;                                 00001140
            IF APS.FNRNR ^= 999 THEN                                    00001150
               CALL SKRIV_FEIL(APS.FNRNR);                              00001160
         END;                                                           00001170
      IF APS.TKNRNR = 0 THEN                                            00001180
         S001051O.TKNRA      = NOR_NUM;                                 00001190
      ELSE                                                              00001200
         DO;                                                            00001210
            S001051O.TKNRA          = BRI_NUM;                          00001220
            S001051I.TKNRL          = CURSOR_POS;                       00001230
            IF APS.TKNRNR ^= 999 THEN                                   00001240
               CALL SKRIV_FEIL(APS.TKNRNR);                             00001250
         END;                                                           00001260
      IF APS.NAVNNR = 0 THEN                                            00001270
         S001051O.NAVNA      = NORMAL;                                  00001280
      ELSE                                                              00001290
         DO;                                                            00001300
            S001051O.NAVNA          = DFHBMBRY;                         00001310
            S001051I.NAVNL          = CURSOR_POS;                       00001320
            IF APS.NAVNNR ^= 999 THEN                                   00001330
               CALL SKRIV_FEIL(APS.NAVNNR);                             00001340
         END;                                                           00001350
      IF APS.SPRÅKNR = 0 THEN                                           00001360
         S001051O.SPRÅKA      = NORMAL;                                 00001370
      ELSE                                                              00001380
         DO;                                                            00001390
            S001051O.SPRÅKA          = DFHBMBRY;                        00001400
            S001051I.SPRÅKL          = CURSOR_POS;                      00001410
            IF APS.SPRÅKNR ^= 999 THEN                                  00001420
               CALL SKRIV_FEIL(APS.SPRÅKNR);                            00001430
         END;                                                           00001440
      IF APS.SIVILSTANDNR = 0 THEN                                      00001450
         S001051O.SIVILSTANDA      = NORMAL;                            00001460
      ELSE                                                              00001470
         DO;                                                            00001480
            S001051O.SIVILSTANDA          = DFHBMBRY;                   00001490
            S001051I.SIVILSTANDL          = CURSOR_POS;                 00001500
            IF APS.SIVILSTANDNR ^= 999 THEN                             00001510
               CALL SKRIV_FEIL(APS.SIVILSTANDNR);                       00001520
         END;                                                           00001530
      IF APS.TILL_EKNR = 0 THEN                                         00001540
         S001051O.TILL_EKA      = NORMAL;                               00001550
      ELSE                                                              00001560
         DO;                                                            00001570
            S001051O.TILL_EKA          = DFHBMBRY;                      00001580
            S001051I.TILL_EKL          = CURSOR_POS;                    00001590
            IF APS.TILL_EKNR ^= 999 THEN                                00001600
               CALL SKRIV_FEIL(APS.TILL_EKNR);                          00001610
         END;                                                           00001620
      IF APS.NORSK_BOSATTNR = 0 THEN                                    00001630
         S001051O.NORSK_BOSATTA      = NORMAL;                          00001640
      ELSE                                                              00001650
         DO;                                                            00001660
            S001051O.NORSK_BOSATTA          = DFHBMBRY;                 00001670
            S001051I.NORSK_BOSATTL          = CURSOR_POS;               00001680
            IF APS.NORSK_BOSATTNR ^= 999 THEN                           00001690
               CALL SKRIV_FEIL(APS.NORSK_BOSATTNR);                     00001700
         END;                                                           00001710
      IF APS.BT_ANTNR = 0 THEN                                          00001720
         S001051O.BT_ANTA    = NOR_NUM;                                 00001730
      ELSE                                                              00001740
         DO;                                                            00001750
            S001051O.BT_ANTA          = BRI_NUM;                        00001760
            S001051I.BT_ANTL          = CURSOR_POS;                     00001770
            IF APS.BT_ANTNR ^= 999 THEN                                 00001780
               CALL SKRIV_FEIL(APS.BT_ANTNR);                           00001790
         END;                                                           00001800
      IF APS.FAINR = 0 THEN                                             00001810
         S001051O.FAIA      = NOR_NUM;                                  00001820
      ELSE                                                              00001830
         DO;                                                            00001840
            S001051O.FAIA          = BRI_NUM;                           00001850
            S001051I.FAIL          = CURSOR_POS;                        00001860
            IF APS.FAINR ^= 999 THEN                                    00001870
               CALL SKRIV_FEIL(APS.FAINR);                              00001880
         END;                                                           00001890
      IF APS.APDNR = 0 THEN                                             00001900
         S001051O.APDA      = NOR_NUM;                                  00001910
      ELSE                                                              00001920
         DO;                                                            00001930
            S001051O.APDA          = BRI_NUM;                           00001940
            S001051I.APDL          = CURSOR_POS;                        00001950
            IF APS.APDNR ^= 999 THEN                                    00001960
               CALL SKRIV_FEIL(APS.APDNR);                              00001970
         END;                                                           00001980
      IF APS.VIRK_DATO_MÅNR = 0 THEN                                    00001990
         S001051O.VIRK_DATO_MÅA      = NOR_NUM;                         00002000
      ELSE                                                              00002010
         DO;                                                            00002020
            S001051O.VIRK_DATO_MÅA          = BRI_NUM;                  00002030
            S001051I.VIRK_DATO_MÅL          = CURSOR_POS;               00002040
            IF APS.VIRK_DATO_MÅNR ^= 999 THEN                           00002050
               CALL SKRIV_FEIL(APS.VIRK_DATO_MÅNR);                     00002060
         END;                                                           00002070
      IF APS.FNR_EKNR = 0 THEN                                          00002080
         S001051O.FNR_EKA      = NOR_NUM;                               00002090
      ELSE                                                              00002100
         DO;                                                            00002110
            S001051O.FNR_EKA          = BRI_NUM;                        00002120
            S001051I.FNR_EKL          = CURSOR_POS;                     00002130
            IF APS.FNR_EKNR ^= 999 THEN                                 00002140
               CALL SKRIV_FEIL(APS.FNR_EKNR);                           00002150
         END;                                                           00002160
      IF APS.NAVN_EKNR = 0 THEN                                         00002170
         S001051O.NAVN_EKA      = NORMAL;                               00002180
      ELSE                                                              00002190
         DO;                                                            00002200
            S001051O.NAVN_EKA          = DFHBMBRY;                      00002210
            S001051I.NAVN_EKL          = CURSOR_POS;                    00002220
            IF APS.NAVN_EKNR ^= 999 THEN                                00002230
               CALL SKRIV_FEIL(APS.NAVN_EKNR);                          00002240
         END;                                                           00002250
      IF APS.EK_INNTNR = 0 THEN                                         00002260
         S001051O.MINST4GA      = NORMAL;                               00002270
      ELSE                                                              00002280
         DO;                                                            00002290
            S001051O.MINST4GA          = DFHBMBRY;                      00002300
            S001051I.MINST4GL          = CURSOR_POS;                    00002310
            IF APS.EK_INNTNR ^= 999 THEN                                00002320
               CALL SKRIV_FEIL(APS.EK_INNTNR);                          00002330
         END;                                                           00002340
                                                                        00002350
      /* VED GAMLE TRANS SKAL FNR OG VIRKDATO BLOKKERES  */             00002360
                                                                        00002370
     IF TRANS_OPPL_OMR.NY_GML_TRANS_IND = 'G' & FRA_MED_DIALOG THEN     00002380
        DO;                                                             00002390
          S001051O.FNRA          = DFHBMASK;       /* PROT AND ASKIP */ 00002400
          S001051O.VIRK_DATO_MÅA = DFHBMASK;                            00002410
        END;                                                            00002420
                                                                        00002430
     ELSE IF FRA_UTEN_DIALOG THEN    /* BLOKKER ALT SAMMEN    */        00002440
                                                                        00002450
        DO;                                                             00002460
          S001051O.REGDATOA      = DFHBMASK;                            00002470
          S001051O.TERMIDA       = DFHBMASK;                            00002480
          S001051O.FNRA          = DFHBMASK;                            00002490
          S001051O.NAVNA         = DFHBMASK;                            00002500
          S001051O.TKNRA         = DFHBMASK;                            00002510
          S001051O.TILL_EKA      = DFHBMASK;                            00002520
          S001051O.SIVILSTANDA   = DFHBMASK;                            00002530
          S001051O.SPRÅKA        = DFHBMASK;                            00002540
          S001051O.BT_ANTA       = DFHBMASK;                            00002550
          S001051O.NORSK_BOSATTA = DFHBMASK;                            00002560
          S001051O.FAIA          = DFHBMASK;                            00002570
          S001051O.APDA          = DFHBMASK;                            00002580
          S001051O.VIRK_DATO_MÅA = DFHBMASK;                            00002590
          S001051O.FNR_EKA       = DFHBMASK;                            00002600
          S001051O.NAVN_EKA      = DFHBMASK;                            00002610
          S001051O.MINST4GA      = DFHBMASK;                            00002620
          MELDING6O = 'TRYKK PF1 FOR OPPBEVAR, PF2 FOR FORKASTE.';      00002630
        END;                                                            00002640
                                                                        00002650
     IF ^ FRA_CICS THEN                                                 00002660
        DO;                                                             00002670
          S001051O.STYRE_KODEA    = DFHBMASK;                           00002680
          S001051O.FUNKSJONSKODEA = DFHBMASK;                           00002690
        END;                                                            00002700
                                                                        00002710
   END OVERFØR_APSØKER_MAP;                                             00002720
 %PAGE;                                /*    */                         00002730
 /* ***************************************************************** */00002740
 /*                                                                   */00002750
 /*   PROSEDYRA OVERFØRER DATA FRA AP_TRANS_OMR.APS TIL               */00002760
 /*   SKJERMBILDE AP_SPES. DELEN.                                     */00002770
 /*   MAP: S001051                                                    */00002780
 /*   MAPSET: S001053                                                 */00002790
 /*                                                                   */00002800
 /* ***************************************************************** */00002810
 %SKIP(2);                                                              00002820
 OVERFØR_APSPES_MAP:                                                    00002830
   PROC;                                                                00002840
   DCL                                                                  00002850
      NORMAL  CHAR (1) INIT(' '),                                       00002860
      NOR_NUM CHAR (1) INIT('&'),                                       00002870
      BRI_NUM CHAR (1) INIT('Q');                                       00002880
                                                                        00002890
 %SKIP;                                                                 00002900
      IF F_FELT_PIC_CHAR3(APSP.STATSBORGER) ^= '000' THEN               00002910
         S001051O.STATSBORGERO    = F_FELT_PIC_CHAR3(APSP.STATSBORGER); 00002920
      IF F_FELT_PIC_CHAR3(APSP.BOSATT)      ^= '000' THEN               00002930
         S001051O.BOSATTO            = F_FELT_PIC_CHAR3(APSP.BOSATT);   00002940
      S001051O.FRAVIK_19_3O          = APSP.FRAVIK_19_3;                00002950
      S001051O.FRAVIK_FLYKTO         = APSP.FRAVIK_FLYKT;               00002960
      S001051O.OVERKOMP_UTLO         = APSP.OVERKOMP_UTL;               00002970
      IF F_FELT_PIC_CHAR2(APSP.TT_F67)      ^= '00' THEN                00002980
         S001051O.TT_F67O            = F_FELT_PIC_CHAR2(APSP.TT_F67);   00002990
      IF F_FELT_PIC_CHAR2(APSP.TT_E66_Å)    ^= '00' THEN                00003000
         S001051O.TT_E66_ÅO          = F_FELT_PIC_CHAR2(APSP.TT_E66_Å); 00003010
      IF F_FELT_PIC_CHAR2(APSP.TT_E66_M)    ^= '00' THEN                00003020
         S001051O.TT_E66_MO          = F_FELT_PIC_CHAR2(APSP.TT_E66_M); 00003030
      IF F_FELT_PIC_CHAR2(APSP.TT_F67_EK)   ^= '00' THEN                00003040
         S001051O.TT_F67_EKO         = F_FELT_PIC_CHAR2(APSP.TT_F67_EK);00003050
      IF F_FELT_PIC_CHAR2(APSP.TT_E66_Å_EK) ^= '00' THEN                00003060
         S001051O.TT_E66_Å_EKO     = F_FELT_PIC_CHAR2(APSP.TT_E66_Å_EK);00003070
      IF F_FELT_PIC_CHAR2(APSP.TT_E66_M_EK) ^= '00' THEN                00003080
         S001051O.TT_E66_M_EKO     = F_FELT_PIC_CHAR2(APSP.TT_E66_M_EK);00003090
      IF F_FELT_PIC_CHAR2(APSP.TT_VENT_UTL) ^= '00' THEN                00003100
         S001051O.TT_VENT_UTLO     = F_FELT_PIC_CHAR2(APSP.TT_VENT_UTL);00003110
      S001051O.IKKE_GPO              = APSP.IKKE_GP;                    00003120
 %SKIP(3);                             /*  */                           00003130
 /*  MARKERING AV ATTRIBUTTER   */                                      00003140
 %SKIP;                                                                 00003150
      IF APSP.STATSBORGERNR = 0 THEN                                    00003160
         S001051O.STATSBORGERA       = NOR_NUM;                         00003170
      ELSE                                                              00003180
         DO;                                                            00003190
            S001051O.STATSBORGERA           = BRI_NUM;                  00003200
            S001051I.STATSBORGERL           = CURSOR_POS;               00003210
            IF APSP.STATSBORGERNR ^= 999 THEN                           00003220
               CALL SKRIV_FEIL(APSP.STATSBORGERNR);                     00003230
         END;                                                           00003240
      IF APSP.BOSATTNR = 0 THEN                                         00003250
         S001051O.BOSATTA       = NOR_NUM;                              00003260
      ELSE                                                              00003270
         DO;                                                            00003280
            S001051O.BOSATTA           = BRI_NUM;                       00003290
            S001051I.BOSATTL           = CURSOR_POS;                    00003300
            IF APSP.BOSATTNR ^= 999 THEN                                00003310
               CALL SKRIV_FEIL(APSP.BOSATTNR);                          00003320
         END;                                                           00003330
      IF APSP.FRAVIK_19_3NR = 0 THEN                                    00003340
         S001051O.FRAVIK_19_3A       = NORMAL;                          00003350
      ELSE                                                              00003360
         DO;                                                            00003370
            S001051O.FRAVIK_19_3A           = DFHBMBRY;                 00003380
            S001051I.FRAVIK_19_3L           = CURSOR_POS;               00003390
            IF APSP.FRAVIK_19_3NR ^= 999 THEN                           00003400
               CALL SKRIV_FEIL(APSP.FRAVIK_19_3NR);                     00003410
         END;                                                           00003420
      IF APSP.FRAVIK_FLYKTNR = 0 THEN                                   00003430
         S001051O.FRAVIK_FLYKTA       = NORMAL;                         00003440
      ELSE                                                              00003450
         DO;                                                            00003460
            S001051O.FRAVIK_FLYKTA           = DFHBMBRY;                00003470
            S001051I.FRAVIK_FLYKTL           = CURSOR_POS;              00003480
            IF APSP.FRAVIK_FLYKTNR ^= 999 THEN                          00003490
               CALL SKRIV_FEIL(APSP.FRAVIK_FLYKTNR);                    00003500
         END;                                                           00003510
      IF APSP.OVERKOMP_UTLNR = 0 THEN                                   00003520
         S001051O.OVERKOMP_UTLA       = NORMAL;                         00003530
      ELSE                                                              00003540
         DO;                                                            00003550
            S001051O.OVERKOMP_UTLA           = DFHBMBRY;                00003560
            S001051I.OVERKOMP_UTLL           = CURSOR_POS;              00003570
            IF APSP.OVERKOMP_UTLNR ^= 999 THEN                          00003580
               CALL SKRIV_FEIL(APSP.OVERKOMP_UTLNR);                    00003590
         END;                                                           00003600
      IF APSP.TT_F67NR = 0 THEN                                         00003610
         S001051O.TT_F67A       = NOR_NUM;                              00003620
      ELSE                                                              00003630
         DO;                                                            00003640
            S001051O.TT_F67A           = BRI_NUM;                       00003650
            S001051I.TT_F67L           = CURSOR_POS;                    00003660
            IF APSP.TT_F67NR ^= 999 THEN                                00003670
               CALL SKRIV_FEIL(APSP.TT_F67NR);                          00003680
         END;                                                           00003690
      IF APSP.TT_E66_ÅNR = 0 THEN                                       00003700
         S001051O.TT_E66_ÅA       = NOR_NUM;                            00003710
      ELSE                                                              00003720
         DO;                                                            00003730
            S001051O.TT_E66_ÅA           = BRI_NUM;                     00003740
            S001051I.TT_E66_ÅL           = CURSOR_POS;                  00003750
            IF APSP.TT_E66_ÅNR ^= 999 THEN                              00003760
               CALL SKRIV_FEIL(APSP.TT_E66_ÅNR);                        00003770
         END;                                                           00003780
      IF APSP.TT_E66_MNR = 0 THEN                                       00003790
         S001051O.TT_E66_MA       = NOR_NUM;                            00003800
      ELSE                                                              00003810
         DO;                                                            00003820
            S001051O.TT_E66_MA           = BRI_NUM;                     00003830
            S001051I.TT_E66_ML           = CURSOR_POS;                  00003840
            IF APSP.TT_E66_MNR ^= 999 THEN                              00003850
               CALL SKRIV_FEIL(APSP.TT_E66_MNR);                        00003860
         END;                                                           00003870
      IF APSP.TT_F67_EKNR = 0 THEN                                      00003880
         S001051O.TT_F67_EKA = NOR_NUM;                                 00003890
      ELSE                                                              00003900
         DO;                                                            00003910
            S001051O.TT_F67_EKA           = BRI_NUM;                    00003920
            S001051I.TT_F67_EKL           = CURSOR_POS;                 00003930
            IF APSP.TT_F67_EKNR ^= 999 THEN                             00003940
               CALL SKRIV_FEIL(APSP.TT_F67_EKNR);                       00003950
         END;                                                           00003960
      IF APSP.TT_E66_Å_EKNR = 0 THEN                                    00003970
         S001051O.TT_E66_Å_EKA       = NOR_NUM;                         00003980
      ELSE                                                              00003990
         DO;                                                            00004000
            S001051O.TT_E66_Å_EKA           = BRI_NUM;                  00004010
            S001051I.TT_E66_Å_EKL           = CURSOR_POS;               00004020
            IF APSP.TT_E66_Å_EKNR ^= 999 THEN                           00004030
               CALL SKRIV_FEIL(APSP.TT_E66_Å_EKNR);                     00004040
         END;                                                           00004050
      IF APSP.TT_E66_M_EKNR = 0 THEN                                    00004060
         S001051O.TT_E66_M_EKA       = NOR_NUM;                         00004070
      ELSE                                                              00004080
         DO;                                                            00004090
            S001051O.TT_E66_M_EKA           = BRI_NUM;                  00004100
            S001051I.TT_E66_M_EKL           = CURSOR_POS;               00004110
            IF APSP.TT_E66_M_EKNR ^= 999 THEN                           00004120
               CALL SKRIV_FEIL(APSP.TT_E66_M_EKNR);                     00004130
         END;                                                           00004140
      IF APSP.TT_VENT_UTLNR = 0 THEN                                    00004150
         S001051O.TT_VENT_UTLA       = NOR_NUM;                         00004160
      ELSE                                                              00004170
         DO;                                                            00004180
            S001051O.TT_VENT_UTLA           = BRI_NUM;                  00004190
            S001051I.TT_VENT_UTLL           = CURSOR_POS;               00004200
            IF APSP.TT_VENT_UTLNR ^= 999 THEN                           00004210
               CALL SKRIV_FEIL(APSP.TT_VENT_UTLNR);                     00004220
         END;                                                           00004230
      IF APSP.IKKE_GPNR = 0 THEN                                        00004240
         S001051O.IKKE_GPA       = NORMAL;                              00004250
      ELSE                                                              00004260
         DO;                                                            00004270
            S001051O.IKKE_GPA           = DFHBMBRY;                     00004280
            S001051I.IKKE_GPL           = CURSOR_POS;                   00004290
            IF APSP.IKKE_GPNR ^= 999 THEN                               00004300
               CALL SKRIV_FEIL(APSP.IKKE_GPNR);                         00004310
         END;                                                           00004320
                                                                        00004330
     IF FRA_UTEN_DIALOG THEN    /* BLOKKER ALT SAMMEN    */             00004340
        CALL BLOKKERE_SPES;                                             00004350
                                                                        00004360
   END OVERFØR_APSPES_MAP;                                              00004370
                                                                        00004380
                                                                        00004390
 /* ***************************************************************** */00004400
 /*                                                                   */00004410
 /*   OVERFØRING FRA WORKAREA TIL MAP FOR BARNEDELEN                  */00004420
 /*                                                                   */00004430
 /* ***************************************************************** */00004440
 %SKIP(2);                                                              00004450
 OVERFØR_APBARN_MAP:                                                    00004460
   PROC;                                                                00004470
   DCL                                                                  00004480
      ANT_BARN FIXED BIN (15);                                          00004490
   DCL                                                                  00004500
      NORMAL  CHAR (1) INIT(' '),                                       00004510
      NOR_NUM CHAR (1) INIT('&'),                                       00004520
      BRI_NUM CHAR (1) INIT('Q');                                       00004530
                                                                        00004540
 %SKIP;                                                                 00004550
      ANT_BARN = 1;                                                     00004560
                                                                        00004570
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00004580
         DO;                                                            00004590
            S001051O.FNR_BARN1O =                                       00004600
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00004610
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00004620
               S001051O.FNR_BARN1A = NOR_NUM;                           00004630
            ELSE                                                        00004640
               DO;                                                      00004650
                  S001051O.FNR_BARN1A = BRI_NUM;                        00004660
                  S001051I.FNR_BARN1L = CURSOR_POS;                     00004670
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00004680
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00004690
               END;                                                     00004700
            S001051O.RBT1O =                                            00004710
                         APB.RBT_BARN(ANT_BARN);                        00004720
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00004730
               S001051O.RBT1A = NORMAL;                                 00004740
            ELSE                                                        00004750
               DO;                                                      00004760
                  S001051O.RBT1A = DFHBMBRY;                            00004770
                  S001051I.RBT1L = CURSOR_POS;                          00004780
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00004790
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00004800
               END;                                                     00004810
            ANT_BARN = ANT_BARN +1;                                     00004820
         END;                                                           00004830
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00004840
         DO;                                                            00004850
            S001051O.FNR_BARN2O =                                       00004860
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00004870
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00004880
               S001051O.FNR_BARN2A = NOR_NUM;                           00004890
            ELSE                                                        00004900
               DO;                                                      00004910
                  S001051O.FNR_BARN2A = BRI_NUM;                        00004920
                  S001051I.FNR_BARN2L = CURSOR_POS;                     00004930
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00004940
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00004950
               END;                                                     00004960
            S001051O.RBT2O =                                            00004970
                         APB.RBT_BARN(ANT_BARN);                        00004980
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00004990
               S001051O.RBT2A = NORMAL;                                 00005000
            ELSE                                                        00005010
               DO;                                                      00005020
                  S001051O.RBT2A = DFHBMBRY;                            00005030
                  S001051I.RBT2L = CURSOR_POS;                          00005040
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00005050
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00005060
               END;                                                     00005070
            ANT_BARN = ANT_BARN +1;                                     00005080
         END;                                                           00005090
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00005100
         DO;                                                            00005110
            S001051O.FNR_BARN3O =                                       00005120
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00005130
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00005140
               S001051O.FNR_BARN3A = NOR_NUM;                           00005150
            ELSE                                                        00005160
               DO;                                                      00005170
                  S001051O.FNR_BARN3A = BRI_NUM;                        00005180
                  S001051I.FNR_BARN3L = CURSOR_POS;                     00005190
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00005200
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00005210
               END;                                                     00005220
            S001051O.RBT3O =                                            00005230
                         APB.RBT_BARN(ANT_BARN);                        00005240
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00005250
               S001051O.RBT3A = NORMAL;                                 00005260
            ELSE                                                        00005270
               DO;                                                      00005280
                  S001051O.RBT3A = DFHBMBRY;                            00005290
                  S001051I.RBT3L = CURSOR_POS;                          00005300
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00005310
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00005320
               END;                                                     00005330
            ANT_BARN = ANT_BARN +1;                                     00005340
         END;                                                           00005350
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00005360
         DO;                                                            00005370
            S001051O.FNR_BARN4O =                                       00005380
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00005390
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00005400
               S001051O.FNR_BARN4A = NOR_NUM;                           00005410
            ELSE                                                        00005420
               DO;                                                      00005430
                  S001051O.FNR_BARN4A = BRI_NUM;                        00005440
                  S001051I.FNR_BARN4L = CURSOR_POS;                     00005450
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00005460
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00005470
               END;                                                     00005480
            S001051O.RBT4O =                                            00005490
                         APB.RBT_BARN(ANT_BARN);                        00005500
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00005510
               S001051O.RBT4A = NORMAL;                                 00005520
            ELSE                                                        00005530
               DO;                                                      00005540
                  S001051O.RBT4A = DFHBMBRY;                            00005550
                  S001051I.RBT4L = CURSOR_POS;                          00005560
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00005570
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00005580
               END;                                                     00005590
            ANT_BARN = ANT_BARN +1;                                     00005600
         END;                                                           00005610
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00005620
         DO;                                                            00005630
            S001051O.FNR_BARN5O =                                       00005640
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00005650
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00005660
               S001051O.FNR_BARN5A = NOR_NUM;                           00005670
            ELSE                                                        00005680
               DO;                                                      00005690
                  S001051O.FNR_BARN5A = BRI_NUM;                        00005700
                  S001051I.FNR_BARN5L = CURSOR_POS;                     00005710
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00005720
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00005730
               END;                                                     00005740
            S001051O.RBT5O =                                            00005750
                         APB.RBT_BARN(ANT_BARN);                        00005760
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00005770
               S001051O.RBT5A = NORMAL;                                 00005780
            ELSE                                                        00005790
               DO;                                                      00005800
                  S001051O.RBT5A = DFHBMBRY;                            00005810
                  S001051I.RBT5L = CURSOR_POS;                          00005820
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00005830
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00005840
               END;                                                     00005850
            ANT_BARN = ANT_BARN +1;                                     00005860
         END;                                                           00005870
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00005880
         DO;                                                            00005890
            S001051O.FNR_BARN6O =                                       00005900
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00005910
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00005920
               S001051O.FNR_BARN6A = NOR_NUM;                           00005930
            ELSE                                                        00005940
               DO;                                                      00005950
                  S001051O.FNR_BARN6A = BRI_NUM;                        00005960
                  S001051I.FNR_BARN6L = CURSOR_POS;                     00005970
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00005980
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00005990
               END;                                                     00006000
            S001051O.RBT6O =                                            00006010
                         APB.RBT_BARN(ANT_BARN);                        00006020
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00006030
               S001051O.RBT6A = NORMAL;                                 00006040
            ELSE                                                        00006050
               DO;                                                      00006060
                  S001051O.RBT6A = DFHBMBRY;                            00006070
                  S001051I.RBT6L = CURSOR_POS;                          00006080
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00006090
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00006100
               END;                                                     00006110
            ANT_BARN = ANT_BARN +1;                                     00006120
         END;                                                           00006130
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00006140
         DO;                                                            00006150
            S001051O.FNR_BARN7O =                                       00006160
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00006170
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00006180
               S001051O.FNR_BARN7A = NOR_NUM;                           00006190
            ELSE                                                        00006200
               DO;                                                      00006210
                  S001051O.FNR_BARN7A = BRI_NUM;                        00006220
                  S001051I.FNR_BARN7L = CURSOR_POS;                     00006230
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00006240
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00006250
               END;                                                     00006260
            S001051O.RBT7O =                                            00006270
                         APB.RBT_BARN(ANT_BARN);                        00006280
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00006290
               S001051O.RBT7A = NORMAL;                                 00006300
            ELSE                                                        00006310
               DO;                                                      00006320
                  S001051O.RBT7A = DFHBMBRY;                            00006330
                  S001051I.RBT7L = CURSOR_POS;                          00006340
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00006350
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00006360
               END;                                                     00006370
            ANT_BARN = ANT_BARN +1;                                     00006380
         END;                                                           00006390
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00006400
         DO;                                                            00006410
            S001051O.FNR_BARN8O =                                       00006420
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00006430
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00006440
               S001051O.FNR_BARN8A = NOR_NUM;                           00006450
            ELSE                                                        00006460
               DO;                                                      00006470
                  S001051O.FNR_BARN8A = BRI_NUM;                        00006480
                  S001051I.FNR_BARN8L = CURSOR_POS;                     00006490
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00006500
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00006510
               END;                                                     00006520
            S001051O.RBT8O =                                            00006530
                         APB.RBT_BARN(ANT_BARN);                        00006540
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00006550
               S001051O.RBT8A = NORMAL;                                 00006560
            ELSE                                                        00006570
               DO;                                                      00006580
                  S001051O.RBT8A = DFHBMBRY;                            00006590
                  S001051I.RBT8L = CURSOR_POS;                          00006600
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00006610
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00006620
               END;                                                     00006630
            ANT_BARN = ANT_BARN +1;                                     00006640
         END;                                                           00006650
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00006660
         DO;                                                            00006670
            S001051O.FNR_BARN9O =                                       00006680
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00006690
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00006700
               S001051O.FNR_BARN9A = NOR_NUM;                           00006710
            ELSE                                                        00006720
               DO;                                                      00006730
                  S001051O.FNR_BARN9A = BRI_NUM;                        00006740
                  S001051I.FNR_BARN9L = CURSOR_POS;                     00006750
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00006760
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00006770
               END;                                                     00006780
            S001051O.RBT9O =                                            00006790
                         APB.RBT_BARN(ANT_BARN);                        00006800
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00006810
               S001051O.RBT9A = NORMAL;                                 00006820
            ELSE                                                        00006830
               DO;                                                      00006840
                  S001051O.RBT9A = DFHBMBRY;                            00006850
                  S001051I.RBT9L = CURSOR_POS;                          00006860
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00006870
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00006880
               END;                                                     00006890
            ANT_BARN = ANT_BARN +1;                                     00006900
         END;                                                           00006910
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00006920
         DO;                                                            00006930
            S001051O.FNR_BARN10O =                                      00006940
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00006950
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00006960
               S001051O.FNR_BARN10A = NOR_NUM;                          00006970
            ELSE                                                        00006980
               DO;                                                      00006990
                  S001051O.FNR_BARN10A = BRI_NUM;                       00007000
                  S001051I.FNR_BARN10L = CURSOR_POS;                    00007010
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00007020
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00007030
               END;                                                     00007040
            S001051O.RBT10O =                                           00007050
                         APB.RBT_BARN(ANT_BARN);                        00007060
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00007070
               S001051O.RBT10A = NORMAL;                                00007080
            ELSE                                                        00007090
               DO;                                                      00007100
                  S001051O.RBT10A = DFHBMBRY;                           00007110
                  S001051I.RBT10L = CURSOR_POS;                         00007120
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00007130
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00007140
               END;                                                     00007150
            ANT_BARN = ANT_BARN +1;                                     00007160
         END;                                                           00007170
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00007180
         DO;                                                            00007190
            S001051O.FNR_BARN11O =                                      00007200
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00007210
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00007220
               S001051O.FNR_BARN11A = NOR_NUM;                          00007230
            ELSE                                                        00007240
               DO;                                                      00007250
                  S001051O.FNR_BARN11A = BRI_NUM;                       00007260
                  S001051I.FNR_BARN11L = CURSOR_POS;                    00007270
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00007280
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00007290
               END;                                                     00007300
            S001051O.RBT11O =                                           00007310
                         APB.RBT_BARN(ANT_BARN);                        00007320
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00007330
               S001051O.RBT11A = NORMAL;                                00007340
            ELSE                                                        00007350
               DO;                                                      00007360
                  S001051O.RBT11A = DFHBMBRY;                           00007370
                  S001051I.RBT11L = CURSOR_POS;                         00007380
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00007390
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00007400
               END;                                                     00007410
            ANT_BARN = ANT_BARN +1;                                     00007420
         END;                                                           00007430
      IF F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN)) ^= (11)'0' THEN      00007440
         DO;                                                            00007450
            S001051O.FNR_BARN12O =                                      00007460
                         F_FELT_PIC_CHAR11(APB.FNR_BARN(ANT_BARN));     00007470
            IF APB.FNR_BARNNR(ANT_BARN) = 0 THEN                        00007480
               S001051O.FNR_BARN12A = NOR_NUM;                          00007490
            ELSE                                                        00007500
               DO;                                                      00007510
                  S001051O.FNR_BARN12A = BRI_NUM;                       00007520
                  S001051I.FNR_BARN12L = CURSOR_POS;                    00007530
                  IF APB.FNR_BARNNR(ANT_BARN) ^= 999 THEN               00007540
                    CALL SKRIV_FEIL(APB.FNR_BARNNR(ANT_BARN));          00007550
               END;                                                     00007560
            S001051O.RBT12O =                                           00007570
                         APB.RBT_BARN(ANT_BARN);                        00007580
            IF APB.RBT_BARNNR(ANT_BARN) = 0 THEN                        00007590
               S001051O.RBT12A = NORMAL;                                00007600
            ELSE                                                        00007610
               DO;                                                      00007620
                  S001051O.RBT12A = DFHBMBRY;                           00007630
                  S001051I.RBT12L = CURSOR_POS;                         00007640
                  IF APB.RBT_BARNNR(ANT_BARN) ^= 999 THEN               00007650
                    CALL SKRIV_FEIL(APB.RBT_BARNNR(ANT_BARN));          00007660
               END;                                                     00007670
         END;                                                           00007680
                                                                        00007690
      IF FRA_UTEN_DIALOG THEN     /* BLOKKER ALT SAMMEN    */           00007700
         CALL BLOKKERE_BARN;                                            00007710
                                                                        00007720
   END OVERFØR_APBARN_MAP;                                              00007730
