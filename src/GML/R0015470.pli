 /*       SIST ENDRET 28/07-98 12.50.36 AV   JDA7339                  */00000000
 /*       SIST ENDRET 28/07-98 12.27.19 AV   JDA7339                  */00000010
 /*       SIST ENDRET 28/07-97 12.35.04 AV   HLA7339                  */00000020
 /*       SIST ENDRET 01/04-96 14.50.15 AV   HLB0310                  */00000030
 /*       SIST ENDRET 02/09-94 13.23.41 AV   DYBVIK                   */00000040
 /*       SIST ENDRET 25/02-94 12.25.17 AV   HERMAN                   */00000050
 /*       SIST ENDRET 03/03-92 09.52.22 AV   DYBVIK                   */00000060
 /*       SIST ENDRET 11/07-91 14.23.48 AV   DYBVIK                   */00000070
 /*       SIST ENDRET 26/04-91 11.47.01 AV   DYBVIK                   */00000080
 /*       SIST ENDRET 12/11-90 13.14.36 AV   DYBVIK                   */00000090
 /*       SIST ENDRET 14/04-89 15.35.31 AV   HERMAN                   */00000100
 /*       SIST ENDRET 30/08-84 12.33.21 AV   DYBVIK                   */00000110
 /*       SIST ENDRET 23/03-83 12.12.18 AV   LUNDEBY                  */00000120
 /*       SIST ENDRET 25/01-83 12.13.50 AV   LUNDEBY                  */00000130
 /*       SIST ENDRET 24/11-82 09.55.10 AV   LUNDEBY                  */00000140
                                                                        00000150
                                                                        00000160
  %PAGE;                                                                00000170
  /* ************************************************************** */  00000180
  /*IDENTIFIKASJON:                                                 */  00000190
  /*    R0015470 -     UNDERMODUL I PLI                             */  00000200
  /*    PROGRAMMERER: S. LUNDEBY , SFK ,  FEBRUAR  1982             */  00000210
  /*                                                                */  00000220
  /*HENSIKT:                                                        */  00000230
  /*    SKRIVE  NEST SISTE STATUS TIL REGISTERET                    */  00000240
  /*                                                                */  00000250
  /*                                                                */  00000260
  /*PROGRAMTILKNYTNING:                                             */  00000270
  /*                                                                */  00000280
  /*                                                                */  00000290
  /*BRUK:   KALLES AV R0015401                                      */  00000300
  /*                                                                */  00000310
  /*                                                                */  00000320
  /* ************************************************************** */  00000330
                                                                        00000340
  P_SKRIV_NEST_SISTE_STATUS :                                           00000350
     PROC;                                                              00000360
                                                                        00000370
     /* *********************************************************** */  00000380
     /*                                                             */  00000390
     /*      SLUTT PÅ DEKLARASJONENE , EKSEKVERINGEN STARTER .      */  00000400
     /*     ---------------------------------------------------     */  00000410
     /*                                                             */  00000420
     /*          INSERT STATUS - SEGM.                              */  00000430
     /*                                                             */  00000440
     /* *********************************************************** */  00000450
                                                                        00000460
     /* TRUDE. ENGANGSBELØP _11_7 KUN HJELPEFELT, SKAL IKKE SKRIVES  */ 00000470
     /* PÅ BASEN.    Y R K E S S K A D E                             */ 00000480
                                                                        00000490
 /*  B00.STATUS.ENGANGSBELØP_11_7(W02_I) = 0    HL  */                  00000500
     W01_HJELPE_PTR                =   ADDR (B00.STATUS(W02_I));        00000510
     SSA_UQUAL                     =  'STATUS   ';                      00000520
     CALL  P_SKRIV_BARN_AV_ROT;                                         00000530
                                                                        00000540
     IF  FEIL_MELD_NR              >   0                THEN            00000550
       DO;                                                              00000560
         /* ******************************************************* */  00000570
         /* FEIL VED SKRIV AV  :         STATUS                     */  00000580
         /* ******************************************************* */  00000590
                                                                        00000600
         GO TO RETUR;                                                   00000610
       END;                                                             00000620
                                                                        00000630
     /* *********************************************************** */  00000640
     /*      INSERT TILKNYTTINGS-PERSONER                           */  00000650
     /* *********************************************************** */  00000660
                                                                        00000670
     DO  I = 1  TO  13                                                  00000680
         WHILE (B00.TILKN.FNR_TILKN(W02_I,I)  >  0);                    00000690
                                                                        00000700
       W01_HJELPE_PTR          =  ADDR (B00.TILKN(W02_I,I));            00000710
       SSA_UQUAL               = 'TILKN    ';                           00000720
       CALL P_SKRIV_BARN_AV_STATUS;                                     00000730
                                                                        00000740
       IF  FEIL_MELD_NR              >   0             THEN             00000750
         DO;                                                            00000760
           /* ***************************************************** */  00000770
           /* FEIL VED SKRIV AV  :        TILKN                     */  00000780
           /* ***************************************************** */  00000790
                                                                        00000800
           GO TO RETUR;                                                 00000810
         END;                                                           00000820
     END;                                                               00000830
                                                                        00000840
     /* *********************************************************** */  00000850
     /*         INSERT FORSI SEGMENT                                */  00000860
     /* *********************************************************** */  00000870
                                                                        00000880
     IF (B00.FORSI.FT_SKAL_BEREGNES(W02_I) ^=  ' ')  THEN               00000890
       DO;                                                              00000900
         IF (B00.FORSI.FT_SKAL_BEREGNES(W02_I) =  'D')  THEN            00000910
             B00.FORSI.FT_SKAL_BEREGNES(W02_I) =  ' ';                  00000920
         W01_HJELPE_PTR        = ADDR(B00.FORSI(W02_I));                00000930
         SSA_UQUAL             = 'FORSI    ';                           00000940
         CALL P_SKRIV_BARN_AV_STATUS;                                   00000950
                                                                        00000960
         IF  FEIL_MELD_NR              >   0             THEN           00000970
           DO;                                                          00000980
             /* *************************************************** */  00000990
             /* FEIL VED SKRIV AV  :       FORSI                    */  00001000
             /* *************************************************** */  00001010
                                                                        00001020
             GO TO RETUR;                                               00001030
           END;                                                         00001040
       END;                                                             00001050
     /* *********************************************************** */  00001060
     /*         INSERT ALDERSPENSJONSOPPLYSNINGER                   */  00001070
     /* *********************************************************** */  00001080
                                                                        00001090
     IF ((B00.PENSJONSTYPE1(W02_I)  = 'D')  &      /*250396 HL*/        00001100
         (B00.KONV_P_KODE(W02_I)    = 'K' !                             00001110
          B00.KONV_P_KODE(W02_I)    = 'O')  )   !                       00001120
        (B00.PENSJONSTYPE1(W02_I)  =  'A')  !                           00001130
        (B00.PENSJONSTYPE1(W02_I)  =  'K')  THEN                        00001140
       DO;                                                              00001150
         W01_HJELPE_PTR        = ADDR(B00.ALDERSP(W02_I));              00001160
         SSA_UQUAL             = 'ALDERSP  ';                           00001170
         CALL P_SKRIV_BARN_AV_STATUS;                                   00001180
                                                                        00001190
         IF  FEIL_MELD_NR              >   0             THEN           00001200
           DO;                                                          00001210
             /* *************************************************** */  00001220
             /* FEIL VED SKRIV AV  :       ALDERSP                  */  00001230
             /* *************************************************** */  00001240
                                                                        00001250
             GO TO RETUR;                                               00001260
           END;                                                         00001270
                                                                        00001280
         /* ******************************************************* */  00001290
         /*               VENTEPERIODE                              */  00001300
         /* ******************************************************* */  00001310
                                                                        00001320
         DO  I = 1  TO  5                                               00001330
             WHILE (B00.UTTAKSDATO_ÅM_ØVRIGE(W02_I,I) > 0);             00001340
                                                                        00001350
           W01_HJELPE_PTR    = ADDR (B00.VENTØVR(W02_I,I));             00001360
           SSA_UQUAL         = 'VENTØVR  ';                             00001370
           CALL  P_SKRIV_BARN_AV_STATUS;                                00001380
                                                                        00001390
           IF   FEIL_MELD_NR              >   0             THEN        00001400
             DO;                                                        00001410
               /* ************************************************ */   00001420
               /* FEIL VED SKRIV AV  :      VENTEØVR               */   00001430
               /* ************************************************ */   00001440
                                                                        00001450
               GO TO RETUR;                                             00001460
             END;                                                       00001470
           END;                                                         00001480
       END;                                                             00001490
                                                                        00001500
     /* ********************************************************** */   00001510
     /*           UFØREPENSJON                                     */   00001520
     /* ********************************************************** */   00001530
                                                                        00001540
     IF B00.PENSJONSTYPE1(W02_I)  = 'U'    !                            00001550
        B00.PENSJONSTYPE1(W02_I)  = 'Y'    !                            00001560
           (B00.PENSJONSTYPE1(W02_I)  = 'D' &                           00001570
            B00.UFØRPENS.SPT_1291(W02_I) > 0  )  !                      00001580
        B00.PENSJONSTYPE3(W02_I)  = 'Y'    !                            00001590
        B00.PENSJONSTYPE3(W02_I)  = 'U'            THEN                 00001600
       DO;                                                              00001610
         W01_HJELPE_PTR        =   ADDR(B00.UFØRPENS(W02_I));           00001620
         SSA_UQUAL             =  'UFØRPENS ';                          00001630
         CALL P_SKRIV_BARN_AV_STATUS;                                   00001640
                                                                        00001650
         IF  FEIL_MELD_NR              >   0             THEN           00001660
           DO;                                                          00001670
             /* ************************************************** */   00001680
             /* FEIL VED SKRIV AV  :     UFØRPENS                  */   00001690
             /* ************************************************** */   00001700
                                                                        00001710
             GO TO RETUR;                                               00001720
           END;                                                         00001730
       END;                                                             00001740
                                                                        00001750
     /* ********************************************************** */   00001760
     /*   LEGGER INN UFØRE-OPPLYSNINGER                            */   00001770
     /* ********************************************************** */   00001780
   /*0697 HL:*/                                                         00001790
     DO  I=1 TO 7               WHILE  (B00.UFT_ÅM   (W02_I,I) > 0);    00001800
       W01_HJELPE_PTR        =  ADDR   (B00.UFØRHIST (W02_I,I) );       00001810
       SSA1_UFØRHIST.UFT_ÅM  =          B00.UFT_ÅM   (W02_I,I);         00001820
       SSA_UQUAL             =                'UFØRHIST ';              00001830
       CALL  P_SKRIV_BARN_AV_STATUS;                                    00001840
                                                                        00001850
       IF  FEIL_MELD_NR      >          0               THEN            00001860
         DO;                                                            00001870
           /* ***************************************************** */  00001880
           /*  FEIL VED SKRIV AV  :  UFØRHIST                       */  00001890
           /* ***************************************************** */  00001900
                                                                        00001910
           GO TO  RETUR;                                                00001920
         END;                                                           00001930
       /* ********************************************************* */  00001940
       /*  LEGGER INN UFØREGRADPERIODER INNENFOR                    */  00001950
       /*  UFØREHISTORIKK-PERIODER .                                */  00001960
       /* ********************************************************* */  00001970
                                                                        00001980
   /*0697 HL:*/                                                         00001990
       DO  J=1 TO 7          WHILE (B00.UFG_DATO_ÅM (W02_I,I,J) > 0);   00002000
         W01_HJELPE_PTR   =   ADDR (B00.UFØRGRAD    (W02_I,I,J));       00002010
         SSA_UQUAL        =               'UFØRGRAD ';                  00002020
         CALL P_SKRIV_BARN_AV_UFØRHIST;                                 00002030
                                                                        00002040
         IF  FEIL_MELD_NR      >          0               THEN          00002050
           DO;                                                          00002060
             /* *************************************************** */  00002070
             /*  FEIL VED SKRIV AV  :  UFØRGRAD                     */  00002080
             /* *************************************************** */  00002090
                                                                        00002100
             GO TO  RETUR;                                              00002110
           END;                                                         00002120
       END;                                                             00002130
     END;                                                               00002140
                                                                        00002150
       /* ******************************************************** */   00002160
       /*         YRKESSKADE                                       */   00002170
       /* ******************************************************** */   00002180
                                                                        00002190
       IF B00.PENSJONSTYPE1(W02_I) = 'Y'   !                            00002200
          B00.PENSJONSTYPE3(W02_I) = 'Y'   !                            00002210
          (B00.PENSJONSTYPE1(W02_I) = 'A'   &                           00002220
           B00.KONV_P_KODE  (W02_I) = 'Y')         THEN                 00002230
         DO;                                                            00002240
           W01_HJELPE_PTR      =   ADDR(B00.YRKEPENS(W02_I));           00002250
           SSA_UQUAL           =  'YRKEPENS ';                          00002260
           CALL P_SKRIV_BARN_AV_STATUS;                                 00002270
                                                                        00002280
           IF FEIL_MELD_NR             >   0             THEN           00002290
             DO;                                                        00002300
               /* ************************************************ */   00002310
               /* FEIL VED SKRIV AV :    YRKEPENS                  */   00002320
               /* ************************************************ */   00002330
                                                                        00002340
               GO TO RETUR;                                             00002350
             END;                                                       00002360
         END;                                                           00002370
                                                                        00002380
               /* ************************************************ */   00002390
               /* YRKEPENS SKAL SKRIVES UT FOR DØDE                */   00002400
               /* ************************************************ */   00002410
                                                                        00002420
       IF B00.PENSJONSTYPE1(W02_I) = 'D'  &                             00002430
          B00.YRKEPENS.YUG (W02_I) > 0          THEN                    00002440
         DO;                                                            00002450
           W01_HJELPE_PTR      =   ADDR(B00.YRKEPENS(W02_I));           00002460
           SSA_UQUAL           =  'YRKEPENS ';                          00002470
           CALL P_SKRIV_BARN_AV_STATUS;                                 00002480
                                                                        00002490
           IF FEIL_MELD_NR             >   0             THEN           00002500
             DO;                                                        00002510
               /* ************************************************ */   00002520
               /* FEIL VED SKRIV AV :    YRKEPENS                  */   00002530
               /* ************************************************ */   00002540
                                                                        00002550
               GO TO RETUR;                                             00002560
             END;                                                       00002570
         END;                                                           00002580
                                                                        00002590
       /* ********************************************************** */ 00002600
       /* LEGGER INN YRKEHIST-OPPLYSNINGER                           */ 00002610
       /* ********************************************************** */ 00002620
                                                                        00002630
       DO I=1 TO 5              WHILE  (B00.YUFT_ÅM  (W02_I,I) > 0);    00002640
         W01_HJELPE_PTR      =  ADDR   (B00.YRKEHIST (W02_I,I) );       00002650
         SSA1_YRKEHIST.YUFT_ÅM =        B00.YUFT_ÅM  (W02_I,I);         00002660
         SSA_UQUAL           =                'YRKEHIST ';              00002670
         CALL P_SKRIV_BARN_AV_STATUS;                                   00002680
                                                                        00002690
         IF FEIL_MELD_NR     >          0               THEN            00002700
           DO;                                                          00002710
             /* *************************************************** */  00002720
             /* FEIL VED SKRIV AV :  YRKEHIST                       */  00002730
             /* *************************************************** */  00002740
                                                                        00002750
             GO TO RETUR;                                               00002760
           END;                                                         00002770
         /* ******************************************************* */  00002780
         /* LEGGER INN YRKEGRADPERIODER INNENFOR                    */  00002790
         /* YRKEHISTORIKK-PERIODER .                                */  00002800
         /* ******************************************************* */  00002810
                                                                        00002820
         DO J=1 TO 5         WHILE (B00.YUG_DATO_ÅM (W02_I,I,J) > 0);   00002830
           W01_HJELPE_PTR =   ADDR (B00.YRKEGRAD    (W02_I,I,J));       00002840
           SSA_UQUAL      =               'YRKEGRAD ';                  00002850
           CALL P_SKRIV_BARN_AV_YRKEHIST;                               00002860
                                                                        00002870
           IF FEIL_MELD_NR     >          0               THEN          00002880
             DO;                                                        00002890
               /* ************************************************* */  00002900
               /* FEIL VED SKRIV AV :  YRKEGRAD                     */  00002910
               /* ************************************************* */  00002920
                                                                        00002930
               GO TO RETUR;                                             00002940
             END;                                                       00002950
         END;                                                           00002960
       END;                                                             00002970
                                                                        00002980
     /* ***************************************************** */        00002990
     /*        BARNEPENSJON                                   */        00003000
     /* ***************************************************** */        00003010
                                                                        00003020
     IF  B00.PENSJONSTYPE1(W02_I)  = 'B'                                00003030
       ! B00.PENSJONSTYPE1(W02_I)  = 'N'           THEN                 00003040
       DO;                                                              00003050
         W01_HJELPE_PTR = ADDR(B00.ETTEBARN(W02_I));                    00003060
         SSA_UQUAL      = 'ETTEBARN ';                                  00003070
         CALL P_SKRIV_BARN_AV_STATUS;                                   00003080
                                                                        00003090
         IF  FEIL_MELD_NR              >   0             THEN           00003100
           DO;                                                          00003110
             /* **************************************************** */ 00003120
             /* FEIL VED SKRIV AV   :     ETTEBARN                   */ 00003130
             /* **************************************************** */ 00003140
                                                                        00003150
             GO TO RETUR;                                               00003160
           END;                                                         00003170
       END;                                                             00003180
                                                                        00003190
     /* ***************************************************** */        00003200
     /*        ETTERPENSJON                                   */        00003210
     /* ***************************************************** */        00003220
                                                                        00003230
     IF  B00.PENSJONSTYPE1(W02_I)  = 'E'                                00003240
       ! B00.PENSJONSTYPE1(W02_I)  = 'J'                                00003250
       ! B00.PENSJONSTYPE2(W02_I)  = 'E'           THEN                 00003260
       DO;                                                              00003270
         W01_HJELPE_PTR = ADDR(B00.ETTEPENS(W02_I));                    00003280
         SSA_UQUAL      = 'ETTEPENS ';                                  00003290
         CALL P_SKRIV_BARN_AV_STATUS;                                   00003300
                                                                        00003310
         IF  FEIL_MELD_NR              >   0             THEN           00003320
           DO;                                                          00003330
             /* **************************************************** */ 00003340
             /* FEIL VED SKRIV AV   :     ETTEPENS                   */ 00003350
             /* **************************************************** */ 00003360
                                                                        00003370
             GO TO RETUR;                                               00003380
           END;                                                         00003390
       END;                                                             00003400
                                                                        00003410
     /* ***************************************************** */        00003420
     /*        EØS INFO                                       */        00003430
     /* ***************************************************** */        00003440
                                                                        00003450
     IF  B00.EØSINFO.BEREGN_FOLKETRYGD (W02_I)  ^= ' '   THEN           00003460
       DO;                                                              00003470
         W01_HJELPE_PTR = ADDR(B00.EØSINFO(W02_I));                     00003480
         SSA_UQUAL      = 'EØSINFO  ';                                  00003490
         CALL P_SKRIV_BARN_AV_STATUS;                                   00003500
                                                                        00003510
         IF  FEIL_MELD_NR              >   0             THEN           00003520
           DO;                                                          00003530
             /* **************************************************** */ 00003540
             /* FEIL VED SKRIV AV   :     EØS INFO                   */ 00003550
             /* **************************************************** */ 00003560
                                                                        00003570
             GO TO RETUR;                                               00003580
           END;                                                         00003590
       END;                                                             00003600
                                                                        00003610
     /* ***************************************************** */        00003620
     /*         SPESIALOPPLYSNINGER                           */        00003630
     /* ***************************************************** */        00003640
                                                                        00003650
     IF P_SPESIALOPPLYSNINGER  (B00.SPESOPPL (W02_I)) THEN              00003660
       DO;                                                              00003670
         W01_HJELPE_PTR = ADDR (B00.SPESOPPL (W02_I));                  00003680
         SSA_UQUAL      = 'SPESOPPL ';                                  00003690
         CALL P_SKRIV_BARN_AV_STATUS;                                   00003700
                                                                        00003710
         IF  FEIL_MELD_NR              >   0             THEN           00003720
           DO;                                                          00003730
             /* **************************************************** */ 00003740
             /* FEIL VED SKRIV AV  :   SPESOPPL                      */ 00003750
             /* **************************************************** */ 00003760
                                                                        00003770
             GO TO RETUR;                                               00003780
           END;                                                         00003790
       END;                                                             00003800
                                                                        00003810
  RETUR:                                                                00003820
                                                                        00003830
  END P_SKRIV_NEST_SISTE_STATUS;                                        00003840
