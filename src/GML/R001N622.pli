 /*       SIST ENDRET 13/03-98 13.33.58 AV   JDA7339                  */00000000
 /*       SIST ENDRET 13/03-98 13.19.18 AV   JDA7339                  */00000010
 /*       SIST ENDRET 05/12-97 12.18.02 AV   JDA7339                  */00000020
 /*       SIST ENDRET 27/11-97 10.42.17 AV   JDA7339                  */00000030
 /*       SIST ENDRET 29/08-97 12.27.45 AV   JDA7339                  */00000040
 /*       SIST ENDRET 28/08-97 08.52.23 AV   SPA7339                  */00000050
 /*       SIST ENDRET 28/07-97 12.31.35 AV   HLA7339                  */00000060
 /*       SIST ENDRET 16/05-97 10.50.15 AV   JDA7339                  */00000070
 /*       SIST ENDRET 09/10-96 11.38.05 AV   JDA0310                  */00000080
 /*       SIST ENDRET 04/03-96 12.49.18 AV   JDA0310                  */00000090
 /*       SIST ENDRET 29/03-95 14.43.30 AV   JDA0310                  */00000100
 /*       SIST ENDRET 02/01-95 13.50.31 AV   HLB0310                  */00000110
 /*       SIST ENDRET 17/11-94 12.05.46 AV   JDA0310                  */00000120
 /*       SIST ENDRET 12/07-94 14.05.20 AV   DYBVIK                   */00000130
 /*       SIST ENDRET 08/06-94 14.04.17 AV   DYBVIK                   */00000140
 /*       SIST ENDRET 25/02-94 12.23.07 AV   HERMAN                   */00000150
 /*       SIST ENDRET 23/09-93 13.03.46 AV   DYBVIK                   */00000160
 /*       SIST ENDRET 27/01-93 15.08.55 AV   DYBVIK                   */00000170
 /*       SIST ENDRET 30/11-92 11.19.56 AV   DYBVIK                   */00000180
 /*       SIST ENDRET 09/10-92 14.31.56 AV   DYBVIK                   */00000190
 /*       SIST ENDRET 12/06-92 13.50.33 AV   TRUDE                    */00000200
 /*       SIST ENDRET 13/03-92 15.39.53 AV   HERMAN                   */00000210
 /*       SIST ENDRET 20/02-92 09.29.32 AV   HERMAN                   */00000220
 /*       SIST ENDRET 01/08-91 14.14.48 AV   DYBVIK                   */00000230
 /*       SIST ENDRET 14/06-91 13.25.11 AV   DYBVIK                   */00000240
 /*       SIST ENDRET 23/05-91 12.50.41 AV   HERMAN                   */00000250
 /*       SIST ENDRET 26/04-91 11.44.59 AV   DYBVIK                   */00000260
 /*       SIST ENDRET 02/04-91 09.54.40 AV   DYBVIK                   */00000270
 /*       SIST ENDRET 06/03-91 11.49.10 AV   DYBVIK                   */00000280
 /* ***************************************************************** */00000290
 /*IDENTIFIKASJON:                                                    */00000300
 /*    R001N622 - PROSEDYRE I PLI                                     */00000310
 /*    PROGRAMMERER:    HERMAN - JANUAR 1991                          */00000320
 /* *****************************************                         */00000330
 /*HENSIKT:                                                           */00000340
 /*    PROSEDYREN AJOURFØRER SØKERS PENSJONSSTATUS MED INFO FRA TRANS */00000350
 /*    UFØREPENSJON.                                                  */00000360
 /* ****************************************************************  */00000370
 /*PROGRAMTILKNYTNING:                                                */00000380
 /*    PROSEDYREN INCLUDES I R001N620.                                */00000390
 /*BRUK:                                                              */00000400
 /*    CALL AJOURFØR_B02_MED_U2TRANS                                  */00000410
 /*                                                                   */00000420
 /* ***************************************************************** */00000430
                                                                        00000440
 %SKIP(2);                                                              00000450
 AJOURFØR_B02_MED_U2TRANS:                                              00000460
   PROC OPTIONS(REENTRANT);                                             00000470
 %SKIP;                                                                 00000480
   DCL                                                                  00000490
  /*  UF_IND           FIXED BIN(15),      */                           00000500
        YUF_IND        FIXED BIN(15),                                   00000510
      J                FIXED BIN(15),                                   00000520
      K                FIXED BIN(15),                                   00000530
      M                FIXED BIN(15),                                   00000540
      HJELP            FIXED DEC (3),                                   00000550
      ÅR_FØR_UFØRHET   PIC '99';                                        00000560
                                                                        00000570
    B02.NAVN(SØKER_IND)            = U2S.NAVN;                          00000580
    B02.SPRÅK(SØKER_IND)           = U2S.SPRÅK;                         00000590
    B02.TKNR(SØKER_IND)            = U2S.TKNR;                          00000600
                                                                        00000610
    IF HJ_VIRK_DATO_ÅM < 9802                  THEN                     00000620
       B02.PENSJON_FØR_9802(SØKER_IND) = 'J';                           00000630
                                                                        00000640
    IF U2S.YRKE                    > 0 THEN                             00000650
    B02.YRKES_KODE(SØKER_IND)      = U2S.YRKE;                          00000660
                                                                        00000670
    IF U2S.INNTEKT_FØR_UP          > 0 THEN                             00000680
    B02.INNTEKT_FØR_UP(SØKER_IND) = U2S.INNTEKT_FØR_UP /100;            00000690
                                                                        00000700
    B02.FØRSTE_GANG_REG(SØKER_IND) = 'N';                               00000710
    DO I = 1 TO 13;                                                     00000720
       IF B02.FNR(I) > 0 THEN                                           00000730
          B02.FØRSTE_GANG_REG(I) = 'N';                                 00000740
    END;                                                                00000750
                                                                        00000760
  /* LEGG INN INNT_DATO_ÅM  TRUDE 270395*/                              00000770
    IF B01.UFØRHIST.UFT_ÅM(SØKER_IND,1)  > 0 THEN                       00000780
       B02.INNT_DATO_ÅM(SØKER_IND)  =  B01.UFØRHIST.UFT_ÅM(SØKER_IND,1);00000790
    ELSE                                                                00000800
       B02.INNT_DATO_ÅM(SØKER_IND)  =  F_SNU_DATO(U2S.UFT_MÅ);          00000810
                                                                        00000820
 /* ***************************************************************** */00000830
 /* YTELSE_SEGMENTET                                                  */00000840
 /* ***************************************************************** */00000850
                                                                        00000860
 %SKIP;                                                                 00000870
    IF B01.PENSJONSTYPE1(SØKER_IND) = 'N' !                             00000880
                           B01.PENSJONSTYPE1(SØKER_IND) = 'B' THEN      00000890
       B02.PENSJONSTYPE3(SØKER_IND) = 'U';                              00000900
    /*    PT1 ER UENDRET                                              */00000910
    ELSE                                                                00000920
       B02.PENSJONSTYPE1(SØKER_IND) = 'U';                              00000930
                                                                        00000940
  L270:                                                                 00000950
    IF U2Y.KAP_11_7_UTLØST          = 'J'   &   /*TRUDE, 31.5.89*/      00000960
       B01.PENSJONSTYPE1(SØKER_IND) = 'F'   THEN                        00000970
          DO;                                                           00000980
             FEIL_VED_LABEL           = '270';                          00000990
             FEIL_MELD_NR             = '1732';                         00001000
          END;                                                          00001010
                                                                        00001020
                                                                        00001030
    IF U2S.YSKADE_TILLEGG           = 'J'  !                            00001040
       B01.PENSJONSTYPE1(SØKER_IND) = 'Y'     THEN                      00001050
          B02.PENSJONSTYPE1(SØKER_IND) = 'Y';                           00001060
                                                                        00001070
    IF U2S.ATT_UF = 'A' THEN                                            00001080
       IF (B01.PENSJONSTYPE1(SØKER_IND)     = 'U' !                     00001090
           B01.PENSJONSTYPE1(SØKER_IND)     = 'Y' ) &                   00001100
           B01.PENSJONSTYPE3(SØKER_IND)    ^= 'A' &                     00001110
                                                                        00001120
          B01.STATUS_KODE_HIST(SØKER_IND)  = ' ' THEN                   00001130
          DO;                                                           00001140
                                                                        00001150
             IF  (STATUS_TYPE = 'B' !                                   00001160
                 STATUS_TYPE = 'I')  &                                  00001170
                 TRANS_LISTE_INDEX = 1  THEN                            00001180
 /* ***************************************************************** */00001190
 /* FEIL,SØKEREN HAR UFØRPENSJON FRA FØR.                             */00001200
 /* ***************************************************************** */00001210
                 DO;                                                    00001220
  L275:                                                                 00001230
                    FEIL_VED_LABEL = '275';                             00001240
                    FEIL_MELD_NR   = 1717;                              00001250
                    GO TO RETUR;                                        00001260
                 END;                                                   00001270
 /* ***************************************************************** */00001280
 /* SØKEREN HAR ATTFØRING FRA FØR.TRANHIST BLIR DA FJERNET.           */00001290
 /* ***************************************************************** */00001300
             ELSE                                                       00001310
                 DO;                                                    00001320
                                                                        00001330
                                                                        00001340
                    SEARCH_FNR                  =                       00001350
                                   TRANS_OPPL_OMR.FØDSNUMMER        ;   00001360
                                                                        00001370
                                                                        00001380
                    FJERN_ALLE                  = '0'B              ;   00001390
                                                                        00001400
                                                                        00001410
                    EXEC CICS LINK PROGRAM                              00001420
                               ('R0015501') COMMAREA(LOKAL_KOM_OMR) ;   00001430
                                                                        00001440
                    IF FEIL_MELD_NR > 0 THEN                            00001450
                       GO TO RETUR                                  ;   00001460
                                                                        00001470
      /* 9712 HL :  FJERNES FOR Å RETTE FEIL3: *********************    00001480
                                                                        00001490
                    ANTALL_TRANS_I_TRANS_LISTE =                        00001500
                                      ANTALL_TRANS_I_TRANS_LISTE - 1;   00001510
         ************************************ */                        00001520
                 END;                                                   00001530
          END;                                                          00001540
       ELSE                                                             00001550
  /* DENNE TESTEN ER BEGRENSET I FORB. MED FEILM.274. ERIK 16.1.86 */   00001560
                 IF B01.PENSJONSTYPE3(SØKER_IND) = 'A'  &               00001570
                    (B01.PENSJONSTYPE1(SØKER_IND)    ^= 'Y' &           00001580
                     B01.PENSJONSTYPE1(SØKER_IND)    ^= 'U' ) &         00001590
                    B01.STATUS_KODE_HIST(SØKER_IND)  = ' ' THEN         00001600
                 DO;                                                    00001610
                                                                        00001620
 /* ***************************************************************** */00001630
 /* FEIL,SØKEREN HAR ATTFØRING FRA FØR.                               */00001640
 /* ***************************************************************** */00001650
                                                                        00001660
  L277:                                                                 00001670
                FEIL_VED_LABEL = '277';                                 00001680
                FEIL_MELD_NR   = 1718;                                  00001690
                GO TO RETUR;                                            00001700
             END;                                                       00001710
          ELSE                                                          00001720
             B02.PENSJONSTYPE3(SØKER_IND) = 'A';                        00001730
    ELSE                                                                00001740
       DO;                                                              00001750
          IF B01.PENSJONSTYPE3(SØKER_IND) = 'A' THEN                    00001760
             DO;                                                        00001770
                                                                        00001780
                DO I = 1 TO 7;     /*0697 HL*/                          00001790
                   IF B01.UFØRHIST.UFT_ÅM(SØKER_IND,I) = 0 THEN         00001800
                      DO;                                               00001810
                         B00.UFØRHIST(SØKER_IND,I-1) =                  00001820
                                 B01.UFØRHIST(SØKER_IND,I-1);           00001830
                         B01.UFØRHIST(SØKER_IND,I-1) = '';              00001840
                         K = I - 1;                                     00001850
                         I = 8;    /*0697 HL*/                          00001860
                      END;                                              00001870
                END;                                                    00001880
             END;                                                       00001890
                                                                        00001900
          IF B02.PENSJONSTYPE1(SØKER_IND) = 'U' !                       00001910
             B02.PENSJONSTYPE1(SØKER_IND) = 'Y' THEN                    00001920
             B02.PENSJONSTYPE3(SØKER_IND) = ' ';                        00001930
       END;                                                             00001940
 /* ***************************************************************** */00001950
 /* TIDLIGERE REGISTERT SOM ETTERLATT EKTEFELLE                       */00001960
 /* ***************************************************************** */00001970
                                                                        00001980
    IF B01.PENSJONSTYPE1(SØKER_IND) = 'E' THEN                          00001990
       B02.PENSJONSTYPE2(SØKER_IND) = 'E';                              00002000
                                                                        00002010
 /* ***************************************************************** */00002020
 /* NYE FORS-TILL BARN SKAL IKKE REGISTRERES,BRUK F7-BL  (JD 7.91)    */00002030
 /* ***************************************************************** */00002040
                                                                        00002050
    IF U2S.BT_ANT > B01.ANTALL_BARN (SØKER_IND) &                       00002060
       HJ_VIRK_DATO_ÅM > 9104 THEN                                      00002070
                 DO;                                                    00002080
  L378:                                                                 00002090
                    FEIL_VED_LABEL = '378';                             00002100
                    FEIL_MELD_NR   = 1738;                              00002110
                    GO TO RETUR;                                        00002120
                 END;                                                   00002130
                                                                        00002140
 /* ***************************************************************** */00002150
 /* HVIS SØKER HAR EKTEFELLE I TRANS                                  */00002160
 /* ***************************************************************** */00002170
                                                                        00002180
    IF U2S.FNR_EK > 0 THEN                                              00002190
       DO;                                                              00002200
          IF  U2S.SIVILSTAND               = 'A' THEN                   00002210
             DO;                                                        00002220
                B02.SIVILSTAND(SØKER_IND)      = 'A';                   00002230
                B02.SIVILSTAND(EKTEF_IND)      = 'A';                   00002240
             END;                                                       00002250
          ELSE                                                          00002260
          IF  U2S.SIVILSTAND               = 'P' THEN                   00002270
             DO;                                                        00002280
                B02.SIVILSTAND(SØKER_IND)      = 'P';                   00002290
                B02.SIVILSTAND(EKTEF_IND)      = 'P';                   00002300
             END;                                                       00002310
          ELSE                                                          00002320
          IF  U2S.SIVILSTAND               = 'W' THEN                   00002330
             DO;                                                        00002340
                B02.SIVILSTAND(SØKER_IND)      = 'W';                   00002350
                B02.SIVILSTAND(EKTEF_IND)      = 'W';                   00002360
             END;                                                       00002370
          ELSE                                                          00002380
          IF  U2S.SIVILSTAND               = 'V' THEN                   00002390
             DO;                                                        00002400
                B02.SIVILSTAND(SØKER_IND)      = 'V';                   00002410
                B02.SIVILSTAND(EKTEF_IND)      = 'V';                   00002420
             END;                                                       00002430
          ELSE                                                          00002440
             DO;                                                        00002450
                B02.SIVILSTAND(SØKER_IND)      = 'G';                   00002460
                B02.SIVILSTAND(EKTEF_IND)      = 'G';                   00002470
             END;                                                       00002480
                                                                        00002490
 /* ***************************************************************** */00002500
 /* HVIS FORSØRGINGSTILLEGG EKTEFELLE                                 */00002510
 /* PENSJONSTYPE1 FOR EKTEFELLEN OG PENSJONSTYPE2 FOR PENSJONISTEN    */00002520
 /* BLE GALT FOR YRKESKADEPENSJONER.  ENDRET 11.1.1990, ERIK.         */00002530
 /* ***************************************************************** */00002540
                                                                        00002550
       /* IF U2S.TILL_EK = 'J' THEN   TEST PÅ B01.ET FJERNET 7.90 JD */ 00002560
          IF U2S.TILL_EK = 'J' & HJ_VIRK_DATO_ÅM > 9104 &               00002570
             B01.PENSJONSTYPE2(SØKER_IND) ^= 'F' THEN                   00002580
             U2S.TILL_EK = ' ' ; /* JD 7.91*/                           00002590
          IF U2S.TILL_EK = 'J' ! B01.UFØRPENS.ET(SØKER_IND) > 0         00002600
               ! B01.GARANTITILLEGG_EK(SØKER_IND) > 0           THEN    00002610
             DO;                                                        00002620
                B02.PENSJONSTYPE2(SØKER_IND)   = 'F';                   00002630
                IF U2S.UFG < 50 THEN                                    00002640
                 DO;                                                    00002650
                    B02.PENSJONSTYPE2(SØKER_IND)   = 'P';               00002660
                    B02.PENSJONSTYPE1(EKTEF_IND)   = 'G';               00002670
                    B02.PENSJONSTYPE2(EKTEF_IND)   = ' ';               00002680
                 END;                                                   00002690
               ELSE                                                     00002700
                 B02.PENSJONSTYPE1(EKTEF_IND)   = 'F';                  00002710
                 B02.PENSJONSTYPE2(EKTEF_IND)   = ' ';                  00002720
             END;                                                       00002730
          ELSE                                                          00002740
             DO;                                                        00002750
                                                                        00002760
 /* ***************************************************************** */00002770
 /* HVIS EKTEFELLEN HAR EGEN PENSJON                                  */00002780
 /* ***************************************************************** */00002790
                                                                        00002800
                                                                        00002810
                IF  B01.PENSJONSTYPE1(EKTEF_IND)    = 'A' !             00002820
                    B01.PENSJONSTYPE1(EKTEF_IND)    = 'Y' !             00002830
                    B01.PENSJONSTYPE1(EKTEF_IND)    = 'K' !             00002840
                    B01.PENSJONSTYPE1(EKTEF_IND)    = 'U' THEN          00002850
                                                                        00002860
 /* ***************************************************************** */00002870
 /* EKTEFELLEN HAR AVTALEFESTET PENSJON SOM IKKE UTBETALES            */00002880
 /* ***************************************************************** */00002890
                                                                        00002900
                    IF B01.PENSJONSTYPE1(EKTEF_IND)    = 'K'  &         00002910
                       B01.PENSJONSTYPE2(EKTEF_IND)    = 'N'  THEN      00002920
                       DO;                                              00002930
                          B02.PENSJONSTYPE2(SØKER_IND)    = 'P';        00002940
                          B02.PENSJONSTYPE2(EKTEF_IND)    = 'N';        00002950
                       END;                                             00002960
                    ELSE                                                00002970
                       IF  U2S.SIVILSTAND               = 'A'   !       00002980
                           U2S.SIVILSTAND               = 'V' THEN      00002990
                          DO;                                           00003000
                             B02.PENSJONSTYPE2(SØKER_IND)   = 'P';      00003010
                             B02.PENSJONSTYPE2(EKTEF_IND)   = 'P';      00003020
                          END;                                          00003030
                       ELSE                                             00003040
                          DO;                                           00003050
                             IF U2Y.KAP_11_7_UTLØST = 'J'  THEN         00003060
                                                                        00003070
                               DO;                                      00003080
                                B02.PENSJONSTYPE2(SØKER_IND) = ' ';     00003090
                                B02.PENSJONSTYPE2(EKTEF_IND) = 'P';     00003100
                               END;                                     00003110
                             ELSE                                       00003120
                               DO;                                      00003130
                             B02.PENSJONSTYPE2(SØKER_IND)   = 'S';      00003140
                             B02.PENSJONSTYPE2(EKTEF_IND)   = 'S';      00003150
                                                             /*AFP1093*/00003160
                          IF B02.PENSJONSTYPE3(EKTEF_IND) = 'S' &       00003170
                             B02.PENSJONSTYPE2(EKTEF_IND) ^= 'N' THEN   00003180
                                 B02.PENSJONSTYPE2(SØKER_IND) = 'P';    00003190
                                                             /*AFP1093*/00003200
                               END;                                     00003210
                          END;                                          00003220
                ELSE                                                    00003230
                   DO;                                                  00003240
                                                                        00003250
 /* ***************************************************************** */00003260
 /* EKTEFELLEN HAR IKKE PENSJON                                       */00003270
 /* ***************************************************************** */00003280
                                                                        00003290
                       IF U2Y.KAP_11_7_UTLØST = 'J'  THEN               00003300
                          B02.PENSJONSTYPE2(SØKER_IND) = ' ';           00003310
                       ELSE                                             00003320
                          B02.PENSJONSTYPE2(SØKER_IND)   = 'P';         00003330
                      B02.PENSJONSTYPE1(EKTEF_IND)   = 'G';             00003340
                      IF U2S.MINST4G = 'J' THEN                         00003350
                         B02.PENSJONSTYPE2(EKTEF_IND)   = 'M';          00003360
                      ELSE                                              00003370
                         B02.PENSJONSTYPE2(EKTEF_IND)   = 'U';          00003380
                   END;                                                 00003390
            END;                                                        00003400
            B02.NAVN(EKTEF_IND)            = U2S.NAVN_EK;               00003410
            B02.SPRÅK(EKTEF_IND)           = U2S.SPRÅK;                 00003420
                                                                        00003430
 /* ***************************************************************** */00003440
 /* TILKN-KODE TIL EKTEFELLENE OPPDATERES MED RESPEKTIVE NYE STATUSER.*/00003450
 /* ***************************************************************** */00003460
                                                                        00003470
            DO I = 1 TO 13;                                             00003480
               IF (B02.FNR_TILKN(SØKER_IND,I)=                          00003490
                                        B02.FNR(EKTEF_IND))THEN         00003500
                  DO;                                                   00003510
                     B02.TILKN.TILKNYTNINGSKODE(SØKER_IND,I)            00003520
                                  =  B02.PENSJONSTYPE1(EKTEF_IND);      00003530
                     I=13;                                              00003540
                  END;                                                  00003550
            END;                                                        00003560
            DO I = 1 TO 13;                                             00003570
               IF (B02.FNR_TILKN(EKTEF_IND,I)=                          00003580
                                        B02.FNR(SØKER_IND))THEN         00003590
                  DO;                                                   00003600
                     B02.TILKNYTNINGSKODE(EKTEF_IND,I)                  00003610
                            =  B02.PENSJONSTYPE1(SØKER_IND);            00003620
                     B02.FT_FØR_91(EKTEF_IND,I) = ' ';                  00003630
                     I=13;                                              00003640
                  END;                                                  00003650
            END;                                                        00003660
       END;                                                             00003670
    ELSE                                                                00003680
                                                                        00003690
 /* **************************************************************** */ 00003700
 /* SØKER HAR IKKE EKTEFELLE                                         */ 00003710
 /* **************************************************************** */ 00003720
                                                                        00003730
       IF ^(B01.PENSJONSTYPE1(SØKER_IND) = 'N' !                        00003740
            B01.PENSJONSTYPE1(SØKER_IND) = 'E' !                        00003750
            B01.PENSJONSTYPE1(SØKER_IND) = 'B')    &                    00003760
          B01.PENSJONSTYPE2(SØKER_IND)  ^= 'E'         THEN             00003770
                                                                        00003780
                       IF U2Y.KAP_11_7_UTLØST = 'J'  THEN               00003790
                          B02.PENSJONSTYPE2(SØKER_IND) = ' ';           00003800
                       ELSE                                             00003810
          B02.PENSJONSTYPE2(SØKER_IND) = 'P';                           00003820
                                                                        00003830
 /* ***************************************************************** */00003840
 /* UFØREPENSJON                                                      */00003850
 /* ***************************************************************** */00003860
                                                                        00003870
    B02.UFØRPENS.UFG(SØKER_IND)           = U2S.UFG;                    00003880
    B02.UFØRPENS.VILKÅR_8_4_3A(SØKER_IND) = U2S.VILKÅR_8_4_3A;          00003890
    B02.UFØRPENS.UTDANNING(SØKER_IND)     = U2S.UTDANNING;              00003900
    B02.UFØRPENS.YRKESM_ATTF(SØKER_IND)   = U2S.YRKESM_ATTF;            00003910
                                                                        00003920
                                                                        00003930
 /* ***************************************************************** */00003940
 /* TRYGDETID                                                         */00003950
 /* ***************************************************************** */00003960
                                                                        00003970
                                                                        00003980
    HJ_UFT_MÅ      = U2S.UFT_MÅ;                                        00003990
                                                                        00004000
    IF U2SP.STI_MÅ            > 0        THEN                           00004010
       HJ_MÅ = U2SP.STI_MÅ;                                             00004020
    ELSE                                                                00004030
       HJ_MÅ = U2S.UFT_MÅ;                                              00004040
                                                                        00004050
    HJ_ÅM = F_SNU_DATO(HJ_MÅ);                                          00004060
    HJ_ÅM_FIX = HJ_ÅM;                                                  00004070
                                                                        00004080
    B02.TT_16_66(SØKER_IND) = U2SP.TT_FRA1937_ÅR * 12 +                 00004090
                              U2SP.TT_FRA1937_MND;                      00004100
    IF B02.TT_16_66(SØKER_IND) > 480     THEN                           00004110
       B02.TT_16_66(SØKER_IND) = 480;    /*080694 HL*/                  00004120
                                                                        00004130
 /* ***************************************************************** */00004140
 /* HVIS SPESIELLE OPPLYSNINGER                                       */00004150
 /* ***************************************************************** */00004160
                                                                        00004170
    B02.SPESOPPL(SØKER_IND) = '';                                       00004180
                                                                        00004190
    IF U2S.NORSK_BOSATT = 'N'  THEN                                     00004200
       DO;                                                              00004210
          IF U2SP.TT_KONVENSJON_ÅR > 0            THEN                  00004220
              DO;                                                       00004230
                 B02.TT_16_66(SØKER_IND) = U2SP.TT_KONVENSJON_ÅR * 12;  00004240
                 IF B02.TT_16_66(SØKER_IND) > 480     THEN              00004250
                    B02.TT_16_66(SØKER_IND) = 480;                      00004260
              END;                                                      00004270
                                                                        00004280
          ELSE                                                          00004290
             /*RETT TIL TIDLIGERE TT HVIS IKKE UTFYLT : */              00004300
          IF B02.TT_16_66(SØKER_IND) = 0          THEN                  00004310
             DO;                                                        00004320
                B02.TT_FRAMT(SØKER_IND) =                               00004330
                    (ALDER_67.ÅR * 12) - (HJ_Å * 12 + HJ_M -1);         00004340
                IF B02.TT_FRAMT(SØKER_IND) < 0 THEN                     00004350
                   B02.TT_FRAMT(SØKER_IND) = 0;                         00004360
                IF B01.TT_16_66(SØKER_IND)  > 0    THEN                 00004370
                   HJELP = (B01.TT_16_66(SØKER_IND)                     00004380
                            +  B01.TT_FRAMT(SØKER_IND) + 11) / 12;      00004390
                ELSE                                                    00004400
                   HJELP = B01.TT_FØR_1967(SØKER_IND)                   00004410
                       + (B01.TT_ETTER_1966(SØKER_IND)                  00004420
                       +  B01.TT_FRAMT(SØKER_IND) + 11) / 12;           00004430
                B02.TT_16_66(SØKER_IND) = HJELP * 12                    00004440
                                        - B02.TT_FRAMT(SØKER_IND);      00004450
             END;                                                       00004460
          ELSE                                                          00004470
            DO;     /*FRAVIK FLYKN GAV RED ANT BUP ÅR. TRUDE 100992 */  00004480
               IF  U2SP.FRAVIK_FLYKT = 'J' THEN                         00004490
                   B02.STATUS.TT_FRAMT(SØKER_IND) =                     00004500
                          (ALDER_67.ÅR * 12) - (HJ_Å * 12 + HJ_M);      00004510
               ELSE                                                     00004520
              B02.STATUS.TT_FRAMT(SØKER_IND) = F_BEREGN_TT_FRAMT_UTLAND 00004530
                           (B02.FNR(SØKER_IND),HJ_ÅM_FIX,SØKER_IND);    00004540
                IF B02.TT_FRAMT(SØKER_IND) < 0 THEN                     00004550
                   B02.TT_FRAMT(SØKER_IND) = 0;                         00004560
            END;                                                        00004570
                                                                        00004580
          B02.SPESOPPL.STATSBORGER(SØKER_IND)   = U2SP.STATSBORGER;     00004590
          B02.SPESOPPL.BOSATT(SØKER_IND)        = U2SP.BOSATT;          00004600
       B02.SPESOPPL.PENSJONSTRYGDET(SØKER_IND) = U2SP.PENSJONSTRYGDET;  00004610
          B02.SPESOPPL.MINST_20ÅR_BOTID(SØKER_IND) = U2SP.MINST_20_ÅR;  00004620
          B02.SPESOPPL.FRAVIK_BOSATT_KONVENSJON(SØKER_IND) =            00004630
                                                     U2SP.KONVENSJON;   00004640
          B02.SPESOPPL.FRAVIK_FLYKTN(SØKER_IND) = U2SP.FRAVIK_FLYKT;    00004650
          IF U2SP.OVERKOMP_UTL = 'J'             THEN                   00004660
             B02.SPESOPPL.OVERKOMP_UTL(SØKER_IND)  = 'J';               00004670
          ELSE                                                          00004680
             B02.SPESOPPL.OVERKOMP_UTL(SØKER_IND)  = 'N';               00004690
          B02.SPESOPPL.IKKE_GP      (SØKER_IND) = U2SP.IKKE_GP;         00004700
          B02.SPESOPPL.KONVENSJON(SØKER_IND) =  U2SP.BEREGNING_KONV;    00004710
          B02.SPESOPPL.FRAVIK_8_1(SØKER_IND)  =  U2SP.FRAVIK_8_1_NR3;   00004720
          B02.UFØRPENS.STI(SØKER_IND) = F_SNU_DATO(U2SP.STI_MÅ);        00004730
                                                                        00004740
       END;                                                             00004750
                                                                        00004760
    ELSE                                                                00004770
       B02.STATUS.TT_FRAMT(SØKER_IND) =                                 00004780
           (ALDER_67.ÅR * 12) - (HJ_Å * 12 + HJ_M);                     00004790
                                                                        00004800
                IF B02.TT_FRAMT(SØKER_IND) < 0 THEN                     00004810
                   B02.TT_FRAMT(SØKER_IND) = 0;                         00004820
    B02.TT_FØR_1967(SØKER_IND)   = 0;                                   00004830
    B02.TT_ETTER_1966(SØKER_IND) = 0;                                   00004840
                                                                        00004850
 /* ***************************************************************** */00004860
 /* PENSJONSGIVENDE INNTEKT                                           */00004870
 /* ***************************************************************** */00004880
                                                                        00004890
 %SKIP;                                                                 00004900
    ÅR_FØR_UFØRHET = HJ_UFT_Å - 1;                                      00004910
                                                                        00004920
 /* ***************************************************************** */00004930
 /* HER MÅ VI TESTE PÅ EN KODE FOR Å SE OM VI HAR FÅTT RAPP. INNTEKT  */00004940
 /* ***************************************************************** */00004950
                                                                        00004960
    IF ÅR_FØR_UFØRHET            > 66     THEN                          00004970
       IF B01.PINNTEKT.PI_KODE(SØKER_IND,ÅR_FØR_UFØRHET) = ' ' !        00004980
          B01.PINNTEKT.PI_KODE(SØKER_IND,ÅR_FØR_UFØRHET) = 'F' THEN     00004990
          DO;                                                           00005000
             IF U2S.PI > 0 THEN                                         00005010
                DO;                                                     00005020
                   B02.PI_KODE(SØKER_IND,ÅR_FØR_UFØRHET) = 'F';         00005030
                   B02.PI(SØKER_IND,ÅR_FØR_UFØRHET)      =              00005040
                                                          U2S.PI / 100; 00005050
                END;                                                    00005060
          END;                                                          00005070
                                                                        00005080
 /* ***************************************************************** */00005090
 /* UFØREHISTORIKK                                                    */00005100
 /* ***************************************************************** */00005110
                                                                        00005120
    DO I = 1 TO 7;              /*0697 HL*/                             00005130
       SELECT;                                                          00005140
         WHEN(B01.UFØRHIST.UFT_ÅM(SØKER_IND,I) = F_SNU_DATO(U2S.UFT_MÅ))00005150
                                                                        00005160
 /* ***************************************************************** */00005170
 /* D.V.S VI HAR EN PERIODE FRA FØR MED SAMME UFTIDSPUNKT             */00005180
 /* ***************************************************************** */00005190
                                                                        00005200
         DO;                                                            00005210
           DO J = 1 TO 7;    /*0697 HL*/                                00005220
              IF B02.UFG_ØVRIGE(SØKER_IND,I,J) > 0 THEN                 00005230
                 DO;                                                    00005240
                    B02.UFG_ØVRIGE(SØKER_IND,I,J) = 0;                  00005250
                    B02.UFG_DATO_ÅM(SØKER_IND,I,J) = 0;                 00005260
                 END;                                                   00005270
              ELSE                                                      00005280
                 J=7;           /*0697 HL*/                             00005290
            END;                                                        00005300
            DIV_PARAM_OMR.REGN_1291 = ' ';    /*HL*/                    00005310
                                                                        00005320
            UF_IND = I;                                                 00005330
            B02.UFØRHIST.UFG(SØKER_IND,I)= U2S.UFG;                     00005340
                                                                        00005350
 /*HL : UFKRIT BLE ALLTID SATT > 0 FOR YRKESSKADDE - RETTET 2.4.91*/    00005360
                                                                        00005370
            IF U2S.VILKÅR_8_4_3A = 'J' THEN                             00005380
               IF U2S.YSKADE_TILLEGG = 'J' THEN                         00005390
                  IF U2Y.KAP_11_7_UTLØST = 'J'    THEN                  00005400
                     B02.UFKRITERIER(SØKER_IND,I) = 5;                  00005410
                  ELSE                                                  00005420
                     B02.UFKRITERIER(SØKER_IND,I) = 4;                  00005430
               ELSE                                                     00005440
                  B02.UFKRITERIER(SØKER_IND,I) = 2;                     00005450
            ELSE                                                        00005460
               B02.UFKRITERIER(SØKER_IND,I) = 0;                        00005470
            IF B01.BUP_GAR_KODE(SØKER_IND,I) = 'A' THEN                 00005480
               DO;                                                      00005490
                  IF HJ_VIRK_DATO_ÅM >= TJUEÅRSDATO  THEN               00005500
                     B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';               00005510
               END;                                                     00005520
            I = 7;            /*0697 HL*/                               00005530
         END;                                                           00005540
         WHEN (B01.UFØRHIST.UFT_ÅM(SØKER_IND,I) = 0)                    00005550
         DO;                                                            00005560
                                                                        00005570
 /* ***************************************************************** */00005580
 /* D.V.S. DETTE ER FØRSTE LEDIGE PLASS.                              */00005590
 /* ***************************************************************** */00005600
                                                                        00005610
            UF_IND = I;                                                 00005620
            B02.UFØRHIST.UFT_ÅM(SØKER_IND,I) = F_SNU_DATO(U2S.UFT_MÅ);  00005630
            B02.UFØRHIST.UFG(SØKER_IND,I)    = U2S.UFG;                 00005640
            IF U2S.VILKÅR_8_4_3A = 'J' THEN                             00005650
               B02.UFKRITERIER(SØKER_IND,I) = 2;                        00005660
            IF UF_IND > 1 THEN                                          00005670
               DO;                                                      00005680
                                                                        00005690
 /* ***************************************************************** */00005700
 /* DET FINNES EN FORRIGE PERIODE SOM VI NÅ OPPHØRER                  */00005710
 /* ***************************************************************** */00005720
                                                                        00005730
                  IF B01.OPPHØRSDATO_ÅM(SØKER_IND,(I-1)) = 0  THEN      00005740
                     DO;                                                00005750
                        B02.OPPHØRSDATO_ÅM(SØKER_IND,(I-1))             00005760
                                       = F_SNU_DATO(U2S.UFT_MÅ);        00005770
                        B02.OPPHØRSKODE(SØKER_IND,(I-1)) = 'J';         00005780
     /*0697 HL*/        DO J = 1 TO 7 WHILE (B02.UFG_ØVRIGE(SØKER_IND,  00005790
                                      (I-1), J) > 0);                   00005800
                           IF B02.UFG_DATO_ÅM(SØKER_IND,(I-1),J) =      00005810
                              B02.UFØRHIST.UFT_ÅM(SØKER_IND,I)  THEN    00005820
                                                                        00005830
                                       /* DET NYE UFØRETIDSPT ER LIK */ 00005840
                                       /* TIDSPT TIL SISTE UFØREGRAD */ 00005850
                                       /* I FORRIGE PERIODE OG MÅ    */ 00005860
                                       /* SLETTES                    */ 00005870
                              DO;                                       00005880
                                 B02.UFG_ØVRIGE(SØKER_IND,(I-1),J) = 0; 00005890
                                 B02.UFG_DATO_ÅM(SØKER_IND,(I-1),J) = 0;00005900
                                 B01.UFG_ØVRIGE(SØKER_IND,(I-1),J) = 0; 00005910
                                 B01.UFG_DATO_ÅM(SØKER_IND,(I-1),J) = 0;00005920
                              END;                                      00005930
                           ELSE                                         00005940
                           IF B02.UFG_DATO_ÅM(SØKER_IND,(I-1),J) >      00005950
                              B02.UFØRHIST.UFT_ÅM(SØKER_IND,I)  THEN    00005960
                              DO;                                       00005970
 /* ***************************************************************** */00005980
 /* FEIL, UFØREDATO I FORRIGE PERIODE ER ETTER DET NYE UFØRETIDSPUNKT */00005990
 /* ***************************************************************** */00006000
                                                                        00006010
  L278:                                                                 00006020
                                   FEIL_VED_LABEL = '278';              00006030
                                   FEIL_MELD_NR   = 1711;               00006040
                                   GO TO RETUR;                         00006050
                              END;                                      00006060
                        END;  /* DO J = 1 TO 7 */                       00006070
                  END;                                                  00006080
                                                                        00006090
 /* ***************************************************************** */00006100
 /* HER OVERFØRES BU2-GARANTI OG KODE FRA FORRIGE PERIODE             */00006110
 /* ***************************************************************** */00006120
                                                                        00006130
                  B02.BUP_GARANTI(SØKER_IND,I) =                        00006140
                                    B02.BUP_GARANTI(SØKER_IND,(I-1));   00006150
                  B02.BUP_GAR_KODE(SØKER_IND,I) =                       00006160
                                   B02.BUP_GAR_KODE(SØKER_IND,(I-1));   00006170
                  IF B02.BUP_GAR_KODE(SØKER_IND,I) = 'A'                00006180
                                                                    THEN00006190
                     DO;                                                00006200
                        IF HJ_VIRK_DATO_ÅM >= TJUEÅRSDATO  THEN         00006210
                           B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';         00006220
                     END;                                               00006230
                                                                        00006240
                  ELSE                                                  00006250
                  IF B02.BUP_GAR_KODE(SØKER_IND,I) = 'C' THEN           00006260
                                    B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';00006270
   /*FJERNET 9708 HL*/                                                  00006280
                                                                        00006290
               END;                                                     00006300
            ELSE                                                        00006310
               CALL UNGE_UFØRE;   /*9708 HL*/                           00006320
 /* ***************************************************************** */00006330
 /* DET ER INGEN FORRRIGE PERIODE                                     */00006340
 /* ***************************************************************** */00006350
                                                                        00006360
                         I = 7;          /*0697 HL*/                    00006370
                   END;                                                 00006380
                OTHERWISE                                               00006390
                   DO;                                                  00006400
                                                                        00006410
                      DIV_PARAM_OMR.REGN_1291 = ' ';    /*HL*/          00006420
 /* ***************************************************************** */00006430
 /* ALLE UFØREPERIODENE ER UTFYLT                                     */00006440
 /* ***************************************************************** */00006450
                                                                        00006460
                      IF I = 7 THEN         /*0697 HL*/                 00006470
                         DO;                                            00006480
                                                                        00006490
 /* ***************************************************************** */00006500
 /* FEIL, ALLE UFØREPERIODENE ER UTFYLT, IKKE PLASS TIL EN TIL        */00006510
 /* ***************************************************************** */00006520
                                                                        00006530
  L279:                                                                 00006540
                            FEIL_VED_LABEL = '279';                     00006550
                            FEIL_MELD_NR   = 1715;                      00006560
                            GO TO RETUR;                                00006570
                         END;                                           00006580
                 END;                                                   00006590
               END;                                                     00006600
          END;                                                          00006610
                                                                        00006620
              /* NY 93 */                                               00006630
    IF B02.BOSATT(SØKER_IND)         > 0 &                      /*93*/  00006640
       B02.VIRK_DATO_ÅM(SØKER_IND)   > 9212 &                   /*93*/  00006650
       B02.PENSJONSTRYGDET(SØKER_IND)         ^= 'J' THEN       /*93*/  00006660
         DO;                                                    /*93*/  00006670
           IF B02.UFØRHIST.BUP_GAR_KODE(SØKER_IND,1) = 'B' !    /*93*/  00006680
              B02.UFØRHIST.BUP_GAR_KODE(SØKER_IND,1) = 'E' THEN /*93*/  00006690
            DO;                                                         00006700
             DO M = 1 TO 7;           /*0697 HL*/                       00006710
              B02.BUP_GAR_KODE(SØKER_IND,M) = ' ';               /*93*/ 00006720
              B02.BUP_GARANTI(SØKER_IND,M) = 0;                  /*93*/ 00006730
             END;                                                /*93*/ 00006740
            END;                                                /*93*/  00006750
            B01.GT_LOV92(SØKER_IND)  = 0;                       /*93*/  00006760
            B02.GT_LOV92(SØKER_IND)  = 0;                       /*93*/  00006770
                                                                        00006780
            IF B01.UFØRPENS.STI(SØKER_IND)     > 0  !                   00006790
               B02.UFØRPENS.STI(SØKER_IND)     > 0  THEN                00006800
             DO;                                                        00006810
               B02.SUM_YTELSE(SØKER_IND)     = 0;                       00006820
               CALL UFØREPENSJON_OPPHØRER;             /*R0019940*/     00006830
               CALL P900_NOR_DATA(B01.FNR(SØKER_IND),                   00006840
                                  B01.TKNR(SØKER_IND));                 00006850
             END;                                                       00006860
         END;                                                   /*93*/  00006870
         /* 93 */                                                       00006880
                                                                        00006890
    IF B01.PENSJONSTYPE3(SØKER_IND) = 'A' THEN                          00006900
       B01.UFØRHIST(SØKER_IND,K) =                                      00006910
                                   B00.UFØRHIST(SØKER_IND,K);           00006920
                                                                        00006930
 /* ***************************************************************** */00006940
 /* SØKEREN HAR ATTFØRING FRA FØR.SS = NS OG NS BLIR FJERNET.         */00006950
 /* ***************************************************************** */00006960
                                                                        00006970
    IF U2S.ATT_UF = 'A' THEN                                            00006980
       IF (STATUS_TYPE = 'B' &                                          00006990
          TRANS_LISTE_INDEX > 1)  THEN                                  00007000
          IF B01.PENSJONSTYPE1(SØKER_IND)  = 'U' &                      00007010
             B01.PENSJONSTYPE3(SØKER_IND) ^= 'A' THEN                   00007020
             DO;                                                        00007030
                B02                         = B01                  ;    00007040
                B01 = '';                                               00007050
                B00 = '';                                               00007060
             END;                                                       00007070
                                                                        00007080
 /* ***************************************************************** */00007090
 /* VERNEPLIKTOPPLYSNINGER                                            */00007100
 /* ***************************************************************** */00007110
                                                                        00007120
    DO I = 1 TO 4 WHILE (U2S.VP_ÅR(I) > 0);                             00007130
       B02.VERNEPLIKTÅR(SØKER_IND,I) = U2S.VP_ÅR(I);                    00007140
    END;                                                                00007150
                                                                        00007160
                                                                        00007170
                                                                        00007180
                                                                        00007190
 /* ***************************************************************** */00007200
 /*                                                                   */00007210
 /* YRKESSKADEOPPLYSNINGER.  ERIK 2.7.87.                             */00007220
 /*                                                                   */00007230
 /* ***************************************************************** */00007240
                                                                        00007250
                                                                        00007260
  %SKIP;                                                                00007270
                                                                        00007280
   IF U2S.YSKADE_TILLEGG = 'J' THEN                                     00007290
                                                                        00007300
 /*   ENDRET 20.7.89 HL - BARE KAP.8 - GRAD ER ENDRET */                00007310
                                                                        00007320
      IF B01.YRKEPENS.YUG(SØKER_IND) = U2Y.YUG     &                    00007330
         B01.UFØRPENS.UFG(SØKER_IND)^= U2S.UFG     THEN ;               00007340
      ELSE                                                              00007350
                                                                        00007360
 /*TILLEGG 13.3.90 HL */                                                00007370
                                                                        00007380
    IF B01.YRKEPENS.YUG(SØKER_IND) > U2Y.YUG     THEN                   00007390
       DO;                                                              00007400
 L280:                                                                  00007410
          FEIL_VED_LABEL = '280';                                       00007420
          FEIL_MELD_NR   =  1737;                                       00007430
          GO TO RETUR;                                                  00007440
       END;                                                             00007450
    ELSE                                                                00007460
                                                                        00007470
 /*HIT 13.3.90 HL*/                                                     00007480
                                                                        00007490
 DO I = 1 TO 5;                                                         00007500
    YUF_IND = I;                                                        00007510
 SELECT;                                                                00007520
    WHEN (B01.YRKEHIST.YUFT_ÅM(SØKER_IND,I) =                           00007530
                 F_SNU_DATO(U2S.UFT_MÅ))                                00007540
       DO;                                                              00007550
          B02.YRKEHIST.YUG(SØKER_IND,I)    = U2Y.YUG;                   00007560
          I = 5;                                                        00007570
       END;                                                             00007580
    WHEN (B01.YRKEHIST.YUFT_ÅM(SØKER_IND,I) = 0)                        00007590
       DO;                                                              00007600
          B02.YRKEHIST.YUFT_ÅM(SØKER_IND,I) =                           00007610
                                F_SNU_DATO(U2S.UFT_MÅ);                 00007620
          B02.YRKEHIST.YUG(SØKER_IND,I)    = U2Y.YUG;                   00007630
                                                                        00007640
          IF (I > 1)  & (B01.YRKEHIST.OPPH_DATO_ÅM                      00007650
                   (SØKER_IND,(I-1)) = 0 ) THEN                         00007660
             DO;                                                        00007670
                                                                        00007680
                B02.YRKEHIST.OPPH_DATO_ÅM(SØKER_IND,(I-1)) =            00007690
                                F_SNU_DATO(U2S.UFT_MÅ);                 00007700
                B02.YRKEHIST.OPPH_KODE(SØKER_IND,(I-1)) = 'J';          00007710
                                                                        00007720
                DO J = 1 TO 5 WHILE                                     00007730
                   (B02.YUG_ØVRIGE(SØKER_IND,(I-1),J) > 0);             00007740
                                                                        00007750
                   IF B02.YUG_DATO_ÅM(SØKER_IND,(I-1),J) =              00007760
                      B02.YRKEHIST.YUFT_ÅM(SØKER_IND,I) THEN            00007770
                      DO;                                               00007780
                         B02.YUG_ØVRIGE(SØKER_IND,(I-1),J) = 0;         00007790
                         B02.YUG_DATO_ÅM(SØKER_IND,(I-1),J)= 0;         00007800
                         B01.YUG_ØVRIGE(SØKER_IND,(I-1),J) = 0;         00007810
                         B01.YUG_DATO_ÅM(SØKER_IND,(I-1),J)= 0;         00007820
                      END;                                              00007830
                   IF B02.YUG_DATO_ÅM(SØKER_IND,(I-1),J) >              00007840
                      B02.YRKEHIST.YUFT_ÅM(SØKER_IND,I) THEN            00007850
                      DO;                                               00007860
  /*  ********************************************* */                  00007870
  /*  Y-UFØRETIDSPUNKT LIGGER FØR OPPHØRSTIDSPUNKT  */                  00007880
  /*  ********************************************* */                  00007890
                                                                        00007900
                                                                        00007910
        L281:                                                           00007920
                         FEIL_VED_LABEL = '281';                        00007930
                         FEIL_MELD_NR   =  1711;                        00007940
                         GO TO RETUR;                                   00007950
                      END;                                              00007960
                END;                                                    00007970
        /*   I = 5    TRUDE */                                          00007980
          END;                                                          00007990
             I = 5;                                                     00008000
       END;                                                             00008010
    OTHERWISE                                                           00008020
       DO;                                                              00008030
          IF I = 5 THEN                                                 00008040
                                                                        00008050
  /*  ********************************************* */                  00008060
  /*  ALLE PERIODENE UTFYLT.  IKKE MER PLASS.       */                  00008070
  /*  ********************************************* */                  00008080
                                                                        00008090
 L282:                                                                  00008100
             DO;                                                        00008110
                FEIL_VED_LABEL = '282';                                 00008120
                FEIL_MELD_NR   =  1715;                                 00008130
                GO TO RETUR;                                            00008140
             END;                                                       00008150
       END;                                                             00008160
 END; /*SELECT*/                                                        00008170
 END;    /*DO I= 1 TO 5*/                                               00008180
                                                                        00008190
  IF U2S.YSKADE_TILLEGG = 'J' THEN                                      00008200
                                                                        00008210
 /*YS ENDRET 20.7.89 HL - BARE KAP.8 - GRAD ER ENDRET */                00008220
                                                                        00008230
    IF B01.YRKEPENS.YUG(SØKER_IND) = U2Y.YUG     &                      00008240
       B01.UFØRPENS.UFG(SØKER_IND)^= U2S.UFG     THEN ;                 00008250
    ELSE                                                                00008260
    DO;                                                                 00008270
       B02.YRKEPENS.YUG(SØKER_IND) = U2Y.YUG;                           00008280
       B02.YRKEHIST.YST_ÅM(SØKER_IND,YUF_IND) =                         00008290
                                F_SNU_DATO(U2Y.YST_MÅ);                 00008300
       B02.YRKEHIST.AÅI(SØKER_IND,YUF_IND) = U2Y.AÅI;                   00008310
       B02.YRKEHIST.YRKE11(SØKER_IND,YUF_IND) = U2Y.YRKE11;             00008320
       B02.YRKEHIST.VILKÅR_1_2_2(SØKER_IND,YUF_IND)=                    00008330
                          U2Y.VILKÅR_1_2_2A !! U2Y.VILKÅR_1_2_2B;       00008340
       B02.YRKEHIST.KAP_11_7_UTLØST(SØKER_IND,YUF_IND) =                00008350
                                             U2Y.KAP_11_7_UTLØST;       00008360
       B02.YRKEPENS.YSYKDOM(SØKER_IND) = U2Y.YSYKDOM        ;           00008370
       DIV_PARAM_OMR.YSYKDOM        = U2Y.YSYKDOM        ;              00008380
 /* ***************************************************************** */00008390
 /*YS - VI SKAL AVVISE :  1) NY YRKESSKADE FOR EN SOM HAR Y FRA FØR   */00008400
 /*YS                     2) ENGANGSUTLØSNING FOR EN SOM HAR UFØRHIST */00008410
 /*YS                                                                 */00008420
 /* ***************************************************************** */00008430
                                                                        00008440
       IF B01.PENSJONSTYPE1(SØKER_IND) = 'Y'      &                     00008450
          YUF_IND                      > 1        &                     00008460
          B02.YRKEHIST.YST_ÅM(SØKER_IND,YUF_IND) ^=                     00008470
          B02.YRKEHIST.YST_ÅM(SØKER_IND,YUF_IND-1) THEN                 00008480
                                                                        00008490
          DO;                                                           00008500
 L283:                                                                  00008510
             FEIL_VED_LABEL = '283';                                    00008520
             FEIL_MELD_NR   = 1728;                                     00008530
             GO TO RETUR;                                               00008540
          END;                                                          00008550
                                                                        00008560
       IF (B01.PENSJONSTYPE1(SØKER_IND) = 'Y'      !                    00008570
           B01.PENSJONSTYPE1(SØKER_IND) = 'U'  )   &                    00008580
          U2Y.KAP_11_7_UTLØST ^= ' '             THEN                   00008590
                                                                        00008600
          DO;                                                           00008610
 L284:                                                                  00008620
             FEIL_VED_LABEL = '284';                                    00008630
             FEIL_MELD_NR   = 1729;                                     00008640
             GO TO RETUR;                                               00008650
          END;                                                          00008660
    END;                                                                00008670
                                                                        00008680
                                                                        00008690
  /*RULLERING AV INNTEKTER - 9802 HL : */                               00008700
    IF B02.FORVENTET(SØKER_IND) > 0          THEN                       00008710
       CALL RULL_FORVENTET(B02.G_DATO_ÅM(SØKER_IND),                    00008720
                           B02.VIRK_DATO_ÅM(SØKER_IND),                 00008730
                           B02.FORVENTET(SØKER_IND));                   00008740
                                                                        00008750
    IF B02.FORSI.PENSJONSINNTEKT(SØKER_IND) > 0  THEN                   00008760
       B02.FORSI.PENSJONSINNTEKT(SØKER_IND) =                           00008770
           F_RULL_FORSI(B02.G_DATO_ÅM(SØKER_IND),                       00008780
                 B02.VIRK_DATO_ÅM(SØKER_IND),                           00008790
                 B02.FORSI.PENSJONSINNTEKT(SØKER_IND));                 00008800
                                                                        00008810
    IF B02.FORSI.ARBEIDSINNTEKT(SØKER_IND) > 0  THEN                    00008820
       B02.FORSI.ARBEIDSINNTEKT(SØKER_IND) =                            00008830
           F_RULL_FORSI(B02.G_DATO_ÅM(SØKER_IND),                       00008840
                 B02.VIRK_DATO_ÅM(SØKER_IND),                           00008850
                 B02.FORSI.ARBEIDSINNTEKT(SØKER_IND));                  00008860
                                                                        00008870
    IF B02.FORSI.PENSJONSINNTEKT_EK(SØKER_IND) > 0  THEN                00008880
       B02.FORSI.PENSJONSINNTEKT_EK(SØKER_IND) =                        00008890
           F_RULL_FORSI(B02.G_DATO_ÅM(SØKER_IND),                       00008900
                  B02.VIRK_DATO_ÅM(SØKER_IND),                          00008910
                  B02.FORSI.PENSJONSINNTEKT_EK(SØKER_IND));             00008920
                                                                        00008930
    IF B02.FORSI.ARBEIDSINNTEKT_EK(SØKER_IND) > 0  THEN                 00008940
       B02.FORSI.ARBEIDSINNTEKT_EK(SØKER_IND) =                         00008950
           F_RULL_FORSI(B02.G_DATO_ÅM(SØKER_IND),                       00008960
                 B02.VIRK_DATO_ÅM(SØKER_IND),                           00008970
                 B02.FORSI.ARBEIDSINNTEKT_EK(SØKER_IND));               00008980
                                                                        00008990
 /* RULLERING AV EKTEFELLES INNTEKTER - 9802 HL */                      00009000
    IF B02.ALDERSP.FAI(EKTEF_IND) > 0   THEN                            00009010
       CALL RULL_FAI(B02.G_DATO_ÅM(EKTEF_IND),                          00009020
                     B02.VIRK_DATO_ÅM(EKTEF_IND),                       00009030
                     B02.ALDERSP.FAI(EKTEF_IND));                       00009040
                                                                        00009050
    IF B02.FORSI.PENSJONSINNTEKT(EKTEF_IND) > 0  THEN                   00009060
       B02.FORSI.PENSJONSINNTEKT(EKTEF_IND) =                           00009070
           F_RULL_FORSI(B02.G_DATO_ÅM(EKTEF_IND),                       00009080
                 B02.VIRK_DATO_ÅM(EKTEF_IND),                           00009090
                 B02.FORSI.PENSJONSINNTEKT(EKTEF_IND));                 00009100
                                                                        00009110
    IF B02.FORSI.ARBEIDSINNTEKT(EKTEF_IND) > 0  THEN                    00009120
       B02.FORSI.ARBEIDSINNTEKT(EKTEF_IND) =                            00009130
           F_RULL_FORSI(B02.G_DATO_ÅM(EKTEF_IND),                       00009140
                 B02.VIRK_DATO_ÅM(EKTEF_IND),                           00009150
                 B02.FORSI.ARBEIDSINNTEKT(EKTEF_IND));                  00009160
                                                                        00009170
    IF B02.FORSI.PENSJONSINNTEKT_EK(EKTEF_IND) > 0  THEN                00009180
       B02.FORSI.PENSJONSINNTEKT_EK(EKTEF_IND) =                        00009190
           F_RULL_FORSI(B02.G_DATO_ÅM(EKTEF_IND),                       00009200
                  B02.VIRK_DATO_ÅM(EKTEF_IND),                          00009210
                  B02.FORSI.PENSJONSINNTEKT_EK(EKTEF_IND));             00009220
                                                                        00009230
    IF B02.FORSI.ARBEIDSINNTEKT_EK(EKTEF_IND) > 0  THEN                 00009240
       B02.FORSI.ARBEIDSINNTEKT_EK(EKTEF_IND) =                         00009250
           F_RULL_FORSI(B02.G_DATO_ÅM(EKTEF_IND),                       00009260
                 B02.VIRK_DATO_ÅM(EKTEF_IND),                           00009270
                 B02.FORSI.ARBEIDSINNTEKT_EK(EKTEF_IND));               00009280
                                                                        00009290
                                                                        00009300
  RETUR:                                                                00009310
   END AJOURFØR_B02_MED_U2TRANS;                                        00009320
