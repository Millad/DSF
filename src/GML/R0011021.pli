 /*       SIST ENDRET 01/12-89 08.37.59 AV   DYBVIK                   */00000000
 /*       SIST ENDRET 29/03-88 13.12.32 AV   DYBVIK                   */00000010
 /*       SIST ENDRET 13/08-84 11.50.10 AV   KARIN                    */00000020
 /*       SIST ENDRET 27/03-84 17.09.05 AV   KARIN                    */00000030
 /*       SIST ENDRET 12/09-83 09.11.40 AV   OLAV                     */00000040
 /*       SIST ENDRET 14/01-83 14.38.15 AV   FARVIK                   */00000050
 /* ************************************************************* */    00000060
 /*IDENTIFIKASJON:                                                */    00000070
 /*     R0011021 PLI                                              */    00000080
 /*     PROGRAMMERER: GEIR, APRIL 1982                            */    00000090
 /* ************************************************************* */    00000100
 /*ENDRINGDATO 23/3-84                                            */    00000110
 /*ENDRINGEN GJELDER : DET ER BEHOV FOR Å REGISTRERE FORELDRELØSE */    00000120
 /*                    BARN UTEN OPPLYSNINGER OM AVDØDE, AVDØDES  */    00000130
 /*                    FNR I TRANSEN ER DA LIK (11)'1'.           */    00000140
 /*                    ENDRINGEN VEDRØRER DETTE FORHOLDET.        */    00000150
 /*ENDRET AV KARIN                                                */    00000160
 /* ************************************************************* */    00000170
 /*ENDRINGDATO 13/8-84                                            */    00000180
 /*ENDRINGEN GJELDER : FEIL VED BEREGNING AV FARENS FRAMTIDIGE    */    00000190
 /*                    TRYGDETID. DET VAR KOPIERT FRA MORENS      */    00000200
 /*                    BEREGNIG OG ET FELT TILHøRTE MOREN FORT-   */    00000210
 /*                    SATT.                                      */    00000220
 /*ENDRET AV KARIN                                                */    00000230
 /* ************************************************************* */    00000240
 /*HENSIKT:                                                       */    00000250
 /*     OPPRETT PENSJONSSTATUS FOR SØKER FRA TRANSEN              */    00000260
 /*PROGRAMTILKNYTNING:                                            */    00000270
 /*     INCLUDES I R0011020                                       */    00000280
 /*BRUK:                                                          */    00000290
 /*     CALL OPPRETT_STATUS_FB_BARN                               */    00000300
 /*                                                               */    00000310
 /* ************************************************************* */    00000320
 %SKIP;                                                                 00000330
 OPPRETT_STATUS_FB_BARN:                                                00000340
   PROC(IND);                                                           00000350
    DCL                                                                 00000360
       HJ_DØD                        PIC '999999',                      00000370
       HJ_DØD_Å DEF HJ_DØD POS(5)    PIC '99',                          00000380
 /*YS*/HJ_DØD_M DEF HJ_DØD POS(3)    PIC '99',                          00000390
 /*YS*/HJ_DØD_ÅM                     PIC '9999',                        00000400
 /*YS*/W2_DØD_Å DEF HJ_DØD_ÅM POS(1) PIC '99',                          00000410
 /*YS*/W2_DØD_M DEF HJ_DØD_ÅM POS(3) PIC '99',                          00000420
       IND                           FIXED BIN (15),                    00000430
       TT_FRAMT_MOR                  FIXED BIN (3),                     00000440
       TT_FRAMT_FAR                  FIXED BIN (3),                     00000450
       ÅR_FØR_DØD                    PIC '99';                          00000460
                                                                        00000470
      HJ_VIRK_DATO_ÅM = F_SNU_DATO(BARN_GEN.VIRK_DATO_MÅ);              00000480
 %SKIP;                                                                 00000490
      B02.PENSJONSTYPE1(IND) = 'B';                                     00000500
                                                                        00000510
 /* ************************************************************* */    00000520
 /* DERSOM BARNET ER YNGSTE BARN                                  */    00000530
 /* ************************************************************* */    00000540
                                                                        00000550
      IF IND = 3 THEN                                                   00000560
         DO;                                                            00000570
   /*       B02.PENSJONSTYPE2(IND) = 'Y';  ENDRET 15.03.88  SATISH    */00000580
            B02.PENSJONSTYPE2(IND) = 'P';                               00000590
                                                                        00000600
 /* ***************************************************************** */00000610
 /* OPPLYSNING OM AVDØDE MOR                                          */00000620
 /* ***************************************************************** */00000630
                                                                        00000640
            IF MOR.FNR_M ^= (11)'1' THEN                                00000650
               DO;                                                      00000660
                  B02.RF0PERSN.NAVN(1)         = MOR.NAVN_M;            00000670
                  B02.STATUS.VILKÅR_8_4_3A(1)  = MOR.VILKÅR_8_4_3A_M;   00000680
                  B02.SPESOPPL.OVERKOMP_UTL(1) = MOR.                   00000690
                                                 OVERKOMP_M;            00000700
                  B02.TT_FØR_1967(1)           = MOR.                   00000710
                                                 TT_F67_M;              00000720
                  B02.TT_ETTER_1966(1)         = MOR.                   00000730
                      TT_E66_Å_M * 12 + MOR.TT_E66_M_M;                 00000740
                  B02.TT_FRAMT(1)              = F_BEREGN_TT_FRAMT(     00000750
                                                   B02.FNR(1),          00000760
                                                   HJ_DØDSDATO_ÅM_MOR); 00000770
                                                                        00000780
 /* ***************************************************************** */00000790
 /* PENSJONSGIVENDE INNTEKT MOR                                       */00000800
 /* ***************************************************************** */00000810
                                                                        00000820
  %SKIP;                                                                00000830
                                                                        00000840
                  IF MOR.DØDSDATO_M ^= 0 THEN                           00000850
                     DO;                                                00000860
                        HJ_DØD     = MOR.DØDSDATO_M;                    00000870
 /*YS*/                 W2_DØD_Å   = HJ_DØD_Å;                          00000880
 /*YS*/                 W2_DØD_M   = HJ_DØD_M;                          00000890
                        ÅR_FØR_DØD = HJ_DØD_Å - 1;                      00000900
                     END;                                               00000910
                  IF B02.PI(1,ÅR_FØR_DØD) = 0 &                         00000920
                     B02.PINNTEKT.PI_KODE(1,ÅR_FØR_DØD) = ' ' THEN      00000930
                     DO;                                                00000940
                        IF MOR.PI_M > 0 THEN                            00000950
                           DO;                                          00000960
                              B02.PI_KODE(1,ÅR_FØR_DØD) = 'F';          00000970
                              B02.PI(1,ÅR_FØR_DØD) = MOR.PI_M / 100;    00000980
                           END;                                         00000990
                     END;                                               00001000
                                                                        00001010
 /*YS*//* *********************************************************** */00001020
 /*YS*//* YRKESSKADE_OPPLYSNINGER  MOR                                */00001030
 /*YS*//* *********************************************************** */00001040
                                                                        00001050
 /*YS*/           IF YSKADE_TILLEGG_M     = 'J'     THEN                00001060
 /*YS*/              DO;                                                00001070
                                                                        00001080
 /*YS*/                 B02.STATUS.DØD_AV_YRKESSKADE(1)  =  'J';        00001090
                                                                        00001100
 /*YS*/                 /* ****************************************** */00001110
 /*YS*/                 /* YRKEHIST FOR AVDØDE SJEKKES FOR Å FINNE    */00001120
 /*YS*/                 /* FØRSTE LEDIGE PLASS I YRKEHIST.            */00001130
 /*YS*/                 /* ****************************************** */00001140
 /*YS*/                                                                 00001150
 /*YS*/                 DO I = 1 TO 5 WHILE (YRKE_IND = 0);             00001160
 /*YS*/                                                                 00001170
 /*YS*/                    IF B02.YRKEHIST.YUFT_ÅM(1,I) = 0  THEN       00001180
 /*YS*/                       YRKE_IND = I;                             00001190
 /*YS*/                 END;                                            00001200
 /*YS*/                                                                 00001210
 /*YS*/                 IF YRKE_IND = 0 THEN                            00001220
 /*YS*/                                                                 00001230
 /*YS*/                 /* ****************************************** */00001240
 /*YS*/                 /* FEIL, 5 YRKEHIST-PERIODER ER BRUKT FRA FØR.*/00001250
 /*YS*/                 /* ****************************************** */00001260
 /*YS*/                                                                 00001270
 /*YS*/                    DO;                                          00001280
 /*YS*/L300:                  FEIL_VED_LABEL = '300';                   00001290
 /*YS*/                       FEIL_MELD_NR   = 1810;                    00001300
 /*YS*/                       GO TO RETUR;                              00001310
 /*YS*/                    END;                                         00001320
 /*YS*/                                                                 00001330
 /*YS*/                 IF YRKE_IND > 1 THEN                            00001340
 /*YS*/                    DO;                                          00001350
 /*YS*/                                                                 00001360
 /*YS*/                       IF B02.YRKEHIST.OPPH_DATO_ÅM              00001370
 /*YS*/                                      (1,YRKE_IND - 1)    >      00001380
 /*YS*/                                       HJ_DØD_ÅM          THEN   00001390
 /*YS*/                                                                 00001400
 /*YS*/                          /* ********************************* */00001410
 /*YS*/                          /* FEIL, DØDSDATO LIGGER FØR         */00001420
 /*YS*/                          /* OPPHØRSTIDSPUNKT I FORRIGE        */00001430
 /*YS*/                          /* PERIODE.                          */00001440
 /*YS*/                          /* ********************************* */00001450
 /*YS*/                                                                 00001460
 /*YS*/                          DO;                                    00001470
 /*YS*/L310:                        FEIL_VED_LABEL = '310';             00001480
 /*YS*/                             FEIL_MELD_NR   = 1712 ;             00001490
 /*YS*/                             GO TO RETUR;                        00001500
 /*YS*/                          END;                                   00001510
 /*YS*/                                                                 00001520
 /*YS*/                       IF B02.YRKEHIST.OPPH_DATO_ÅM              00001530
 /*YS*/                                    (1,YRKE_IND - 1)  = 0  THEN  00001540
 /*YS*/                          DO;                                    00001550
 /*YS*/                                                                 00001560
 /*YS*/                             /* ****************************** */00001570
 /*YS*/                             /* KONTROLL SOM KANSKJE BØR       */00001580
 /*YS*/                             /* FORETAS:                       */00001590
 /*YS*/                             /*   HVIS IKKE SAMME SKADE        */00001600
 /*YS*/                             /*   OG GRAD = 100        : FEIL. */00001610
 /*YS*/                             /* ****************************** */00001620
 /*YS*/                                                                 00001630
 /*YS*/                             IF B02.YRKEHIST.YST_ÅM              00001640
 /*YS*/                                                 (1,YRKE_IND - 1)00001650
 /*YS*/                                 ^= F_SNU_DATO(FBY_MOR.YST_MÅ_M) 00001660
 /*YS*/                                                             THEN00001670
 /*YS*/                                DO;                              00001680
 /*YS*/                                   B02.YRKEHIST.OPPH_DATO_ÅM     00001690
 /*YS*/                                                 (1,YRKE_IND - 1)00001700
 /*YS*/                                             =    HJ_DØD_ÅM ;    00001710
 /*YS*/                                   B02.YRKEHIST.OPPH_KODE        00001720
 /*YS*/                                         (1,YRKE_IND - 1)  = 'J';00001730
 /*YS*/                                END;                             00001740
 /*YS*/                             ELSE                                00001750
 /*YS*/                                DO;                              00001760
 /*YS*/                                   B02.YRKEHIST.OPPH_DATO_ÅM     00001770
 /*YS*/                                                 (1,YRKE_IND - 1)00001780
 /*YS*/                                   = F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM);00001790
 /*YS*/                                   B02.YRKEHIST.OPPH_KODE        00001800
 /*YS*/                                     (1,YRKE_IND - 1)  = 'D';    00001810
 /*YS*/                                END;                             00001820
 /*YS*/                          END;                                   00001830
 /*YS*/                                                                 00001840
 /*YS*/                                                                 00001850
 /*YS*/                       /* ************************************ */00001860
 /*YS*/                       /* KONTROLL SOM KANSKJE BØR FORETAS:    */00001870
 /*YS*/                       /*   HVIS SAMME SKADE    :              */00001880
 /*YS*/                       /*                  KONTROLLER OPPLYSN. */00001890
 /*YS*/                       /*                  PÅ BLANKETTEN MOT   */00001900
 /*YS*/                       /*                  OPPLYSN. I YRKEHIST.*/00001910
 /*YS*/                       /* ************************************ */00001920
 /*YS*/                                                                 00001930
 /*YS*/                    END;                                         00001940
 /*YS*/                                                                 00001950
 /*YS*/                 IF    YRKE_IND = 1                             !00001960
 /*YS*/                    (  YRKE_IND > 1                             &00001970
 /*YS*/                     ((B02.YRKEHIST.YST_ÅM(1,YRKE_IND - 1) ^=    00001980
 /*YS*/                                F_SNU_DATO(FBY_MOR.YST_MÅ_M)  ) !00001990
 /*YS*/                      (B02.YRKEHIST.YST_ÅM(1,YRKE_IND - 1)  =    00002000
 /*YS*/                                F_SNU_DATO(FBY_MOR.YST_MÅ_M)    &00002010
 /*YS*/                       B02.YRKEHIST.OPPH_DATO_ÅM(1,YRKE_IND - 1) 00002020
 /*YS*/                                > 0                             &00002030
 /*YS*/                       B02.YRKEHIST.OPPH_DATO_ÅM(1,YRKE_IND - 1) 00002040
 /*YS*/                        ^= F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM)       ))) 00002050
 /*YS*/                                                          THEN   00002060
 /*YS*/                                                                 00002070
 /*YS*/                    /* *************************************** */00002080
 /*YS*/                    /* OPPLYSNINGER OM AVDØDE LEGGES INN I     */00002090
 /*YS*/                    /* YRKEHIST.                               */00002100
 /*YS*/                    /* *************************************** */00002110
 /*YS*/                                                                 00002120
 /*YS*/                    DO;                                          00002130
 /*YS*/                       B02.YRKEHIST.YUFT_ÅM(1,YRKE_IND) =        00002140
 /*YS*/                                                       HJ_DØD_ÅM;00002150
 /*YS*/                       B02.YRKEHIST.YUG(1,YRKE_IND) = 100;       00002160
 /*YS*/                       B02.YRKEHIST.YST_ÅM(1,YRKE_IND) =         00002170
 /*YS*/                                    F_SNU_DATO(FBY_MOR.YST_MÅ_M);00002180
 /*YS*/                       B02.YRKEHIST.AÅI(1,YRKE_IND) =            00002190
 /*YS*/                                                   FBY_MOR.AÅI_M;00002200
 /*YS*/                       B02.YRKEHIST.YRKE11(1,YRKE_IND) =         00002210
 /*YS*/                                              FBY_MOR.YRKE11_M;  00002220
 /*YS*/                       B02.YRKEHIST.VILKÅR_1_2_2(1,YRKE_IND) =   00002230
 /*YS*/                                     FBY_MOR.VILKÅR_1_2_2A_M !!  00002240
 /*YS*/                                     FBY_MOR.VILKÅR_1_2_2B_M;    00002250
 /*YS*/                       B02.YRKEHIST.OPPH_DATO_ÅM(1,YRKE_IND) =   00002260
 /*YS*/                                   F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM);  00002270
 /*YS*/                       B02.YRKEHIST.OPPH_KODE(1,YRKE_IND) = 'D'; 00002280
 /*YS*/                    END;                                         00002290
 /*YS*/              END;                                               00002300
                                                                        00002310
                                                                        00002320
 /*YS*/           ELSE                                                  00002330
 /*YS*/                                                                 00002340
 /*YS*/              /* ********************************************* */00002350
 /*YS*/              /* YRKESSKADEBLANKETT ER IKKE MED, MEN DET       */00002360
 /*YS*/              /* SJEKKES I B02 FOR Å FINNE UT OM DET ER        */00002370
 /*YS*/              /* YRKESSKADE FRA FØR.                           */00002380
 /*YS*/              /* ********************************************* */00002390
 /*YS*/                                                                 00002400
 /*YS*/              DO;                                                00002410
 /*YS*/                                                                 00002420
 /*YS*/                 DO I = 1 TO 5 WHILE (YRKE_IND = 0);             00002430
 /*YS*/                                                                 00002440
 /*YS*/                    IF B02.YRKEHIST.YUFT_ÅM(1,I) = 0 THEN        00002450
 /*YS*/                    YRKE_IND  = I;                               00002460
 /*YS*/                 END;                                            00002470
 /*YS*/                                                                 00002480
 /*YS*/                 IF YRKE_IND = 0 THEN                            00002490
 /*YS*/                    YRKE_IND = 6;                                00002500
 /*YS*/                                                                 00002510
 /*YS*/                 IF YRKE_IND > 1 THEN                            00002520
 /*YS*/                    DO;                                          00002530
 /*YS*/                                                                 00002540
 /*YS*/                       IF B02.YRKEHIST.OPPH_DATO_ÅM              00002550
 /*YS*/                            (1,YRKE_IND - 1) > HJ_DØD_ÅM THEN    00002560
 /*YS*/                                                                 00002570
 /*YS*/                          /* ********************************* */00002580
 /*YS*/                          /* FEIL, DØDSDATO LIGGER FØR         */00002590
 /*YS*/                          /* OPPHØRSTIDSPUNKT I FORRIGE        */00002600
 /*YS*/                          /* PERIODE.                          */00002610
 /*YS*/                          /* ********************************* */00002620
 /*YS*/                                                                 00002630
 /*YS*/                          DO;                                    00002640
 /*YS*/L320:                        FEIL_VED_LABEL  = '320';            00002650
 /*YS*/                             FEIL_MELD_NR    = 1712 ;            00002660
 /*YS*/                             GO TO RETUR;                        00002670
 /*YS*/                          END;                                   00002680
 /*YS*/                                                                 00002690
 /*YS*/                       IF B02.YRKEHIST.OPPH_DATO_ÅM              00002700
 /*YS*/                                     (1,YRKE_IND - 1)  = 0  THEN 00002710
 /*YS*/                          DO;                                    00002720
 /*YS*/                             B02.YRKEHIST.OPPH_DATO_ÅM           00002730
 /*YS*/                                                 (1,YRKE_IND - 1)00002740
 /*YS*/                                  =  F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM);00002750
 /*YS*/                             B02.YRKEHIST.OPPH_KODE              00002760
 /*YS*/                                        (1,YRKE_IND - 1) = 'D';  00002770
 /*YS*/                          END;                                   00002780
 /*YS*/                    END;                                         00002790
 /*YS*/              END;                                               00002800
               END;                                                     00002810
 /* ***************************************************************** */00002820
 /* OPPLYSNING OM AVDØDE FAR                                          */00002830
 /* ***************************************************************** */00002840
            IF FAR.FNR_F ^= (11)'1' THEN                                00002850
               DO;                                                      00002860
                  B02.RF0PERSN.NAVN(2)         = FAR.NAVN_F;            00002870
                  B02.STATUS.VILKÅR_8_4_3A(2)  = FAR.VILKÅR_8_4_3A_F;   00002880
                  B02.SPESOPPL.OVERKOMP_UTL(2) = FAR.                   00002890
                                                 OVERKOMP_F;            00002900
                  B02.TT_FØR_1967(2)           = FAR.                   00002910
                                                    TT_F67_F;           00002920
                  B02.TT_ETTER_1966(2)         = FAR.                   00002930
                      TT_E66_Å_F * 12 + FAR.TT_E66_M_F;                 00002940
                  B02.TT_FRAMT(2)              = F_BEREGN_TT_FRAMT(     00002950
                                                 B02.FNR(2),            00002960
                                                 HJ_DØDSDATO_ÅM_FAR);   00002970
                                                                        00002980
 /* **************************************************************** */ 00002990
 /* OPPLYSNINGER OM VERNEPLIKT                                       */ 00003000
 /* **************************************************************** */ 00003010
                                                                        00003020
                  DO I = 1 TO 4 WHILE (FAR.VP_ÅR_F(I) > 0);             00003030
                     B02.VERNEPLIKTÅR(2,I) = FAR.VP_ÅR_F(I);            00003040
                  END;                                                  00003050
                                                                        00003060
 /* ***************************************************************** */00003070
 /* PENSJONSGIVENDE INNTEKT MOR                                       */00003080
 /* ***************************************************************** */00003090
                                                                        00003100
  %SKIP;                                                                00003110
                  IF FAR.DØDSDATO_F ^= 0 THEN                           00003120
                     DO;                                                00003130
                        HJ_DØD     = FAR.DØDSDATO_F;                    00003140
 /*YS*/                 W2_DØD_Å   = HJ_DØD_Å;                          00003150
 /*YS*/                 W2_DØD_M   = HJ_DØD_M;                          00003160
                        ÅR_FØR_DØD = HJ_DØD_Å - 1;                      00003170
                     END;                                               00003180
                  IF B02.PI(2,ÅR_FØR_DØD) = 0 &                         00003190
                     B02.PINNTEKT.PI_KODE(2,ÅR_FØR_DØD) = ' ' THEN      00003200
                     DO;                                                00003210
                        IF FAR.PI_F > 0 THEN                            00003220
                           DO;                                          00003230
                              B02.PI_KODE(2,ÅR_FØR_DØD) = 'F';          00003240
                              B02.PI(2,ÅR_FØR_DØD) = FAR.PI_F / 100;    00003250
                           END;                                         00003260
                     END;                                               00003270
                                                                        00003280
 /*YS*//* *********************************************************** */00003290
 /*YS*//* YRKESSKADE_OPPLYSNINGER  FAR                                */00003300
 /*YS*//* *********************************************************** */00003310
                                                                        00003320
 /*YS*/           IF YSKADE_TILLEGG_F     = 'J'     THEN                00003330
 /*YS*/              DO;                                                00003340
                                                                        00003350
 /*YS*/                 B02.STATUS.DØD_AV_YRKESSKADE(2)  =  'J';        00003360
                                                                        00003370
 /*YS*/                 /* ****************************************** */00003380
 /*YS*/                 /* YRKEHIST FOR AVDØDE SJEKKES FOR Å FINNE    */00003390
 /*YS*/                 /* FØRSTE LEDIGE PLASS I YRKEHIST.            */00003400
 /*YS*/                 /* ****************************************** */00003410
 /*YS*/                                                                 00003420
 /*YS*/                 DO I = 1 TO 5 WHILE (YRKE_IND = 0);             00003430
 /*YS*/                                                                 00003440
 /*YS*/                    IF B02.YRKEHIST.YUFT_ÅM(2,I) = 0  THEN       00003450
 /*YS*/                       YRKE_IND = I;                             00003460
 /*YS*/                 END;                                            00003470
 /*YS*/                                                                 00003480
 /*YS*/                 IF YRKE_IND = 0 THEN                            00003490
 /*YS*/                                                                 00003500
 /*YS*/                 /* ****************************************** */00003510
 /*YS*/                 /* FEIL, 5 YRKEHIST-PERIODER ER BRUKT FRA FØR.*/00003520
 /*YS*/                 /* ****************************************** */00003530
 /*YS*/                                                                 00003540
 /*YS*/                    DO;                                          00003550
 /*YS*/L330:                  FEIL_VED_LABEL = '330';                   00003560
 /*YS*/                       FEIL_MELD_NR   = 1810;                    00003570
 /*YS*/                       GO TO RETUR;                              00003580
 /*YS*/                    END;                                         00003590
 /*YS*/                                                                 00003600
 /*YS*/                 IF YRKE_IND > 1 THEN                            00003610
 /*YS*/                    DO;                                          00003620
 /*YS*/                                                                 00003630
 /*YS*/                       IF B02.YRKEHIST.OPPH_DATO_ÅM              00003640
 /*YS*/                                      (2,YRKE_IND - 1)    >      00003650
 /*YS*/                                       HJ_DØD_ÅM          THEN   00003660
 /*YS*/                                                                 00003670
 /*YS*/                          /* ********************************* */00003680
 /*YS*/                          /* FEIL, DØDSDATO LIGGER FØR         */00003690
 /*YS*/                          /* OPPHØRSTIDSPUNKT I FORRIGE        */00003700
 /*YS*/                          /* PERIODE.                          */00003710
 /*YS*/                          /* ********************************* */00003720
 /*YS*/                                                                 00003730
 /*YS*/                          DO;                                    00003740
 /*YS*/L340:                        FEIL_VED_LABEL = '340';             00003750
 /*YS*/                             FEIL_MELD_NR   = 1712 ;             00003760
 /*YS*/                             GO TO RETUR;                        00003770
 /*YS*/                          END;                                   00003780
 /*YS*/                                                                 00003790
 /*YS*/                       IF B02.YRKEHIST.OPPH_DATO_ÅM              00003800
 /*YS*/                                    (2,YRKE_IND - 1)  = 0  THEN  00003810
 /*YS*/                          DO;                                    00003820
 /*YS*/                                                                 00003830
 /*YS*/                             /* ****************************** */00003840
 /*YS*/                             /* KONTROLL SOM KANSKJE BØR       */00003850
 /*YS*/                             /* FORETAS:                       */00003860
 /*YS*/                             /*   HVIS IKKE SAMME SKADE        */00003870
 /*YS*/                             /*   OG GRAD = 100        : FEIL. */00003880
 /*YS*/                             /* ****************************** */00003890
 /*YS*/                                                                 00003900
 /*YS*/                             IF B02.YRKEHIST.YST_ÅM              00003910
 /*YS*/                                                 (2,YRKE_IND - 1)00003920
 /*YS*/                                  ^= F_SNU_DATO(FBY_FAR.YST_MÅ_F)00003930
 /*YS*/                                                             THEN00003940
 /*YS*/                                DO;                              00003950
 /*YS*/                                   B02.YRKEHIST.OPPH_DATO_ÅM     00003960
 /*YS*/                                                 (2,YRKE_IND - 1)00003970
 /*YS*/                                             =    HJ_DØD_ÅM ;    00003980
 /*YS*/                                   B02.YRKEHIST.OPPH_KODE        00003990
 /*YS*/                                         (2,YRKE_IND - 1)  = 'J';00004000
 /*YS*/                                END;                             00004010
 /*YS*/                             ELSE                                00004020
 /*YS*/                                DO;                              00004030
 /*YS*/                                   B02.YRKEHIST.OPPH_DATO_ÅM     00004040
 /*YS*/                                                 (2,YRKE_IND - 1)00004050
 /*YS*/                                   = F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM);00004060
 /*YS*/                                   B02.YRKEHIST.OPPH_KODE        00004070
 /*YS*/                                     (2,YRKE_IND - 1)  = 'D';    00004080
 /*YS*/                                END;                             00004090
 /*YS*/                          END;                                   00004100
 /*YS*/                                                                 00004110
 /*YS*/                                                                 00004120
 /*YS*/                       /* ************************************ */00004130
 /*YS*/                       /* KONTROLL SOM KANSKJE BØR FORETAS:    */00004140
 /*YS*/                       /*   HVIS SAMME SKADE    :              */00004150
 /*YS*/                       /*                  KONTROLLER OPPLYSN. */00004160
 /*YS*/                       /*                  PÅ BLANKETTEN MOT   */00004170
 /*YS*/                       /*                  OPPLYSN. I YRKEHIST.*/00004180
 /*YS*/                       /* ************************************ */00004190
 /*YS*/                                                                 00004200
 /*YS*/                    END;                                         00004210
 /*YS*/                                                                 00004220
 /*YS*/                 IF    YRKE_IND = 1                             !00004230
 /*YS*/                    (  YRKE_IND > 1                             &00004240
 /*YS*/                     ((B02.YRKEHIST.YST_ÅM(2,YRKE_IND - 1) ^=    00004250
 /*YS*/                                F_SNU_DATO(FBY_FAR.YST_MÅ_F)  ) !00004260
 /*YS*/                      (B02.YRKEHIST.YST_ÅM(2,YRKE_IND - 1)  =    00004270
 /*YS*/                                F_SNU_DATO(FBY_FAR.YST_MÅ_F)    &00004280
 /*YS*/                       B02.YRKEHIST.OPPH_DATO_ÅM(2,YRKE_IND - 1) 00004290
 /*YS*/                                > 0                             &00004300
 /*YS*/                       B02.YRKEHIST.OPPH_DATO_ÅM(2,YRKE_IND - 1) 00004310
 /*YS*/                        ^= F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM)       ))) 00004320
 /*YS*/                                                          THEN   00004330
 /*YS*/                                                                 00004340
 /*YS*/                    /* *************************************** */00004350
 /*YS*/                    /* OPPLYSNINGER OM AVDØDE LEGGES INN I     */00004360
 /*YS*/                    /* YRKEHIST.                               */00004370
 /*YS*/                    /* *************************************** */00004380
 /*YS*/                                                                 00004390
 /*YS*/                    DO;                                          00004400
 /*YS*/                       B02.YRKEHIST.YUFT_ÅM(2,YRKE_IND) =        00004410
 /*YS*/                                                       HJ_DØD_ÅM;00004420
 /*YS*/                       B02.YRKEHIST.YUG(2,YRKE_IND) = 100;       00004430
 /*YS*/                       B02.YRKEHIST.YST_ÅM(2,YRKE_IND) =         00004440
 /*YS*/                                    F_SNU_DATO(FBY_FAR.YST_MÅ_F);00004450
 /*YS*/                       B02.YRKEHIST.AÅI(2,YRKE_IND) =            00004460
 /*YS*/                                                   FBY_FAR.AÅI_F;00004470
 /*YS*/                       B02.YRKEHIST.YRKE11(2,YRKE_IND) =         00004480
 /*YS*/                                                FBY_FAR.YRKE11_F;00004490
 /*YS*/                       B02.YRKEHIST.VILKÅR_1_2_2(2,YRKE_IND) =   00004500
 /*YS*/                                     FBY_FAR.VILKÅR_1_2_2A_F !!  00004510
 /*YS*/                                     FBY_FAR.VILKÅR_1_2_2B_F;    00004520
 /*YS*/                       B02.YRKEHIST.OPPH_DATO_ÅM(2,YRKE_IND) =   00004530
 /*YS*/                                   F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM);  00004540
 /*YS*/                       B02.YRKEHIST.OPPH_KODE(2,YRKE_IND) = 'D'; 00004550
 /*YS*/                    END;                                         00004560
 /*YS*/              END;                                               00004570
                                                                        00004580
                                                                        00004590
 /*YS*/           ELSE                                                  00004600
 /*YS*/                                                                 00004610
 /*YS*/              /* ********************************************* */00004620
 /*YS*/              /* YRKESSKADEBLANKETT ER IKKE MED, MEN DET       */00004630
 /*YS*/              /* SJEKKES I B02 FOR Å FINNE UT OM DET ER        */00004640
 /*YS*/              /* YRKESSKADE FRA FØR.                           */00004650
 /*YS*/              /* ********************************************* */00004660
 /*YS*/                                                                 00004670
 /*YS*/              DO;                                                00004680
 /*YS*/                                                                 00004690
 /*YS*/                 DO I = 1 TO 5 WHILE (YRKE_IND = 0);             00004700
 /*YS*/                                                                 00004710
 /*YS*/                    IF B02.YRKEHIST.YUFT_ÅM(2,I) = 0 THEN        00004720
 /*YS*/                    YRKE_IND  = I;                               00004730
 /*YS*/                 END;                                            00004740
 /*YS*/                                                                 00004750
 /*YS*/                 IF YRKE_IND = 0 THEN                            00004760
 /*YS*/                    YRKE_IND = 6;                                00004770
 /*YS*/                                                                 00004780
 /*YS*/                 IF YRKE_IND > 1 THEN                            00004790
 /*YS*/                    DO;                                          00004800
 /*YS*/                                                                 00004810
 /*YS*/                       IF B02.YRKEHIST.OPPH_DATO_ÅM              00004820
 /*YS*/                            (2,YRKE_IND - 1) > HJ_DØD_ÅM THEN    00004830
 /*YS*/                                                                 00004840
 /*YS*/                          /* ********************************* */00004850
 /*YS*/                          /* FEIL, DØDSDATO LIGGER FØR         */00004860
 /*YS*/                          /* OPPHØRSTIDSPUNKT I FORRIGE        */00004870
 /*YS*/                          /* PERIODE.                          */00004880
 /*YS*/                          /* ********************************* */00004890
 /*YS*/                                                                 00004900
 /*YS*/                          DO;                                    00004910
 /*YS*/L350:                        FEIL_VED_LABEL  = '350';            00004920
 /*YS*/                             FEIL_MELD_NR    = 1712 ;            00004930
 /*YS*/                             GO TO RETUR;                        00004940
 /*YS*/                          END;                                   00004950
 /*YS*/                                                                 00004960
 /*YS*/                       IF B02.YRKEHIST.OPPH_DATO_ÅM              00004970
 /*YS*/                                     (2,YRKE_IND - 1)  = 0  THEN 00004980
 /*YS*/                          DO;                                    00004990
 /*YS*/                             B02.YRKEHIST.OPPH_DATO_ÅM           00005000
 /*YS*/                                                 (2,YRKE_IND - 1)00005010
 /*YS*/                                  =  F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM);00005020
 /*YS*/                             B02.YRKEHIST.OPPH_KODE              00005030
 /*YS*/                                        (2,YRKE_IND - 1) = 'D';  00005040
 /*YS*/                          END;                                   00005050
 /*YS*/                    END;                                         00005060
 /*YS*/              END;                                               00005070
               END;                                                     00005080
         END;                                                           00005090
      ELSE                                                              00005100
         B02.PENSJONSTYPE2(IND) = 'Ø';                                  00005110
                                                                        00005120
 /*YS*/IF YSKADE_TILLEGG_M = 'J' !                                      00005130
 /*YS*/   YSKADE_TILLEGG_F = 'J' THEN                                   00005140
 /*YS*/   B02.STATUS.DØD_AV_YRKESSKADE(IND)  =  'E';                    00005150
                                                                        00005160
      B02.PENSJONSTYPE1(IND) = 'B';                                     00005170
      B02.VIRK_DATO_ÅM(IND)  = HJ_VIRK_DATO_ÅM;                         00005180
                                                                        00005190
      IF B02.FØRSTE_GANG_REG(IND) = ' ' THEN                            00005200
         B02.FØRSTE_GANG_REG(IND) = 'J' ;                               00005210
      ELSE                                                              00005220
         B02.FØRSTE_GANG_REG(IND) = 'N' ;                               00005230
                                                                        00005240
      B02.STATUS.SIVILSTAND(IND) = 'U';                                 00005250
                                                                        00005260
 /*YS*/ RETUR:                                                          00005270
                                                                        00005280
   END OPPRETT_STATUS_FB_BARN;                                          00005290
