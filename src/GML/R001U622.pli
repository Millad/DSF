 /*       SIST ENDRET 28/07-98 12.50.10 AV   JDA7339                  */00000000
 /*       SIST ENDRET 28/07-98 12.27.04 AV   JDA7339                  */00000010
 /*       SIST ENDRET 12/06-98 13.34.12 AV   SPA7339                  */00000020
 /*       SIST ENDRET 25/05-98 12.38.01 AV   SPA7339                  */00000030
 /*       SIST ENDRET 30/03-98 12.56.04 AV   JDA7339                  */00000040
 /*       SIST ENDRET 22/12-97 09.57.45 AV   HLA7339                  */00000050
 /*       SIST ENDRET 22/12-97 09.56.05 AV   HLA7339                  */00000060
 /*       SIST ENDRET 05/12-97 12.19.43 AV   JDA7339                  */00000070
 /*       SIST ENDRET 27/11-97 10.43.59 AV   JDA7339                  */00000080
 /*       SIST ENDRET 24/10-97 11.56.18 AV   JDA7339                  */00000090
 /*       SIST ENDRET 25/09-97 09.55.18 AV   HLA7339                  */00000100
 /*       SIST ENDRET 29/08-97 12.09.16 AV   JDA7339                  */00000110
 /*       SIST ENDRET 28/08-97 08.52.31 AV   SPA7339                  */00000120
 /*       SIST ENDRET 16/07-97 14.08.18 AV   HLA7339                  */00000130
 /*       SIST ENDRET 16/05-97 10.49.40 AV   JDA7339                  */00000140
 /*       SIST ENDRET 28/04-97 11.12.16 AV   TSB7339                  */00000150
 /*       SIST ENDRET 19/03-97 10.43.51 AV   JDA7339                  */00000160
 /*       SIST ENDRET 09/10-96 11.38.13 AV   JDA0310                  */00000170
 /*       SIST ENDRET 19/08-96 08.38.10 AV   HLB0310                  */00000180
 /*       SIST ENDRET 15/07-96 08.00.20 AV   HLB0310                  */00000190
 /*       SIST ENDRET 19/04-96 09.40.58 AV   HLB0310                  */00000200
 /*       SIST ENDRET 13/11-95 12.32.08 AV   JDA0310                  */00000210
 /*       SIST ENDRET 11/08-95 12.20.12 AV   TSB0310                  */00000220
 /*       SIST ENDRET 10/08-95 15.16.36 AV   TSB0310                  */00000230
 /*       SIST ENDRET 26/06-95 13.57.16 AV   JDA0310                  */00000240
 /*       SIST ENDRET 21/03-95 13.18.42 AV   TSB0310                  */00000250
 /*       SIST ENDRET 21/03-95 10.45.49 AV   TSB0310                  */00000260
 /*       SIST ENDRET 20/03-95 11.38.08 AV   JDA0310                  */00000270
 /*       SIST ENDRET 02/01-95 14.16.10 AV   HLB0310                  */00000280
 /*       SIST ENDRET 17/11-94 12.06.03 AV   JDA0310                  */00000290
 /*       SIST ENDRET 13/10-94 09.44.52 AV   JDA0310                  */00000300
 /*       SIST ENDRET 21/09-94 15.32.53 AV   HERMAN                   */00000310
 /*       SIST ENDRET 12/09-94 13.11.21 AV   HERMAN                   */00000320
 /*       SIST ENDRET 25/07-94 13.50.00 AV   DYBVIK                   */00000330
 /*       SIST ENDRET 12/07-94 14.05.48 AV   DYBVIK                   */00000340
 /*       SIST ENDRET 11/07-94 12.40.17 AV   DYBVIK                   */00000350
 /*       SIST ENDRET 16/06-94 09.16.42 AV   TRUDE                    */00000360
 /*       SIST ENDRET 08/06-94 14.04.26 AV   DYBVIK                   */00000370
 /*       SIST ENDRET 24/05-94 14.01.26 AV   DYBVIK                   */00000380
 /*       SIST ENDRET 25/02-94 12.24.52 AV   HERMAN                   */00000390
 /* ***************************************************************** */00000400
 /*IDENTIFIKASJON:                                                    */00000410
 /*    R001U622 - PROSEDYRE I PLI                                     */00000420
 /*    PROGRAMMERER:    HERMAN - JULI 1993                            */00000430
 /* *****************************************                         */00000440
 /*HENSIKT:                                                           */00000450
 /*    PROSEDYREN AJOURFØRER SØKERS PENSJONSSTATUS MED INFO FRA TRANS */00000460
 /*    UFØREPENSJON.                                                  */00000470
 /* ****************************************************************  */00000480
 /*PROGRAMTILKNYTNING:                                                */00000490
 /*    PROSEDYREN INCLUDES I R001U620.                                */00000500
 /*BRUK:                                                              */00000510
 /*    CALL AJOURFØR_B02_MED_U3TRANS                                  */00000520
 /*                                                                   */00000530
 /* ***************************************************************** */00000540
                                                                        00000550
 %SKIP(2);                                                              00000560
 AJOURFØR_B02_MED_U3TRANS:                                              00000570
   PROC OPTIONS(REENTRANT);                                             00000580
 %SKIP;                                                                 00000590
   DCL                                                                  00000600
  /*  UF_IND           FIXED BIN(15),      */                           00000610
        YUF_IND        FIXED BIN(15),                                   00000620
      J                FIXED BIN(15),                                   00000630
      K                FIXED BIN(15),                                   00000640
      M                FIXED BIN(15),                                   00000650
      HJELP            FIXED DEC (3),                                   00000660
      ÅR_FØR_UFØRHET   PIC '99';                                        00000670
   DCL    ALDER_UF            FIXED DEC (5) INIT (0);      /*HL*/       00000680
   DCL    ALDER_EK            FIXED DEC (5) INIT (0);      /*HL*/       00000690
                                                                        00000700
      FNR = U3S.FNR;                                                    00000710
      ALDER_UF = F_ALDER(U3S.FNR,U3S.UFT_MÅ);   /*HL*/                  00000720
                                                                        00000730
                                                                        00000740
    IF HJ_VIRK_DATO_ÅM < 9802              THEN                         00000750
       B02.PENSJON_FØR_9802(SØKER_IND) = 'J';                           00000760
                                                                        00000770
    B02.NAVN(SØKER_IND)            = U3S.NAVN;                          00000780
    B02.SPRÅK(SØKER_IND)           = U3S.SPRÅK;                         00000790
    B02.TKNR(SØKER_IND)            = U3S.TKNR;                          00000800
                                                                        00000810
    IF U3S.YRKE                    >  0    THEN                         00000820
       B02.YRKES_KODE(SØKER_IND)   = U3S.YRKE;                          00000830
                                                                        00000840
    B02.FØRSTE_GANG_REG(SØKER_IND) = 'N';                               00000850
    DO I = 1 TO 13;                                                     00000860
       IF B02.FNR(I) > 0 THEN                                           00000870
          B02.FØRSTE_GANG_REG(I) = 'N';                                 00000880
    END;                                                                00000890
    /* 9705HL-------------------------------------------------------- */00000900
    IF   (B01.PENSJONSTYPE1(SØKER_IND) ^= 'U')  &                       00000910
         (B01.PENSJONSTYPE1(SØKER_IND) ^= 'Y')  &                       00000920
         (U3S.YSKADE_TILLEGG ^= 'J'          )  &                       00000930
         (U3S.UFG < 50                       )          THEN            00000940
        DO;                                                             00000950
    L269:                                                               00000960
           FEIL_VED_LABEL           = '269';                            00000970
           FEIL_MELD_NR             = '38';                             00000980
        END;                                                            00000990
    /* HIT 9705HL---------------------------------------------------- */00001000
                                                                        00001010
 /* ***************************************************************** */00001020
 /* YTELSE_SEGMENTET                                                  */00001030
 /* ***************************************************************** */00001040
                                                                        00001050
 %SKIP;                                                                 00001060
    IF B01.PENSJONSTYPE1(SØKER_IND) = 'N' !                             00001070
                           B01.PENSJONSTYPE1(SØKER_IND) = 'B' THEN      00001080
       B02.PENSJONSTYPE3(SØKER_IND) = 'U';                              00001090
    /*    PT1 ER UENDRET                                              */00001100
    ELSE                                                                00001110
       B02.PENSJONSTYPE1(SØKER_IND) = 'U';                              00001120
                                                                        00001130
  L270:                                                                 00001140
    IF U3Y.KAP_11_7_UTLØST          = 'J'   &   /*TRUDE, 31.5.89*/      00001150
       B01.PENSJONSTYPE1(SØKER_IND) = 'F'   THEN                        00001160
          DO;                                                           00001170
             FEIL_VED_LABEL           = '270';                          00001180
             FEIL_MELD_NR             = '1732';                         00001190
          END;                                                          00001200
                                                                        00001210
  L271:                                                                 00001220
  /* REDUKSJON AV UFG SKAL SKJE MED ENDRINGSBLANKETT*/                  00001230
    IF B01.UFØRPENS.UFG(SØKER_IND) > U3S.UFG          THEN              00001240
          DO;                                                           00001250
             FEIL_VED_LABEL           = '271';                          00001260
             FEIL_MELD_NR             = '1741';                         00001270
          END;                                                          00001280
                                                                        00001290
  /*TILLEGG 120796 HL : */                                              00001300
    IF F_SNU_DATO(U3S.UFT_MÅ) < 9100       THEN                         00001310
       B02.PENSJONSRETT_FØR_91(SØKER_IND) = 'J';                        00001320
                                                                        00001330
    IF U3S.YSKADE_TILLEGG           = 'J'  !                            00001340
       B01.PENSJONSTYPE1(SØKER_IND) = 'Y'     THEN                      00001350
          B02.PENSJONSTYPE1(SØKER_IND) = 'Y';                           00001360
                                                                        00001370
    IF U3S.ATT_UF = 'A' THEN                                            00001380
       IF (B01.PENSJONSTYPE1(SØKER_IND)     = 'U' !                     00001390
           B01.PENSJONSTYPE1(SØKER_IND)     = 'Y' ) &                   00001400
           B01.PENSJONSTYPE3(SØKER_IND)    ^= 'A' &                     00001410
                                                                        00001420
          B01.STATUS_KODE_HIST(SØKER_IND)  = ' ' THEN                   00001430
          DO;                                                           00001440
                                                                        00001450
             IF  (STATUS_TYPE = 'B' !                                   00001460
                 STATUS_TYPE = 'I')  &                                  00001470
                 TRANS_LISTE_INDEX = 1  THEN                            00001480
 /* ***************************************************************** */00001490
 /* FEIL,SØKEREN HAR UFØRPENSJON FRA FØR.                             */00001500
 /* ***************************************************************** */00001510
                 DO;                                                    00001520
  L275:                                                                 00001530
                    FEIL_VED_LABEL = '275';                             00001540
                    FEIL_MELD_NR   = 1717;                              00001550
                    GO TO RETUR;                                        00001560
                 END;                                                   00001570
 /* ***************************************************************** */00001580
 /* SØKEREN HAR ATTFØRING FRA FØR.TRANHIST BLIR DA FJERNET.           */00001590
 /* ***************************************************************** */00001600
             ELSE                                                       00001610
                 DO;                                                    00001620
                                                                        00001630
                                                                        00001640
                    SEARCH_FNR                  =                       00001650
                                   TRANS_OPPL_OMR.FØDSNUMMER        ;   00001660
                                                                        00001670
                                                                        00001680
                    FJERN_ALLE                  = '0'B              ;   00001690
                                                                        00001700
                                                                        00001710
                    EXEC CICS LINK PROGRAM                              00001720
                               ('R0015501') COMMAREA(LOKAL_KOM_OMR) ;   00001730
                                                                        00001740
                    IF FEIL_MELD_NR > 0 THEN                            00001750
                       GO TO RETUR                                  ;   00001760
                                                                        00001770
                                                                        00001780
  /* FJERNET FOR Å RETTE FEIL NR 3. 9712 HL : *********                 00001790
                    ANTALL_TRANS_I_TRANS_LISTE =                        00001800
                                      ANTALL_TRANS_I_TRANS_LISTE - 1;   00001810
                  ***************************************** */          00001820
                    TRANS_OPPL_OMR.BLANKETTYPE = 'UA';                  00001830
                                                                        00001840
                 END;                                                   00001850
          END;                                                          00001860
       ELSE                                                             00001870
  /* DENNE TESTEN ER BEGRENSET I FORB. MED FEILM.274. ERIK 16.1.86 */   00001880
                 IF B01.PENSJONSTYPE3(SØKER_IND) = 'A'  &               00001890
                    (B01.PENSJONSTYPE1(SØKER_IND)    ^= 'Y' &           00001900
                     B01.PENSJONSTYPE1(SØKER_IND)    ^= 'U' ) &         00001910
                    B01.STATUS_KODE_HIST(SØKER_IND)  = ' ' THEN         00001920
                 DO;                                                    00001930
                                                                        00001940
 /* ***************************************************************** */00001950
 /* FEIL,SØKEREN HAR ATTFØRING FRA FØR.                               */00001960
 /* ***************************************************************** */00001970
                                                                        00001980
  L277:                                                                 00001990
                FEIL_VED_LABEL = '277';                                 00002000
                FEIL_MELD_NR   = 1718;                                  00002010
                GO TO RETUR;                                            00002020
             END;                                                       00002030
          ELSE                                                          00002040
             B02.PENSJONSTYPE3(SØKER_IND) = 'A';                        00002050
    ELSE                                                                00002060
       DO;                                                              00002070
          IF B01.PENSJONSTYPE3(SØKER_IND) = 'A' THEN                    00002080
             DO;                                                        00002090
                                                                        00002100
                DO I = 1 TO 7;              /*0697 HL*/                 00002110
                   IF B01.UFØRHIST.UFT_ÅM(SØKER_IND,I) = 0 THEN         00002120
                      DO;                                               00002130
                         B00.UFØRHIST(SØKER_IND,I-1) =                  00002140
                                 B01.UFØRHIST(SØKER_IND,I-1);           00002150
                         B01.UFØRHIST(SØKER_IND,I-1) = '';              00002160
                         K = I - 1;                                     00002170
                         I = 8;            /*0697 HL*/                  00002180
                      END;                                              00002190
                END;                                                    00002200
             END;                                                       00002210
                                                                        00002220
          IF B02.PENSJONSTYPE1(SØKER_IND) = 'U' !                       00002230
             B02.PENSJONSTYPE1(SØKER_IND) = 'Y' THEN                    00002240
             B02.PENSJONSTYPE3(SØKER_IND) = ' ';                        00002250
       END;                                                             00002260
 /* ***************************************************************** */00002270
 /* TIDLIGERE REGISTERT SOM ETTERLATT EKTEFELLE                       */00002280
 /* ***************************************************************** */00002290
                                                                        00002300
    IF B01.PENSJONSTYPE1(SØKER_IND) = 'E' THEN                          00002310
       B02.PENSJONSTYPE2(SØKER_IND) = 'E';                              00002320
                                                                        00002330
 /* ***************************************************************** */00002340
 /* NYE FORS-TILL BARN SKAL IKKE REGISTRERES,BRUK F7-BL  (JD 7.91)    */00002350
 /* ***************************************************************** */00002360
                                                                        00002370
 /* ***************************************************************** */00002380
 /* HVIS SØKER HAR EKTEFELLE I TRANS                                  */00002390
 /* ***************************************************************** */00002400
                                                                        00002410
    IF U3S.FNR_EK > 0 THEN                                              00002420
       DO;                                                              00002430
          IF  U3S.SIVILSTAND               = 'A' THEN                   00002440
             DO;                                                        00002450
                B02.SIVILSTAND(SØKER_IND)      = 'A';                   00002460
                B02.SIVILSTAND(EKTEF_IND)      = 'A';                   00002470
             END;                                                       00002480
          ELSE           /* TRUDE:'P' OG 'W' VAR IKKE MED. 1606094*/    00002490
          IF  U3S.SIVILSTAND               = 'P' THEN                   00002500
             DO;                                                        00002510
                B02.SIVILSTAND(SØKER_IND)      = 'P';                   00002520
                B02.SIVILSTAND(EKTEF_IND)      = 'P';                   00002530
             END;                                                       00002540
          ELSE                                                          00002550
          IF  U3S.SIVILSTAND               = 'W' THEN                   00002560
             DO;                                                        00002570
                B02.SIVILSTAND(SØKER_IND)      = 'W';                   00002580
                B02.SIVILSTAND(EKTEF_IND)      = 'W';                   00002590
             END;                                                       00002600
          ELSE                                                          00002610
          IF  U3S.SIVILSTAND               = 'V' THEN                   00002620
             DO;                                                        00002630
                B02.SIVILSTAND(SØKER_IND)      = 'V';                   00002640
                B02.SIVILSTAND(EKTEF_IND)      = 'V';                   00002650
             END;                                                       00002660
          ELSE                                                          00002670
             DO;                                                        00002680
                B02.SIVILSTAND(SØKER_IND)      = 'G';                   00002690
                B02.SIVILSTAND(EKTEF_IND)      = 'G';                   00002700
             END;                                                       00002710
                                                                        00002720
          B02.EK_INNT_OVER_2G(SØKER_IND) = U3S.EK_INNT_OVER_2G;         00002730
                                                                        00002740
 /* ***************************************************************** */00002750
 /* HVIS FORSØRGINGSTILLEGG EKTEFELLE                                 */00002760
 /* PENSJONSTYPE1 FOR EKTEFELLEN OG PENSJONSTYPE2 FOR PENSJONISTEN    */00002770
 /* BLE GALT FOR YRKESKADEPENSJONER.  ENDRET 11.1.1990, ERIK.         */00002780
 /* ***************************************************************** */00002790
                                                                        00002800
       /* IF U3S.TILL_EK = 'J' THEN   TEST PÅ B01.ET FJERNET 7.90 JD */ 00002810
          IF U3S.TILL_EK = 'J' & HJ_VIRK_DATO_ÅM > 9104 &               00002820
             B01.PENSJONSTYPE2(SØKER_IND) ^= 'F' THEN                   00002830
             U3S.TILL_EK = ' ' ; /* JD 7.91*/                           00002840
          IF U3S.TILL_EK = 'J' ! B01.UFØRPENS.ET(SØKER_IND) > 0         00002850
               ! B01.GARANTITILLEGG_EK(SØKER_IND) > 0           THEN    00002860
             DO;                                                        00002870
                B02.PENSJONSTYPE2(SØKER_IND)   = 'F';                   00002880
              IF   U3S.UFG < 50    &                                    00002890
                   HJ_VIRK_DATO_ÅM < 9705      THEN  /*9705 HL*/        00002900
                 DO;                                                    00002910
                    B02.PENSJONSTYPE2(SØKER_IND)   = 'P';               00002920
                    B02.PENSJONSTYPE1(EKTEF_IND)   = 'G';               00002930
                    B02.PENSJONSTYPE2(EKTEF_IND)   = ' ';               00002940
                 END;                                                   00002950
               ELSE                                                     00002960
                 B02.PENSJONSTYPE1(EKTEF_IND)   = 'F';                  00002970
                 B02.PENSJONSTYPE2(EKTEF_IND)   = ' ';                  00002980
             END;                                                       00002990
          ELSE                                                          00003000
             DO;                                                        00003010
                                                                        00003020
 /* ***************************************************************** */00003030
 /* HVIS EKTEFELLEN HAR EGEN PENSJON                                  */00003040
 /* ***************************************************************** */00003050
                                                                        00003060
                IF  B01.PENSJONSTYPE1(EKTEF_IND)    = 'A' !             00003070
                    B01.PENSJONSTYPE1(EKTEF_IND)    = 'Y' !             00003080
                    B01.PENSJONSTYPE1(EKTEF_IND)    = 'K' !             00003090
                    B01.PENSJONSTYPE1(EKTEF_IND)    = 'U' THEN          00003100
                                                                        00003110
 /* ***************************************************************** */00003120
 /* EKTEFELLEN HAR AVTALEFESTET PENSJON SOM IKKE UTBETALES            */00003130
 /* ***************************************************************** */00003140
                                                                        00003150
                    IF B01.PENSJONSTYPE1(EKTEF_IND)    = 'K'  &         00003160
                       B01.PENSJONSTYPE2(EKTEF_IND)    = 'N'  THEN      00003170
                       DO;                                              00003180
                          B02.PENSJONSTYPE2(SØKER_IND)    = 'P';        00003190
                          B02.PENSJONSTYPE2(EKTEF_IND)    = 'N';        00003200
                       END;                                             00003210
                    ELSE                                                00003220
                       IF  U3S.SIVILSTAND               = 'A'  !        00003230
                           U3S.SIVILSTAND               = 'V' THEN      00003240
                          DO;                                           00003250
                             B02.PENSJONSTYPE2(SØKER_IND)   = 'P';      00003260
                             B02.PENSJONSTYPE2(EKTEF_IND)   = 'P';      00003270
                          END;                                          00003280
                       ELSE                                             00003290
                          DO;                                           00003300
                             IF U3Y.KAP_11_7_UTLØST = 'J'  THEN         00003310
                                                                        00003320
                               DO;                                      00003330
                                B02.PENSJONSTYPE2(SØKER_IND) = ' ';     00003340
                                B02.PENSJONSTYPE2(EKTEF_IND) = 'P';     00003350
                               END;                                     00003360
                             ELSE                                       00003370
                               DO;                                      00003380
                             B02.PENSJONSTYPE2(SØKER_IND)   = 'S';      00003390
                             B02.PENSJONSTYPE2(EKTEF_IND)   = 'S';      00003400
                               END;                                     00003410
                          END;                                          00003420
                ELSE                                                    00003430
                   DO;                                                  00003440
                                                                        00003450
 /* ***************************************************************** */00003460
 /* EKTEFELLEN HAR IKKE PENSJON                                       */00003470
 /* ***************************************************************** */00003480
                                                                        00003490
                       IF U3Y.KAP_11_7_UTLØST = 'J'  THEN               00003500
                          B02.PENSJONSTYPE2(SØKER_IND) = ' ';           00003510
                       ELSE                                             00003520
                          B02.PENSJONSTYPE2(SØKER_IND)   = 'P';         00003530
                      B02.PENSJONSTYPE1(EKTEF_IND)   = 'G';             00003540
                   END;                                                 00003550
            END;                                                        00003560
            B02.NAVN(EKTEF_IND)            = U3S.NAVN_EK;               00003570
            B02.SPRÅK(EKTEF_IND)           = U3S.SPRÅK;                 00003580
                                                                        00003590
 /* ***************************************************************** */00003600
 /* TILKN-KODE TIL EKTEFELLENE OPPDATERES MED RESPEKTIVE NYE STATUSER.*/00003610
 /* ***************************************************************** */00003620
                                                                        00003630
            DO I = 1 TO 13;                                             00003640
               IF (B02.FNR_TILKN(SØKER_IND,I)=                          00003650
                                        B02.FNR(EKTEF_IND))THEN         00003660
                  DO;                                                   00003670
                     B02.TILKN.TILKNYTNINGSKODE(SØKER_IND,I)            00003680
                                  =  B02.PENSJONSTYPE1(EKTEF_IND);      00003690
                     I=13;                                              00003700
                  END;                                                  00003710
            END;                                                        00003720
            DO I = 1 TO 13;                                             00003730
               IF (B02.FNR_TILKN(EKTEF_IND,I)=                          00003740
                                        B02.FNR(SØKER_IND))THEN         00003750
                  DO;                                                   00003760
                     B02.TILKNYTNINGSKODE(EKTEF_IND,I)                  00003770
                            =  B02.PENSJONSTYPE1(SØKER_IND);            00003780
                     B02.FT_FØR_91(EKTEF_IND,I) = ' ';                  00003790
                     I=13;                                              00003800
                  END;                                                  00003810
            END;                                                        00003820
       END;                                                             00003830
    ELSE                                                                00003840
                                                                        00003850
 /* **************************************************************** */ 00003860
 /* SØKER HAR IKKE EKTEFELLE                                         */ 00003870
 /* **************************************************************** */ 00003880
                                                                        00003890
       IF ^(B01.PENSJONSTYPE1(SØKER_IND) = 'N' !                        00003900
            B01.PENSJONSTYPE1(SØKER_IND) = 'E' !                        00003910
            B01.PENSJONSTYPE1(SØKER_IND) = 'B')    &                    00003920
          B01.PENSJONSTYPE2(SØKER_IND)  ^= 'E'         THEN             00003930
                                                                        00003940
                       IF U3Y.KAP_11_7_UTLØST = 'J'  THEN               00003950
                          B02.PENSJONSTYPE2(SØKER_IND) = ' ';           00003960
                       ELSE                                             00003970
          B02.PENSJONSTYPE2(SØKER_IND) = 'P';                           00003980
                                                                        00003990
 /* ***************************************************************** */00004000
 /* UFØREPENSJON                                                      */00004010
 /* ***************************************************************** */00004020
                                                                        00004030
    IF U3S.UFG >= B02.UFØRPENS.GARANTIGRAD(SØKER_IND)     THEN          00004040
       DO;                                                              00004050
          B02.UFØRPENS.GARANTIGRAD(SØKER_IND)  = 0;                     00004060
          B02.FRYSDATO_ÅM                      = 0;                     00004070
          B02.FRYSKODE                         = ' ';                   00004080
       END;                                                             00004090
                                                                        00004100
    B02.UFØRPENS.UFG(SØKER_IND)           = U3S.UFG;                    00004110
    B02.UFØRPENS.VILKÅR_8_4_3A(SØKER_IND) = U3S.VILKÅR_8_4_3A;          00004120
                                                                        00004130
    /* INNTEKT-FØR-UP BLE BORTE VED NY BLANKETT . TRUDE 200395*/        00004140
    IF U3S.INNTEKT_FØR_UP > 0 THEN                                      00004150
       IF B01.UFØRHIST.UFT_ÅM(SØKER_IND,1) > 0 &                        00004160
          (B01.UFØRHIST.UFT_ÅM(SØKER_IND,1) ^=                          00004170
           F_SNU_DATO((U3S.UFT_MÅ))          ) &    /*9712 MH*/         00004180
          B01.PENSJONSTYPE3(SØKER_IND) ^= 'A'  THEN                     00004190
 L120:                                                                  00004200
          DO;  /* HAR UFØRE FRA FØR, SKAL BRUKE ENDRINGSBLANKETT */     00004210
             FEIL_VED_LABEL = '120'; /* TILSVARER FELTNUMMER */         00004220
             FEIL_MELD_NR   = 448;                                      00004230
             GO TO RETUR;                                               00004240
          END; /* HAR UFØRE FRA FØR, SKAL BRUKE ENDRINGSBLANKETT */     00004250
       ELSE                                                             00004260
          DO;  /* FØRSTE UFØRETIDSPUNKT - OK */                         00004270
             B02.UFØRPENS.INNTEKT_FØR_UP(SØKER_IND)                     00004280
                = U3S.INNTEKT_FØR_UP /100;                              00004290
                                                                        00004300
             IF B01.INNT_DATO_ÅM(SØKER_IND) > 0 THEN                    00004310
                B02.INNT_DATO_ÅM(SØKER_IND)                             00004320
                   = B01.INNT_DATO_ÅM(SØKER_IND);                       00004330
             ELSE                                                       00004340
                B02.INNT_DATO_ÅM(SØKER_IND) = F_SNU_DATO(U3S.UFT_MÅ);   00004350
          END; /* FØRSTE UFØRETIDSPUNKT - OK */                         00004360
    ELSE                                                                00004370
       DO;  /* INNTEKT FØR UP IKKE UTFYLT */                            00004380
          IF B01.UFØRPENS.INNTEKT_FØR_UP(SØKER_IND) > 0 THEN            00004390
             DO;  /* HAR REGISTRERT INNTEKTSNIVÅ */                     00004400
                B02.UFØRPENS.INNTEKT_FØR_UP(SØKER_IND)                  00004410
                   = B01.UFØRPENS.INNTEKT_FØR_UP(SØKER_IND);            00004420
                IF B01.INNT_DATO_ÅM(SØKER_IND) > 0 THEN                 00004430
                   B02.INNT_DATO_ÅM(SØKER_IND)                          00004440
                      = B01.INNT_DATO_ÅM(SØKER_IND);                    00004450
                ELSE                                                    00004460
                   B02.INNT_DATO_ÅM(SØKER_IND)                          00004470
                      = B01.UFØRHIST.UFT_ÅM(SØKER_IND,1);               00004480
             END; /* HAR REGISTRERT INNTEKTSNIVÅ */                     00004490
      END; /* INNTEKT FØR UP IKKE UTFYLT */                             00004500
                                                                        00004510
    B02.UFØRPENS.UTDANNING(SØKER_IND)     = U3S.UTDANNING;              00004520
    B02.UFØRPENS.YRKESM_ATTF(SØKER_IND)   = U3S.YRKESM_ATTF;            00004530
    B02.YNGSTE_BARN_FÅR       (SØKER_IND) = U3S.YNGSTE_BARN_FÅR;        00004540
    IF ALDER_UF  > 2600       THEN                                      00004550
       U3S.GARANTERT_TP = ' ';                       /*9802*/           00004560
    ELSE                                                                00004570
    IF FNR_R_Å < 41           THEN                                      00004580
       U3S.GARANTERT_TP = ' ';                       /*9802*/           00004590
    ELSE      /*9804 HL */                                              00004600
    IF B01.PENSJONSTYPE1(SØKER_IND) = 'U'   !                           00004610
       B01.PENSJONSTYPE1(SØKER_IND) = 'Y'          THEN                 00004620
       DO;                                                              00004630
          IF (U3S.GARANTERT_TP = 'J'   &                                00004640
              B01.GARANTERT_TP(SØKER_IND)  = 'N' )     !                00004650
             (U3S.GARANTERT_TP = 'N'   &                                00004660
              (B01.GARANTERT_TP(SØKER_IND)  = 'J' !                     00004670
               B01.GARANTERT_TP(SØKER_IND)  = ' ' ))       THEN         00004680
             DO;                                                        00004690
                FEIL_VED_LABEL = '118';                                 00004700
                FEIL_MELD_NR   = 1552; /*IKKE LOV Å ENDRE KODE*/        00004710
                GO TO RETUR;                                            00004720
             END;                                                       00004730
       END;                                                             00004740
    ELSE                                                                00004750
    IF U3S.GARANTERT_TP = ' '      THEN                                 00004760
       DO;                                                              00004770
  L118:   /*FELTNUMMER*/                                                00004780
          FEIL_VED_LABEL = '118';                                       00004790
          FEIL_MELD_NR   = 1544;                                        00004800
          GO TO RETUR;                                                  00004810
       END;                                                             00004820
    ELSE                                                                00004830
       B02.GARANTERT_TP (SØKER_IND) = U3S.GARANTERT_TP;                 00004840
                                                                        00004850
    /* -------------------------------------------------------------- */00004860
    /* 1.22 TIDSBEGRENSET ATTFØRING                          R0019703 */00004870
    /* -------------------------------------------------------------- */00004880
    IF   (U3S.TIDSBEGR_ATTF ^= '')                 THEN                 00004890
      DO;                                                               00004900
         FEIL_MELD_NR                                                   00004910
            = FKS_TIDSBEGR_ATTF                                         00004920
                 (U3S.TIDSBEGR_ATTF,                                    00004930
                  U3S.SKJERM_ATTF);                                     00004940
         IF FEIL_MELD_NR ^= 0 THEN                                      00004950
            FEIL_VED_LABEL = '122'; /* TILSVARER FELTNUMMER */          00004960
      END;                                                              00004970
    /* -------------------------------------------------------------- */00004980
    /* 1.23 VARIG SKJERMET ATTFØRING                         R0019704 */00004990
    /* -------------------------------------------------------------- */00005000
    IF (U3S.SKJERM_ATTF ^= '') THEN                                     00005010
       DO;                                                              00005020
          FEIL_MELD_NR                                                  00005030
             = FKS_SKJERM_ATTF                                          00005040
                  (U3S.SKJERM_ATTF,                                     00005050
                   U3S.TIDSBEGR_ATTF);                                  00005060
          IF FEIL_MELD_NR ^= 0 THEN                                     00005070
             FEIL_VED_LABEL = '123'; /* TILSVARER FELTNUMMER */         00005080
       END;                                                             00005090
                                                                        00005100
 /*NY U3 9802 HL : */                                                   00005110
    IF U3S.ATT_UF = 'A'       &                                         00005120
      (U3S.FRYSP_3ÅR_ARB ^= ' '   !                                     00005130
       U3S.FRYSP_TIDSB   ^= ' '    )     THEN                           00005140
  L124:   /*FELTNUMMER*/                                                00005150
       DO;                                                              00005160
          FEIL_VED_LABEL = '124';                                       00005170
          FEIL_MELD_NR   = 1546;                                        00005180
          GO TO RETUR;                                                  00005190
       END;                                                             00005200
    IF U3S.FRYSP_3ÅR_ARB = 'S' THEN                                     00005210
       DO;                                                              00005220
          IF U3S.FRYSP_TIDSB ^= 'X'      THEN                           00005230
             DO;                                                        00005240
                FEIL_VED_LABEL = '124';                                 00005250
                FEIL_MELD_NR   = 1547;                                  00005260
                GO TO RETUR;                                            00005270
             END;                                                       00005280
          ELSE                                                          00005290
          IF B02.FRYSKODE(SØKER_IND) = ' '      THEN                    00005300
             DO;                                                        00005310
                FEIL_VED_LABEL = '124';                                 00005320
                FEIL_MELD_NR   = 1548;                                  00005330
                GO TO RETUR;                                            00005340
             END;                                                       00005350
          ELSE                                                          00005360
             DO;                                                        00005370
                B02.FRYSKODE(SØKER_IND) = '1';                          00005380
                B02.FRYSDATO_ÅM(SØKER_IND) = HJ_VIRK_DATO_ÅM;           00005390
             END;                                                       00005400
       END;                                                             00005410
    ELSE                                                                00005420
    IF U3S.FRYSP_TIDSB   = 'S' THEN                                     00005430
       DO;                                                              00005440
          IF U3S.FRYSP_3ÅR_ARB ^= 'X'      THEN                         00005450
             DO;                                                        00005460
                FEIL_VED_LABEL = '124';                                 00005470
                FEIL_MELD_NR   = 1547;                                  00005480
                GO TO RETUR;                                            00005490
             END;                                                       00005500
          ELSE                                                          00005510
          IF B02.FRYSKODE(SØKER_IND) = ' '      THEN                    00005520
             DO;                                                        00005530
                FEIL_VED_LABEL = '124';                                 00005540
                FEIL_MELD_NR   = 1548;                                  00005550
                GO TO RETUR;                                            00005560
             END;                                                       00005570
          ELSE                                                          00005580
             DO;                                                        00005590
                B02.FRYSKODE(SØKER_IND) = '2';                          00005600
                B02.FRYSDATO_ÅM(SØKER_IND) = HJ_VIRK_DATO_ÅM;           00005610
             END;                                                       00005620
       END;                                                             00005630
    ELSE                                                                00005640
    IF U3S.FRYSP_3ÅR_ARB = 'X' THEN                                     00005650
       DO; /*BARE TILLATT VED OVERGANG TIL FRYSP_TIDSB*/                00005660
          FEIL_VED_LABEL = '124';                                       00005670
          FEIL_MELD_NR   = 1549;                                        00005680
          GO TO RETUR;                                                  00005690
       END;                                                             00005700
    ELSE                                                                00005710
    IF U3S.FRYSP_TIDSB   = 'X' THEN                                     00005720
       DO;                                                              00005730
          IF B02.FRYSKODE(SØKER_IND) ^= '2'      THEN                   00005740
             DO;                                                        00005750
                FEIL_VED_LABEL = '124';                                 00005760
                FEIL_MELD_NR   = 0435;                                  00005770
                GO TO RETUR;                                            00005780
             END;                                                       00005790
          ELSE                                                          00005800
             DO;                                                        00005810
                B02.FRYSKODE(SØKER_IND) = ' ';                          00005820
                B02.FRYSDATO_ÅM(SØKER_IND) = 0;                         00005830
             END;                                                       00005840
       END;                                                             00005850
                                                          /*EØS*/       00005860
    IF U3S.ATT_UF = 'X'    THEN                                         00005870
       B02.PENSJONSTYPE2(SØKER_IND) = 'A';                              00005880
                                                                        00005890
 /* ***************************************************************** */00005900
 /* TRYGDETID  (FELTENE TT_FRA1937 ER OPPDATERT I 603 FOR NORSK_BOSATT*/00005910
 /*             DE INNEHOLDER FAKTISK TRYGDETID)                      */00005920
 /* ***************************************************************** */00005930
                                                                        00005940
    HJ_UFT_MÅ      = U3S.UFT_MÅ;                                        00005950
                                                                        00005960
    IF U3SP.STI_MÅ_3B         > 0        THEN                           00005970
       HJ_MÅ = U3SP.STI_MÅ_3B;                                          00005980
  /* ************                                                       00005990
    ELSE                                                                00006000
    IF U3SP.STI_MÅ_3C         > 0        THEN                           00006010
       HJ_MÅ = U3SP.STI_MÅ_3C;            ************* */              00006020
    ELSE                                                                00006030
       HJ_MÅ = U3S.UFT_MÅ;                                              00006040
                                                                        00006050
    HJ_ÅM = F_SNU_DATO(HJ_MÅ);                                          00006060
    HJ_ÅM_FIX = HJ_ÅM;                                                  00006070
 /* B02.TT_16_66(SØKER_IND) = U3SP.TT_FRA1937_ÅR * 12 +                 00006080
                                    U3SP.TT_FRA1937_MND;    */          00006090
                                                                        00006100
                                                                        00006110
   IF U3S.NORSK_BOSATT ^= 'N'  THEN                                     00006120
     DO;                                                                00006130
      IF  HJ_VIRK_DATO_ÅM > 9100   THEN                                 00006140
       B02.TT_16_66(SØKER_IND) = (HJ_UFT_Å -(FNR_R_Å + 16)) * 12        00006150
                               + HJ_UFT_M - FNR_R_M; /*HL 120994*/      00006160
      ELSE                                                              00006170
       DO;                                                              00006180
         B02.TT_16_66(SØKER_IND) = U3SP.TT_FRA1937_ÅR * 12 +            00006190
                                 U3SP.TT_FRA1937_MND;/*TRUDE 131094  */ 00006200
                                                                        00006210
         B02.TT_FØR_1967  (SØKER_IND) = U3SP.TT_F67;                    00006220
         B02.TT_ETTER_1966(SØKER_IND) = U3SP.TT_E66_Å * 12 +            00006230
                                        U3SP.TT_E66_M;                  00006240
       END;                                                             00006250
    END;     /* BOSATT */                                               00006260
                                                                        00006270
    IF B02.TT_16_66(SØKER_IND) > 480     THEN                           00006280
       B02.TT_16_66(SØKER_IND) = 480;   /*HL 080694*/                   00006290
                                                                        00006300
 /*BLANKES FOR SIKKERHETS SKYLD : */                                    00006310
    B02.TT_NORDISK_FAKT_MND (SØKER_IND) = 0;                            00006320
    B02.PÅ_NORDISK_FAKT    (SØKER_IND) = 0;                             00006330
                                                                        00006340
 /* ***************************************************************** */00006350
 /* HVIS SPESIELLE OPPLYSNINGER                                       */00006360
 /* ***************************************************************** */00006370
                                                                        00006380
    B02.SPESOPPL(SØKER_IND) = '';                                       00006390
    B02.EØSINFO (SØKER_IND) = '';                                       00006400
                                                                        00006410
    IF U3S.NORSK_BOSATT = 'N'  THEN                                     00006420
       DO;                                                              00006430
          IF U3SP.TT_F67           = 0         &                        00006440
             U3SP.TT_E66_Å         = 0         &                        00006450
             U3SP.TT_E66_M         = 0         &                        00006460
             U3SP.TT_KONVENSJON_ÅR = 0         &                        00006470
             U3SP.TT_FRA1937_ÅR    = 0         &                        00006480
             U3SP.TT_FRA1937_MND   = 0        THEN                      00006490
             DO;                                                        00006500
 /* ***************************************************************** */00006510
 /* KARI SANNESS 27.1.94 : HVIS DET IKKE ER FYLT UT NOE OM TRYGDETID, */00006520
 /*                        SÅ SKAL GAMMEL TT BRUKES                   */00006530
 /* ***************************************************************** */00006540
                                                                        00006550
                B02.TT_16_66(SØKER_IND) = B02.TT_ANV(SØKER_IND) * 12    00006560
                                        - B02.TT_FRAMT(SØKER_IND);      00006570
                B02.TT_FØR_1967(SØKER_IND) = 0;                         00006580
                B02.TT_ETTER_1966(SØKER_IND) = 0;                       00006590
                B02.TT_67_TIL_70 (SØKER_IND) = 0;                       00006600
             END;                                                       00006610
          ELSE                                                          00006620
             DO;                                                        00006630
                B02.TT_16_66(SØKER_IND)                                 00006640
                   = U3SP.TT_FRA1937_ÅR * 12 + U3SP.TT_FRA1937_MND;     00006650
                B02.TT_FØR_1967(SØKER_IND) = U3SP.TT_F67;               00006660
                B02.TT_ETTER_1966(SØKER_IND)                            00006670
                   = U3SP.TT_E66_Å * 12 + U3SP.TT_E66_M;                00006680
                B02.TT_GARANTI (SØKER_IND) = 0;        /*17.1.94HL */   00006690
                IF (U3SP.TT_KONVENSJON_ÅR > 0) THEN                     00006700
                   B02.TT_16_66(SØKER_IND)                              00006710
                      = U3SP.TT_KONVENSJON_ÅR * 12;                     00006720
                ELSE                                                    00006730
             /*REGN TT_FRAMT*/                                          00006740
                                                                        00006750
 /* FJERNET NESTE TEST 0994 HL : */                                     00006760
                                                                        00006770
  /*      IF B02.TT_16_66(SØKER_IND) = 0          THEN                  00006780
             B02.TT_FRAMT(SØKER_IND) =                                  00006790
                    (ALDER_67.ÅR * 12) - (HJ_Å * 12 + HJ_M -1);         00006800
          ELSE    */                                                    00006810
                   DO;/*FRAVIK FLYKT GAV RED ANT BUP ÅR. TRUDE 100992*/ 00006820
                      IF  U3SP.FRAVIK_FLYKT = 'J'      !                00006830
                          (B02.TT_16_66(SØKER_IND) =  0  &              00006840
                           B02.UFØRPENS.STI(SØKER_IND) =  0 ) THEN      00006850
                         IF B02.PENSJONSRETT_FØR_91(SØKER_IND)='J' THEN 00006860
                            B02.STATUS.TT_FRAMT(SØKER_IND)              00006870
                               = (ALDER_67.ÅR * 12 + ALDER_67.MND)      00006880
                               - (HJ_Å * 12 + HJ_M);                    00006890
                         ELSE                                           00006900
                            B02.STATUS.TT_FRAMT(SØKER_IND)              00006910
                               = (ALDER_67.ÅR * 12)                     00006920
                               - (HJ_Å * 12 + HJ_M);                    00006930
                      ELSE                                              00006940
                         B02.STATUS.TT_FRAMT(SØKER_IND)                 00006950
                            = F_BEREGN_TT_FRAMT_UTLAND                  00006960
                                 ((B02.FNR(SØKER_IND)),                 00006970
                                   HJ_ÅM_FIX,                           00006980
                                   SØKER_IND);                          00006990
                   END;                                                 00007000
                                                                        00007010
             END;                                                       00007020
          IF B02.TT_16_66(SØKER_IND) > 480     THEN                     00007030
             B02.TT_16_66(SØKER_IND) = 480;                             00007040
                                                                        00007050
          /* TILLEGGSTEST 210994 HL : */                                00007060
                                                                        00007070
          IF U3SP.TT_F67_EK > 0       THEN                              00007080
             B02.TT_FØR_1967  (EKTEF_IND) = U3SP.TT_F67_EK;             00007090
                                                                        00007100
          IF U3SP.TT_E66_Å_EK > 0     THEN                              00007110
             B02.TT_ETTER_1966(EKTEF_IND) = U3SP.TT_E66_Å_EK * 12 +     00007120
                                            U3SP.TT_E66_M_EK;           00007130
                                                                        00007140
          B02.SPESOPPL.STATSBORGER(SØKER_IND)   = U3SP.STATSBORGER;     00007150
          B02.SPESOPPL.BOSATT(SØKER_IND)        = U3SP.BOSATT;          00007160
       B02.SPESOPPL.PENSJONSTRYGDET(SØKER_IND) = U3SP.PENSJONSTRYGDET;  00007170
          B02.SPESOPPL.MINST_20ÅR_BOTID(SØKER_IND) = U3SP.MINST_20_ÅR;  00007180
          B02.SPESOPPL.FRAVIK_BOSATT_KONVENSJON(SØKER_IND) =            00007190
                                                     U3SP.KONVENSJON;   00007200
          B02.SPESOPPL.FRAVIK_FLYKTN(SØKER_IND) = U3SP.FRAVIK_FLYKT;    00007210
          IF U3SP.OVERKOMP_UTL = 'J'             THEN                   00007220
             B02.SPESOPPL.OVERKOMP_UTL(SØKER_IND)  = 'J';               00007230
          ELSE                                                          00007240
             B02.SPESOPPL.OVERKOMP_UTL(SØKER_IND)  = 'N';               00007250
          B02.SPESOPPL.IKKE_GP      (SØKER_IND) = U3SP.IKKE_GP;         00007260
          B02.SPESOPPL.KONVENSJON(SØKER_IND) =  U3SP.BEREGNING_KONV;    00007270
    /*NY U3 9802 HL : */                                                00007280
  /*      IF U3SP.FRAVIK_8_1_3B = 'J'   !                               00007290
             U3SP.FRAVIK_8_1_3C = 'J'           THEN     */             00007300
          IF U3SP.UNNTAK_12_2   = 'J'          THEN                     00007310
  /*         B02.SPESOPPL.FRAVIK_8_1_3(SØKER_IND)  =  'J';  */          00007320
             B02.SPESOPPL.UNNTAK_12_2 (SØKER_IND)  =  'J';              00007330
          IF U3SP.STI_MÅ_3B > 0          THEN                           00007340
             B02.UFØRPENS.STI(SØKER_IND) = F_SNU_DATO(U3SP.STI_MÅ_3B);  00007350
  /*      ELSE                                                          00007360
          IF U3SP.STI_MÅ_3C > 0          THEN                           00007370
             B02.UFØRPENS.STI(SØKER_IND) = F_SNU_DATO(U3SP.STI_MÅ_3C);  00007380
  ***************** */                                                  00007390
          B02.SPESOPPL.FRAVIK_8_1(SØKER_IND) = U3SP.FRAVIK_8_1;         00007400
          IF U3SP.TT_PÅ     = 'J'    !                                  00007410
             U3SP.TT_LIK_PÅ = 'J'          THEN                         00007420
             DO;                                                        00007430
                B02.SPESOPPL.TT_PÅ     (SØKER_IND) = 'J';               00007440
    /*          B02.TT_FØR_1967        (SØKER_IND) =  0 ;               00007450
                B02.TT_ETTER_1966      (SØKER_IND) =  0 ;               00007460
                B02.TT_FRAMT           (SØKER_IND) =  0 ;               00007470
                B02.TT_67_TIL_70       (SØKER_IND) =  0 ;               00007480
                B02.TT_16_66           (SØKER_IND) =  0 ;               00007490
                B02.TT_GARANTI         (SØKER_IND) =  0 ;   */          00007500
             END;                                                       00007510
          B02.SPESOPPL.TT_FRAMTIDIG (SØKER_IND) = U3SP.TT_FRAMTIDIG;    00007520
          B02.SPESOPPL.TT_FAKTISK   (SØKER_IND) = U3SP.TT_FAKTISK;      00007530
  /*      B02.SPESOPPL.FRAVIK_5_1(SØKER_IND) = U3SP.FRAVIK_5_1; */      00007540
          B02.SPESOPPL.UNG_UFØR  (SØKER_IND) = U3SP.UNG_UFØR;           00007550
                                                                        00007560
 /*TILLEGG 0196 HL : */                                                 00007570
                                                                        00007580
          B02.TT_NORDISK_FAKT_MND (SØKER_IND)                           00007590
             = ((U3SP.TT_FAKTISK_NORDISK_ÅR * 12)                       00007600
             + U3SP.TT_FAKTISK_NORDISK_MND);                            00007610
          B02.PÅ_NORDISK_FAKT(SØKER_IND)                                00007620
             = U3SP.PÅ_FAKTISK_NORDISK;                                 00007630
          IF ( B02.TT_NORDISK_FAKT_MND(SØKER_IND)                       00007640
              +B02.PÅ_NORDISK_FAKT(SØKER_IND)    > 0 ) THEN             00007650
             B02.NORDISK_KONVENSJON(SØKER_IND) = 'J';                   00007660
  /*EØS : */                                                            00007670
          B02.KONVENSJON_LAND(SØKER_IND) = U3SP.KONVENSJON_LAND;        00007680
          B02.FRAVIK_BOSATT_EØS(SØKER_IND) = U3SP.FRAVIK_BOSATT_EØS;    00007690
          B02.TP_NORDISK       (SØKER_IND) = U3SP.TP_NORDISK;           00007700
          B02.TP_NORDISK_LAND  (SØKER_IND) = U3SP.TP_NORDISK_LAND;      00007710
          B02.TT_KONVENSJON_ÅR  (SØKER_IND) = U3SP.TT_KONVENSJON_ÅR;    00007720
  /*EØSINFO : */                                                        00007730
          /* -------------------------------------------------------- */00007740
          IF (B02.PENSJONSTYPE2(SØKER_IND) = 'A') THEN                  00007750
             DO;                                                        00007760
                B02.BEREGN_FOLKETRYGD(SØKER_IND) = 'J';                 00007770
                B02.EØS_8_4_3A(SØKER_IND)        = U3S.VILKÅR_8_4_3A;   00007780
             END;                                                       00007790
          ELSE                                                          00007800
             DO;                                                        00007810
                B02.BEREGN_FOLKETRYGD(SØKER_IND)                        00007820
                   = U3SP.BEREGN_FOLKETRYGD;                            00007830
                B02.EØS_8_4_3A(SØKER_IND)                               00007840
                   = U3SP.EØS_8_4_3A;                                   00007850
             END;                                                       00007860
          /* 3.18 */                                                    00007870
          B02.TT_PRO_RATA_MND(SØKER_IND)                                00007880
             = U3SP.TT_PRORATA_EØS_MND                                  00007890
             + (U3SP.TT_PRORATA_EØS_ÅR * 12);                           00007900
                                                                        00007910
          /* 3.17 */                                                    00007920
          B02.TT_TEORETISK_EØS_MND(SØKER_IND) =                         00007930
                    U3SP.TT_TEORETISK_EØS_MND                           00007940
                 + (U3SP.TT_TEORETISK_EØS_ÅR * 12);                     00007950
                                                                        00007960
          IF ( B02.TT_PRO_RATA_MND(SØKER_IND)                           00007970
              +B02.TT_TEORETISK_EØS_MND(SØKER_IND)>0) THEN              00007980
             B02.PRO_RATA_BEREGNING(BER_SØ_IND) = 'J';                  00007990
          /* 3. 19 */                                                   00008000
          B02.PENSJON_EØS (SØKER_IND)  = U3SP.PENSJON_EØS;              00008010
                                                                        00008020
          /* 3.16 POENGÅR I EØSOMRÅDET */                               00008030
          DO I = 67  TO 106;                                            00008040
                B02.INNTEKTSÅR_EØS(SØKER_IND,I) = NEI;                  00008050
          END;                                                          00008060
                                                                        00008070
          DO I = 1 TO 33;                                               00008080
             ÅR_IND = U3SP.EØS_ÅR(I);                                   00008090
             IF ÅR_IND > 0   THEN                                       00008100
                B02.INNTEKTSÅR_EØS(SØKER_IND,ÅR_IND) = JA;              00008110
          END;                                                          00008120
          DO I = 1967 TO 2006;                                          00008130
                B02.EØS_ÅR_IKKE_PRO_RATA(SØKER_IND,I) = NEI;            00008140
          END;                                                          00008150
                                                                        00008160
          DO I = 1 TO 9;                                                00008170
             ÅR_IND = U3SP.EØS_ÅR_IKKE_PRO_RATA(I);                     00008180
             IF ÅR_IND > 0   THEN                                       00008190
                B02.EØS_ÅR_IKKE_PRO_RATA(SØKER_IND,I) = JA;             00008200
          END;                                                          00008210
       END;                                                             00008220
                                                                        00008230
    ELSE                                                                00008240
       B02.STATUS.TT_FRAMT(SØKER_IND) =                                 00008250
           (ALDER_67.ÅR * 12) - (HJ_Å * 12 + HJ_M);                     00008260
                                                                        00008270
    IF B02.STATUS.TT_FRAMT(SØKER_IND) < 0           THEN                00008280
       B02.STATUS.TT_FRAMT(SØKER_IND) = 0;                              00008290
    IF B02.STATUS.TT_FRAMT(SØKER_IND) > 480         THEN                00008300
       B02.STATUS.TT_FRAMT(SØKER_IND) = 480;   /*HL 0196*/              00008310
                                                                        00008320
 /* ***************************************************************** */00008330
 /* PENSJONSGIVENDE INNTEKT                                           */00008340
 /* ***************************************************************** */00008350
                                                                        00008360
 %SKIP;                                                                 00008370
    ÅR_FØR_UFØRHET = HJ_UFT_Å - 1;                                      00008380
                                                                        00008390
 /* ***************************************************************** */00008400
 /* HER MÅ VI TESTE PÅ EN KODE FOR Å SE OM VI HAR FÅTT RAPP. INNTEKT  */00008410
 /* ***************************************************************** */00008420
                                                                        00008430
    IF ÅR_FØR_UFØRHET            > 66     THEN                          00008440
       IF B01.PINNTEKT.PI_KODE(SØKER_IND,ÅR_FØR_UFØRHET) = ' ' !        00008450
          B01.PINNTEKT.PI_KODE(SØKER_IND,ÅR_FØR_UFØRHET) = 'F' THEN     00008460
          DO;                                                           00008470
             IF U3S.PI > 0 THEN                                         00008480
                DO;                                                     00008490
                   B02.PI_KODE(SØKER_IND,ÅR_FØR_UFØRHET) = 'F';         00008500
                   B02.PI(SØKER_IND,ÅR_FØR_UFØRHET)      =              00008510
                                                          U3S.PI / 100; 00008520
                END;                                                    00008530
          END;                                                          00008540
                                                                        00008550
 /* ***************************************************************** */00008560
 /* UFØREHISTORIKK                                                    */00008570
 /* ***************************************************************** */00008580
                                                                        00008590
    DO I = 1 TO 7;                 /*0697 HL*/                          00008600
       SELECT;                                                          00008610
         WHEN(B01.UFØRHIST.UFT_ÅM(SØKER_IND,I) = F_SNU_DATO(U3S.UFT_MÅ))00008620
                                                                        00008630
 /* ***************************************************************** */00008640
 /* D.V.S VI HAR EN PERIODE FRA FØR MED SAMME UFTIDSPUNKT             */00008650
 /* ***************************************************************** */00008660
                                                                        00008670
         DO;                                                            00008680
            DO J = 1 TO 7;     /*0697 HL*/                              00008690
              IF B02.UFG_DATO_ÅM(SØKER_IND,I,J) > 0 THEN                00008700
                 DO;                                                    00008710
                    B02.UFG_ØVRIGE(SØKER_IND,I,J) = 0;                  00008720
                    B02.UFG_DATO_ÅM(SØKER_IND,I,J) = 0;                 00008730
                 END;                                                   00008740
              ELSE                                                      00008750
                 J=7;         /*0697 HL*/                               00008760
            END;                                                        00008770
            DIV_PARAM_OMR.REGN_1291 = ' ';    /*HL*/                    00008780
                                                                        00008790
            UF_IND = I;                                                 00008800
            B02.UFØRHIST.UFG(SØKER_IND,I)= U3S.UFG;                     00008810
                                                                        00008820
 /*HL : UFKRIT BLE ALLTID SATT > 0 FOR YRKESSKADDE - RETTET 2.4.91*/    00008830
                                                                        00008840
            IF U3S.VILKÅR_8_4_3A = 'J' THEN                             00008850
               IF U3S.YSKADE_TILLEGG = 'J' THEN                         00008860
                  IF U3Y.KAP_11_7_UTLØST = 'J'    THEN                  00008870
                     B02.UFKRITERIER(SØKER_IND,I) = 5;                  00008880
                  ELSE                                                  00008890
                     B02.UFKRITERIER(SØKER_IND,I) = 4;                  00008900
               ELSE                                                     00008910
                  B02.UFKRITERIER(SØKER_IND,I) = 2;                     00008920
            ELSE                                                        00008930
               B02.UFKRITERIER(SØKER_IND,I) = 0;                        00008940
            IF B01.BUP_GAR_KODE(SØKER_IND,I) = 'A' THEN                 00008950
               DO;                                                      00008960
                  IF HJ_VIRK_DATO_ÅM >= TJUEÅRSDATO  THEN               00008970
                     B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';               00008980
               END;                                                     00008990
            B02.UFØRHIST.OPPHØRSDATO_ÅM(SØKER_IND,I) = 0;               00009000
            B02.UFØRHIST.OPPHØRSKODE   (SØKER_IND,I) = ' ';             00009010
            I = 7;                     /*0697 HL*/                      00009020
         END;                                                           00009030
         WHEN (B01.UFØRHIST.UFT_ÅM(SØKER_IND,I) = 0)                    00009040
         DO;                                                            00009050
                                                                        00009060
 /* ***************************************************************** */00009070
 /* D.V.S. DETTE ER FØRSTE LEDIGE PLASS.                              */00009080
 /* ***************************************************************** */00009090
                                                                        00009100
            UF_IND = I;                                                 00009110
            B02.UFØRHIST.UFT_ÅM(SØKER_IND,I) = F_SNU_DATO(U3S.UFT_MÅ);  00009120
            B02.UFØRHIST.UFG(SØKER_IND,I)    = U3S.UFG;                 00009130
            IF U3S.VILKÅR_8_4_3A = 'J' THEN                             00009140
               B02.UFKRITERIER(SØKER_IND,I) = 2;                        00009150
                                                                        00009160
 /*DETTE ER FØRSTE PERIODE - 9708 HL :                   */             00009170
                                                                        00009180
            IF UF_IND = 1  THEN                                         00009190
               CALL UNGE_UFØRE;                /*U623*/                 00009200
 /*         IF UF_IND > 1 THEN              */                          00009210
            ELSE                                                        00009220
               DO;                                                      00009230
                                                                        00009240
 /* ***************************************************************** */00009250
 /* DET FINNES EN FORRIGE PERIODE SOM VI NÅ OPPHØRER                  */00009260
 /* ***************************************************************** */00009270
                                                                        00009280
                  IF B01.OPPHØRSDATO_ÅM(SØKER_IND,(I-1)) = 0  THEN      00009290
                     DO;                                                00009300
                        B02.OPPHØRSDATO_ÅM(SØKER_IND,(I-1))             00009310
         /*                     = F_SNU_DATO(U3S.UFT_MÅ);*/             00009320
                                = OPPH_ÅR*100+OPPH_MN;  /*9807*/        00009330
                        B02.OPPHØRSKODE(SØKER_IND,(I-1)) = 'J';         00009340
      /*0697 HL*/       DO J = 1 TO 7 WHILE (B02.UFG_DATO_ÅM(SØKER_IND, 00009350
                                      (I-1), J) > 0);                   00009360
                           IF B02.UFG_DATO_ÅM(SØKER_IND,(I-1),J) =      00009370
                              B02.UFØRHIST.UFT_ÅM(SØKER_IND,I)  THEN    00009380
                                                                        00009390
                                       /* DET NYE UFØRETIDSPT ER LIK */ 00009400
                                       /* TIDSPT TIL SISTE UFØREGRAD */ 00009410
                                       /* I FORRIGE PERIODE OG MÅ    */ 00009420
                                       /* SLETTES                    */ 00009430
                              DO;                                       00009440
                                 B02.UFG_ØVRIGE(SØKER_IND,(I-1),J) = 0; 00009450
                                 B02.UFG_DATO_ÅM(SØKER_IND,(I-1),J) = 0;00009460
                                 B01.UFG_ØVRIGE(SØKER_IND,(I-1),J) = 0; 00009470
                                 B01.UFG_DATO_ÅM(SØKER_IND,(I-1),J) = 0;00009480
                              END;                                      00009490
                           ELSE                                         00009500
                           IF B02.UFG_DATO_ÅM(SØKER_IND,(I-1),J) >      00009510
                              B02.UFØRHIST.UFT_ÅM(SØKER_IND,I)  THEN    00009520
                              DO;                                       00009530
 /* ***************************************************************** */00009540
 /* FEIL, UFØREDATO I FORRIGE PERIODE ER ETTER DET NYE UFØRETIDSPUNKT */00009550
 /* ***************************************************************** */00009560
                                                                        00009570
  L278:                                                                 00009580
                                   FEIL_VED_LABEL = '278';              00009590
                                   FEIL_MELD_NR   = 1711;               00009600
                                   GO TO RETUR;                         00009610
                              END;                                      00009620
                        END;  /* DO J = 1 TO 7 */                       00009630
                                                                        00009640
                     END;                                               00009650
                                                                        00009660
                  ELSE        /*TILLEGG 0195 HL : */                    00009670
                  IF B01.OPPHØRSDATO_ÅM(SØKER_IND,(I-1)) >              00009680
                                  F_SNU_DATO(U3S.UFT_MÅ)    THEN        00009690
                     DO;                                                00009700
                        B02.OPPHØRSDATO_ÅM(SØKER_IND,(I-1))             00009710
        /*                     = F_SNU_DATO(U3S.UFT_MÅ); */             00009720
                               = OPPH_ÅR*100+OPPH_MN;  /*9807*/         00009730
                        B02.OPPHØRSKODE(SØKER_IND,(I-1)) = 'J';         00009740
                     END;                                               00009750
                                                                        00009760
 /* ***************************************************************** */00009770
 /* HER OVERFØRES BUP-GARANTI OG KODE FRA FORRIGE PERIODE             */00009780
 /* ***************************************************************** */00009790
                                                                        00009800
                  B02.BUP_GARANTI(SØKER_IND,I) =                        00009810
                                    B02.BUP_GARANTI(SØKER_IND,(I-1));   00009820
                  B02.BUP_GAR_KODE(SØKER_IND,I) =                       00009830
                                   B02.BUP_GAR_KODE(SØKER_IND,(I-1));   00009840
                  IF B02.BUP_GAR_KODE(SØKER_IND,I) = 'A'                00009850
                                                                    THEN00009860
                     DO;                                                00009870
                        IF HJ_VIRK_DATO_ÅM >= TJUEÅRSDATO  THEN         00009880
                           B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';         00009890
                     END;                                               00009900
                                                                        00009910
  /*******        ELSE                                                  00009920
                  IF B02.BUP_GAR_KODE(SØKER_IND,I) = 'C' THEN           00009930
                                    B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';00009940
                                                                        00009950
                  ELSE                                                  00009960
                  IF B02.BUP_GAR_KODE(SØKER_IND,I) = 'D' THEN           00009970
                     IF HJ_VIRK_DATO_ÅM < TJUEÅRSDATO + 201        THEN 00009980
                        B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';            00009990
                     ELSE                                               00010000
                     IF HJ_VIRK_DATO_ÅM > 9204        THEN              00010010
                                    B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';00010020
                                                                        00010030
                  IF B02.BUP_GAR_KODE(SØKER_IND,I) = 'A' !              00010040
                     B02.BUP_GAR_KODE(SØKER_IND,I) = 'B' !              00010050
                     B02.BUP_GAR_KODE(SØKER_IND,I) = 'C' !              00010060
                     B02.BUP_GAR_KODE(SØKER_IND,I) = 'D' THEN           00010070
                     IF HJ_VIRK_DATO_ÅM < 8805 THEN                     00010080
                        IF HJ_VIRK_DATO_ÅM < 8705 THEN                  00010090
                           B02.BUP_GARANTI(SØKER_IND,I) = 2.00;         00010100
                        ELSE                                            00010110
                           B02.BUP_GARANTI(SØKER_IND,I) = 2.50;         00010120
                     ELSE                                               00010130
                     IF HJ_VIRK_DATO_ÅM < 9105 THEN                     00010140
                        B02.BUP_GARANTI(SØKER_IND,I) = 3.00;            00010150
                     ELSE                                               00010160
                        B02.BUP_GARANTI(SØKER_IND,I) = 3.30;            00010170
                                                                        00010180
    ************************************************************** */   00010190
               END;                                                     00010200
  /*                  ELSE */                                           00010210
                                                                        00010220
 /* ***************************************************************** */00010230
 /* DET ER INGEN FORRRIGE PERIODE                                     */00010240
 /* ***************************************************************** */00010250
 /*TILLEGG 16.8.96 HL : ********** */                                   00010260
                                                                        00010270
  /* ************************************************                   00010280
  IF FNR_R_Å > 22                                  THEN                 00010290
    IF FNR_R_Å < 45                                  THEN               00010300
       DO;                                                              00010310
         IF ALDER_UF       < 2201                    THEN               00010320
           DO;                                                          00010330
                                                                        00010340
                                                                        00010350
             B02.BUP_GAR_KODE(SØKER_IND,1)  = 'E';                      00010360
                                                                        00010370
             IF HJ_VIRK_DATO_ÅM < 8907                     THEN;        00010380
             ELSE                                                       00010390
                                                                        00010400
                                                                        00010410
             IF HJ_VIRK_DATO_ÅM < 9101                     THEN         00010420
                B02.BUP_GARANTI(SØKER_IND,1)  = 1.6;                    00010430
             ELSE                                                       00010440
                                                                        00010450
                                                                        00010460
             IF HJ_VIRK_DATO_ÅM < 9201                     THEN         00010470
                IF FNR_R_Å > 24                            THEN         00010480
                   B02.BUP_GARANTI(SØKER_IND,1)  = 2.0;                 00010490
                ELSE                                                    00010500
                   B02.BUP_GARANTI(SØKER_IND,1)  = 1.6;                 00010510
             ELSE                                                       00010520
                                                                        00010530
                                                                        00010540
             IF HJ_VIRK_DATO_ÅM < 9205                     THEN         00010550
                IF FNR_R_Å > 25                            THEN         00010560
                   B02.BUP_GARANTI(SØKER_IND,1)  = 2.5;                 00010570
                ELSE                                                    00010580
                IF FNR_R_Å = 25                            THEN         00010590
                   B02.BUP_GARANTI(SØKER_IND,1)  = 2.0;                 00010600
                ELSE                                                    00010610
                   B02.BUP_GARANTI(SØKER_IND,1)  = 1.6;                 00010620
             ELSE                                                       00010630
                                                                        00010640
             IF HJ_VIRK_DATO_ÅM < 9705                     THEN         00010650
                                                                        00010660
                                                                        00010670
                IF FNR_R_Å > 25                            THEN         00010680
                   IF FNR_R_Å > 42                         THEN         00010690
                      DO;                                               00010700
                        B02.BUP_GAR_KODE(SØKER_IND,1)  = 'E';           00010710
                        B02.BUP_GARANTI (SØKER_IND,1)  = 3.3;           00010720
                      END;                                              00010730
                   ELSE                                                 00010740
                      B02.BUP_GARANTI(SØKER_IND,1)  = 3.0;              00010750
                ELSE                                                    00010760
                IF FNR_R_Å = 25                            THEN         00010770
                   B02.BUP_GARANTI(SØKER_IND,1)  = 2.0;                 00010780
                ELSE                                                    00010790
                   B02.BUP_GARANTI(SØKER_IND,1)  = 1.6;                 00010800
             ELSE                                                       00010810
                IF FNR_R_Å > 42                            THEN         00010820
                   DO;                                                  00010830
                     B02.BUP_GAR_KODE(SØKER_IND,1)  = 'E';              00010840
                     B02.BUP_GARANTI (SØKER_IND,1)  = 3.3;              00010850
                   END;                                                 00010860
                ELSE                                                    00010870
                IF FNR_R_Å > 30                         THEN            00010880
                   B02.BUP_GARANTI(SØKER_IND,1)  = 3.3;                 00010890
                ELSE                                                    00010900
                IF FNR_R_Å > 25                            THEN         00010910
                   B02.BUP_GARANTI(SØKER_IND,1)  = 3.0;                 00010920
                ELSE                                                    00010930
                IF FNR_R_Å = 25                            THEN         00010940
                   B02.BUP_GARANTI(SØKER_IND,1)  = 2.0;                 00010950
                ELSE                                                    00010960
                   B02.BUP_GARANTI(SØKER_IND,1)  = 1.6;                 00010970
           END;                                                         00010980
         ELSE                                                           00010990
                                                                        00011000
                                                                        00011010
         IF ALDER_UF       < 2401                    THEN               00011020
           DO;                                                          00011030
             B02.BUP_GAR_KODE(SØKER_IND,1)  = 'E';                      00011040
             IF HJ_VIRK_DATO_ÅM < 9205                     THEN         00011050
                IF FNR_R_Å > 42                         THEN            00011060
                   B02.BUP_GAR_KODE(SØKER_IND,1)  = 'D';                00011070
                ELSE;                                                   00011080
             ELSE                                                       00011090
             IF HJ_VIRK_DATO_ÅM < 9705                     THEN         00011100
                IF FNR_R_Å > 42                         THEN            00011110
                   DO;                                                  00011120
                     B02.BUP_GAR_KODE(SØKER_IND,1)  = 'B';              00011130
                     B02.BUP_GARANTI (SØKER_IND,1)  = 3.3;              00011140
                   END;                                                 00011150
                ELSE                                                    00011160
                IF FNR_R_Å > 25                            THEN         00011170
                      B02.BUP_GARANTI(SØKER_IND,1)  = 3.0;              00011180
                ELSE                                                    00011190
                IF FNR_R_Å = 25                            THEN         00011200
                   B02.BUP_GARANTI(SØKER_IND,1)  = 2.0;                 00011210
                ELSE                                                    00011220
                   B02.BUP_GARANTI(SØKER_IND,1)  = 1.6;                 00011230
             ELSE                                                       00011240
                IF FNR_R_Å > 42                         THEN            00011250
                   DO;                                                  00011260
                     B02.BUP_GAR_KODE(SØKER_IND,1)  = 'B';              00011270
                     B02.BUP_GARANTI (SØKER_IND,1)  = 3.3;              00011280
                   END;                                                 00011290
                ELSE                                                    00011300
                IF FNR_R_Å > 30                            THEN         00011310
                      B02.BUP_GARANTI(SØKER_IND,1)  = 3.3;              00011320
                ELSE                                                    00011330
                IF FNR_R_Å > 25                            THEN         00011340
                      B02.BUP_GARANTI(SØKER_IND,1)  = 3.0;              00011350
                ELSE                                                    00011360
                IF FNR_R_Å = 25                            THEN         00011370
                   B02.BUP_GARANTI(SØKER_IND,1)  = 2.0;                 00011380
                ELSE                                                    00011390
                   B02.BUP_GARANTI(SØKER_IND,1)  = 1.6;                 00011400
           END;                                                         00011410
       END;                                                             00011420
                                                                        00011430
                                                                        00011440
     ELSE                                                               00011450
                                                                        00011460
                      IF B02.UFØRHIST.UFT_ÅM(SØKER_IND,I) <             00011470
                                            (TJUEÅRSDATO + 401)  &      00011480
                         B02.UFØRPENS.UFG(SØKER_IND) > 49     THEN      00011490
                         DO;                                            00011500
                            IF B02.UFØRHIST.UFT_ÅM(SØKER_IND,I) <       00011510
                                            (TJUEÅRSDATO + 201)  THEN   00011520
                               IF HJ_VIRK_DATO_ÅM < TJUEÅRSDATO THEN    00011530
                                  B02.BUP_GAR_KODE(SØKER_IND,I) = 'A';  00011540
                               ELSE                                     00011550
                                  B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';  00011560
                            ELSE                                        00011570
                            IF HJ_VIRK_DATO_ÅM > 9204 THEN              00011580
                                  B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';  00011590
                            ELSE                                        00011600
                                  B02.BUP_GAR_KODE(SØKER_IND,I) = 'D';  00011610
                            IF HJ_VIRK_DATO_ÅM < 8805 THEN              00011620
                               IF HJ_VIRK_DATO_ÅM < 8705 THEN           00011630
                                  B02.BUP_GARANTI(SØKER_IND,I) = 2.00;  00011640
                               ELSE                                     00011650
                                  B02.BUP_GARANTI(SØKER_IND,I) = 2.50;  00011660
                            ELSE                                        00011670
                            IF HJ_VIRK_DATO_ÅM < 9105 THEN              00011680
                               B02.BUP_GARANTI(SØKER_IND,I) = 3.00;     00011690
                            ELSE                                        00011700
                               B02.BUP_GARANTI(SØKER_IND,I) = 3.30;     00011710
                         END;                                           00011720
       ****************************************************** */        00011730
                         I = 7;                                         00011740
                   END;                                                 00011750
                OTHERWISE                                               00011760
                   DO;                                                  00011770
                                                                        00011780
                      DIV_PARAM_OMR.REGN_1291 = ' ';    /*HL*/          00011790
 /* ***************************************************************** */00011800
 /* ALLE UFØREPERIODENE ER UTFYLT                                     */00011810
 /* ***************************************************************** */00011820
                                                                        00011830
                      IF I = 7 THEN              /*0697 HL*/            00011840
                         DO;                                            00011850
                                                                        00011860
 /* ***************************************************************** */00011870
 /* FEIL, ALLE UFØREPERIODENE ER UTFYLT, IKKE PLASS TIL EN TIL        */00011880
 /* ***************************************************************** */00011890
                                                                        00011900
  L279:                                                                 00011910
                            FEIL_VED_LABEL = '279';                     00011920
                            FEIL_MELD_NR   = 1715;                      00011930
                            GO TO RETUR;                                00011940
                         END;                                           00011950
                 END;                                                   00011960
               END;                                                     00011970
          END;                                                          00011980
                                                                        00011990
              /* NY 93 */                                               00012000
    IF B02.BOSATT(SØKER_IND)         > 0 &                      /*93*/  00012010
       B02.VIRK_DATO_ÅM(SØKER_IND)   > 9212 &                   /*93*/  00012020
       B02.PENSJONSTRYGDET(SØKER_IND)         ^= 'J' THEN       /*93*/  00012030
         DO;                                                    /*93*/  00012040
           IF (B02.UFØRHIST.BUP_GAR_KODE(SØKER_IND,1) = 'B' !   /*93*/  00012050
               B02.UFØRHIST.BUP_GAR_KODE(SØKER_IND,1) = 'E' ) & /*93*/  00012060
               B02.SPESOPPL.UNG_UFØR    (SØKER_IND)  ^= 'J' THEN        00012070
            DO;                                                         00012080
             DO M = 1 TO 7;                /*0697 HL*/                  00012090
              B02.BUP_GAR_KODE(SØKER_IND,M) = ' ';               /*93*/ 00012100
              B02.BUP_GARANTI(SØKER_IND,M) = 0;                  /*93*/ 00012110
             END;                                                /*93*/ 00012120
              DIV_PARAM_OMR.SISTE_UFTIDSPUNKT = 'J';                    00012130
            END;                                                /*93*/  00012140
            B01.GT_LOV92(SØKER_IND)  = 0;                       /*93*/  00012150
            B02.GT_LOV92(SØKER_IND)  = 0;                       /*93*/  00012160
                                                                        00012170
      /*    IF B01.UFØRPENS.STI(SØKER_IND)     > 0  !                   00012180
               B02.UFØRPENS.STI(SØKER_IND)     > 0  THEN MHA7339*/      00012190
            /* NY TEST EØS-REGLER ?? */                                 00012200
            IF (B01.UFØRPENS.STI(SØKER_IND)     > 0  !                  00012210
                B02.UFØRPENS.STI(SØKER_IND)     > 0  ) &                00012220
               ^(B02.MINST_20ÅR_BOTID(SØKER_IND)         = 'J' !        00012230
                 B02.FRAVIK_BOSATT_EØS(SØKER_IND)        = 'J' !        00012240
                 B02.FRAVIK_5_1(SØKER_IND)               = 'J' !        00012250
                 B02.FRAVIK_BOSATT_KONVENSJON(SØKER_IND) = 'J' !        00012260
                 B02.FRAVIK_8_1(SØKER_IND)               = 'J' ) THEN   00012270
             DO;                                                        00012280
               B02.SUM_YTELSE(SØKER_IND)     = 0;                       00012290
               CALL UFØREPENSJON_OPPHØRER;             /*R0019940*/     00012300
               CALL P900_NOR_DATA((B01.FNR(SØKER_IND)),                 00012310
                                  (B01.TKNR(SØKER_IND)));               00012320
             END;                                                       00012330
         END;                                                   /*93*/  00012340
         /* 93 */                                                       00012350
                                                                        00012360
    IF B01.PENSJONSTYPE3(SØKER_IND) = 'A' THEN                          00012370
       B01.UFØRHIST(SØKER_IND,K) =                                      00012380
                                   B00.UFØRHIST(SØKER_IND,K);           00012390
                                                                        00012400
 /* ***************************************************************** */00012410
 /* SØKEREN HAR ATTFØRING FRA FØR.SS = NS OG NS BLIR FJERNET.         */00012420
 /* ***************************************************************** */00012430
                                                                        00012440
    IF U3S.ATT_UF = 'A' THEN                                            00012450
       IF (STATUS_TYPE = 'B' &                                          00012460
          TRANS_LISTE_INDEX > 1)  THEN                                  00012470
          IF B01.PENSJONSTYPE1(SØKER_IND)  = 'U' &                      00012480
             B01.PENSJONSTYPE3(SØKER_IND) ^= 'A' THEN                   00012490
             DO;                                                        00012500
                B02                         = B01                  ;    00012510
                B01 = '';                                               00012520
                B00 = '';                                               00012530
             END;                                                       00012540
                                                                        00012550
 /* ***************************************************************** */00012560
 /* VERNEPLIKTOPPLYSNINGER                                            */00012570
 /* ***************************************************************** */00012580
                                                                        00012590
    DO I = 1 TO 4 WHILE (U3S.VP_ÅR(I) > 0);                             00012600
       B02.VERNEPLIKTÅR(SØKER_IND,I) = U3S.VP_ÅR(I);                    00012610
    END;                                                                00012620
                                                                        00012630
                                                                        00012640
                                                                        00012650
                                                                        00012660
 /* ***************************************************************** */00012670
 /*                                                                   */00012680
 /* YRKESSKADEOPPLYSNINGER.  ERIK 2.7.87.                             */00012690
 /*                                                                   */00012700
 /* ***************************************************************** */00012710
                                                                        00012720
                                                                        00012730
  %SKIP;                                                                00012740
                                                                        00012750
   IF U3S.YSKADE_TILLEGG = 'J' THEN                                     00012760
                                                                        00012770
 /*   ENDRET 20.7.89 HL - BARE KAP.8 - GRAD ER ENDRET */                00012780
                                                                        00012790
      IF B01.YRKEPENS.YUG(SØKER_IND) = U3Y.YUG     &                    00012800
         B01.UFØRPENS.UFG(SØKER_IND)^= U3S.UFG     THEN ;               00012810
      ELSE                                                              00012820
                                                                        00012830
 /*TILLEGG 13.3.90 HL */                                                00012840
                                                                        00012850
    IF B01.YRKEPENS.YUG(SØKER_IND) > U3Y.YUG     THEN                   00012860
       DO;                                                              00012870
 L280:                                                                  00012880
          FEIL_VED_LABEL = '280';                                       00012890
          FEIL_MELD_NR   =  1737;                                       00012900
          GO TO RETUR;                                                  00012910
       END;                                                             00012920
    ELSE                                                                00012930
                                                                        00012940
 /*HIT 13.3.90 HL*/                                                     00012950
                                                                        00012960
 DO I = 1 TO 5;                                                         00012970
    YUF_IND = I;                                                        00012980
 SELECT;                                                                00012990
    WHEN (B01.YRKEHIST.YUFT_ÅM(SØKER_IND,I) =                           00013000
                 F_SNU_DATO(U3S.UFT_MÅ))                                00013010
       DO;                                                              00013020
          B02.YRKEHIST.YUG(SØKER_IND,I)    = U3Y.YUG;                   00013030
  /*0496 HL - ET EVT. OPPHØR MÅ SLETTES : */                            00013040
          B02.YRKEHIST.OPPH_DATO_ÅM(SØKER_IND,I) = 0;                   00013050
          B02.YRKEHIST.OPPH_KODE(SØKER_IND,I) = ' ';                    00013060
          I = 5;                                                        00013070
       END;                                                             00013080
    WHEN (B01.YRKEHIST.YUFT_ÅM(SØKER_IND,I) = 0)                        00013090
       DO;                                                              00013100
          B02.YRKEHIST.YUFT_ÅM(SØKER_IND,I) =                           00013110
                                F_SNU_DATO(U3S.UFT_MÅ);                 00013120
          B02.YRKEHIST.YUG(SØKER_IND,I)    = U3Y.YUG;                   00013130
                                                                        00013140
          IF (I > 1)  & (B01.YRKEHIST.OPPH_DATO_ÅM                      00013150
                   (SØKER_IND,(I-1)) = 0 ) THEN                         00013160
             DO;                                                        00013170
                                                                        00013180
                B02.YRKEHIST.OPPH_DATO_ÅM(SØKER_IND,(I-1)) =            00013190
      /*                    F_SNU_DATO(U3S.UFT_MÅ); */                  00013200
                            OPPH_ÅR*100+OPPH_MN;  /*9807*/              00013210
                B02.YRKEHIST.OPPH_KODE(SØKER_IND,(I-1)) = 'J';          00013220
                                                                        00013230
                DO J = 1 TO 5 WHILE                                     00013240
                   (B02.YUG_ØVRIGE(SØKER_IND,(I-1),J) > 0);             00013250
                                                                        00013260
                   IF B02.YUG_DATO_ÅM(SØKER_IND,(I-1),J) =              00013270
                      B02.YRKEHIST.YUFT_ÅM(SØKER_IND,I) THEN            00013280
                      DO;                                               00013290
                         B02.YUG_ØVRIGE(SØKER_IND,(I-1),J) = 0;         00013300
                         B02.YUG_DATO_ÅM(SØKER_IND,(I-1),J)= 0;         00013310
                         B01.YUG_ØVRIGE(SØKER_IND,(I-1),J) = 0;         00013320
                         B01.YUG_DATO_ÅM(SØKER_IND,(I-1),J)= 0;         00013330
                      END;                                              00013340
                   IF B02.YUG_DATO_ÅM(SØKER_IND,(I-1),J) >              00013350
                      B02.YRKEHIST.YUFT_ÅM(SØKER_IND,I) THEN            00013360
                      DO;                                               00013370
  /*  ********************************************* */                  00013380
  /*  Y-UFØRETIDSPUNKT LIGGER FØR OPPHØRSTIDSPUNKT  */                  00013390
  /*  ********************************************* */                  00013400
                                                                        00013410
                                                                        00013420
        L281:                                                           00013430
                         FEIL_VED_LABEL = '281';                        00013440
                         FEIL_MELD_NR   =  1711;                        00013450
                         GO TO RETUR;                                   00013460
                      END;                                              00013470
                END;                                                    00013480
        /*   I = 5    TRUDE */                                          00013490
          END;                                                          00013500
             I = 5;                                                     00013510
       END;                                                             00013520
    OTHERWISE                                                           00013530
       DO;                                                              00013540
          IF I = 5 THEN                                                 00013550
                                                                        00013560
  /*  ********************************************* */                  00013570
  /*  ALLE PERIODENE UTFYLT.  IKKE MER PLASS.       */                  00013580
  /*  ********************************************* */                  00013590
                                                                        00013600
 L282:                                                                  00013610
             DO;                                                        00013620
                FEIL_VED_LABEL = '282';                                 00013630
                FEIL_MELD_NR   =  1715;                                 00013640
                GO TO RETUR;                                            00013650
             END;                                                       00013660
       END;                                                             00013670
 END; /*SELECT*/                                                        00013680
 END;    /*DO I= 1 TO 5*/                                               00013690
                                                                        00013700
  IF U3S.YSKADE_TILLEGG = 'J' THEN                                      00013710
                                                                        00013720
 /*YS ENDRET 20.7.89 HL - BARE KAP.8 - GRAD ER ENDRET */                00013730
                                                                        00013740
    IF B01.YRKEPENS.YUG(SØKER_IND) = U3Y.YUG     &                      00013750
       B01.UFØRPENS.UFG(SØKER_IND)^= U3S.UFG     THEN ;                 00013760
    ELSE                                                                00013770
    DO;                                                                 00013780
       B02.YRKEPENS.YUG(SØKER_IND) = U3Y.YUG;                           00013790
       B02.YRKEHIST.YST_ÅM(SØKER_IND,YUF_IND) =                         00013800
                                F_SNU_DATO(U3Y.YST_MÅ);                 00013810
       B02.YRKEHIST.AÅI(SØKER_IND,YUF_IND) = U3Y.AÅI;                   00013820
       B02.YRKEHIST.YRKE11(SØKER_IND,YUF_IND) = U3Y.YRKE11;             00013830
       B02.YRKEHIST.VILKÅR_1_2_2(SØKER_IND,YUF_IND)=                    00013840
                          U3Y.VILKÅR_1_2_2A !! U3Y.VILKÅR_1_2_2B;       00013850
       B02.YRKEHIST.KAP_11_7_UTLØST(SØKER_IND,YUF_IND) =                00013860
                                             U3Y.KAP_11_7_UTLØST;       00013870
       B02.YRKEPENS.YSYKDOM(SØKER_IND) = U3Y.YSYKDOM   ;                00013880
       DIV_PARAM_OMR.YSYKDOM        = U3Y.YSYKDOM        ;              00013890
 /* ***************************************************************** */00013900
 /*YS - VI SKAL AVVISE :  1) NY YRKESSKADE FOR EN SOM HAR Y FRA FØR   */00013910
 /*YS                     2) ENGANGSUTLØSNING FOR EN SOM HAR UFØRHIST */00013920
 /*YS                                                                 */00013930
 /* ***************************************************************** */00013940
                                                                        00013950
                                                                        00013960
       IF B01.PENSJONSTYPE1(SØKER_IND) = 'Y'      &                     00013970
          YUF_IND                      > 1        &                     00013980
          B02.YRKEHIST.YST_ÅM(SØKER_IND,YUF_IND) ^=                     00013990
          B02.YRKEHIST.YST_ÅM(SØKER_IND,YUF_IND-1) THEN                 00014000
                                                                        00014010
          DO;                                                           00014020
 L283:                                                                  00014030
             FEIL_VED_LABEL = '283';                                    00014040
             FEIL_MELD_NR   = 1728;                                     00014050
             GO TO RETUR;                                               00014060
          END;                                                          00014070
                                                                        00014080
                                                                        00014090
       IF (B01.PENSJONSTYPE1(SØKER_IND) = 'Y'      !                    00014100
           B01.PENSJONSTYPE1(SØKER_IND) = 'U'  )   &                    00014110
          U3Y.KAP_11_7_UTLØST ^= ' '             THEN                   00014120
                                                                        00014130
          DO;                                                           00014140
 L284:                                                                  00014150
             FEIL_VED_LABEL = '284';                                    00014160
             FEIL_MELD_NR   = 1729;                                     00014170
             GO TO RETUR;                                               00014180
          END;                                                          00014190
    END;                                                                00014200
                                                                        00014210
  /*RULLERING AV INNTEKTER - 9802 HL : */                               00014220
    IF B02.FORVENTET(SØKER_IND) > 0          THEN                       00014230
       CALL RULL_FORVENTET(B02.G_DATO_ÅM(SØKER_IND),                    00014240
                           B02.VIRK_DATO_ÅM(SØKER_IND),                 00014250
                           B02.FORVENTET(SØKER_IND));                   00014260
                                                                        00014270
    IF B02.FORSI.PENSJONSINNTEKT(SØKER_IND) > 0  THEN                   00014280
       B02.FORSI.PENSJONSINNTEKT(SØKER_IND) =                           00014290
           F_RULL_FORSI(B02.G_DATO_ÅM(SØKER_IND),                       00014300
                 B02.VIRK_DATO_ÅM(SØKER_IND),                           00014310
                 B02.FORSI.PENSJONSINNTEKT(SØKER_IND));                 00014320
                                                                        00014330
    IF B02.FORSI.ARBEIDSINNTEKT(SØKER_IND) > 0  THEN                    00014340
       B02.FORSI.ARBEIDSINNTEKT(SØKER_IND) =                            00014350
           F_RULL_FORSI(B02.G_DATO_ÅM(SØKER_IND),                       00014360
                 B02.VIRK_DATO_ÅM(SØKER_IND),                           00014370
                 B02.FORSI.ARBEIDSINNTEKT(SØKER_IND));                  00014380
                                                                        00014390
    IF B02.FORSI.PENSJONSINNTEKT_EK(SØKER_IND) > 0  THEN                00014400
       B02.FORSI.PENSJONSINNTEKT_EK(SØKER_IND) =                        00014410
           F_RULL_FORSI(B02.G_DATO_ÅM(SØKER_IND),                       00014420
                  B02.VIRK_DATO_ÅM(SØKER_IND),                          00014430
                  B02.FORSI.PENSJONSINNTEKT_EK(SØKER_IND));             00014440
                                                                        00014450
    IF B02.FORSI.ARBEIDSINNTEKT_EK(SØKER_IND) > 0  THEN                 00014460
       B02.FORSI.ARBEIDSINNTEKT_EK(SØKER_IND) =                         00014470
           F_RULL_FORSI(B02.G_DATO_ÅM(SØKER_IND),                       00014480
                 B02.VIRK_DATO_ÅM(SØKER_IND),                           00014490
                 B02.FORSI.ARBEIDSINNTEKT_EK(SØKER_IND));               00014500
                                                                        00014510
 /* RULLERING AV EKTEFELLES INNTEKTER - 9802 HL */                      00014520
    IF B02.ALDERSP.FAI(EKTEF_IND) > 0   THEN                            00014530
       CALL RULL_FAI(B02.G_DATO_ÅM(EKTEF_IND),                          00014540
                     B02.VIRK_DATO_ÅM(EKTEF_IND),                       00014550
                     B02.ALDERSP.FAI(EKTEF_IND));                       00014560
                                                                        00014570
    IF B02.FORSI.PENSJONSINNTEKT(EKTEF_IND) > 0  THEN                   00014580
       B02.FORSI.PENSJONSINNTEKT(EKTEF_IND) =                           00014590
           F_RULL_FORSI(B02.G_DATO_ÅM(EKTEF_IND),                       00014600
                 B02.VIRK_DATO_ÅM(EKTEF_IND),                           00014610
                 B02.FORSI.PENSJONSINNTEKT(EKTEF_IND));                 00014620
                                                                        00014630
    IF B02.FORSI.ARBEIDSINNTEKT(EKTEF_IND) > 0  THEN                    00014640
       B02.FORSI.ARBEIDSINNTEKT(EKTEF_IND) =                            00014650
           F_RULL_FORSI(B02.G_DATO_ÅM(EKTEF_IND),                       00014660
                 B02.VIRK_DATO_ÅM(EKTEF_IND),                           00014670
                 B02.FORSI.ARBEIDSINNTEKT(EKTEF_IND));                  00014680
                                                                        00014690
    IF B02.FORSI.PENSJONSINNTEKT_EK(EKTEF_IND) > 0  THEN                00014700
       B02.FORSI.PENSJONSINNTEKT_EK(EKTEF_IND) =                        00014710
           F_RULL_FORSI(B02.G_DATO_ÅM(EKTEF_IND),                       00014720
                  B02.VIRK_DATO_ÅM(EKTEF_IND),                          00014730
                  B02.FORSI.PENSJONSINNTEKT_EK(EKTEF_IND));             00014740
                                                                        00014750
    IF B02.FORSI.ARBEIDSINNTEKT_EK(EKTEF_IND) > 0  THEN                 00014760
       B02.FORSI.ARBEIDSINNTEKT_EK(EKTEF_IND) =                         00014770
           F_RULL_FORSI(B02.G_DATO_ÅM(EKTEF_IND),                       00014780
                 B02.VIRK_DATO_ÅM(EKTEF_IND),                           00014790
                 B02.FORSI.ARBEIDSINNTEKT_EK(EKTEF_IND));               00014800
                                                                        00014810
                                                                        00014820
  RETUR:                                                                00014830
   END AJOURFØR_B02_MED_U3TRANS;                                        00014840
