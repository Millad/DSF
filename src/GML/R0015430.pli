 /*       SIST ENDRET 28/07-98 12.50.31 AV   JDA7339                  */00000000
 /*       SIST ENDRET 28/07-98 12.27.15 AV   JDA7339                  */00000010
 /*       SIST ENDRET 28/07-97 12.34.59 AV   HLA7339                  */00000020
 /*       SIST ENDRET 01/04-96 14.50.09 AV   HLB0310                  */00000030
 /*       SIST ENDRET 25/02-94 12.25.10 AV   HERMAN                   */00000040
 /*       SIST ENDRET 03/03-92 09.52.13 AV   DYBVIK                   */00000050
 /*       SIST ENDRET 12/07-91 08.22.21 AV   HERMAN                   */00000060
 /*       SIST ENDRET 26/04-91 11.46.51 AV   DYBVIK                   */00000070
 /*       SIST ENDRET 12/11-90 13.14.25 AV   DYBVIK                   */00000080
 /*       SIST ENDRET 14/04-89 15.35.16 AV   HERMAN                   */00000090
 /*       SIST ENDRET 30/08-84 12.30.40 AV   DYBVIK                   */00000100
 /*       SIST ENDRET 23/03-83 12.12.04 AV   LUNDEBY                  */00000110
 /*       SIST ENDRET 25/01-83 12.13.26 AV   LUNDEBY                  */00000120
 /*       SIST ENDRET 24/11-82 09.55.10 AV   LUNDEBY                  */00000130
                                                                        00000140
                                                                        00000150
  %PAGE;                                                                00000160
  /* ************************************************************** */  00000170
  /*IDENTIFIKASJON:                                                 */  00000180
  /*    R0015430 -     UNDERMODUL I PLI                             */  00000190
  /*    PROGRAMMERER: S. LUNDEBY          FEBRUAR  1982             */  00000200
  /*                                                                */  00000210
  /*HENSIKT:                                                        */  00000220
  /*    SKRIVE       SISTE STATUS TIL REGISTERET                    */  00000230
  /*                                                                */  00000240
  /*                                                                */  00000250
  /*PROGRAMTILKNYTNING:                                             */  00000260
  /*                                                                */  00000270
  /*                                                                */  00000280
  /*BRUK:   KALLES AV R0015401                                      */  00000290
  /*                                                                */  00000300
  /*                                                                */  00000310
  /* ************************************************************** */  00000320
                                                                        00000330
  P_SKRIV_SISTE_STATUS :                                                00000340
     PROC;                                                              00000350
                                                                        00000360
     /* *********************************************************** */  00000370
     /*                                                             */  00000380
     /*      SLUTT PÅ DEKLARASJONENE , EKSEKVERINGEN STARTER .      */  00000390
     /*     ---------------------------------------------------     */  00000400
     /*                                                             */  00000410
     /*          INSERT STATUS - SEGM.                              */  00000420
     /*                                                             */  00000430
     /* *********************************************************** */  00000440
                                                                        00000450
     /* TRUDE. ENGANGSBELØP_11_7 ER KUN HJELPEFELT.                 */  00000460
     /* SKAL IKKE SKRIVES PÅ BASEN.    Y R K E S S K A D E          */  00000470
                                                                        00000480
 /*  B02.STATUS.ENGANGSBELØP_11_7(W02_I)  = 0   HL    */                00000490
     W01_HJELPE_PTR                =   ADDR (B02.STATUS(W02_I));        00000500
     SSA_UQUAL                     =  'STATUS   ';                      00000510
     CALL  P_SKRIV_BARN_AV_ROT;                                         00000520
                                                                        00000530
     IF  FEIL_MELD_NR              >   0                THEN            00000540
       DO;                                                              00000550
         /* ******************************************************* */  00000560
         /* FEIL VED SKRIV AV  :         STATUS                     */  00000570
         /* ******************************************************* */  00000580
                                                                        00000590
         GO TO RETUR;                                                   00000600
       END;                                                             00000610
                                                                        00000620
     /* *********************************************************** */  00000630
     /*      INSERT TILKNYTTINGS-PERSONER                           */  00000640
     /* *********************************************************** */  00000650
                                                                        00000660
     DO  I = 1  TO  13                                                  00000670
         WHILE (B02.TILKN.FNR_TILKN(W02_I,I)  >  0);                    00000680
                                                                        00000690
       W01_HJELPE_PTR          =  ADDR (B02.TILKN(W02_I,I));            00000700
       SSA_UQUAL               = 'TILKN    ';                           00000710
       CALL P_SKRIV_BARN_AV_STATUS;                                     00000720
                                                                        00000730
       IF  FEIL_MELD_NR              >   0             THEN             00000740
         DO;                                                            00000750
           /* ***************************************************** */  00000760
           /* FEIL VED SKRIV AV  :        TILKN                     */  00000770
           /* ***************************************************** */  00000780
                                                                        00000790
           GO TO RETUR;                                                 00000800
         END;                                                           00000810
     END;                                                               00000820
                                                                        00000830
     /* *********************************************************** */  00000840
     /*         INSERT FORSI SEGMENT                                */  00000850
     /* *********************************************************** */  00000860
                                                                        00000870
     IF (B02.FORSI.FT_SKAL_BEREGNES(W02_I) ^=  ' ')  THEN               00000880
       DO;                                                              00000890
         IF (B02.FORSI.FT_SKAL_BEREGNES(W02_I) =  'D')  THEN            00000900
             B02.FORSI.FT_SKAL_BEREGNES(W02_I) =  ' ';                  00000910
         W01_HJELPE_PTR        = ADDR(B02.FORSI(W02_I));                00000920
         SSA_UQUAL             = 'FORSI    ';                           00000930
         CALL P_SKRIV_BARN_AV_STATUS;                                   00000940
                                                                        00000950
         IF  FEIL_MELD_NR              >   0             THEN           00000960
           DO;                                                          00000970
             /* *************************************************** */  00000980
             /* FEIL VED SKRIV AV  :       FORSI                    */  00000990
             /* *************************************************** */  00001000
                                                                        00001010
             GO TO RETUR;                                               00001020
           END;                                                         00001030
       END;                                                             00001040
     /* *********************************************************** */  00001050
     /*         INSERT ALDERSPENSJONSOPPLYSNINGER                   */  00001060
     /* *********************************************************** */  00001070
                                                                        00001080
     IF ((B02.PENSJONSTYPE1(W02_I)  = 'D')  &      /*250396 HL*/        00001090
         (B02.KONV_P_KODE(W02_I)    = 'K' !                             00001100
          B02.KONV_P_KODE(W02_I)    = 'O')  )   !                       00001110
        (B02.PENSJONSTYPE1(W02_I)  =  'A')  !                           00001120
        (B02.PENSJONSTYPE1(W02_I)  =  'K')  THEN    /*AFP*/             00001130
       DO;                                                              00001140
         W01_HJELPE_PTR        = ADDR(B02.ALDERSP(W02_I));              00001150
         SSA_UQUAL             = 'ALDERSP  ';                           00001160
         CALL P_SKRIV_BARN_AV_STATUS;                                   00001170
                                                                        00001180
         IF  FEIL_MELD_NR              >   0             THEN           00001190
           DO;                                                          00001200
             /* *************************************************** */  00001210
             /* FEIL VED SKRIV AV  :       ALDERSP                  */  00001220
             /* *************************************************** */  00001230
                                                                        00001240
             GO TO RETUR;                                               00001250
           END;                                                         00001260
                                                                        00001270
         /* ******************************************************* */  00001280
         /*               VENTEPERIODE                              */  00001290
         /* ******************************************************* */  00001300
                                                                        00001310
         DO  I = 1  TO  5                                               00001320
             WHILE (B02.UTTAKSDATO_ÅM_ØVRIGE(W02_I,I) > 0);             00001330
                                                                        00001340
           W01_HJELPE_PTR    = ADDR (B02.VENTØVR(W02_I,I));             00001350
           SSA_UQUAL         = 'VENTØVR  ';                             00001360
           CALL  P_SKRIV_BARN_AV_STATUS;                                00001370
                                                                        00001380
           IF   FEIL_MELD_NR              >   0             THEN        00001390
             DO;                                                        00001400
               /* ************************************************ */   00001410
               /* FEIL VED SKRIV AV  :      VENTEØVR               */   00001420
               /* ************************************************ */   00001430
                                                                        00001440
               GO TO RETUR;                                             00001450
             END;                                                       00001460
           END;                                                         00001470
       END;                                                             00001480
                                                                        00001490
     /* ********************************************************** */   00001500
     /*           UFØREPENSJON - VI MÅ OPPBEVARE 1291-INFO (HL)    */   00001510
     /* ********************************************************** */   00001520
                                                                        00001530
     IF B02.PENSJONSTYPE1(W02_I)  = 'U'          !                      00001540
        B02.PENSJONSTYPE1(W02_I)  = 'Y'          !                      00001550
           (B02.PENSJONSTYPE1(W02_I)  = 'D' &                           00001560
            B02.UFØRPENS.SPT_1291(W02_I) > 0  )  !                      00001570
        B02.PENSJONSTYPE3(W02_I)  = 'Y'          !                      00001580
        B02.PENSJONSTYPE3(W02_I)  = 'U'            THEN                 00001590
       DO;                                                              00001600
         W01_HJELPE_PTR        =   ADDR (B02.UFØRPENS(W02_I));          00001610
         SSA_UQUAL             =  'UFØRPENS ';                          00001620
         CALL P_SKRIV_BARN_AV_STATUS;                                   00001630
                                                                        00001640
         IF  FEIL_MELD_NR              >   0             THEN           00001650
           DO;                                                          00001660
             /* ************************************************** */   00001670
             /* FEIL VED SKRIV AV  :     UFØRPENS                  */   00001680
             /* ************************************************** */   00001690
                                                                        00001700
             GO TO RETUR;                                               00001710
           END;                                                         00001720
       END;                                                             00001730
                                                                        00001740
     /* ********************************************************** */   00001750
     /*   LEGGER INN UFØRE-OPPLYSNINGER                            */   00001760
     /* ********************************************************** */   00001770
                                                                        00001780
   /*0697 HL:*/                                                         00001790
     DO  I=1 TO 7               WHILE  (B02.UFT_ÅM   (W02_I,I) > 0);    00001800
       W01_HJELPE_PTR        =  ADDR   (B02.UFØRHIST (W02_I,I) );       00001810
       SSA1_UFØRHIST.UFT_ÅM  =          B02.UFT_ÅM   (W02_I,I);         00001820
       SSA_UQUAL             =                'UFØRHIST ';              00001830
       CALL  P_SKRIV_BARN_AV_STATUS;                                    00001840
                                                                        00001850
       IF  FEIL_MELD_NR      >          0               THEN            00001860
         DO;                                                            00001870
           /* ***************************************************** */  00001880
           /*  FEIL VED SKRIV AV  :  UFØRHIST                       */  00001890
           /* ***************************************************** */  00001900
                                                                        00001910
           GO TO  RETUR;                                                00001920
         END;                                                           00001930
       /* ********************************************************* */  00001940
       /*  LEGGER INN UFØREGRADPERIODER INNENFOR                    */  00001950
       /*  UFØREHISTORIKK-PERIODER .                                */  00001960
       /* ********************************************************* */  00001970
                                                                        00001980
   /*0697 HL*/                                                          00001990
       DO  J=1 TO 7          WHILE (B02.UFG_DATO_ÅM (W02_I,I,J) > 0);   00002000
         W01_HJELPE_PTR   =   ADDR (B02.UFØRGRAD    (W02_I,I,J));       00002010
         SSA_UQUAL        =               'UFØRGRAD ';                  00002020
         CALL P_SKRIV_BARN_AV_UFØRHIST;                                 00002030
                                                                        00002040
         IF  FEIL_MELD_NR      >          0               THEN          00002050
           DO;                                                          00002060
             /* *************************************************** */  00002070
             /*  FEIL VED SKRIV AV  :  UFØRGRAD                     */  00002080
             /* *************************************************** */  00002090
                                                                        00002100
             GO TO  RETUR;                                              00002110
           END;                                                         00002120
       END;                                                             00002130
     END;                                                               00002140
                                                                        00002150
       /* ******************************************************** */   00002160
       /*         YRKESSKADEPENSJON                                */   00002170
       /* ******************************************************** */   00002180
                                                                        00002190
       IF B02.PENSJONSTYPE1(W02_I) = 'Y' !                              00002200
          B02.PENSJONSTYPE3(W02_I) = 'Y' !                              00002210
          (B02.PENSJONSTYPE1(W02_I) = 'A' &                             00002220
           B02.ALDERSP.KONV_P_KODE(W02_I) = 'Y')      THEN              00002230
         DO;                                                            00002240
           W01_HJELPE_PTR      =   ADDR (B02.YRKEPENS(W02_I));          00002250
           SSA_UQUAL           =  'YRKEPENS ';                          00002260
           CALL P_SKRIV_BARN_AV_STATUS;                                 00002270
                                                                        00002280
           IF FEIL_MELD_NR             >   0             THEN           00002290
             DO;                                                        00002300
               /* ************************************************ */   00002310
               /* FEIL VED SKRIV AV :    YRKEPENS                  */   00002320
               /* ************************************************ */   00002330
                                                                        00002340
               GO TO RETUR;                                             00002350
             END;                                                       00002360
         END;                                                           00002370
                                                                        00002380
       /* ******************************************************** */   00002390
       /* YRKEPENS SKRIVES UT FOR DØDE                             */   00002400
       /* ******************************************************** */   00002410
                                                                        00002420
       IF B02.PENSJONSTYPE1(W02_I) = 'D'   &                            00002430
          B02.YRKEPENS.YUG (W02_I) > 0         THEN                     00002440
         DO;                                                            00002450
           W01_HJELPE_PTR      =   ADDR (B02.YRKEPENS(W02_I));          00002460
           SSA_UQUAL           =  'YRKEPENS ';                          00002470
           CALL P_SKRIV_BARN_AV_STATUS;                                 00002480
                                                                        00002490
           IF FEIL_MELD_NR             >   0             THEN           00002500
             DO;                                                        00002510
               /* ************************************************ */   00002520
               /* FEIL VED SKRIV AV :    YRKEPENS                  */   00002530
               /* ************************************************ */   00002540
                                                                        00002550
               GO TO RETUR;                                             00002560
             END;                                                       00002570
         END;                                                           00002580
       /* ******************************************************** */   00002590
       /* LEGGER INN YRKESSKADE-HISTORIKK                          */   00002600
       /* ******************************************************** */   00002610
                                                                        00002620
       DO I=1 TO 5              WHILE  (B02.YUFT_ÅM  (W02_I,I) > 0);    00002630
         W01_HJELPE_PTR      =  ADDR   (B02.YRKEHIST (W02_I,I) );       00002640
         SSA1_YRKEHIST.YUFT_ÅM =        B02.YUFT_ÅM  (W02_I,I);         00002650
         SSA_UQUAL           =                'YRKEHIST ';              00002660
         CALL P_SKRIV_BARN_AV_STATUS;                                   00002670
                                                                        00002680
         IF FEIL_MELD_NR     >          0               THEN            00002690
           DO;                                                          00002700
             /* *************************************************** */  00002710
             /* FEIL VED SKRIV AV :  YRKEHIST                       */  00002720
             /* *************************************************** */  00002730
                                                                        00002740
             GO TO RETUR;                                               00002750
           END;                                                         00002760
         /* ****************************************************** */   00002770
         /* LEGGER INN YRKEGRADPERIODER INNENFOR                   */   00002780
         /* YRKEHISTORIKK-PERIODER .                               */   00002790
         /* ****************************************************** */   00002800
                                                                        00002810
         DO J=1 TO 5         WHILE (B02.YUG_DATO_ÅM (W02_I,I,J) > 0);   00002820
           W01_HJELPE_PTR =   ADDR (B02.YRKEGRAD    (W02_I,I,J));       00002830
           SSA_UQUAL      =               'YRKEGRAD ';                  00002840
           CALL P_SKRIV_BARN_AV_YRKEHIST;                               00002850
                                                                        00002860
           IF FEIL_MELD_NR     >          0               THEN          00002870
             DO;                                                        00002880
               /* ************************************************* */  00002890
               /* FEIL VED SKRIV AV :  UFØRGRAD                     */  00002900
               /* ************************************************* */  00002910
                                                                        00002920
               GO TO RETUR;                                             00002930
             END;                                                       00002940
         END;                                                           00002950
       END;                                                             00002960
                                                                        00002970
     /* ***************************************************** */        00002980
     /*        BARNEPENSJON                                   */        00002990
     /* ***************************************************** */        00003000
                                                                        00003010
     IF  B02.PENSJONSTYPE1(W02_I)  = 'B'                                00003020
       ! B02.PENSJONSTYPE1(W02_I)  = 'N'           THEN                 00003030
       DO;                                                              00003040
         W01_HJELPE_PTR = ADDR(B02.ETTEBARN(W02_I));                    00003050
         SSA_UQUAL      = 'ETTEBARN ';                                  00003060
         CALL P_SKRIV_BARN_AV_STATUS;                                   00003070
                                                                        00003080
         IF  FEIL_MELD_NR              >   0             THEN           00003090
           DO;                                                          00003100
             /* **************************************************** */ 00003110
             /* FEIL VED SKRIV AV   :     ETTEBARN                   */ 00003120
             /* **************************************************** */ 00003130
                                                                        00003140
             GO TO RETUR;                                               00003150
           END;                                                         00003160
       END;                                                             00003170
                                                                        00003180
     /* ***************************************************** */        00003190
     /*        ETTERPENSJON                                   */        00003200
     /* ***************************************************** */        00003210
                                                                        00003220
     IF  B02.PENSJONSTYPE1(W02_I)  = 'E'                                00003230
       ! B02.PENSJONSTYPE1(W02_I)  = 'J'                                00003240
       ! B02.PENSJONSTYPE2(W02_I)  = 'E'           THEN                 00003250
       DO;                                                              00003260
         W01_HJELPE_PTR = ADDR(B02.ETTEPENS(W02_I));                    00003270
         SSA_UQUAL      = 'ETTEPENS ';                                  00003280
         CALL P_SKRIV_BARN_AV_STATUS;                                   00003290
                                                                        00003300
         IF  FEIL_MELD_NR              >   0             THEN           00003310
           DO;                                                          00003320
             /* **************************************************** */ 00003330
             /* FEIL VED SKRIV AV   :     ETTEPENS                   */ 00003340
             /* **************************************************** */ 00003350
                                                                        00003360
             GO TO RETUR;                                               00003370
           END;                                                         00003380
       END;                                                             00003390
                                                                        00003400
     /* ***************************************************** */        00003410
     /*        EØS INFO                                       */        00003420
     /* ***************************************************** */        00003430
                                                                        00003440
     IF  B02.EØSINFO.BEREGN_FOLKETRYGD (W02_I)  ^= ' '   THEN           00003450
       DO;                                                              00003460
         DCL 1 HLTEST1,  % INCLUDE P0019966;                            00003470
         HLTEST1    = B02.EØSINFO(W02_I);                               00003480
         W01_HJELPE_PTR = ADDR(B02.EØSINFO(W02_I));                     00003490
         SSA_UQUAL      = 'EØSINFO  ';                                  00003500
         CALL P_SKRIV_BARN_AV_STATUS;                                   00003510
                                                                        00003520
         IF  FEIL_MELD_NR              >   0             THEN           00003530
           DO;                                                          00003540
             /* **************************************************** */ 00003550
             /* FEIL VED SKRIV AV   :     EØS INFO                   */ 00003560
             /* **************************************************** */ 00003570
                                                                        00003580
             GO TO RETUR;                                               00003590
           END;                                                         00003600
       END;                                                             00003610
                                                                        00003620
     /* ***************************************************** */        00003630
     /*         SPESIALOPPLYSNINGER                           */        00003640
     /* ***************************************************** */        00003650
                                                                        00003660
     IF P_SPESIALOPPLYSNINGER  (B02.SPESOPPL (W02_I)) THEN              00003670
       DO;                                                              00003680
         W01_HJELPE_PTR = ADDR (B02.SPESOPPL (W02_I));                  00003690
         SSA_UQUAL      = 'SPESOPPL ';                                  00003700
         CALL P_SKRIV_BARN_AV_STATUS;                                   00003710
                                                                        00003720
         IF  FEIL_MELD_NR              >   0             THEN           00003730
           DO;                                                          00003740
             /* **************************************************** */ 00003750
             /* FEIL VED SKRIV AV  :   SPESOPPL                      */ 00003760
             /* **************************************************** */ 00003770
                                                                        00003780
             GO TO RETUR;                                               00003790
           END;                                                         00003800
       END;                                                             00003810
                                                                        00003820
  RETUR:                                                                00003830
                                                                        00003840
  END P_SKRIV_SISTE_STATUS;                                             00003850
