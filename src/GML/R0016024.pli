 /*       SIST ENDRET 03/07-97 14.15.36 AV   JDA7339                  */00000000
 /*       SIST ENDRET 03/07-97 13.34.03 AV   JDA7339                  */00000010
 /*       SIST ENDRET 03/07-97 13.07.23 AV   JDA7339                  */00000020
 /*       SIST ENDRET 03/07-97 12.54.33 AV   JDA7339                  */00000030
 /*       SIST ENDRET 03/07-97 12.27.06 AV   JDA7339                  */00000040
 /*       SIST ENDRET 27/06-94 14.54.18 AV   DYBVIK                   */00000050
 /*       SIST ENDRET 13/12-91 12.26.06 AV   DYBVIK                   */00000060
 /*********************************************************************/00000070
 /* IDENTIFIKASJON:                                                   */00000080
 /*    R0016024 - PLUKKET UT AV R0016001 (BEDRE OVERSIKT). BØ9112     */00000090
 /* HENSIKT:                                                          */00000100
 /*    SKRIVER DANNETE SEGMENTER TIL TRMAIN (TRANS-BASE)              */00000110
 /* PROGRAMTILKNYTNING:                                               */00000120
 /*    LOKAL PROSEDYRE I R0016001                                     */00000130
 /*********************************************************************/00000140
                                                                        00000150
 SKRIV_STAT_SEGM: PROC;                                                 00000160
                                                                        00000170
 /*-------------------------------------------------------------------*/00000180
 /* PROSEDYREN LESER SEGMENT-TABELL OG SKRIVER UT DE SEGMENTENE TIL   */00000190
 /* TRANS-STAT-BASEN SOM HAR TILHØRENDE ELEMENTET I SEGMENT-TABELL    */00000200
 /* SATT TIL 'TRUE' (DVS '1'B). PROSEDYREN HENTER INFORMASJONEN       */00000210
 /* FRA ARBEIDS-OMRÅDE TIL TRANS-STAT-BASEN.                          */00000220
 /*-------------------------------------------------------------------*/00000230
                                                                        00000240
    /* SETTING AV REGDATO'ER VED HJELP AV 'DATE' OG 'TIME'  */          00000250
                                                                        00000260
    EXEC CICS ASKTIME ABSTIME(W_ABSTIME);                               00000270
    W_ABS  = W_ABSTIME;                                                 00000280
    DO WHILE (W_ABS = W_ABSTIME);                                       00000290
        EXEC CICS ASKTIME ABSTIME(W_ABSTIME);                           00000300
    END;                                                                00000310
    W_ABS  = W_ABSTIME;                                                 00000320
    DATO   = DATE;                                                      00000330
    KLOKKE = TIME;                                                      00000340
    MILLI_SEK = W_ABS_MILLI_SEK;                                        00000350
    EXEC CICS ENTER TRACEID(100) FROM (W_ABS_MILLI_SEK);                00000360
    EXEC CICS ENTER TRACEID(101) FROM (      MILLI_SEK);                00000370
    PTYPE.REGDATO   = DATO_ÅM;                                          00000380
    SIVILST.REGDATO = DATO_ÅM;                                          00000390
    APOPPL.REGDATO = DATO_ÅM;                                           00000400
    PENSJON.REGDATO = DATO_ÅM;                                          00000410
    UPPER.REGDATO   = DATO_ÅM;                                          00000420
    KT.REGDATO      = DATO_ÅM;                                          00000430
    VT.REGDATO      = DATO_ÅM;                                          00000440
    ET.REGDATO      = DATO_ÅM;                                          00000450
    BT.REGDATO      = DATO_ÅM;                                          00000460
    YSKADE.REGDATO  = DATO_ÅM;                                          00000470
                                                                        00000480
    /* BEHANDLING AV ROT-SEGMENT */                                     00000490
                                                                        00000500
    HELP_FNR  = TR0ROT.FNR;                                             00000510
    PBR_TEXT = 'DANN ROTSEGMENT.  ID = ' !! HELP_FNR;                   00000520
 /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                       00000530
                                                                        00000540
    SSA_UNQUAL = 'TR0ROT  ';                                            00000550
    CALL PLITDLI (PARAM_COUNT_4,                                        00000560
                  INSERT,                                               00000570
                  TR0_PCB,                                              00000580
                  TR0ROT,                                               00000590
                  SSA_UNQUAL);                                          00000600
    IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                           00000610
       ^(TR0_PCB.STATUS_KODE = '  ' ! TR0_PCB.STATUS_KODE = 'II') THEN  00000620
    DO;                                                                 00000630
 L100:                                                                  00000640
     /*--------------------------------------*/                         00000650
     /* FEIL VED INSERT-KALLET TIL TR0-BASEN */                         00000660
     /* SEGMENTET FANTES IKKE FRA FØR OG     */                         00000670
     /* LOT SEG HELLER IKKE LEGGE INN        */                         00000680
     /*--------------------------------------*/                         00000690
                                                                        00000700
        DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                             00000710
        DIV_PARAM_OMR.FEIL_VED_LABEL = 'L100';                          00000720
        DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;             00000730
        GO TO UTGANG;                                                   00000740
    END;                                                                00000750
                                                                        00000760
                                                                        00000770
 /*-------------------------------*/                                    00000780
 /* BEHANDLING AV REGTPKT-SEGMENT */                                    00000790
 /*-------------------------------*/                                    00000800
                                                                        00000810
    SSA_TR0ROT.FNR_KEY = TR0ROT.FNR;                                    00000820
    IF SEGMENT_TABELL.REGTPKT THEN                                      00000830
    DO;                                                                 00000840
       REGTPKT.DATOKL = DATO_KLOKKE;                                    00000850
       PBR_TEXT = 'DANN REGTPKT-SEGMENT.  ID = ' !! DATO_KLOKKE;        00000860
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00000870
                                                                        00000880
       IO_PEK = ADDR(REGTPKT);                                          00000890
       IO_AREA = IO_HELP_AREA;                                          00000900
       SSA_UNQUAL = 'REGTPKT ';                                         00000910
       CALL PLITDLI (PARAM_COUNT_5,                                     00000920
                     INSERT,                                            00000930
                     TR0_PCB,                                           00000940
                     IO_AREA,                                           00000950
                     SSA_TR0ROT,                                        00000960
                     SSA_UNQUAL);                                       00000970
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00000980
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00000990
       DO;                                                              00001000
 L110:                                                                  00001010
        /*------------------------------------------------*/            00001020
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN           */            00001030
        /* UNIKT REGTPKT-SEGMENTET LOT SEG IKKE LEGGE INN */            00001040
        /*------------------------------------------------*/            00001050
                                                                        00001060
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00001070
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L110';                       00001080
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00001090
           GO TO UTGANG;                                                00001100
        END;                                                            00001110
     END;                                                               00001120
                                                                        00001130
 /*-----------------------------*/                                      00001140
 /* BEHANDLING AV PTYPE-SEGMENT */                                      00001150
 /*-----------------------------*/                                      00001160
                                                                        00001170
    SSA_REGTPKT.DATOKL_KEY = REGTPKT.DATOKL;                            00001180
    IF SEGMENT_TABELL.PTYPE THEN                                        00001190
    DO;                                                                 00001200
       PBR_TEXT = 'DANN PTYPE-SEGMENT';                                 00001210
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00001220
                                                                        00001230
       IO_PEK = ADDR(PTYPE);                                            00001240
       IO_AREA = IO_HELP_AREA;                                          00001250
       SSA_UNQUAL = 'PTYPE   ';                                         00001260
       CALL PLITDLI (PARAM_COUNT_6,                                     00001270
                     INSERT,                                            00001280
                     TR0_PCB,                                           00001290
                     IO_AREA,                                           00001300
                     SSA_TR0ROT,                                        00001310
                     SSA_REGTPKT,                                       00001320
                     SSA_UNQUAL);                                       00001330
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00001340
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00001350
       DO;                                                              00001360
 L120:                                                                  00001370
           /*----------------------------------------------*/           00001380
           /* FEIL VED INSERT-KALLET TIL TR0-BASEN         */           00001390
           /* UNIKT PTYPE-SEGMENTET LOT SEG IKKE LEGGE INN */           00001400
           /*----------------------------------------------*/           00001410
                                                                        00001420
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00001430
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L120';                       00001440
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00001450
           GO TO UTGANG;                                                00001460
        END;                                                            00001470
     END;                                                               00001480
                                                                        00001490
 /*-------------------------------*/                                    00001500
 /* BEHANDLING AV SIVILST-SEGMENT */                                    00001510
 /*-------------------------------*/                                    00001520
                                                                        00001530
    IF SEGMENT_TABELL.SIVILST THEN                                      00001540
    DO;                                                                 00001550
       PBR_TEXT = 'DANN SIVILST-SEGMENT';                               00001560
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00001570
                                                                        00001580
       IO_PEK = ADDR(SIVILST);                                          00001590
       IO_AREA = IO_HELP_AREA;                                          00001600
       SSA_UNQUAL = 'SIVILST ';                                         00001610
       CALL PLITDLI (PARAM_COUNT_6,                                     00001620
                     INSERT,                                            00001630
                     TR0_PCB,                                           00001640
                     IO_AREA,                                           00001650
                     SSA_TR0ROT,                                        00001660
                     SSA_REGTPKT,                                       00001670
                     SSA_UNQUAL);                                       00001680
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00001690
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00001700
       DO;                                                              00001710
 L130:                                                                  00001720
        /*------------------------------------------------*/            00001730
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN           */            00001740
        /* UNIKT SIVILST-SEGMENTET LOT SEG IKKE LEGGE INN */            00001750
        /*------------------------------------------------*/            00001760
                                                                        00001770
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00001780
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L130';                       00001790
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00001800
           GO TO UTGANG;                                                00001810
        END;                                                            00001820
     END;                                                               00001830
                                                                        00001840
                                                                        00001850
 /*-------------------------------*/                                    00001860
 /* BEHANDLING AV APOPPL-SEGMENT */                                     00001870
 /*-------------------------------*/                                    00001880
                                                                        00001890
    IF SEGMENT_TABELL.APOPPL THEN                                       00001900
    DO;                                                                 00001910
       PBR_TEXT = 'DANN APOPPL-SEGMENT';                                00001920
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00001930
                                                                        00001940
       IO_PEK = ADDR(APOPPL);                                           00001950
       IO_AREA = IO_HELP_AREA;                                          00001960
       SSA_UNQUAL = 'APOPPL ';                                          00001970
       CALL PLITDLI (PARAM_COUNT_6,                                     00001980
                     INSERT,                                            00001990
                     TR0_PCB,                                           00002000
                     IO_AREA,                                           00002010
                     SSA_TR0ROT,                                        00002020
                     SSA_REGTPKT,                                       00002030
                     SSA_UNQUAL);                                       00002040
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00002050
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00002060
       DO;                                                              00002070
 L140:                                                                  00002080
        /*------------------------------------------------*/            00002090
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN           */            00002100
        /* UNIKT APOPPL-SEGMENTET LOT SEG IKKE LEGGE INN */             00002110
        /*------------------------------------------------*/            00002120
                                                                        00002130
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00002140
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L140';                       00002150
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00002160
           GO TO UTGANG;                                                00002170
        END;                                                            00002180
     END;                                                               00002190
                                                                        00002200
 /*-------------------------------*/                                    00002210
 /* BEHANDLING AV PENSJON-SEGMENT */                                    00002220
 /*-------------------------------*/                                    00002230
                                                                        00002240
    IF SEGMENT_TABELL.PENSJON THEN                                      00002250
    DO;                                                                 00002260
       PBR_TEXT = 'DANN PENSJON-SEGMENT';                               00002270
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00002280
                                                                        00002290
       IO_PEK = ADDR(PENSJON);                                          00002300
       IO_AREA = IO_HELP_AREA;                                          00002310
       SSA_UNQUAL = 'PENSJON ';                                         00002320
       CALL PLITDLI (PARAM_COUNT_6,                                     00002330
                     INSERT,                                            00002340
                     TR0_PCB,                                           00002350
                     IO_AREA,                                           00002360
                     SSA_TR0ROT,                                        00002370
                     SSA_REGTPKT,                                       00002380
                     SSA_UNQUAL);                                       00002390
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00002400
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00002410
       DO;                                                              00002420
 L150:                                                                  00002430
        /*------------------------------------------------*/            00002440
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN           */            00002450
        /* UNIKT PENSJON-SEGMENTET LOT SEG IKKE LEGGE INN */            00002460
        /*------------------------------------------------*/            00002470
                                                                        00002480
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00002490
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L150';                       00002500
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00002510
           GO TO UTGANG;                                                00002520
        END;                                                            00002530
     END;                                                               00002540
                                                                        00002550
 /*--------------------------*/                                         00002560
 /* BEHANDLING AV KT-SEGMENT */                                         00002570
 /*--------------------------*/                                         00002580
                                                                        00002590
    IF SEGMENT_TABELL.KT THEN                                           00002600
    DO;                                                                 00002610
       PBR_TEXT = 'DANN KT-SEGMENT';                                    00002620
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00002630
                                                                        00002640
       IO_PEK = ADDR(KT);                                               00002650
       IO_AREA = IO_HELP_AREA;                                          00002660
       SSA_UNQUAL = 'KT      ';                                         00002670
       CALL PLITDLI (PARAM_COUNT_6,                                     00002680
                     INSERT,                                            00002690
                     TR0_PCB,                                           00002700
                     IO_AREA,                                           00002710
                     SSA_TR0ROT,                                        00002720
                     SSA_REGTPKT,                                       00002730
                     SSA_UNQUAL);                                       00002740
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00002750
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00002760
       DO;                                                              00002770
 L160:                                                                  00002780
        /*-------------------------------------------*/                 00002790
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN      */                 00002800
        /* UNIKT KT-SEGMENTET LOT SEG IKKE LEGGE INN */                 00002810
        /*-------------------------------------------*/                 00002820
                                                                        00002830
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00002840
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L160';                       00002850
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00002860
           GO TO UTGANG;                                                00002870
        END;                                                            00002880
     END;                                                               00002890
                                                                        00002900
 /*------------------------------*/                                     00002910
 /* BEHANDLING AV EKTILL-SEGMENT */                                     00002920
 /*------------------------------*/                                     00002930
                                                                        00002940
    IF SEGMENT_TABELL.ET THEN                                           00002950
    DO;                                                                 00002960
       PBR_TEXT = 'DANN ET-SEGMENT';                                    00002970
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00002980
                                                                        00002990
       IO_PEK = ADDR(ET);                                               00003000
       IO_AREA = IO_HELP_AREA;                                          00003010
       SSA_UNQUAL = 'ET      ';                                         00003020
       CALL PLITDLI (PARAM_COUNT_6,                                     00003030
                     INSERT,                                            00003040
                     TR0_PCB,                                           00003050
                     IO_AREA,                                           00003060
                     SSA_TR0ROT,                                        00003070
                     SSA_REGTPKT,                                       00003080
                     SSA_UNQUAL);                                       00003090
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00003100
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00003110
       DO;                                                              00003120
 L170:                                                                  00003130
        /*-------------------------------------------*/                 00003140
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN      */                 00003150
        /* UNIKT ET-SEGMENTET LOT SEG IKKE LEGGE INN */                 00003160
        /*-------------------------------------------*/                 00003170
                                                                        00003180
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00003190
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L170';                       00003200
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00003210
           GO TO UTGANG;                                                00003220
        END;                                                            00003230
     END;                                                               00003240
                                                                        00003250
 /*-----------------------------*/                                      00003260
 /* BEHANDLING AV UPPER-SEGMENT */                                      00003270
 /*-----------------------------*/                                      00003280
                                                                        00003290
    IF SEGMENT_TABELL.UPPER THEN                                        00003300
    DO;                                                                 00003310
       PBR_TEXT = 'DANN UPPER-SEGMENT';                                 00003320
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00003330
                                                                        00003340
       IO_PEK = ADDR(UPPER);                                            00003350
       IO_AREA = IO_HELP_AREA;                                          00003360
       SSA_UNQUAL = 'UPPER   ';                                         00003370
       CALL PLITDLI (PARAM_COUNT_6,                                     00003380
                     INSERT,                                            00003390
                     TR0_PCB,                                           00003400
                     IO_AREA,                                           00003410
                     SSA_TR0ROT,                                        00003420
                     SSA_REGTPKT,                                       00003430
                     SSA_UNQUAL);                                       00003440
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00003450
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00003460
       DO;                                                              00003470
 L180:                                                                  00003480
        /*----------------------------------------------*/              00003490
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN         */              00003500
        /* UNIKT UPPER-SEGMENTET LOT SEG IKKE LEGGE INN */              00003510
        /*----------------------------------------------*/              00003520
                                                                        00003530
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00003540
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L180';                       00003550
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00003560
           GO TO UTGANG;                                                00003570
        END;                                                            00003580
     END;                                                               00003590
                                                                        00003600
 /*--------------------------*/                                         00003610
 /* BEHANDLING AV VT-SEGMENT */                                         00003620
 /*--------------------------*/                                         00003630
                                                                        00003640
    IF SEGMENT_TABELL.VT THEN                                           00003650
    DO;                                                                 00003660
       PBR_TEXT = 'DANN VT-SEGMENT';                                    00003670
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00003680
                                                                        00003690
       IO_PEK = ADDR(VT);                                               00003700
       IO_AREA = IO_HELP_AREA;                                          00003710
       SSA_UNQUAL = 'VT      ';                                         00003720
       CALL PLITDLI (PARAM_COUNT_6,                                     00003730
                     INSERT,                                            00003740
                     TR0_PCB,                                           00003750
                     IO_AREA,                                           00003760
                     SSA_TR0ROT,                                        00003770
                     SSA_REGTPKT,                                       00003780
                     SSA_UNQUAL);                                       00003790
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00003800
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00003810
       DO;                                                              00003820
 L190:                                                                  00003830
        /*-------------------------------------------*/                 00003840
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN      */                 00003850
        /* UNIKT VT-SEGMENTET LOT SEG IKKE LEGGE INN */                 00003860
        /*-------------------------------------------*/                 00003870
                                                                        00003880
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00003890
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L190';                       00003900
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00003910
           GO TO UTGANG;                                                00003920
        END;                                                            00003930
     END;                                                               00003940
                                                                        00003950
 /*--------------------------*/                                         00003960
 /* BEHANDLING AV BT-SEGMENT */                                         00003970
 /*--------------------------*/                                         00003980
                                                                        00003990
    IF SEGMENT_TABELL.BT THEN                                           00004000
    DO;                                                                 00004010
       PBR_TEXT = 'DANN BT-SEGMENT';                                    00004020
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00004030
                                                                        00004040
       IO_PEK = ADDR(BT);                                               00004050
       IO_AREA = IO_HELP_AREA;                                          00004060
       SSA_UNQUAL = 'BT      ';                                         00004070
       CALL PLITDLI (PARAM_COUNT_6,                                     00004080
                     INSERT,                                            00004090
                     TR0_PCB,                                           00004100
                     IO_AREA,                                           00004110
                     SSA_TR0ROT,                                        00004120
                     SSA_REGTPKT,                                       00004130
                     SSA_UNQUAL);                                       00004140
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00004150
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00004160
       DO;                                                              00004170
 L200:                                                                  00004180
        /*-------------------------------------------*/                 00004190
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN      */                 00004200
        /* UNIKT BT-SEGMENTET LOT SEG IKKE LEGGE INN */                 00004210
        /*-------------------------------------------*/                 00004220
                                                                        00004230
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00004240
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L200';                       00004250
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00004260
           GO TO UTGANG;                                                00004270
        END;                                                            00004280
     END;                                                               00004290
                                                                        00004300
 /*-----------------------------*/                                      00004310
 /* BEHANDLING AV TILKN-SEGMENT */                                      00004320
 /*-----------------------------*/                                      00004330
                                                                        00004340
    IF SEGMENT_TABELL.TILKN THEN                                        00004350
    DO;                                                                 00004360
       SSA_UNQUAL = 'TILKN   ';                                         00004370
                                                                        00004380
       DO J=1 TO 6;    /* ØKER TIL 6 TILKN-MULIGHETER(SAMBOER) BØ9012 */00004390
          IF TILKN.TKNYTT(J).FNR_TILKN > 0 THEN                         00004400
          DO;                                                           00004410
                                                                        00004420
             HELP_FNR = TILKN.TKNYTT(J).FNR_TILKN;                      00004430
             PBR_TEXT = 'TILKN : ' !! HELP_FNR !! ' KODE : ' !!         00004440
                        TILKN.TKNYTT(J).TILKNYTNINGSKODE;               00004450
          /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */              00004460
                                                                        00004470
             IO_PEK = ADDR(TILKN.TKNYTT(J));                            00004480
             IO_AREA = IO_HELP_AREA;                                    00004490
             CALL PLITDLI (PARAM_COUNT_6,                               00004500
                           INSERT,                                      00004510
                           TR0_PCB,                                     00004520
                           IO_AREA,                                     00004530
                           SSA_TR0ROT,                                  00004540
                           SSA_REGTPKT,                                 00004550
                           SSA_UNQUAL);                                 00004560
             IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                  00004570
                TR0_PCB.STATUS_KODE ^= '  ' THEN                        00004580
             DO;                                                        00004590
 L210:                                                                  00004600
              /*----------------------------------------------*/        00004610
              /* FEIL VED INSERT-KALLET TIL TR0-BASEN         */        00004620
              /* ET TILKN-SEGMENTET LOT SEG IKKE LEGGE INN    */        00004630
              /*----------------------------------------------*/        00004640
                                                                        00004650
                 DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                    00004660
                 DIV_PARAM_OMR.FEIL_VED_LABEL = 'L210';                 00004670
                 DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;    00004680
                 GO TO UTGANG;                                          00004690
              END;                                                      00004700
           END;                                                         00004710
        END;                                                            00004720
     END;                                                               00004730
                                                                        00004740
 /*------------------------------*/                                     00004750
 /* BEHANDLING AV ETTERL-SEGMENT */                                     00004760
 /*------------------------------*/                                     00004770
                                                                        00004780
    IF SEGMENT_TABELL.ETTERL THEN                                       00004790
    DO;                                                                 00004800
       PBR_TEXT = 'DANN ETTERL-SEGMENT';                                00004810
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00004820
                                                                        00004830
       IO_PEK = ADDR(ETTERL);                                           00004840
       IO_AREA = IO_HELP_AREA;                                          00004850
       SSA_UNQUAL = 'ETTERL  ';                                         00004860
       CALL PLITDLI (PARAM_COUNT_6,                                     00004870
                     INSERT,                                            00004880
                     TR0_PCB,                                           00004890
                     IO_AREA,                                           00004900
                     SSA_TR0ROT,                                        00004910
                     SSA_REGTPKT,                                       00004920
                     SSA_UNQUAL);                                       00004930
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00004940
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00004950
       DO;                                                              00004960
 L220:                                                                  00004970
        /*-----------------------------------------------*/             00004980
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN          */             00004990
        /* UNIKT ETTERL-SEGMENTET LOT SEG IKKE LEGGE INN */             00005000
        /*-----------------------------------------------*/             00005010
                                                                        00005020
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00005030
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L220';                       00005040
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00005050
           GO TO UTGANG;                                                00005060
        END;                                                            00005070
     END;                                                               00005080
 /*--------------------------------*/                                   00005090
 /* BEHANDLING AV DIAGNOSE-SEGMENT */                                   00005100
 /*--------------------------------*/                                   00005110
                                                                        00005120
    IF SEGMENT_TABELL.DIAGNOSE THEN                                     00005130
    DO;                                                                 00005140
       PBR_TEXT = 'DANN DIAGNOSE-SEGMENT';                              00005150
  /*   EXEC CICS ENTER TRACEID(01) FROM (PBR_TEXT); */                  00005160
                                                                        00005170
       IO_PEK = ADDR(DIAGNOSE);                                         00005180
       IO_AREA = IO_HELP_AREA;                                          00005190
       SSA_UNQUAL = 'DIAGNOSE';                                         00005200
       CALL PLITDLI (PARAM_COUNT_6,                                     00005210
                     INSERT,                                            00005220
                     TR0_PCB,                                           00005230
                     IO_AREA,                                           00005240
                     SSA_TR0ROT,                                        00005250
                     SSA_REGTPKT,                                       00005260
                     SSA_UNQUAL);                                       00005270
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00005280
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00005290
       DO;                                                              00005300
 L230:                                                                  00005310
        /*-----------------------------------------------*/             00005320
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN          */             00005330
        /* UNIKT DIAGNOSE-SEGMENT LOT SEG IKKE LEGGE INN */             00005340
        /*-----------------------------------------------*/             00005350
                                                                        00005360
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00005370
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L230';                       00005380
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00005390
           GO TO UTGANG;                                                00005400
        END;                                                            00005410
     END;                                                               00005420
                                                                        00005430
 /*--------------------------------*/                                   00005440
 /* BEHANDLING AV SPESOPPL-SEGMENT */                                   00005450
 /*--------------------------------*/                                   00005460
                                                                        00005470
    IF SEGMENT_TABELL.SPESOPPL THEN                                     00005480
    DO;                                                                 00005490
       PBR_TEXT = 'DANN SPESOPPL-SEGMENT';                              00005500
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00005510
                                                                        00005520
       IO_PEK = ADDR(SPESOPPL);                                         00005530
       IO_AREA = IO_HELP_AREA;                                          00005540
       SSA_UNQUAL = 'SPESOPPL';                                         00005550
       CALL PLITDLI (PARAM_COUNT_6,                                     00005560
                     INSERT,                                            00005570
                     TR0_PCB,                                           00005580
                     IO_AREA,                                           00005590
                     SSA_TR0ROT,                                        00005600
                     SSA_REGTPKT,                                       00005610
                     SSA_UNQUAL);                                       00005620
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00005630
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00005640
       DO;                                                              00005650
 L240:                                                                  00005660
        /*-----------------------------------------------*/             00005670
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN          */             00005680
        /* UNIKT SPESOPPL-SEGMENT LOT SEG IKKE LEGGE INN */             00005690
        /*-----------------------------------------------*/             00005700
                                                                        00005710
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00005720
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L240';                       00005730
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00005740
           GO TO UTGANG;                                                00005750
        END;                                                            00005760
     END;                                                               00005770
 /*--------------------------------*/                                   00005780
 /* BEHANDLING AV YSKADE-SEGMENT */                                     00005790
 /*--------------------------------*/                                   00005800
                                                                        00005810
    IF SEGMENT_TABELL.YSKADE THEN                                       00005820
    DO;                                                                 00005830
       PBR_TEXT = 'DANN YSKADE-SEGMENT';                                00005840
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM;*/                     00005850
                                                                        00005860
       IO_PEK = ADDR(YSKADE);                                           00005870
       IO_AREA = IO_HELP_AREA;                                          00005880
       SSA_UNQUAL = 'YSKADE  ';                                         00005890
       CALL PLITDLI (PARAM_COUNT_6,                                     00005900
                     INSERT,                                            00005910
                     TR0_PCB,                                           00005920
                     IO_AREA,                                           00005930
                     SSA_TR0ROT,                                        00005940
                     SSA_REGTPKT,                                       00005950
                     SSA_UNQUAL);                                       00005960
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00005970
          TR0_PCB.STATUS_KODE ^= '  ' THEN                              00005980
       DO;                                                              00005990
 L250:                                                                  00006000
        /*-----------------------------------------------*/             00006010
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN          */             00006020
        /* UNIKT YSKADE  -SEGMENT LOT SEG IKKE LEGGE INN */             00006030
        /*-----------------------------------------------*/             00006040
                                                                        00006050
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00006060
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L250';                       00006070
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00006080
           GO TO UTGANG;                                                00006090
        END;                                                            00006100
     END;                                                               00006110
                                                                        00006120
 /*--------------------------------*/                                   00006130
 /* BEHANDLING AV EØSINFO-SEGMENT  */                                   00006140
 /*--------------------------------*/                                   00006150
                                                                        00006160
    IF SEGMENT_TABELL.EØSINFO THEN                                      00006170
    DO;                                                                 00006180
       PBR_TEXT = 'DANN EØSINFO-SEGMENT';                               00006190
    /* EXEC CICS SEND TEXT FROM (PBR_TEXT) ACCUM; */                    00006200
                                                                        00006210
       IO_PEK = ADDR(EØSINFO);                                          00006220
       IO_AREA = IO_HELP_AREA;                                          00006230
       SSA_UNQUAL = 'EØSINFO ';                                         00006240
                                                                        00006250
       CALL PLITDLI (PARAM_COUNT_6,                                     00006260
                     INSERT,                                            00006270
                     TR0_PCB,                                           00006280
                     IO_AREA,                                           00006290
                     SSA_TR0ROT,                                        00006300
                     SSA_REGTPKT,                                       00006310
                     SSA_UNQUAL);                                       00006320
                                                                        00006330
       IF DLIUIB.UIBRCODE.UIBFCTR ^= UIB_RC_OK !                        00006340
          TR0_PCB.STATUS_KODE     ^= '  ' THEN                          00006350
       DO;                                                              00006360
 L260:                                                                  00006370
        /*-----------------------------------------------*/             00006380
        /* FEIL VED INSERT-KALLET TIL TR0-BASEN          */             00006390
        /* UNIKT EØSINFO-SEGMENT LOT SEG IKKE LEGGE INN */              00006400
        /*-----------------------------------------------*/             00006410
                                                                        00006420
           DIV_PARAM_OMR.FEIL_MELD_NR   = 500;                          00006430
           DIV_PARAM_OMR.FEIL_VED_LABEL = 'L260';                       00006440
           DIV_PARAM_OMR.DB_STATUS_KODE = TR0_PCB.STATUS_KODE;          00006450
           GO TO UTGANG;                                                00006460
        END;                                                            00006470
     END;                                                               00006480
 END SKRIV_STAT_SEGM;                                                   00006490
                                                                        00006500
