 /*       SIST ENDRET 01/12-89 08.38.10 AV   DYBVIK                   */00000000
 /*       SIST ENDRET 29/03-88 13.12.43 AV   DYBVIK                   */00000010
 /*       SIST ENDRET 24/03-87 11.47.11 AV   DYBVIK                   */00000020
 /*       SIST ENDRET 27/03-84 17.10.06 AV   KARIN                    */00000030
 /*       SIST ENDRET 31/01-84 15.14.23 AV   FARVIK                   */00000040
 /*       SIST ENDRET 09/09-83 13.03.56 AV   OLAV                     */00000050
 /*       SIST ENDRET 26/01-83 07.56.54 AV   FARVIK                   */00000060
 /* **************************************************************** */ 00000070
 /*IDENTIFIKASJON:                                                   */ 00000080
 /*    R0011022 - PROSEDYRE I PLI                                    */ 00000090
 /*    PROGRAMMERER: GEIR, MARS 1982                                 */ 00000100
 /* **************************************************************** */ 00000110
 /*ENDRINGSDATO 27/3-84                                              */ 00000120
 /*ENDRINGEN GJELDER : DET ER BEHOV FOR Å KUNNE REGISTRERE FORELDRE- */ 00000130
 /*                    LØSE BARN UTEN OPPLYSNINGER OM AVDØD MOR/FAR  */ 00000140
 /*                    AVDØDES FNR I TRANSEN ER DA = (11)'1'.        */ 00000150
 /*                    ENDRINGEN GJELDER DETTE FORHOLDET.            */ 00000160
 /*ENDRET AV KARIN                                                   */ 00000170
 /* **************************************************************** */ 00000180
 /*ENDRINGSDATO 040287                                               */ 00000190
 /*ENDRINGEN GJELDER : FARS FRAMTIDIGE TRYGDETID BLE BEREGNET GALT   */ 00000200
 /*                    FORDI MORS DØDSDATO BLE BRUKT SOM DØDSDATO.   */ 00000210
 /*                    FEILRAPP. 410, 464.                           */ 00000220
 /*ENDRET AV BRITT                                                   */ 00000230
 /* **************************************************************** */ 00000240
 /*HENSIKT:                                                          */ 00000250
 /*    PENSJONSSTATUS OPPDATERES MED INFORMASJON FRA TRANSEN         */ 00000260
 /*PROGRAMTILKNYTNINNG:                                              */ 00000270
 /*    FUNKSJONEN INCLUDES I BEHANDLINGA AV FORELDRELØSE BARN        */ 00000280
 /*BRUK:                                                             */ 00000290
 /*    AJOURFØR_B02_MED_FB_TRANS                                     */ 00000300
 /*                                                                  */ 00000310
 /* **************************************************************** */ 00000320
 %SKIP(2);                                                              00000330
 AJOURFØR_B02_MED_FB_TRANS:                                             00000340
   PROC(POS_I_TRANS);                                                   00000350
                                                                        00000360
    DCL                                                                 00000370
       POS_I_TRANS                   FIXED BIN(15);                     00000380
                                                                        00000390
    DCL                                                                 00000400
       HJ_DØD                        PIC '999999',                      00000410
       HJ_DØD_Å DEF HJ_DØD POS(5)    PIC '99',                          00000420
 /*YS*/HJ_DØD_M DEF HJ_DØD POS(3)    PIC '99',                          00000430
 /*YS*/HJ_DØD_ÅM                     PIC '9999',                        00000440
 /*YS*/W2_DØD_Å DEF HJ_DØD_ÅM POS(1) PIC '99',                          00000450
 /*YS*/W2_DØD_M DEF HJ_DØD_ÅM POS(3) PIC '99',                          00000460
       ÅR_FØR_DØD                    PIC '99';                          00000470
                                                                        00000480
 %SKIP;                                                                 00000490
      B02.PENSJONSTYPE1(BARN_IND)     = 'B';                            00000500
      B02.FØRSTE_GANG_REG(BARN_IND)   = 'N';                            00000510
      B02.STATUS.SIVILSTAND(BARN_IND) = 'U';                            00000520
      B02.NAVN (BARN_IND)  = BARN.NAVN_B(POS_I_TRANS);                  00000530
      B02.TKNR (BARN_IND)  = BARN.TKNR(POS_I_TRANS);                    00000540
      B02.SPRÅK(BARN_IND)  = BARN_GEN.SPRÅK;                            00000550
                                                                        00000560
 /* ************************************************************* */    00000570
 /* DERSOM BARNET ER YNGSTE BARN                                  */    00000580
 /* ************************************************************* */    00000590
                                                                        00000600
      IF BARN_IND = 3 THEN                                              00000610
         DO;                                                            00000620
  /*    B02.PENSJONSTYPE2(BARN_IND) = 'Y';  ENDRET  15.03.88 SATISH   */00000630
            B02.PENSJONSTYPE2(BARN_IND) = 'P';                          00000640
                                                                        00000650
 /* ***************************************************************** */00000660
 /* OPPLYSNING OM AVDØDE MOR                                          */00000670
 /* ***************************************************************** */00000680
                                                                        00000690
            IF MOR.FNR_M ^= (11)'1' THEN                                00000700
               DO;                                                      00000710
                  B02.RF0PERSN.NAVN(1)         = MOR.NAVN_M;            00000720
                  B02.STATUS.VILKÅR_8_4_3A(1)  = MOR.VILKÅR_8_4_3A_M;   00000730
                  B02.SPESOPPL.OVERKOMP_UTL(1) = MOR.                   00000740
                                                 OVERKOMP_M;            00000750
                  B02.TT_FØR_1967(1)           = MOR.                   00000760
                                                 TT_F67_M;              00000770
                  B02.TT_ETTER_1966(1)         = MOR.                   00000780
                      TT_E66_Å_M * 12 + MOR.TT_E66_M_M;                 00000790
                  B02.TT_FRAMT(1)              = F_BEREGN_TT_FRAMT(     00000800
                                                 B02.FNR(1),            00000810
                                                 HJ_DØDSDATO_ÅM_MOR);   00000820
                                                                        00000830
 /* ***************************************************************** */00000840
 /* PENSJONSGIVENDE INNTEKT MOR                                       */00000850
 /* ***************************************************************** */00000860
                                                                        00000870
                  HJ_DØD     = MOR.DØDSDATO_M;                          00000880
 /*YS*/           W2_DØD_Å   = HJ_DØD_Å;                                00000890
 /*YS*/           W2_DØD_M   = HJ_DØD_M;                                00000900
                  ÅR_FØR_DØD = HJ_DØD_Å - 1;                            00000910
                  IF B01.PI(1,ÅR_FØR_DØD) = 0 &                         00000920
                     B01.PINNTEKT.PI_KODE(1,ÅR_FØR_DØD) = ' ' THEN      00000930
                     DO;                                                00000940
                        IF MOR.PI_M > 0 THEN                            00000950
                           DO;                                          00000960
                              B02.PI_KODE(1,ÅR_FØR_DØD) = 'F';          00000970
                              B02.PI(1,ÅR_FØR_DØD) = MOR.PI_M / 100;    00000980
                           END;                                         00000990
                     END;                                               00001000
 /*YS*/           IF YSKADE_TILLEGG_M = 'J' THEN                        00001010
 /*YS*/              DO;                                                00001020
 /*YS*/                 B02.DØD_AV_YRKESSKADE(1)  = 'J';                00001030
 /*YS*/                                                                 00001040
 /*YS*/                 /* ****************************************** */00001050
 /*YS*/                 /* YRKEHIST FOR AVDØDE SJEKKES FOR Å FINNE    */00001060
 /*YS*/                 /* FØRSTE LEDIGE PLASS I YRKEHIST.            */00001070
 /*YS*/                 /* ****************************************** */00001080
 /*YS*/                                                                 00001090
 /*YS*/                 DO I = 1 TO 5 WHILE (YRKE_IND = 0);             00001100
 /*YS*/                                                                 00001110
 /*YS*/                    IF B02.YRKEHIST.YUFT_ÅM(1,I) = 0  THEN       00001120
 /*YS*/                       YRKE_IND = I;                             00001130
 /*YS*/                 END;                                            00001140
 /*YS*/                                                                 00001150
 /*YS*/                 IF YRKE_IND = 0 THEN                            00001160
 /*YS*/                                                                 00001170
 /*YS*/                    /* *************************************** */00001180
 /*YS*/                    /* FEIL, 5 YRKEHIST-PERIODER ER BRUKT FRA  */00001190
 /*YS*/                    /* FØR.                                    */00001200
 /*YS*/                    /* *************************************** */00001210
 /*YS*/                                                                 00001220
 /*YS*/                    DO;                                          00001230
 /*YS*/L400:                  FEIL_VED_LABEL = '400';                   00001240
 /*YS*/                       FEIL_MELD_NR   = 1810 ;                   00001250
 /*YS*/                       GO TO RETUR;                              00001260
 /*YS*/                    END;                                         00001270
 /*YS*/                                                                 00001280
 /*YS*/                 IF YRKE_IND > 1 THEN                            00001290
 /*YS*/                    DO;                                          00001300
 /*YS*/                                                                 00001310
 /*YS*/                       IF B02.YRKEHIST.OPPH_DATO_ÅM              00001320
 /*YS*/                                                 (1,YRKE_IND - 1)00001330
 /*YS*/                                   >  HJ_DØD_ÅM            THEN  00001340
 /*YS*/                                                                 00001350
 /*YS*/                          /* ********************************* */00001360
 /*YS*/                          /* FEIL, DØDSDATO LIGGER FØR         */00001370
 /*YS*/                          /* OPPHØRSTIDSPUNKT I FORRIGE        */00001380
 /*YS*/                          /* PERIODE.                          */00001390
 /*YS*/                          /* ********************************* */00001400
 /*YS*/                                                                 00001410
 /*YS*/                          DO;                                    00001420
 /*YS*/L410:                        FEIL_VED_LABEL = '410';             00001430
 /*YS*/                             FEIL_MELD_NR   = 1712 ;             00001440
 /*YS*/                             GO TO RETUR;                        00001450
 /*YS*/                          END;                                   00001460
 /*YS*/                                                                 00001470
 /*YS*/                       IF B02.YRKEHIST.OPPH_DATO_ÅM              00001480
 /*YS*/                                     (1,YRKE_IND - 1) = 0  THEN  00001490
 /*YS*/                          DO;                                    00001500
 /*YS*/                                                                 00001510
 /*YS*/                             /* ****************************** */00001520
 /*YS*/                             /* KONTROLL SOM KANSKJE BØR       */00001530
 /*YS*/                             /* FORETAS:                       */00001540
 /*YS*/                             /*   HVIS IKKE SAMME SKADE        */00001550
 /*YS*/                             /*   OG GRAD = 100        : FEIL. */00001560
 /*YS*/                             /* ****************************** */00001570
 /*YS*/                                                                 00001580
 /*YS*/                             IF B02.YRKEHIST.YST_ÅM              00001590
 /*YS*/                                            (1,YRKE_IND - 1) ^=  00001600
 /*YS*/                                F_SNU_DATO(FBY_MOR.YST_MÅ_M) THEN00001610
 /*YS*/                                DO;                              00001620
 /*YS*/                                   B02.YRKEHIST.OPPH_DATO_ÅM     00001630
 /*YS*/                                                 (1,YRKE_IND - 1)00001640
 /*YS*/                                             =    HJ_DØD_ÅM ;    00001650
 /*YS*/                                   B02.YRKEHIST.OPPH_KODE        00001660
 /*YS*/                                      (1,YRKE_IND - 1)  = 'J';   00001670
 /*YS*/                                END;                             00001680
 /*YS*/                             ELSE                                00001690
 /*YS*/                                DO;                              00001700
 /*YS*/                                   B02.YRKEHIST.OPPH_DATO_ÅM     00001710
 /*YS*/                                            (1,YRKE_IND - 1)=    00001720
 /*YS*/                                     F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM);00001730
 /*YS*/                                   B02.YRKEHIST.OPPH_KODE        00001740
 /*YS*/                                         (1,YRKE_IND - 1)  = 'D';00001750
 /*YS*/                                END;                             00001760
 /*YS*/                          END;                                   00001770
 /*YS*/                                                                 00001780
 /*YS*/                                                                 00001790
 /*YS*/                       /* ************************************ */00001800
 /*YS*/                       /* KONTROLL SOM KANSKJE BØR FORETAS:    */00001810
 /*YS*/                       /*  HVIS SAMME SKADE  :                 */00001820
 /*YS*/                       /*                  KONTROLLER OPPLYSN. */00001830
 /*YS*/                       /*                  PÅ BLANKETTEN MOT   */00001840
 /*YS*/                       /*                  OPPLYSN. I YRKEHIST.*/00001850
 /*YS*/                       /* ************************************ */00001860
 /*YS*/                                                                 00001870
 /*YS*/                    END;                                         00001880
 /*YS*/                                                                 00001890
 /*YS*/                 IF    YRKE_IND = 1                             !00001900
 /*YS*/                    (  YRKE_IND > 1                             &00001910
 /*YS*/                     ((B02.YRKEHIST.YST_ÅM(1,YRKE_IND - 1) ^=    00001920
 /*YS*/                              F_SNU_DATO(FBY_MOR.YST_MÅ_M))     !00001930
 /*YS*/                      (B02.YRKEHIST.YST_ÅM(1,YRKE_IND - 1) =     00001940
 /*YS*/                              F_SNU_DATO(FBY_MOR.YST_MÅ_M)      &00001950
 /*YS*/                       B02.YRKEHIST.OPPH_DATO_ÅM(1,YRKE_IND - 1) 00001960
 /*YS*/                              > 0                               &00001970
 /*YS*/                       B02.YRKEHIST.OPPH_DATO_ÅM(1,YRKE_IND - 1) 00001980
 /*YS*/                            ^=  F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM)  ))) 00001990
 /*YS*/                                                            THEN 00002000
 /*YS*/                                                                 00002010
 /*YS*/                    /* *************************************** */00002020
 /*YS*/                    /* YRKEHIST FYLLES MED OPPLYSNINGER FRA    */00002030
 /*YS*/                    /* BLANKETTEN.                             */00002040
 /*YS*/                    /* *************************************** */00002050
 /*YS*/                                                                 00002060
 /*YS*/                    DO;                                          00002070
 /*YS*/                       B02.YRKEHIST.YUFT_ÅM(1,YRKE_IND) =        00002080
 /*YS*/                                                       HJ_DØD_ÅM;00002090
 /*YS*/                       B02.YRKEHIST.YUG(1,YRKE_IND) = 100;       00002100
 /*YS*/                       B02.YRKEHIST.YST_ÅM(1,YRKE_IND) =         00002110
 /*YS*/                                    F_SNU_DATO(FBY_MOR.YST_MÅ_M);00002120
 /*YS*/                       B02.YRKEHIST.AÅI(1,YRKE_IND) =            00002130
 /*YS*/                                                   FBY_MOR.AÅI_M;00002140
 /*YS*/                       B02.YRKEHIST.YRKE11(1,YRKE_IND) =         00002150
 /*YS*/                                                FBY_MOR.YRKE11_M;00002160
 /*YS*/                       B02.YRKEHIST.VILKÅR_1_2_2(1,YRKE_IND) =   00002170
 /*YS*/                                       FBY_MOR.VILKÅR_1_2_2A_M !!00002180
 /*YS*/                                       FBY_MOR.VILKÅR_1_2_2B_M;  00002190
 /*YS*/                       B02.YRKEHIST.OPPH_DATO_ÅM(1,YRKE_IND) =   00002200
 /*YS*/                                     F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM);00002210
 /*YS*/                       B02.YRKEHIST.OPPH_KODE(1,YRKE_IND) = 'D'; 00002220
 /*YS*/                    END;                                         00002230
 /*YS*/                                                                 00002240
 /*YS*/              END;                                               00002250
                                                                        00002260
                                                                        00002270
 /*YS*/           ELSE                                                  00002280
 /*YS*/                                                                 00002290
 /*YS*/              /* ****************************************** */   00002300
 /*YS*/              /* YRKESSKADEBLANKETT ER IKKE MED, MEN DET    */   00002310
 /*YS*/              /* SKJEKKES FOR Å FINNE UT OM DET ER          */   00002320
 /*YS*/              /* YRKESSKADE FRA FØR.                        */   00002330
 /*YS*/              /* ****************************************** */   00002340
 /*YS*/                                                                 00002350
 /*YS*/              DO;                                                00002360
 /*YS*/                                                                 00002370
 /*YS*/                 DO I = 1 TO 5 WHILE (YRKE_IND = 0);             00002380
 /*YS*/                                                                 00002390
 /*YS*/                    IF B02.YRKEHIST.YUFT_ÅM(1,I) = 0  THEN       00002400
 /*YS*/                       YRKE_IND = I;                             00002410
 /*YS*/                 END;                                            00002420
 /*YS*/                                                                 00002430
 /*YS*/                 IF YRKE_IND = 0 THEN                            00002440
 /*YS*/                    YRKE_IND = 6;                                00002450
 /*YS*/                                                                 00002460
 /*YS*/                 IF YRKE_IND > 1 THEN                            00002470
 /*YS*/                    DO;                                          00002480
 /*YS*/                                                                 00002490
 /*YS*/                       IF                                        00002500
 /*YS*/                        B02.YRKEHIST.OPPH_DATO_ÅM(1,YRKE_IND - 1)00002510
 /*YS*/                                   >  HJ_DØD_ÅM            THEN  00002520
 /*YS*/                                                                 00002530
 /*YS*/                          /* ********************************* */00002540
 /*YS*/                          /* FEIL, DØDSDATO LIGGER FØR         */00002550
 /*YS*/                          /* OPPHØRSTIDSPUNKT I FORRIGE        */00002560
 /*YS*/                          /* PERIODE.                          */00002570
 /*YS*/                          /* ********************************* */00002580
 /*YS*/                                                                 00002590
 /*YS*/                          DO;                                    00002600
 /*YS*/L420:                        FEIL_VED_LABEL = '420';             00002610
 /*YS*/                             FEIL_MELD_NR   = 1712 ;             00002620
 /*YS*/                             GO TO RETUR;                        00002630
 /*YS*/                          END;                                   00002640
 /*YS*/                                                                 00002650
 /*YS*/                       IF                                        00002660
 /*YS*/                        B02.YRKEHIST.OPPH_DATO_ÅM(1,YRKE_IND - 1)00002670
 /*YS*/                                                      = 0  THEN  00002680
 /*YS*/                          DO;                                    00002690
 /*YS*/                             B02.YRKEHIST.OPPH_DATO_ÅM           00002700
 /*YS*/                                                 (1,YRKE_IND - 1)00002710
 /*YS*/                                   = F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM);00002720
 /*YS*/                             B02.YRKEHIST.OPPH_KODE              00002730
 /*YS*/                                       (1,YRKE_IND - 1)  = 'D';  00002740
 /*YS*/                          END;                                   00002750
 /*YS*/                    END;                                         00002760
 /*YS*/              END;                                               00002770
                                                                        00002780
               END;                                                     00002790
                                                                        00002800
 /* ***************************************************************** */00002810
 /* OPPLYSNING OM AVDØDE FAR                                          */00002820
 /* ***************************************************************** */00002830
                                                                        00002840
            IF FAR.FNR_F ^= (11)'1' THEN                                00002850
               DO;                                                      00002860
                  B02.RF0PERSN.NAVN(2)         = FAR.NAVN_F;            00002870
                  B02.STATUS.VILKÅR_8_4_3A(2)  = FAR.VILKÅR_8_4_3A_F;   00002880
                  B02.SPESOPPL.OVERKOMP_UTL(2) = FAR.                   00002890
                                                 OVERKOMP_F;            00002900
                  B02.TT_FØR_1967(2)           = FAR.                   00002910
                                                 TT_F67_F;              00002920
                  B02.TT_ETTER_1966(2)         = FAR.                   00002930
                      TT_E66_Å_F * 12 + FAR.TT_E66_M_F;                 00002940
                  B02.TT_FRAMT(2)              = F_BEREGN_TT_FRAMT(     00002950
                                                 B02.FNR(2),            00002960
                                                 HJ_DØDSDATO_ÅM_FAR);   00002970
                                                                        00002980
 /* **************************************************************** */ 00002990
 /* OPPLYSNINGER OM VERNEPLIKT                                       */ 00003000
 /* **************************************************************** */ 00003010
                                                                        00003020
                  DO I = 1 TO 4 WHILE (FAR.VP_ÅR_F(POS_I_TRANS) > 0);   00003030
                     B02.VERNEPLIKTÅR(2,I) = FAR.VP_ÅR_F(POS_I_TRANS);  00003040
                  END;                                                  00003050
                                                                        00003060
 /* ***************************************************************** */00003070
 /* PENSJONSGIVENDE INNTEKT FAR                                       */00003080
 /* ***************************************************************** */00003090
                                                                        00003100
  %SKIP;                                                                00003110
                  HJ_DØD     = FAR.DØDSDATO_F;                          00003120
 /*YS*/           W2_DØD_Å   = HJ_DØD_Å;                                00003130
 /*YS*/           W2_DØD_M   = HJ_DØD_M;                                00003140
                  ÅR_FØR_DØD = HJ_DØD_Å - 1;                            00003150
                  IF B01.PI(2,ÅR_FØR_DØD) = 0 &                         00003160
                     B01.PINNTEKT.PI_KODE(2,ÅR_FØR_DØD) = ' ' THEN      00003170
                     DO;                                                00003180
                        IF FAR.PI_F > 0 THEN                            00003190
                           DO;                                          00003200
                              B02.PI_KODE(2,ÅR_FØR_DØD) = 'F';          00003210
                              B02.PI(2,ÅR_FØR_DØD) = FAR.PI_F / 100;    00003220
                           END;                                         00003230
                     END;                                               00003240
 /*YS*/           IF YSKADE_TILLEGG_F = 'J' THEN                        00003250
 /*YS*/              DO;                                                00003260
 /*YS*/                 B02.DØD_AV_YRKESSKADE(2)  = 'J';                00003270
 /*YS*/                                                                 00003280
 /*YS*/                 /* ****************************************** */00003290
 /*YS*/                 /* YRKEHIST FOR AVDØDE SJEKKES FOR Å FINNE    */00003300
 /*YS*/                 /* FØRSTE LEDIGE PLASS I YRKEHIST.            */00003310
 /*YS*/                 /* ****************************************** */00003320
 /*YS*/                                                                 00003330
 /*YS*/                 DO I = 1 TO 5 WHILE (YRKE_IND = 0);             00003340
 /*YS*/                                                                 00003350
 /*YS*/                    IF B02.YRKEHIST.YUFT_ÅM(2,I) = 0  THEN       00003360
 /*YS*/                       YRKE_IND = I;                             00003370
 /*YS*/                 END;                                            00003380
 /*YS*/                                                                 00003390
 /*YS*/                 IF YRKE_IND = 0 THEN                            00003400
 /*YS*/                                                                 00003410
 /*YS*/                    /* *************************************** */00003420
 /*YS*/                    /* FEIL, 5 YRKEHIST-PERIODER ER BRUKT FRA  */00003430
 /*YS*/                    /* FØR.                                    */00003440
 /*YS*/                    /* *************************************** */00003450
 /*YS*/                                                                 00003460
 /*YS*/                    DO;                                          00003470
 /*YS*/L430:                  FEIL_VED_LABEL = '430';                   00003480
 /*YS*/                       FEIL_MELD_NR   = 1810 ;                   00003490
 /*YS*/                       GO TO RETUR;                              00003500
 /*YS*/                    END;                                         00003510
 /*YS*/                                                                 00003520
 /*YS*/                 IF YRKE_IND > 1 THEN                            00003530
 /*YS*/                    DO;                                          00003540
 /*YS*/                                                                 00003550
 /*YS*/                       IF B02.YRKEHIST.OPPH_DATO_ÅM              00003560
 /*YS*/                                                 (2,YRKE_IND - 1)00003570
 /*YS*/                                   >  HJ_DØD_ÅM            THEN  00003580
 /*YS*/                                                                 00003590
 /*YS*/                          /* ********************************* */00003600
 /*YS*/                          /* FEIL, DØDSDATO LIGGER FØR         */00003610
 /*YS*/                          /* OPPHØRSTIDSPUNKT I FORRIGE        */00003620
 /*YS*/                          /* PERIODE.                          */00003630
 /*YS*/                          /* ********************************* */00003640
 /*YS*/                                                                 00003650
 /*YS*/                          DO;                                    00003660
 /*YS*/L440:                        FEIL_VED_LABEL = '440';             00003670
 /*YS*/                             FEIL_MELD_NR   = 1712 ;             00003680
 /*YS*/                             GO TO RETUR;                        00003690
 /*YS*/                          END;                                   00003700
 /*YS*/                                                                 00003710
 /*YS*/                       IF B02.YRKEHIST.OPPH_DATO_ÅM              00003720
 /*YS*/                                     (2,YRKE_IND - 1) = 0  THEN  00003730
 /*YS*/                          DO;                                    00003740
 /*YS*/                                                                 00003750
 /*YS*/                             /* ****************************** */00003760
 /*YS*/                             /* KONTROLL SOM KANSKJE BØR       */00003770
 /*YS*/                             /* FORETAS:                       */00003780
 /*YS*/                             /*   HVIS IKKE SAMME SKADE        */00003790
 /*YS*/                             /*   OG GRAD = 100        : FEIL. */00003800
 /*YS*/                             /* ****************************** */00003810
 /*YS*/                                                                 00003820
 /*YS*/                             IF B02.YRKEHIST.YST_ÅM              00003830
 /*YS*/                                            (2,YRKE_IND - 1) ^=  00003840
 /*YS*/                                F_SNU_DATO(FBY_FAR.YST_MÅ_F) THEN00003850
 /*YS*/                                DO;                              00003860
 /*YS*/                                   B02.YRKEHIST.OPPH_DATO_ÅM     00003870
 /*YS*/                                                 (2,YRKE_IND - 1)00003880
 /*YS*/                                             =    HJ_DØD_ÅM ;    00003890
 /*YS*/                                   B02.YRKEHIST.OPPH_KODE        00003900
 /*YS*/                                      (2,YRKE_IND - 1)  = 'J';   00003910
 /*YS*/                                END;                             00003920
 /*YS*/                             ELSE                                00003930
 /*YS*/                                DO;                              00003940
 /*YS*/                                   B02.YRKEHIST.OPPH_DATO_ÅM     00003950
 /*YS*/                                            (2,YRKE_IND - 1)=    00003960
 /*YS*/                                     F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM);00003970
 /*YS*/                                   B02.YRKEHIST.OPPH_KODE        00003980
 /*YS*/                                         (2,YRKE_IND - 1)  = 'D';00003990
 /*YS*/                                END;                             00004000
 /*YS*/                          END;                                   00004010
 /*YS*/                                                                 00004020
 /*YS*/                                                                 00004030
 /*YS*/                       /* ************************************ */00004040
 /*YS*/                       /* KONTROLL SOM KANSKJE BØR FORETAS:    */00004050
 /*YS*/                       /*  HVIS SAMME SKADE  :                 */00004060
 /*YS*/                       /*                  KONTROLLER OPPLYSN. */00004070
 /*YS*/                       /*                  PÅ BLANKETTEN MOT   */00004080
 /*YS*/                       /*                  OPPLYSN. I YRKEHIST.*/00004090
 /*YS*/                       /* ************************************ */00004100
 /*YS*/                                                                 00004110
 /*YS*/                    END;                                         00004120
 /*YS*/                                                                 00004130
 /*YS*/                 IF    YRKE_IND = 1                             !00004140
 /*YS*/                    (  YRKE_IND > 1                             &00004150
 /*YS*/                     ((B02.YRKEHIST.YST_ÅM(2,YRKE_IND - 1) ^=    00004160
 /*YS*/                              F_SNU_DATO(FBY_FAR.YST_MÅ_F))     !00004170
 /*YS*/                      (B02.YRKEHIST.YST_ÅM(2,YRKE_IND - 1) =     00004180
 /*YS*/                              F_SNU_DATO(FBY_FAR.YST_MÅ_F)      &00004190
 /*YS*/                       B02.YRKEHIST.OPPH_DATO_ÅM(2,YRKE_IND - 1) 00004200
 /*YS*/                              > 0                               &00004210
 /*YS*/                       B02.YRKEHIST.OPPH_DATO_ÅM(2,YRKE_IND - 1) 00004220
 /*YS*/                            ^=  F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM)  ))) 00004230
 /*YS*/                                                            THEN 00004240
 /*YS*/                                                                 00004250
 /*YS*/                    /* *************************************** */00004260
 /*YS*/                    /* YRKEHIST FYLLES MED OPPLYSNINGER FRA    */00004270
 /*YS*/                    /* BLANKETTEN.                             */00004280
 /*YS*/                    /* *************************************** */00004290
 /*YS*/                                                                 00004300
 /*YS*/                    DO;                                          00004310
 /*YS*/                       B02.YRKEHIST.YUFT_ÅM(2,YRKE_IND) =        00004320
 /*YS*/                                                       HJ_DØD_ÅM;00004330
 /*YS*/                       B02.YRKEHIST.YUG(2,YRKE_IND) = 100;       00004340
 /*YS*/                       B02.YRKEHIST.YST_ÅM(2,YRKE_IND) =         00004350
 /*YS*/                                    F_SNU_DATO(FBY_FAR.YST_MÅ_F);00004360
 /*YS*/                       B02.YRKEHIST.AÅI(2,YRKE_IND) =            00004370
 /*YS*/                                                   FBY_FAR.AÅI_F;00004380
 /*YS*/                       B02.YRKEHIST.YRKE11(2,YRKE_IND) =         00004390
 /*YS*/                                                FBY_FAR.YRKE11_F;00004400
 /*YS*/                       B02.YRKEHIST.VILKÅR_1_2_2(2,YRKE_IND) =   00004410
 /*YS*/                                       FBY_FAR.VILKÅR_1_2_2A_F !!00004420
 /*YS*/                                       FBY_FAR.VILKÅR_1_2_2B_F;  00004430
 /*YS*/                       B02.YRKEHIST.OPPH_DATO_ÅM(2,YRKE_IND) =   00004440
 /*YS*/                                     F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM);00004450
 /*YS*/                       B02.YRKEHIST.OPPH_KODE(2,YRKE_IND) = 'D'; 00004460
 /*YS*/                    END;                                         00004470
 /*YS*/                                                                 00004480
 /*YS*/              END;                                               00004490
                                                                        00004500
                                                                        00004510
 /*YS*/           ELSE                                                  00004520
 /*YS*/                                                                 00004530
 /*YS*/              /* ****************************************** */   00004540
 /*YS*/              /* YRKESSKADEBLANKETT ER IKKE MED, MEN DET    */   00004550
 /*YS*/              /* SKJEKKES FOR Å FINNE UT OM DET ER          */   00004560
 /*YS*/              /* YRKESSKADE FRA FØR.                        */   00004570
 /*YS*/              /* ****************************************** */   00004580
 /*YS*/                                                                 00004590
 /*YS*/              DO;                                                00004600
 /*YS*/                                                                 00004610
 /*YS*/                 DO I = 1 TO 5 WHILE (YRKE_IND = 0);             00004620
 /*YS*/                                                                 00004630
 /*YS*/                    IF B02.YRKEHIST.YUFT_ÅM(2,I) = 0  THEN       00004640
 /*YS*/                       YRKE_IND = I;                             00004650
 /*YS*/                 END;                                            00004660
 /*YS*/                                                                 00004670
 /*YS*/                 IF YRKE_IND = 0 THEN                            00004680
 /*YS*/                    YRKE_IND = 6;                                00004690
 /*YS*/                                                                 00004700
 /*YS*/                 IF YRKE_IND > 1 THEN                            00004710
 /*YS*/                    DO;                                          00004720
 /*YS*/                                                                 00004730
 /*YS*/                       IF                                        00004740
 /*YS*/                        B02.YRKEHIST.OPPH_DATO_ÅM(2,YRKE_IND - 1)00004750
 /*YS*/                                   >  HJ_DØD_ÅM            THEN  00004760
 /*YS*/                                                                 00004770
 /*YS*/                          /* ********************************* */00004780
 /*YS*/                          /* FEIL, DØDSDATO LIGGER FØR         */00004790
 /*YS*/                          /* OPPHØRSTIDSPUNKT I FORRIGE        */00004800
 /*YS*/                          /* PERIODE.                          */00004810
 /*YS*/                          /* ********************************* */00004820
 /*YS*/                                                                 00004830
 /*YS*/                          DO;                                    00004840
 /*YS*/L450:                        FEIL_VED_LABEL = '450';             00004850
 /*YS*/                             FEIL_MELD_NR   = 1712 ;             00004860
 /*YS*/                             GO TO RETUR;                        00004870
 /*YS*/                          END;                                   00004880
 /*YS*/                                                                 00004890
 /*YS*/                       IF                                        00004900
 /*YS*/                        B02.YRKEHIST.OPPH_DATO_ÅM(2,YRKE_IND - 1)00004910
 /*YS*/                                                      = 0  THEN  00004920
 /*YS*/                          DO;                                    00004930
 /*YS*/                             B02.YRKEHIST.OPPH_DATO_ÅM           00004940
 /*YS*/                                                 (2,YRKE_IND - 1)00004950
 /*YS*/                                   = F_DATO_ÅM_PLUSS1(HJ_DØD_ÅM);00004960
 /*YS*/                             B02.YRKEHIST.OPPH_KODE              00004970
 /*YS*/                                       (2,YRKE_IND - 1)  = 'D';  00004980
 /*YS*/                          END;                                   00004990
 /*YS*/                    END;                                         00005000
 /*YS*/              END;                                               00005010
                                                                        00005020
               END;                                                     00005030
         END;                                                           00005040
      ELSE                                                              00005050
         B02.PENSJONSTYPE2(BARN_IND) = 'Ø';                             00005060
                                                                        00005070
 /*YS*/IF YSKADE_TILLEGG_M  = 'J' !                                     00005080
 /*YS*/   YSKADE_TILLEGG_F  = 'J' THEN                                  00005090
 /*YS*/   B02.DØD_AV_YRKESSKADE(BARN_IND)  = 'E';                       00005100
                                                                        00005110
 /*YS*/ RETUR:                                                          00005120
                                                                        00005130
   END AJOURFØR_B02_MED_FB_TRANS;                                       00005140
