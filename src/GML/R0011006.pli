 /*       SIST ENDRET 01/12-89 08.37.28 AV   DYBVIK                   */00000000
 /*       SIST ENDRET 07/05-86 07.09.01 AV   FARVIK                   */00000010
 /*       SIST ENDRET 04/11-85 08.45.44 AV   FARVIK                   */00000020
 /*       SIST ENDRET 22/10-85 16.31.37 AV   FARVIK                   */00000030
 /*       SIST ENDRET 23/08-85 13.10.08 AV   FARVIK                   */00000040
 /*       SIST ENDRET 21/08-85 08.07.05 AV   FARVIK                   */00000050
 /*       SIST ENDRET 02/06-83 07.24.45 AV   FARVIK                   */00000060
                                                                        00000070
                                                                        00000080
  /*IDENTIFIKASJON:                                                   */00000090
  /*    R0011006 - PROSEDYRE I PLI                                    */00000100
  /*    PROGRAMMERER:  JAN  , JULI 1981                               */00000110
  /*HENSIKT:                                                          */00000120
  /*    PROGRAMMET INNEHOLDER:                                        */00000130
  /*    PROSEDYRER FOR Å OVERFØRE DATA FRA FB_TRANS_OMR TIL           */00000140
  /*    SKJERMBILDE (MAP S001101 MAPSET S00110).                      */00000150
  /*    SKJERMBILDE (MAP S001201 MAPSET S00120).  *//*YS*//*          */00000160
  /*    PROSEDYRE FOR SKRIVING AV FEILMELDINGER.                      */00000170
  /*BRUK:                                                             */00000180
  /*    OVERFØR_FB_BARN_MAP:      OVERFØRING AV BARNEDELEN            */00000190
  /*    OVERFØR_FB_MOR_MAP:       OVERFØRING AV OPPLYSNINGER OM MOR   */00000200
  /*    OVERFØR_FB_FAR_MAP:       OVERFØRING AV OPPLYSNINGER OM FAR   */00000210
  /*    OVERFØR_FBY_MOR_MAP:      OVERFØRING AV YRKESSKADEOPPL. MOR   */00000220
  /*    OVERFØR_FBY_FAR_MAP:      OVERFØRING AV YRKESSKADEOPPL. FAR   */00000230
  /*                                                                  */00000240
  % PAGE;                                                               00000250
  /* **************************************************************** */00000260
  /*   PROSEDYRA OVERFØRER DATA FRA FB_TRANS_OMR TIL                  */00000270
  /*   SKJERMBILDE FB_BARN DELEN.                                     */00000280
  /*   MAP: S001101                                                   */00000290
  /*   MAPSET: S00110                                                 */00000300
  /* **************************************************************** */00000310
  % SKIP (2);                                                           00000320
   OVERFØR_FB_BARN_MAP:                                                 00000330
    PROC;                                                               00000340
    DCL                                                                 00000350
       F       PIC  '9',                                                00000360
       ANDRE   PIC  'Z9',                                               00000370
       NORMAL  CHAR (1) INIT(' '),                                      00000380
       NOR_NUM CHAR (1) INIT('&'),                                      00000390
       BRI_NUM CHAR (1) INIT('Q');                                      00000400
                                                                        00000410
       SELECT(BARNE_TAB_POS);                                           00000420
          WHEN('1')                                                     00000430
            F = 1;                                                      00000440
          WHEN('2')                                                     00000450
            F = 5;                                                      00000460
          WHEN('3')                                                     00000470
            F = 9;                                                      00000480
          OTHERWISE;                                                    00000490
       END;                /**   SELECT   **/                           00000500
                                                                        00000510
       ANDRE = F + 3;                                                   00000520
                                                                        00000530
       CALL INTERN_OVERFØR_BARN;                                        00000540
                                                                        00000550
                                                                        00000560
                                                                        00000570
       INTERN_OVERFØR_BARN:                                             00000580
         PROC;                                                          00000590
       EXEC CICS ENTER TRACEID(61) FROM (F);                            00000600
       EXEC CICS ENTER TRACEID(62) FROM (BARN.FNR_B(F));                00000610
       EXEC CICS ENTER TRACEID(63) FROM (NAVN_B(F));                    00000620
       EXEC CICS ENTER TRACEID(64) FROM (TKNR(F));                      00000630
           S001101O.INDIKATORO = F !! '-' !! ANDRE;                     00000640
                                                                        00000650
           IF F_FELT_PIC_CHAR11(BARN.FNR_B(F)) ^= (11)'0' THEN          00000660
             S001101O.FNR_BARN1O = F_FELT_PIC_CHAR11(BARN.FNR_B(F));    00000670
                                                                        00000680
           S001101O.NAVN_BARN1O   = NAVN_B(F);                          00000690
                                                                        00000700
           IF F_FELT_PIC_CHAR4(TKNR(F)) ^= '0000' THEN                  00000710
             S001101O.TKNR1O     = F_FELT_PIC_CHAR4(TKNR(F));           00000720
                                                                        00000730
           IF F_FELT_PIC_CHAR11(BARN.FNR_B(F + 1)) ^= (11)'0' THEN      00000740
             S001101O.FNR_BARN2O = F_FELT_PIC_CHAR11(BARN.FNR_B(F +1)); 00000750
                                                                        00000760
           S001101O.NAVN_BARN2O   = NAVN_B(F + 1);                      00000770
                                                                        00000780
           IF F_FELT_PIC_CHAR4(TKNR(F + 1)) ^= '0000' THEN              00000790
             S001101O.TKNR2O     = F_FELT_PIC_CHAR4(TKNR(F + 1));       00000800
                                                                        00000810
           IF F_FELT_PIC_CHAR11(BARN.FNR_B(F + 2)) ^= (11)'0' THEN      00000820
             S001101O.FNR_BARN3O = F_FELT_PIC_CHAR11(BARN.FNR_B(F + 2));00000830
                                                                        00000840
           S001101O.NAVN_BARN3O   = NAVN_B(F + 2);                      00000850
                                                                        00000860
           IF F_FELT_PIC_CHAR4(TKNR(F + 2)) ^= '0000' THEN              00000870
             S001101O.TKNR3O     = F_FELT_PIC_CHAR4(TKNR(F + 2));       00000880
                                                                        00000890
           IF F_FELT_PIC_CHAR11(BARN.FNR_B(F + 3)) ^= (11)'0' THEN      00000900
             S001101O.FNR_BARN4O = F_FELT_PIC_CHAR11(BARN.FNR_B(F + 3));00000910
                                                                        00000920
           S001101O.NAVN_BARN4O   = NAVN_B(F + 3);                      00000930
                                                                        00000940
           IF F_FELT_PIC_CHAR4(TKNR(F + 3)) ^= '0000' THEN              00000950
             S001101O.TKNR4O     = F_FELT_PIC_CHAR4(TKNR(F + 3));       00000960
                                                                        00000970
                                                                        00000980
             IF BARN.FNR_BNR(F) = 0 THEN                                00000990
                S001101O.FNR_BARN1A      = NOR_NUM;                     00001000
             ELSE                                                       00001010
                DO;                                                     00001020
                   S001101O.FNR_BARN1A  = BRI_NUM;                      00001030
                   S001101I.FNR_BARN1L  = CURSOR_POS;                   00001040
                   IF BARN.FNR_BNR(F) ^= 999 THEN                       00001050
                      CALL SKRIV_FEIL(BARN.FNR_BNR(F));                 00001060
                END;                                                    00001070
             IF NAVN_BNR(F) = 0 THEN                                    00001080
                S001101O.NAVN_BARN1A = NORMAL;                          00001090
             ELSE                                                       00001100
                DO;                                                     00001110
                   S001101O.NAVN_BARN1A     = DFHBMBRY;                 00001120
                   S001101I.NAVN_BARN1L     = CURSOR_POS;               00001130
                   IF NAVN_BNR(F) ^= 999 THEN                           00001140
                      CALL SKRIV_FEIL(NAVN_BNR(F));                     00001150
                END;                                                    00001160
             IF TKNRNR(F) = 0 THEN                                      00001170
                S001101O.TKNR1A    = NOR_NUM;                           00001180
             ELSE                                                       00001190
                DO;                                                     00001200
                   S001101O.TKNR1A        = BRI_NUM;                    00001210
                   S001101I.TKNR1L        = CURSOR_POS;                 00001220
                   IF TKNRNR(F) ^= 999 THEN                             00001230
                      CALL SKRIV_FEIL(TKNRNR(F));                       00001240
                END;                                                    00001250
                                                                        00001260
             IF BARN.FNR_BNR(F + 1) = 0 THEN                            00001270
                S001101O.FNR_BARN2A      = NOR_NUM;                     00001280
             ELSE                                                       00001290
                DO;                                                     00001300
                   S001101O.FNR_BARN2A  = BRI_NUM;                      00001310
                   S001101I.FNR_BARN2L  = CURSOR_POS;                   00001320
                   IF BARN.FNR_BNR(F + 1) ^= 999 THEN                   00001330
                      CALL SKRIV_FEIL(BARN.FNR_BNR(F + 1));             00001340
                END;                                                    00001350
             IF NAVN_BNR(F + 1) = 0 THEN                                00001360
                S001101O.NAVN_BARN2A = NORMAL;                          00001370
             ELSE                                                       00001380
                DO;                                                     00001390
                   S001101O.NAVN_BARN2A     = DFHBMBRY;                 00001400
                   S001101I.NAVN_BARN2L     = CURSOR_POS;               00001410
                   IF NAVN_BNR(F + 1) ^= 999 THEN                       00001420
                      CALL SKRIV_FEIL(NAVN_BNR(F + 1));                 00001430
                END;                                                    00001440
             IF TKNRNR(F + 1) = 0 THEN                                  00001450
                S001101O.TKNR2A    = NOR_NUM;                           00001460
             ELSE                                                       00001470
                DO;                                                     00001480
                   S001101O.TKNR2A        = BRI_NUM;                    00001490
                   S001101I.TKNR2L        = CURSOR_POS;                 00001500
                   IF TKNRNR(F + 1) ^= 999 THEN                         00001510
                      CALL SKRIV_FEIL(TKNRNR(F + 1));                   00001520
                END;                                                    00001530
                                                                        00001540
             IF BARN.FNR_BNR(F + 2) = 0 THEN                            00001550
                S001101O.FNR_BARN3A      = NOR_NUM;                     00001560
             ELSE                                                       00001570
                DO;                                                     00001580
                   S001101O.FNR_BARN3A  = BRI_NUM;                      00001590
                   S001101I.FNR_BARN3L  = CURSOR_POS;                   00001600
                   IF BARN.FNR_BNR(F + 2) ^= 999 THEN                   00001610
                      CALL SKRIV_FEIL(BARN.FNR_BNR(F + 2));             00001620
                END;                                                    00001630
             IF NAVN_BNR(F + 2) = 0 THEN                                00001640
                S001101O.NAVN_BARN3A = NORMAL;                          00001650
             ELSE                                                       00001660
                DO;                                                     00001670
                   S001101O.NAVN_BARN3A     = DFHBMBRY;                 00001680
                   S001101I.NAVN_BARN3L     = CURSOR_POS;               00001690
                   IF NAVN_BNR(F + 2) ^= 999 THEN                       00001700
                      CALL SKRIV_FEIL(NAVN_BNR(F + 2));                 00001710
                END;                                                    00001720
             IF TKNRNR(F + 2) = 0 THEN                                  00001730
                S001101O.TKNR3A    = NOR_NUM;                           00001740
             ELSE                                                       00001750
                DO;                                                     00001760
                   S001101O.TKNR3A        = BRI_NUM;                    00001770
                   S001101I.TKNR3L        = CURSOR_POS;                 00001780
                   IF TKNRNR(F + 2) ^= 999 THEN                         00001790
                      CALL SKRIV_FEIL(TKNRNR(F + 2));                   00001800
                END;                                                    00001810
                                                                        00001820
             IF BARN.FNR_BNR(F + 3) = 0 THEN                            00001830
                S001101O.FNR_BARN4A      = NOR_NUM;                     00001840
             ELSE                                                       00001850
                DO;                                                     00001860
                   S001101O.FNR_BARN4A  = BRI_NUM;                      00001870
                   S001101I.FNR_BARN4L  = CURSOR_POS;                   00001880
                   IF BARN.FNR_BNR(F + 3) ^= 999 THEN                   00001890
                      CALL SKRIV_FEIL(BARN.FNR_BNR(F + 3));             00001900
                END;                                                    00001910
             IF NAVN_BNR(F + 3) = 0 THEN                                00001920
                S001101O.NAVN_BARN4A = NORMAL;                          00001930
             ELSE                                                       00001940
                DO;                                                     00001950
                   S001101O.NAVN_BARN4A     = DFHBMBRY;                 00001960
                   S001101I.NAVN_BARN4L     = CURSOR_POS;               00001970
                   IF NAVN_BNR(F + 3) ^= 999 THEN                       00001980
                      CALL SKRIV_FEIL(NAVN_BNR(F + 3));                 00001990
                END;                                                    00002000
             IF TKNRNR(F + 3) = 0 THEN                                  00002010
                S001101O.TKNR4A    = NOR_NUM;                           00002020
             ELSE                                                       00002030
                DO;                                                     00002040
                   S001101O.TKNR4A        = BRI_NUM;                    00002050
                   S001101I.TKNR4L        = CURSOR_POS;                 00002060
                   IF TKNRNR(F + 3) ^= 999 THEN                         00002070
                      CALL SKRIV_FEIL(TKNRNR(F + 3));                   00002080
                END;                                                    00002090
                                                                        00002100
       END INTERN_OVERFØR_BARN;                                         00002110
                                                                        00002120
                                                                        00002130
       S001101O.REGDATOO      = F_FELT_PIC_CHAR6(REGDATO);              00002140
       S001101O.TERMIDO       = TERMID;                                 00002150
       S001101O.SPRÅKO        = SPRÅK;                                  00002160
       S001101O.VIRK_DATO_MÅO = F_FELT_PIC_CHAR4(VIRK_DATO_MÅ);         00002170
                                                                        00002180
 % SKIP (3);                                                            00002190
  /*   FEILMELDINGER MARKERING AV FELT (ATTRIBUTTENE)                 */00002200
                                                                        00002210
  /*DERSOM FEIL FRA BEHANDLE-TRANS OVERFØRES FEIL HER,BARE FØRSTE GANG*/00002220
       IF ^ FRA_CICS THEN                                               00002230
          DO;                                                           00002240
            IF FEIL_MELD_NR > 0 THEN                                    00002250
               CALL SKRIV_FEIL(FEIL_MELD_NR);                           00002260
             FEIL_MELD_NR = 0;                                          00002270
          END;                                                          00002280
                                                                        00002290
     S001101O.DUMMYA = '_';                                             00002300
                                                                        00002310
      S001101O.REGDATOA = DFHBMASK;                                     00002320
      S001101O.TERMIDA  = DFHBMASK;                                     00002330
                                                                        00002340
      IF SPRÅKNR = 0 THEN                                               00002350
         S001101O.SPRÅKA  = NORMAL;                                     00002360
      ELSE                                                              00002370
         DO;                                                            00002380
            S001101O.SPRÅKA = DFHBMBRY;                                 00002390
            S001101I.SPRÅKL = CURSOR_POS;                               00002400
            IF SPRÅKNR ^= 999 THEN                                      00002410
               CALL SKRIV_FEIL(SPRÅKNR);                                00002420
         END;                                                           00002430
      IF VIRK_DATO_MÅNR   = 0 THEN                                      00002440
         S001101O.VIRK_DATO_MÅA    = NOR_NUM;                           00002450
      ELSE                                                              00002460
         DO;                                                            00002470
            S001101O.VIRK_DATO_MÅA = BRI_NUM;                           00002480
            S001101I.VIRK_DATO_MÅL = CURSOR_POS;                        00002490
            IF VIRK_DATO_MÅNR ^= 999 THEN                               00002500
               CALL SKRIV_FEIL(VIRK_DATO_MÅNR);                         00002510
         END;                                                           00002520
                                                                        00002530
      /* VED GAMLE TRANS SKAL FNR OG VIRKNINGSDATO BLOKKERES   */       00002540
                                                                        00002550
      IF TRANS_OPPL_OMR.NY_GML_TRANS_IND = 'G' & FRA_MED_DIALOG THEN    00002560
         DO;                                                            00002570
           S001101O.FNR_BARN1A    = DFHBMASK;                           00002580
           S001101O.VIRK_DATO_MÅA = DFHBMASK;                           00002590
         END;                                                           00002600
                                                                        00002610
      ELSE IF FRA_UTEN_DIALOG THEN  /* BLOKKER ALT SAMMEN  */           00002620
                                                                        00002630
         DO;                                                            00002640
           S001101O.FNR_BARN1A    = DFHBMASK;                           00002650
           S001101O.NAVN_BARN1A   = DFHBMASK;                           00002660
           S001101O.TKNR1A        = DFHBMASK;                           00002670
           S001101O.FNR_BARN2A    = DFHBMASK;                           00002680
           S001101O.NAVN_BARN2A   = DFHBMASK;                           00002690
           S001101O.TKNR2A        = DFHBMASK;                           00002700
           S001101O.FNR_BARN3A    = DFHBMASK;                           00002710
           S001101O.NAVN_BARN3A   = DFHBMASK;                           00002720
           S001101O.TKNR3A        = DFHBMASK;                           00002730
           S001101O.FNR_BARN4A    = DFHBMASK;                           00002740
           S001101O.NAVN_BARN4A   = DFHBMASK;                           00002750
           S001101O.TKNR4A        = DFHBMASK;                           00002760
           S001101O.REGDATOA      = DFHBMASK;                           00002770
           S001101O.TERMIDA       = DFHBMASK;                           00002780
           S001101O.SPRÅKA        = DFHBMASK;                           00002790
           S001101O.VIRK_DATO_MÅA = DFHBMASK;                           00002800
           MELDING6O = 'TRYKK PF1 FOR OPPBEVAR, PF2 FOR FORKASTE.';     00002810
         END;                                                           00002820
                                                                        00002830
      IF ^ FRA_CICS THEN                                                00002840
         DO;                                                            00002850
           S001101O.STYRE_KODEA    = DFHBMASK;                          00002860
           S001101O.FUNKSJONSKODEA = DFHBMASK;                          00002870
         END;                                                           00002880
                                                                        00002890
    END OVERFØR_FB_BARN_MAP;                                            00002900
  %PAGE;                                                                00002910
  /* **************************************************************** */00002920
  /*                                                                  */00002930
  /*   PROSEDYREN OVERFØRER DATA FRA FB_TRANS_OMR TIL                 */00002940
  /*   SKJERMBILDE FB_DELEN MOR.                                      */00002950
  /*   MAP:  S001101                                                  */00002960
  /*   MAPSET:  S00110                                                */00002970
  /*                                                                  */00002980
  /* **************************************************************** */00002990
  %SKIP(2);                                                             00003000
   OVERFØR_FB_MOR_MAP:                                                  00003010
    PROC;                                                               00003020
    DCL                                                                 00003030
       NORMAL  CHAR (1) INIT(' '),                                      00003040
       NOR_NUM CHAR (1) INIT('&'),                                      00003050
       BRI_NUM CHAR (1) INIT('Q');                                      00003060
                                                                        00003070
       S001101O.FNR_MO                  = F_FELT_PIC_CHAR11(FNR_M);     00003080
       S001101O.NAVN_MO                 = NAVN_M;                       00003090
       S001101O.DØDSDATO_MO             = F_FELT_PIC_CHAR6(DØDSDATO_M); 00003100
       S001101O.VILKÅR_8_4_3A_MO        = VILKÅR_8_4_3A_M;              00003110
       S001101O.OVERKOMP_MO             = OVERKOMP_M;                   00003120
       IF F_FELT_PIC_CHAR2(TT_F67_M)   ^= '00' THEN                     00003130
          S001101O.TT_F67_MO            = F_FELT_PIC_CHAR2(TT_F67_M);   00003140
       IF F_FELT_PIC_CHAR2(TT_E66_M_M) ^= '00' THEN                     00003150
          S001101O.TT_E66_M_MO          = F_FELT_PIC_CHAR2(TT_E66_M_M); 00003160
       IF F_FELT_PIC_CHAR2(TT_E66_Å_M) ^= '00' THEN                     00003170
          S001101O.TT_E66_Å_MO          = F_FELT_PIC_CHAR2(TT_E66_Å_M); 00003180
       IF F_FELT_PIC_CHAR7(PI_M)       ^= '0000000' THEN                00003190
          S001101O.PI_MO                = F_FELT_PIC_CHAR7(PI_M);       00003200
 /*YS*/S001101O.YSKADE_TILL_MORO        = YSKADE_TILLEGG_M ;            00003210
  %SKIP(3);                                                             00003220
                                                                        00003230
  /* MARKERING AV ATTRIBUTTER   */                                      00003240
                                                                        00003250
       IF FNR_MNR = 0 THEN                                              00003260
          S001101O.FNR_MA  = NOR_NUM;                                   00003270
       ELSE                                                             00003280
          DO;                                                           00003290
             S001101O.FNR_MA      = BRI_NUM;                            00003300
             S001101I.FNR_ML      = CURSOR_POS;                         00003310
             IF FNR_MNR ^= 999 THEN                                     00003320
                CALL SKRIV_FEIL(FNR_MNR);                               00003330
          END;                                                          00003340
       IF NAVN_MNR = 0 THEN                                             00003350
          S001101O.NAVN_MA = NORMAL;                                    00003360
       ELSE                                                             00003370
          DO;                                                           00003380
             S001101O.NAVN_MA      = DFHBMBRY;                          00003390
             S001101I.NAVN_ML      = CURSOR_POS;                        00003400
             IF NAVN_MNR ^= 999 THEN                                    00003410
                CALL SKRIV_FEIL(NAVN_MNR);                              00003420
          END;                                                          00003430
       IF DØDSDATO_MNR = 0 THEN                                         00003440
          S001101O.DØDSDATO_MA  = NOR_NUM;                              00003450
       ELSE                                                             00003460
          DO;                                                           00003470
             S001101O.DØDSDATO_MA      = BRI_NUM;                       00003480
             S001101I.DØDSDATO_ML      = CURSOR_POS;                    00003490
             IF DØDSDATO_MNR ^= 999 THEN                                00003500
                CALL SKRIV_FEIL(DØDSDATO_MNR);                          00003510
          END;                                                          00003520
       IF VILKÅR_8_4_3A_MNR = 0 THEN                                    00003530
          S001101O.VILKÅR_8_4_3A_MA  = NORMAL;                          00003540
       ELSE                                                             00003550
          DO;                                                           00003560
             S001101O.VILKÅR_8_4_3A_MA      = DFHBMBRY;                 00003570
             S001101I.VILKÅR_8_4_3A_ML      = CURSOR_POS;               00003580
             IF VILKÅR_8_4_3A_MNR ^= 999 THEN                           00003590
                CALL SKRIV_FEIL(VILKÅR_8_4_3A_MNR);                     00003600
          END;                                                          00003610
       IF OVERKOMP_MNR       = 0 THEN                                   00003620
          S001101O.OVERKOMP_MA        = NORMAL;                         00003630
       ELSE                                                             00003640
          DO;                                                           00003650
             S001101O.OVERKOMP_MA      = DFHBMBRY;                      00003660
             S001101I.OVERKOMP_ML      = CURSOR_POS;                    00003670
             IF OVERKOMP_MNR ^= 999 THEN                                00003680
                CALL SKRIV_FEIL(OVERKOMP_MNR);                          00003690
          END;                                                          00003700
       IF TT_F67_MNR          = 0 THEN                                  00003710
          S001101O.TT_F67_MA           = NOR_NUM;                       00003720
       ELSE                                                             00003730
          DO;                                                           00003740
             S001101O.TT_F67_MA        = BRI_NUM;                       00003750
             S001101I.TT_F67_ML        = CURSOR_POS;                    00003760
             IF TT_F67_MNR   ^= 999 THEN                                00003770
                CALL SKRIV_FEIL(TT_F67_MNR);                            00003780
          END;                                                          00003790
       IF TT_E66_M_MNR        = 0 THEN                                  00003800
          S001101O.TT_E66_M_MA         = NOR_NUM;                       00003810
       ELSE                                                             00003820
          DO;                                                           00003830
             S001101O.TT_E66_M_MA      = BRI_NUM;                       00003840
             S001101I.TT_E66_M_ML      = CURSOR_POS;                    00003850
             IF TT_E66_M_MNR ^= 999 THEN                                00003860
                CALL SKRIV_FEIL(TT_E66_M_MNR);                          00003870
          END;                                                          00003880
       IF TT_E66_Å_MNR        = 0 THEN                                  00003890
          S001101O.TT_E66_Å_MA         = NOR_NUM;                       00003900
       ELSE                                                             00003910
          DO;                                                           00003920
             S001101O.TT_E66_Å_MA      = BRI_NUM;                       00003930
             S001101I.TT_E66_Å_ML      = CURSOR_POS;                    00003940
             IF TT_E66_Å_MNR ^= 999 THEN                                00003950
                CALL SKRIV_FEIL(TT_E66_Å_MNR);                          00003960
          END;                                                          00003970
       IF PI_MNR = 0 THEN                                               00003980
          S001101O.PI_MA  = NOR_NUM;                                    00003990
       ELSE                                                             00004000
          DO;                                                           00004010
             S001101O.PI_MA      = BRI_NUM;                             00004020
             S001101I.PI_ML      = CURSOR_POS;                          00004030
             IF PI_MNR ^= 999 THEN                                      00004040
                CALL SKRIV_FEIL(PI_MNR);                                00004050
          END;                                                          00004060
 /*YS*/IF YSKADE_TILLEGG_MNR = 0 THEN                                   00004070
 /*YS*/   S001101O.YSKADE_TILL_MORA  = NORMAL;                          00004080
 /*YS*/ELSE                                                             00004090
 /*YS*/   DO;                                                           00004100
 /*YS*/      S001101O.YSKADE_TILL_MORA      = DFHBMBRY;                 00004110
 /*YS*/      S001101I.YSKADE_TILL_MORL      = CURSOR_POS;               00004120
 /*YS*/      IF YSKADE_TILLEGG_MNR ^= 999 THEN                          00004130
 /*YS*/         CALL SKRIV_FEIL(YSKADE_TILLEGG_MNR);                    00004140
 /*YS*/   END;                                                          00004150
                                                                        00004160
      IF FRA_UTEN_DIALOG THEN          /* BLOKKER ALT SAMMEN  */        00004170
                                                                        00004180
         DO;                                                            00004190
           S001101O.FNR_MA           = DFHBMASK;                        00004200
           S001101O.NAVN_MA          = DFHBMASK;                        00004210
           S001101O.DØDSDATO_MA      = DFHBMASK;                        00004220
           S001101O.VILKÅR_8_4_3A_MA = DFHBMASK;                        00004230
           S001101O.OVERKOMP_MA      = DFHBMASK;                        00004240
           S001101O.TT_F67_MA        = DFHBMASK;                        00004250
           S001101O.TT_E66_M_MA      = DFHBMASK;                        00004260
           S001101O.TT_E66_Å_MA      = DFHBMASK;                        00004270
           S001101O.PI_MA            = DFHBMASK;                        00004280
 /*YS*/    S001101O.YSKADE_TILL_MORA = DFHBMASK;                        00004290
         END;                                                           00004300
                                                                        00004310
   END OVERFØR_FB_MOR_MAP;                                              00004320
  %PAGE;                                                                00004330
  /* **************************************************************** */00004340
  /*                                                                  */00004350
  /*   PROSEDYREN OVERFØRER DATA FRA FB_TRANS_OMR TIL                 */00004360
  /*   SKJERMBILDE FB_DELEN FAR.                                      */00004370
  /*   MAP:  S001101                                                  */00004380
  /*   MAPSET:  S00110                                                */00004390
  /*                                                                  */00004400
  /* **************************************************************** */00004410
  %SKIP(2);                                                             00004420
   OVERFØR_FB_FAR_MAP:                                                  00004430
    PROC;                                                               00004440
                                                                        00004450
    DCL                                                                 00004460
       NORMAL  CHAR (1) INIT(' '),                                      00004470
       NOR_NUM CHAR (1) INIT('&'),                                      00004480
       BRI_NUM CHAR (1) INIT('Q');                                      00004490
                                                                        00004500
       S001101O.FNR_FO                  = F_FELT_PIC_CHAR11(FNR_F);     00004510
       S001101O.NAVN_FO                 = NAVN_F;                       00004520
       S001101O.DØDSDATO_FO             = F_FELT_PIC_CHAR6(DØDSDATO_F); 00004530
       S001101O.VILKÅR_8_4_3A_FO        = VILKÅR_8_4_3A_F;              00004540
       S001101O.OVERKOMP_FO             = OVERKOMP_F;                   00004550
       IF F_FELT_PIC_CHAR2(TT_F67_F)   ^= '00' THEN                     00004560
          S001101O.TT_F67_FO            = F_FELT_PIC_CHAR2(TT_F67_F);   00004570
       IF F_FELT_PIC_CHAR2(TT_E66_M_F) ^= '00' THEN                     00004580
          S001101O.TT_E66_M_FO          = F_FELT_PIC_CHAR2(TT_E66_M_F); 00004590
       IF F_FELT_PIC_CHAR2(TT_E66_Å_F) ^= '00' THEN                     00004600
          S001101O.TT_E66_Å_FO          = F_FELT_PIC_CHAR2(TT_E66_Å_F); 00004610
       IF F_FELT_PIC_CHAR2(VP_ÅR_F(1)) ^= '00' THEN                     00004620
          S001101O.VP_ÅR1_FO            = F_FELT_PIC_CHAR2(VP_ÅR_F(1)); 00004630
       IF F_FELT_PIC_CHAR2(VP_ÅR_F(2)) ^= '00' THEN                     00004640
          S001101O.VP_ÅR2_FO            = F_FELT_PIC_CHAR2(VP_ÅR_F(2)); 00004650
       IF F_FELT_PIC_CHAR2(VP_ÅR_F(3)) ^= '00' THEN                     00004660
          S001101O.VP_ÅR3_FO            = F_FELT_PIC_CHAR2(VP_ÅR_F(3)); 00004670
       IF F_FELT_PIC_CHAR2(VP_ÅR_F(4)) ^= '00' THEN                     00004680
          S001101O.VP_ÅR4_FO            = F_FELT_PIC_CHAR2(VP_ÅR_F(4)); 00004690
       IF F_FELT_PIC_CHAR7(PI_F)       ^= '0000000' THEN                00004700
          S001101O.PI_FO                = F_FELT_PIC_CHAR7(PI_F);       00004710
 /*YS*/S001101O.YSKADE_TILL_FARO        = YSKADE_TILLEGG_F ;            00004720
  %SKIP(3);                                                             00004730
                                                                        00004740
  /* MARKERING AV ATTRIBUTTER   */                                      00004750
                                                                        00004760
       IF FNR_FNR = 0 THEN                                              00004770
          S001101O.FNR_FA  = NOR_NUM;                                   00004780
       ELSE                                                             00004790
          DO;                                                           00004800
             S001101O.FNR_FA      = BRI_NUM;                            00004810
             S001101I.FNR_FL      = CURSOR_POS;                         00004820
             IF FNR_FNR ^= 999 THEN                                     00004830
                CALL SKRIV_FEIL(FNR_FNR);                               00004840
          END;                                                          00004850
       IF NAVN_FNR = 0 THEN                                             00004860
          S001101O.NAVN_FA = NORMAL;                                    00004870
       ELSE                                                             00004880
          DO;                                                           00004890
             S001101O.NAVN_FA      = DFHBMBRY;                          00004900
             S001101I.NAVN_FL      = CURSOR_POS;                        00004910
             IF NAVN_FNR ^= 999 THEN                                    00004920
                CALL SKRIV_FEIL(NAVN_FNR);                              00004930
          END;                                                          00004940
       IF DØDSDATO_FNR = 0 THEN                                         00004950
          S001101O.DØDSDATO_FA  = NOR_NUM;                              00004960
       ELSE                                                             00004970
          DO;                                                           00004980
             S001101O.DØDSDATO_FA      = BRI_NUM;                       00004990
             S001101I.DØDSDATO_FL      = CURSOR_POS;                    00005000
             IF DØDSDATO_FNR ^= 999 THEN                                00005010
                CALL SKRIV_FEIL(DØDSDATO_FNR);                          00005020
          END;                                                          00005030
       IF VILKÅR_8_4_3A_FNR = 0 THEN                                    00005040
          S001101O.VILKÅR_8_4_3A_FA  = NORMAL;                          00005050
       ELSE                                                             00005060
          DO;                                                           00005070
             S001101O.VILKÅR_8_4_3A_FA      = DFHBMBRY;                 00005080
             S001101I.VILKÅR_8_4_3A_FL      = CURSOR_POS;               00005090
             IF VILKÅR_8_4_3A_FNR ^= 999 THEN                           00005100
                CALL SKRIV_FEIL(VILKÅR_8_4_3A_FNR);                     00005110
          END;                                                          00005120
       IF OVERKOMP_FNR       = 0 THEN                                   00005130
          S001101O.OVERKOMP_FA        = NORMAL;                         00005140
       ELSE                                                             00005150
          DO;                                                           00005160
             S001101O.OVERKOMP_FA      = DFHBMBRY;                      00005170
             S001101I.OVERKOMP_FL      = CURSOR_POS;                    00005180
             IF OVERKOMP_FNR ^= 999 THEN                                00005190
                CALL SKRIV_FEIL(OVERKOMP_FNR);                          00005200
          END;                                                          00005210
       IF TT_F67_FNR          = 0 THEN                                  00005220
          S001101O.TT_F67_FA           = NOR_NUM;                       00005230
       ELSE                                                             00005240
          DO;                                                           00005250
             S001101O.TT_F67_FA        = BRI_NUM;                       00005260
             S001101I.TT_F67_FL        = CURSOR_POS;                    00005270
             IF TT_F67_FNR   ^= 999 THEN                                00005280
                CALL SKRIV_FEIL(TT_F67_FNR);                            00005290
          END;                                                          00005300
       IF TT_E66_M_FNR        = 0 THEN                                  00005310
          S001101O.TT_E66_M_FA         = NOR_NUM;                       00005320
       ELSE                                                             00005330
          DO;                                                           00005340
             S001101O.TT_E66_M_FA      = BRI_NUM;                       00005350
             S001101I.TT_E66_M_FL      = CURSOR_POS;                    00005360
             IF TT_E66_M_FNR ^= 999 THEN                                00005370
                CALL SKRIV_FEIL(TT_E66_M_FNR);                          00005380
          END;                                                          00005390
       IF TT_E66_Å_FNR        = 0 THEN                                  00005400
          S001101O.TT_E66_Å_FA         = NOR_NUM;                       00005410
       ELSE                                                             00005420
          DO;                                                           00005430
             S001101O.TT_E66_Å_FA      = BRI_NUM;                       00005440
             S001101I.TT_E66_Å_FL      = CURSOR_POS;                    00005450
             IF TT_E66_Å_FNR ^= 999 THEN                                00005460
                CALL SKRIV_FEIL(TT_E66_Å_FNR);                          00005470
          END;                                                          00005480
       IF VP_ÅR_FNR(1) = 0 THEN                                         00005490
          S001101O.VP_ÅR1_FA    = NOR_NUM;                              00005500
       ELSE                                                             00005510
          DO;                                                           00005520
             S001101O.VP_ÅR1_FA        = BRI_NUM;                       00005530
             S001101I.VP_ÅR1_FL        = CURSOR_POS;                    00005540
             IF VP_ÅR_FNR(1) ^= 999 THEN                                00005550
                CALL SKRIV_FEIL(VP_ÅR_FNR(1));                          00005560
          END;                                                          00005570
       IF VP_ÅR_FNR(2) = 0 THEN                                         00005580
          S001101O.VP_ÅR2_FA    = NOR_NUM;                              00005590
       ELSE                                                             00005600
          DO;                                                           00005610
             S001101O.VP_ÅR2_FA        = BRI_NUM;                       00005620
             S001101I.VP_ÅR2_FL        = CURSOR_POS;                    00005630
             IF VP_ÅR_FNR(2) ^= 999 THEN                                00005640
                CALL SKRIV_FEIL(VP_ÅR_FNR(2));                          00005650
          END;                                                          00005660
       IF VP_ÅR_FNR(3) = 0 THEN                                         00005670
          S001101O.VP_ÅR3_FA    = NOR_NUM;                              00005680
       ELSE                                                             00005690
          DO;                                                           00005700
             S001101O.VP_ÅR3_FA        = BRI_NUM;                       00005710
             S001101I.VP_ÅR3_FL        = CURSOR_POS;                    00005720
             IF VP_ÅR_FNR(3) ^= 999 THEN                                00005730
                CALL SKRIV_FEIL(VP_ÅR_FNR(3));                          00005740
          END;                                                          00005750
       IF VP_ÅR_FNR(4) = 0 THEN                                         00005760
          S001101O.VP_ÅR4_FA    = NOR_NUM;                              00005770
       ELSE                                                             00005780
          DO;                                                           00005790
             S001101O.VP_ÅR4_FA        = BRI_NUM;                       00005800
             S001101I.VP_ÅR4_FL        = CURSOR_POS;                    00005810
             IF VP_ÅR_FNR(4) ^= 999 THEN                                00005820
                CALL SKRIV_FEIL(VP_ÅR_FNR(4));                          00005830
          END;                                                          00005840
       IF PI_FNR = 0 THEN                                               00005850
          S001101O.PI_FA  = NOR_NUM;                                    00005860
       ELSE                                                             00005870
          DO;                                                           00005880
             S001101O.PI_FA      = BRI_NUM;                             00005890
             S001101I.PI_FL      = CURSOR_POS;                          00005900
             IF PI_FNR ^= 999 THEN                                      00005910
                CALL SKRIV_FEIL(PI_FNR);                                00005920
          END;                                                          00005930
 /*YS*/IF YSKADE_TILLEGG_FNR = 0 THEN                                   00005940
 /*YS*/   S001101O.YSKADE_TILL_FARA  = NORMAL;                          00005950
 /*YS*/ELSE                                                             00005960
 /*YS*/   DO;                                                           00005970
 /*YS*/      S001101O.YSKADE_TILL_FARA      = DFHBMBRY;                 00005980
 /*YS*/      S001101I.YSKADE_TILL_FARL      = CURSOR_POS;               00005990
 /*YS*/      IF YSKADE_TILLEGG_FNR ^= 999 THEN                          00006000
 /*YS*/         CALL SKRIV_FEIL(YSKADE_TILLEGG_FNR);                    00006010
 /*YS*/   END;                                                          00006020
                                                                        00006030
      IF FRA_UTEN_DIALOG THEN          /* BLOKKER ALT SAMMEN  */        00006040
                                                                        00006050
         DO;                                                            00006060
           S001101O.FNR_FA           = DFHBMASK;                        00006070
           S001101O.NAVN_FA          = DFHBMASK;                        00006080
           S001101O.DØDSDATO_FA      = DFHBMASK;                        00006090
           S001101O.VILKÅR_8_4_3A_FA = DFHBMASK;                        00006100
           S001101O.OVERKOMP_FA      = DFHBMASK;                        00006110
           S001101O.TT_F67_FA        = DFHBMASK;                        00006120
           S001101O.TT_E66_M_FA      = DFHBMASK;                        00006130
           S001101O.TT_E66_Å_FA      = DFHBMASK;                        00006140
           S001101O.VP_ÅR1_FA        = DFHBMASK;                        00006150
           S001101O.VP_ÅR2_FA        = DFHBMASK;                        00006160
           S001101O.VP_ÅR3_FA        = DFHBMASK;                        00006170
           S001101O.VP_ÅR4_FA        = DFHBMASK;                        00006180
           S001101O.PI_FA            = DFHBMASK;                        00006190
 /*YS*/    S001101O.YSKADE_TILL_FARA = DFHBMASK;                        00006200
         END;                                                           00006210
                                                                        00006220
    END OVERFØR_FB_FAR_MAP;                                             00006230
   %PAGE;                                                               00006240
   /* *************************************************************** */00006250
   /*                                                                 */00006260
   /*   PROSEDYREN OVERFØRER YRKESSKADEOPPLYSNINGER FRA FBY_MOR       */00006270
   /*   TIL SKJERMBILDE FOR YRKESSKADEOPPLYSNINGER.                   */00006280
   /*   O B S.  NY PROSEDYRE O B S.             *//*YS*//*   O B S    */00006290
   /*   MAP:  S001201                                                 */00006300
   /*   MAPSET:  S00120                                               */00006310
   /*                                                                 */00006320
   /* *************************************************************** */00006330
   %SKIP(2);                                                            00006340
  OVERFØR_FBY_MOR_MAP:                                                  00006350
    PROC;                                                               00006360
    DCL                                                                 00006370
       NORMAL            CHAR (1) INIT(' '),                            00006380
       NOR_NUM           CHAR (1) INIT('&'),                            00006390
       BRI_NUM           CHAR (1) INIT('Q');                            00006400
                                                                        00006410
  %SKIP;                                                                00006420
       S001201O.REGDATOO         = F_FELT_PIC_CHAR6(REGDATO);           00006430
       S001201O.TERMIDO          = TERMID;                              00006440
       S001201O.FNRO             = F_FELT_PIC_CHAR11(FNR_M);            00006450
       S001201O.NAVNO            = NAVN_M;                              00006460
       S001201O.TKNRO            = F_FELT_PIC_CHAR4(TKNR(1));           00006470
       S001201O.VIRK_DATOO       = F_FELT_PIC_CHAR4(VIRK_DATO_MÅ);      00006480
       S001201O.VILKÅR_1_2_2AO   = FBY_MOR.VILKÅR_1_2_2A_M;             00006490
       S001201O.VILKÅR_1_2_2BO   = FBY_MOR.VILKÅR_1_2_2B_M;             00006500
       S001201O.YST_MÅO          = F_FELT_PIC_CHAR4(FBY_MOR.YST_MÅ_M);  00006510
       S001201O.YSYKDOMO         = FBY_MOR.YSYKDOM_M;                   00006520
       IF F_FELT_PIC_CHAR3(FBY_MOR.YUG_M) ^= '000' THEN                 00006530
          S001201O.YUGO          = F_FELT_PIC_CHAR3(FBY_MOR.YUG_M);     00006540
       S001201O.KAP11_7_UTLØSTO = FBY_MOR.KAP_11_7_UTLØST_M;            00006550
       S001201O.YRKE11O          = FBY_MOR.YRKE11_M;                    00006560
       IF F_FELT_PIC_CHAR7(FBY_MOR.AÅI_M) ^= (7)'9' THEN                00006570
          S001201O.AÅIO          = F_FELT_PIC_CHAR7(FBY_MOR.AÅI_M);     00006580
       IF F_FELT_PIC_CHAR11(FBY_MOR.FNR_EK_M) ^= (11)'0' THEN           00006590
          S001201O.FNR_EKO       = F_FELT_PIC_CHAR11(FBY_MOR.FNR_EK_M); 00006600
       IF F_FELT_PIC_CHAR11(FBY_MOR.FNR_SAMBOER_M) ^= (11)'0' THEN      00006610
          S001201O.FNR_SAMBOERO  =                                      00006620
                             F_FELT_PIC_CHAR11(FBY_MOR.FNR_SAMBOER_M);  00006630
       IF F_FELT_PIC_CHAR11(FBY_MOR.FNR_Y_BARN_M) ^= (11)'0' THEN       00006640
          S001201O.FNR_Y_BARNO   =                                      00006650
                            F_FELT_PIC_CHAR11(FBY_MOR.FNR_Y_BARN_M);    00006660
       S001201O.PLEIEBARNO       = FBY_MOR.PLEIEBARN_M;                 00006670
                                                                        00006680
 %SKIP(3);                                                              00006690
 /* MARKERING AV ATTRIBUTTER  */                                        00006700
 %SKIP;                                                                 00006710
       S001201O.DUMMYA = '_';                                           00006720
                                                                        00006730
       IF ^ FRA_CICS THEN                                               00006740
          DO;                                                           00006750
             IF FEIL_MELD_NR > 0 THEN                                   00006760
                CALL SKRIV_FEIL_YP(FEIL_MELD_NR);                       00006770
             FEIL_MELD_NR = 0;                                          00006780
          END;                                                          00006790
                                                                        00006800
       S001201O.REGDATOA   = DFHBMASK;                                  00006810
       S001201O.TERMIDA    = DFHBMASK;                                  00006820
       S001201O.FNRA       = DFHBMASK;                                  00006830
       S001201O.TKNRA      = DFHBMASK;                                  00006840
       S001201O.NAVNA      = DFHBMASK;                                  00006850
       S001201O.UFTA       = DFHBMASK;                                  00006860
       S001201O.VIRK_DATOA = DFHBMASK;                                  00006870
                                                                        00006880
       IF FBY_MOR.VILKÅR_1_2_2A_MNR = 0 THEN                            00006890
          S001201O.VILKÅR_1_2_2AA = NORMAL;                             00006900
       ELSE                                                             00006910
          DO;                                                           00006920
            S001201O.VILKÅR_1_2_2AA = DFHBMBRY;                         00006930
            S001201I.VILKÅR_1_2_2AL = CURSOR_POS;                       00006940
            IF FBY_MOR.VILKÅR_1_2_2A_MNR ^= 999 THEN                    00006950
               CALL SKRIV_FEIL_YP(FBY_MOR.VILKÅR_1_2_2A_MNR);           00006960
          END;                                                          00006970
       IF FBY_MOR.VILKÅR_1_2_2B_MNR = 0 THEN                            00006980
          S001201O.VILKÅR_1_2_2BA = NORMAL;                             00006990
       ELSE                                                             00007000
          DO;                                                           00007010
            S001201O.VILKÅR_1_2_2BA = DFHBMBRY;                         00007020
            S001201I.VILKÅR_1_2_2BL = CURSOR_POS;                       00007030
            IF FBY_MOR.VILKÅR_1_2_2B_MNR ^= 999 THEN                    00007040
               CALL SKRIV_FEIL_YP(FBY_MOR.VILKÅR_1_2_2B_MNR);           00007050
          END;                                                          00007060
       IF FBY_MOR.YST_MÅ_MNR = 0 THEN                                   00007070
          S001201O.YST_MÅA = NOR_NUM;                                   00007080
       ELSE                                                             00007090
          DO;                                                           00007100
            S001201O.YST_MÅA = BRI_NUM;                                 00007110
            S001201I.YST_MÅL = CURSOR_POS;                              00007120
            IF FBY_MOR.YST_MÅ_MNR ^= 999 THEN                           00007130
               CALL SKRIV_FEIL_YP(FBY_MOR.YST_MÅ_MNR);                  00007140
          END;                                                          00007150
       IF FBY_MOR.YSYKDOM_MNR = 0 THEN                                  00007160
          S001201O.YSYKDOMA = NORMAL;                                   00007170
       ELSE                                                             00007180
          DO;                                                           00007190
            S001201O.YSYKDOMA = DFHBMBRY;                               00007200
            S001201I.YSYKDOML = CURSOR_POS;                             00007210
            IF FBY_MOR.YSYKDOM_MNR ^= 999 THEN                          00007220
               CALL SKRIV_FEIL_YP(FBY_MOR.YSYKDOM_MNR);                 00007230
          END;                                                          00007240
       IF FBY_MOR.YUG_MNR = 0 THEN                                      00007250
          S001201O.YUGA = NOR_NUM;                                      00007260
       ELSE                                                             00007270
          DO;                                                           00007280
            S001201O.YUGA = BRI_NUM;                                    00007290
            S001201I.YUGL = CURSOR_POS;                                 00007300
            IF FBY_MOR.YUG_MNR ^= 999 THEN                              00007310
               CALL SKRIV_FEIL_YP(FBY_MOR.YUG_MNR);                     00007320
          END;                                                          00007330
       IF FBY_MOR.KAP_11_7_UTLØST_MNR = 0 THEN                          00007340
          S001201O.KAP11_7_UTLØSTA = NORMAL;                            00007350
       ELSE                                                             00007360
          DO;                                                           00007370
            S001201O.KAP11_7_UTLØSTA = DFHBMBRY;                        00007380
            S001201I.KAP11_7_UTLØSTL = CURSOR_POS;                      00007390
            IF FBY_MOR.KAP_11_7_UTLØST_MNR ^= 999 THEN                  00007400
               CALL SKRIV_FEIL_YP(FBY_MOR.KAP_11_7_UTLØST_MNR);         00007410
          END;                                                          00007420
       IF FBY_MOR.YRKE11_MNR = 0 THEN                                   00007430
          S001201O.YRKE11A = NORMAL;                                    00007440
       ELSE                                                             00007450
          DO;                                                           00007460
            S001201O.YRKE11A = DFHBMBRY;                                00007470
            S001201I.YRKE11L = CURSOR_POS;                              00007480
            IF FBY_MOR.YRKE11_MNR ^= 999 THEN                           00007490
               CALL SKRIV_FEIL_YP(FBY_MOR.YRKE11_MNR);                  00007500
          END;                                                          00007510
       IF FBY_MOR.AÅI_MNR = 0 THEN                                      00007520
          S001201O.AÅIA = NOR_NUM;                                      00007530
       ELSE                                                             00007540
          DO;                                                           00007550
            S001201O.AÅIA = BRI_NUM;                                    00007560
            S001201I.AÅIL = CURSOR_POS;                                 00007570
            IF FBY_MOR.AÅI_MNR ^= 999 THEN                              00007580
               CALL SKRIV_FEIL_YP(FBY_MOR.AÅI_MNR);                     00007590
          END;                                                          00007600
       IF FBY_MOR.FNR_EK_MNR = 0 THEN                                   00007610
          S001201O.FNR_EKA = NOR_NUM;                                   00007620
       ELSE                                                             00007630
          DO;                                                           00007640
            S001201O.FNR_EKA = BRI_NUM;                                 00007650
            S001201I.FNR_EKL = CURSOR_POS;                              00007660
            IF FBY_MOR.FNR_EK_MNR ^= 999 THEN                           00007670
               CALL SKRIV_FEIL_YP(FBY_MOR.FNR_EK_MNR);                  00007680
          END;                                                          00007690
       IF FBY_MOR.FNR_SAMBOER_MNR = 0 THEN                              00007700
          S001201O.FNR_SAMBOERA = NOR_NUM;                              00007710
       ELSE                                                             00007720
          DO;                                                           00007730
            S001201O.FNR_SAMBOERA = BRI_NUM;                            00007740
            S001201I.FNR_SAMBOERL = CURSOR_POS;                         00007750
            IF FBY_MOR.FNR_SAMBOER_MNR ^= 999 THEN                      00007760
               CALL SKRIV_FEIL_YP(FBY_MOR.FNR_SAMBOER_MNR);             00007770
          END;                                                          00007780
       IF FBY_MOR.FNR_Y_BARN_MNR = 0 THEN                               00007790
          S001201O.FNR_Y_BARNA = NOR_NUM;                               00007800
       ELSE                                                             00007810
          DO;                                                           00007820
            S001201O.FNR_Y_BARNA = BRI_NUM;                             00007830
            S001201I.FNR_Y_BARNL = CURSOR_POS;                          00007840
            IF FBY_MOR.FNR_Y_BARN_MNR ^= 999 THEN                       00007850
               CALL SKRIV_FEIL_YP(FBY_MOR.FNR_Y_BARN_MNR);              00007860
          END;                                                          00007870
       IF FBY_MOR.PLEIEBARN_MNR = 0 THEN                                00007880
          S001201O.PLEIEBARNA = NOR_NUM;                                00007890
       ELSE                                                             00007900
          DO;                                                           00007910
            S001201O.PLEIEBARNA = BRI_NUM;                              00007920
            S001201I.PLEIEBARNL = CURSOR_POS;                           00007930
            IF FBY_MOR.PLEIEBARN_MNR ^= 999 THEN                        00007940
               CALL SKRIV_FEIL_YP(FBY_MOR.PLEIEBARN_MNR);               00007950
          END;                                                          00007960
                                                                        00007970
 /* VED GAMLE TRANS SKAL FELTER BLOKKERES                         */    00007980
       IF ^(TRANS_OPPL_OMR.NY_GML_TRANS_IND = 'G' & FRA_MED_DIALOG) THEN00007990
          IF FRA_UTEN_DIALOG                                        THEN00008000
             DO;                                                        00008010
                S001201O.VILKÅR_1_2_2AA  = DFHBMASK;                    00008020
                S001201O.VILKÅR_1_2_2BA  = DFHBMASK;                    00008030
                S001201O.YST_MÅA         = DFHBMASK;                    00008040
                S001201O.YSYKDOMA        = DFHBMASK;                    00008050
                S001201O.YUGA            = DFHBMASK;                    00008060
                S001201O.KAP11_7_UTLØSTA = DFHBMASK;                    00008070
                S001201O.YRKE11A         = DFHBMASK;                    00008080
                S001201O.AÅIA            = DFHBMASK;                    00008090
                S001201O.FNR_EKA         = DFHBMASK;                    00008100
                S001201O.FNR_SAMBOERA    = DFHBMASK;                    00008110
                S001201O.FNR_Y_BARNA     = DFHBMASK;                    00008120
                S001201O.PLEIEBARNA      = DFHBMASK;                    00008130
                YMELDING6O               =                              00008140
                          'TRYKK PF1 FOR OPPBEVAR, PF2 FOR FORKASTE.';  00008150
             END;                                                       00008160
       IF ^FRA_CICS THEN                                                00008170
          DO;                                                           00008180
             S001201O.STYRE_KODEA    = DFHBMASK;                        00008190
             S001201O.FUNKSJONSKODEA = DFHBMASK;                        00008200
          END;                                                          00008210
                                                                        00008220
    END OVERFØR_FBY_MOR_MAP;                                            00008230
   %PAGE;                                                               00008240
   /* *************************************************************** */00008250
   /*                                                                 */00008260
   /*   PROSEDYREN OVERFØRER YRKESSKADEOPPLYSNINGER FRA FBY_FAR       */00008270
   /*   TIL SKJERMBILDE FOR YRKESSKADEOPPLYSNINGER.                   */00008280
   /*   O B S.  NY PROSEDYRE O B S.             *//*YS*//*   O B S    */00008290
   /*   MAP:  S001201                                                 */00008300
   /*   MAPSET:  S00120                                               */00008310
   /*                                                                 */00008320
   /* *************************************************************** */00008330
   %SKIP(2);                                                            00008340
  OVERFØR_FBY_FAR_MAP:                                                  00008350
    PROC;                                                               00008360
    DCL                                                                 00008370
       NORMAL            CHAR (1) INIT(' '),                            00008380
       NOR_NUM           CHAR (1) INIT('&'),                            00008390
       BRI_NUM           CHAR (1) INIT('Q');                            00008400
                                                                        00008410
  %SKIP;                                                                00008420
       S001201O.REGDATOO         = F_FELT_PIC_CHAR6(REGDATO);           00008430
       S001201O.TERMIDO          = TERMID;                              00008440
       S001201O.FNRO             = F_FELT_PIC_CHAR11(FNR_F);            00008450
       S001201O.NAVNO            = NAVN_F;                              00008460
       S001201O.TKNRO            = F_FELT_PIC_CHAR4(TKNR(1));           00008470
       S001201O.VIRK_DATOO       = F_FELT_PIC_CHAR4(VIRK_DATO_MÅ);      00008480
       S001201O.VILKÅR_1_2_2AO   = FBY_FAR.VILKÅR_1_2_2A_F;             00008490
       S001201O.VILKÅR_1_2_2BO   = FBY_FAR.VILKÅR_1_2_2B_F;             00008500
       S001201O.YST_MÅO          = F_FELT_PIC_CHAR4(FBY_FAR.YST_MÅ_F);  00008510
       S001201O.YSYKDOMO         = FBY_FAR.YSYKDOM_F;                   00008520
       IF F_FELT_PIC_CHAR3(FBY_FAR.YUG_F) ^= '000' THEN                 00008530
          S001201O.YUGO          = F_FELT_PIC_CHAR3(FBY_FAR.YUG_F);     00008540
       S001201O.KAP11_7_UTLØSTO = FBY_FAR.KAP_11_7_UTLØST_F;            00008550
       S001201O.YRKE11O          = FBY_FAR.YRKE11_F;                    00008560
       IF F_FELT_PIC_CHAR7(FBY_FAR.AÅI_F) ^= (7)'9' THEN                00008570
          S001201O.AÅIO          = F_FELT_PIC_CHAR7(FBY_FAR.AÅI_F);     00008580
       IF F_FELT_PIC_CHAR11(FBY_FAR.FNR_EK_F) ^= (11)'0' THEN           00008590
          S001201O.FNR_EKO       = F_FELT_PIC_CHAR11(FBY_FAR.FNR_EK_F); 00008600
       IF F_FELT_PIC_CHAR11(FBY_FAR.FNR_SAMBOER_F) ^= (11)'0' THEN      00008610
          S001201O.FNR_SAMBOERO  =                                      00008620
                             F_FELT_PIC_CHAR11(FBY_FAR.FNR_SAMBOER_F);  00008630
       IF F_FELT_PIC_CHAR11(FBY_FAR.FNR_Y_BARN_F) ^= (11)'0' THEN       00008640
          S001201O.FNR_Y_BARNO   =                                      00008650
                            F_FELT_PIC_CHAR11(FBY_FAR.FNR_Y_BARN_F);    00008660
       S001201O.PLEIEBARNO       = FBY_FAR.PLEIEBARN_F;                 00008670
                                                                        00008680
 %SKIP(3);                                                              00008690
 /* MARKERING AV ATTRIBUTTER  */                                        00008700
 %SKIP;                                                                 00008710
       S001201O.DUMMYA = '_';                                           00008720
                                                                        00008730
       IF ^ FRA_CICS THEN                                               00008740
          DO;                                                           00008750
             IF FEIL_MELD_NR > 0 THEN                                   00008760
                CALL SKRIV_FEIL_YP(FEIL_MELD_NR);                       00008770
             FEIL_MELD_NR = 0;                                          00008780
          END;                                                          00008790
                                                                        00008800
       S001201O.REGDATOA   = DFHBMASK;                                  00008810
       S001201O.TERMIDA    = DFHBMASK;                                  00008820
       S001201O.FNRA       = DFHBMASK;                                  00008830
       S001201O.TKNRA      = DFHBMASK;                                  00008840
       S001201O.NAVNA      = DFHBMASK;                                  00008850
       S001201O.UFTA       = DFHBMASK;                                  00008860
       S001201O.VIRK_DATOA = DFHBMASK;                                  00008870
                                                                        00008880
       IF FBY_FAR.VILKÅR_1_2_2A_FNR = 0 THEN                            00008890
          S001201O.VILKÅR_1_2_2AA = NORMAL;                             00008900
       ELSE                                                             00008910
          DO;                                                           00008920
            S001201O.VILKÅR_1_2_2AA = DFHBMBRY;                         00008930
            S001201I.VILKÅR_1_2_2AL = CURSOR_POS;                       00008940
            IF FBY_FAR.VILKÅR_1_2_2A_FNR ^= 999 THEN                    00008950
               CALL SKRIV_FEIL_YP(FBY_FAR.VILKÅR_1_2_2A_FNR);           00008960
          END;                                                          00008970
       IF FBY_FAR.VILKÅR_1_2_2B_FNR = 0 THEN                            00008980
          S001201O.VILKÅR_1_2_2BA = NORMAL;                             00008990
       ELSE                                                             00009000
          DO;                                                           00009010
            S001201O.VILKÅR_1_2_2BA = DFHBMBRY;                         00009020
            S001201I.VILKÅR_1_2_2BL = CURSOR_POS;                       00009030
            IF FBY_FAR.VILKÅR_1_2_2B_FNR ^= 999 THEN                    00009040
               CALL SKRIV_FEIL_YP(FBY_FAR.VILKÅR_1_2_2B_FNR);           00009050
          END;                                                          00009060
       IF FBY_FAR.YST_MÅ_FNR = 0 THEN                                   00009070
          S001201O.YST_MÅA = NOR_NUM;                                   00009080
       ELSE                                                             00009090
          DO;                                                           00009100
            S001201O.YST_MÅA = BRI_NUM;                                 00009110
            S001201I.YST_MÅL = CURSOR_POS;                              00009120
            IF FBY_FAR.YST_MÅ_FNR ^= 999 THEN                           00009130
               CALL SKRIV_FEIL_YP(FBY_FAR.YST_MÅ_FNR);                  00009140
          END;                                                          00009150
       IF FBY_FAR.YSYKDOM_FNR = 0 THEN                                  00009160
          S001201O.YSYKDOMA = NORMAL;                                   00009170
       ELSE                                                             00009180
          DO;                                                           00009190
            S001201O.YSYKDOMA = DFHBMBRY;                               00009200
            S001201I.YSYKDOML = CURSOR_POS;                             00009210
            IF FBY_FAR.YSYKDOM_FNR ^= 999 THEN                          00009220
               CALL SKRIV_FEIL_YP(FBY_FAR.YSYKDOM_FNR);                 00009230
          END;                                                          00009240
       IF FBY_FAR.YUG_FNR = 0 THEN                                      00009250
          S001201O.YUGA = NOR_NUM;                                      00009260
       ELSE                                                             00009270
          DO;                                                           00009280
            S001201O.YUGA = BRI_NUM;                                    00009290
            S001201I.YUGL = CURSOR_POS;                                 00009300
            IF FBY_FAR.YUG_FNR ^= 999 THEN                              00009310
               CALL SKRIV_FEIL_YP(FBY_FAR.YUG_FNR);                     00009320
          END;                                                          00009330
       IF FBY_FAR.KAP_11_7_UTLØST_FNR = 0 THEN                          00009340
          S001201O.KAP11_7_UTLØSTA = NORMAL;                            00009350
       ELSE                                                             00009360
          DO;                                                           00009370
            S001201O.KAP11_7_UTLØSTA = DFHBMBRY;                        00009380
            S001201I.KAP11_7_UTLØSTL = CURSOR_POS;                      00009390
            IF FBY_FAR.KAP_11_7_UTLØST_FNR ^= 999 THEN                  00009400
               CALL SKRIV_FEIL_YP(FBY_FAR.KAP_11_7_UTLØST_FNR);         00009410
          END;                                                          00009420
       IF FBY_FAR.YRKE11_FNR = 0 THEN                                   00009430
          S001201O.YRKE11A = NORMAL;                                    00009440
       ELSE                                                             00009450
          DO;                                                           00009460
            S001201O.YRKE11A = DFHBMBRY;                                00009470
            S001201I.YRKE11L = CURSOR_POS;                              00009480
            IF FBY_FAR.YRKE11_FNR ^= 999 THEN                           00009490
               CALL SKRIV_FEIL_YP(FBY_FAR.YRKE11_FNR);                  00009500
          END;                                                          00009510
       IF FBY_FAR.AÅI_FNR = 0 THEN                                      00009520
          S001201O.AÅIA = NOR_NUM;                                      00009530
       ELSE                                                             00009540
          DO;                                                           00009550
            S001201O.AÅIA = BRI_NUM;                                    00009560
            S001201I.AÅIL = CURSOR_POS;                                 00009570
            IF FBY_FAR.AÅI_FNR ^= 999 THEN                              00009580
               CALL SKRIV_FEIL_YP(FBY_FAR.AÅI_FNR);                     00009590
          END;                                                          00009600
       IF FBY_FAR.FNR_EK_FNR = 0 THEN                                   00009610
          S001201O.FNR_EKA = NOR_NUM;                                   00009620
       ELSE                                                             00009630
          DO;                                                           00009640
            S001201O.FNR_EKA = BRI_NUM;                                 00009650
            S001201I.FNR_EKL = CURSOR_POS;                              00009660
            IF FBY_FAR.FNR_EK_FNR ^= 999 THEN                           00009670
               CALL SKRIV_FEIL_YP(FBY_FAR.FNR_EK_FNR);                  00009680
          END;                                                          00009690
       IF FBY_FAR.FNR_SAMBOER_FNR = 0 THEN                              00009700
          S001201O.FNR_SAMBOERA = NOR_NUM;                              00009710
       ELSE                                                             00009720
          DO;                                                           00009730
            S001201O.FNR_SAMBOERA = BRI_NUM;                            00009740
            S001201I.FNR_SAMBOERL = CURSOR_POS;                         00009750
            IF FBY_FAR.FNR_SAMBOER_FNR ^= 999 THEN                      00009760
               CALL SKRIV_FEIL_YP(FBY_FAR.FNR_SAMBOER_FNR);             00009770
          END;                                                          00009780
       IF FBY_FAR.FNR_Y_BARN_FNR = 0 THEN                               00009790
          S001201O.FNR_Y_BARNA = NOR_NUM;                               00009800
       ELSE                                                             00009810
          DO;                                                           00009820
            S001201O.FNR_Y_BARNA = BRI_NUM;                             00009830
            S001201I.FNR_Y_BARNL = CURSOR_POS;                          00009840
            IF FBY_FAR.FNR_Y_BARN_FNR ^= 999 THEN                       00009850
               CALL SKRIV_FEIL_YP(FBY_FAR.FNR_Y_BARN_FNR);              00009860
          END;                                                          00009870
       IF FBY_FAR.PLEIEBARN_FNR = 0 THEN                                00009880
          S001201O.PLEIEBARNA = NOR_NUM;                                00009890
       ELSE                                                             00009900
          DO;                                                           00009910
            S001201O.PLEIEBARNA = BRI_NUM;                              00009920
            S001201I.PLEIEBARNL = CURSOR_POS;                           00009930
            IF FBY_FAR.PLEIEBARN_FNR ^= 999 THEN                        00009940
               CALL SKRIV_FEIL_YP(FBY_FAR.PLEIEBARN_FNR);               00009950
          END;                                                          00009960
                                                                        00009970
 /* VED GAMLE TRANS SKAL FELTER BLOKKERES                         */    00009980
       IF ^(TRANS_OPPL_OMR.NY_GML_TRANS_IND = 'G' & FRA_MED_DIALOG) THEN00009990
          IF FRA_UTEN_DIALOG                                        THEN00010000
             DO;                                                        00010010
                S001201O.VILKÅR_1_2_2AA  = DFHBMASK;                    00010020
                S001201O.VILKÅR_1_2_2BA  = DFHBMASK;                    00010030
                S001201O.YST_MÅA         = DFHBMASK;                    00010040
                S001201O.YSYKDOMA        = DFHBMASK;                    00010050
                S001201O.YUGA            = DFHBMASK;                    00010060
                S001201O.KAP11_7_UTLØSTA = DFHBMASK;                    00010070
                S001201O.YRKE11A         = DFHBMASK;                    00010080
                S001201O.AÅIA            = DFHBMASK;                    00010090
                S001201O.FNR_EKA         = DFHBMASK;                    00010100
                S001201O.FNR_SAMBOERA    = DFHBMASK;                    00010110
                S001201O.FNR_Y_BARNA     = DFHBMASK;                    00010120
                S001201O.PLEIEBARNA      = DFHBMASK;                    00010130
                YMELDING6O               =                              00010140
                          'TRYKK PF1 FOR OPPBEVAR, PF2 FOR FORKASTE.';  00010150
             END;                                                       00010160
       IF ^FRA_CICS THEN                                                00010170
          DO;                                                           00010180
             S001201O.STYRE_KODEA    = DFHBMASK;                        00010190
             S001201O.FUNKSJONSKODEA = DFHBMASK;                        00010200
          END;                                                          00010210
                                                                        00010220
    END OVERFØR_FBY_FAR_MAP;                                            00010230
