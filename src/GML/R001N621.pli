 /*       SIST ENDRET 05/12-97 12.17.56 AV   JDA7339                  */00000000
 /*       SIST ENDRET 27/11-97 10.42.12 AV   JDA7339                  */00000010
 /*       SIST ENDRET 03/09-97 12.32.16 AV   HLA7339                  */00000020
 /*       SIST ENDRET 03/09-97 12.30.11 AV   HLA7339                  */00000030
 /*       SIST ENDRET 29/08-97 12.27.39 AV   JDA7339                  */00000040
 /*       SIST ENDRET 28/08-97 08.52.18 AV   SPA7339                  */00000050
 /*       SIST ENDRET 28/07-97 12.31.28 AV   HLA7339                  */00000060
 /*       SIST ENDRET 16/05-97 10.50.04 AV   JDA7339                  */00000070
 /*       SIST ENDRET 04/03-96 12.48.57 AV   JDA0310                  */00000080
 /*       SIST ENDRET 13/02-96 11.17.17 AV   HLB0310                  */00000090
 /*       SIST ENDRET 29/03-95 14.43.20 AV   JDA0310                  */00000100
 /*       SIST ENDRET 17/11-94 12.05.35 AV   JDA0310                  */00000110
 /*       SIST ENDRET 12/07-94 14.04.53 AV   DYBVIK                   */00000120
 /*       SIST ENDRET 08/06-94 14.04.08 AV   DYBVIK                   */00000130
 /*       SIST ENDRET 25/02-94 12.22.43 AV   HERMAN                   */00000140
 /*       SIST ENDRET 22/04-93 08.33.24 AV   DYBVIK                   */00000150
 /*       SIST ENDRET 27/01-93 15.08.46 AV   DYBVIK                   */00000160
 /*       SIST ENDRET 09/10-92 14.31.45 AV   DYBVIK                   */00000170
 /*       SIST ENDRET 12/06-92 13.33.59 AV   TRUDE                    */00000180
 /*       SIST ENDRET 20/02-92 09.29.21 AV   HERMAN                   */00000190
 /*       SIST ENDRET 01/08-91 14.14.57 AV   DYBVIK                   */00000200
 /*       SIST ENDRET 14/06-91 13.24.58 AV   DYBVIK                   */00000210
 /*       SIST ENDRET 15/04-91 16.00.51 AV   HERMAN                   */00000220
 /*       SIST ENDRET 02/04-91 09.54.29 AV   DYBVIK                   */00000230
 /*       SIST ENDRET 06/03-91 11.49.03 AV   DYBVIK                   */00000240
  /* *************************************************************** */ 00000250
  /*IDENTIFIKASJON:                                                  */ 00000260
  /*    R001N621 - PROSEDYRE I PLI                                   */ 00000270
  /*    PROGRAMMERER: HERMAN           JAN 1991                      */ 00000280
  /*HENSIKT:                                                         */ 00000290
  /*    OPPRETTE PENSJONSSTATUS FOR SØKER FRA TRANSEN                */ 00000300
  /* *************************************************************** */ 00000310
  /*ENDRET:                                                          */ 00000320
  /*ENDRINGEN GJELDER:                                               */ 00000330
  /*ENDRET AV:                                                       */ 00000340
  /* *************************************************************** */ 00000350
  /* *************************************************************** */ 00000360
  /*PROGRAMTILKNYTNING:                                              */ 00000370
  /*    PROSEDYREN INNGÅR SOM EN DEL AV BEHANDLINGA AV UFØREPENSJON  */ 00000380
  /*    INCLUDES I R001N620 NÅR STATUS_TYPE = A, C, I, K             */ 00000390
  /*BRUK:                                                            */ 00000400
  /*    CALL OPPRETT_B02_PENSJONSSTATUS_U2_SØKER                     */ 00000410
  /* *************************************************************** */ 00000420
  %SKIP(2);                                                             00000430
 OPPRETT_STATUS_U2_SØKER:                                               00000440
    PROC;                                                               00000450
    DCL                                                                 00000460
  /*   UF_IND           PIC '9',    */                                  00000470
       ÅR_FØR_UFØRHET   PIC '99';                                       00000480
          DCL  YRK_IND  FIXED BIN(15);                                  00000490
          DCL  M        FIXED BIN(15);                                  00000500
                                                                        00000510
          DCL  VILKÅR_DEF CHAR(2);                                      00000520
          DCL  1 W_VILKÅR_1_2_2AB DEFINED VILKÅR_DEF,                   00000530
                 3 W_VILKÅR_1_2_2A CHAR(1),                             00000540
                 3 W_VILKÅR_1_2_2B CHAR(1);                             00000550
                                                                        00000560
                                                                        00000570
 /* ***************************************************************** */00000580
 /* ENDRET AV KARIN 8/12-84                                           */00000590
 /* NÅR STATUS_TYPE = A OG STATUS_KODE_HIST = O MÅ VI FØRST BLANKE    */00000600
 /* FELTENE SOM LIGGER I STATUS_SEGMENTENE.                           */00000610
 /* B01 ER FLYTTET OVER TIL B02 I R0010620.                           */00000620
 /* ***************************************************************** */00000630
      IF STATUS_TYPE_SØKER                = 'A' &                       00000640
         B01.STATUS_KODE_HIST (SØKER_IND) = 'O' THEN                    00000650
         DO;                                                            00000660
            B02.STATUS   (SØKER_IND)   = '';                            00000670
            B02.UFØRPENS (SØKER_IND)   = '';                            00000680
            B02.UFØRHIST (SØKER_IND,1) = '';                            00000690
            B02.UFØRHIST (SØKER_IND,2) = '';                            00000700
            B02.UFØRHIST (SØKER_IND,3) = '';                            00000710
            B02.UFØRHIST (SØKER_IND,4) = '';                            00000720
            B02.UFØRHIST (SØKER_IND,5) = '';                            00000730
            B02.UFØRHIST (SØKER_IND,6) = '';    /*9709 HL*/             00000740
            B02.UFØRHIST (SØKER_IND,7) = '';    /*9709 HL*/             00000750
            B02.YRKEPENS (SØKER_IND)   = '';                            00000760
            B02.YRKEHIST (SØKER_IND,1) = '';                            00000770
            B02.YRKEHIST (SØKER_IND,2) = '';                            00000780
            B02.YRKEHIST (SØKER_IND,3) = '';                            00000790
            B02.YRKEHIST (SØKER_IND,4) = '';                            00000800
            B02.YRKEHIST (SØKER_IND,5) = '';                            00000810
            B02.ETTEPENS (SØKER_IND)   = '';                            00000820
            B02.ETTEBARN (SØKER_IND)   = '';                            00000830
            B02.SPESOPPL (SØKER_IND)   = '';                            00000840
         END;                                                           00000850
                                                                        00000860
 /* ***************************************************************** */00000870
 /* STATUS_SEGMENTET                                                  */00000880
 /* ***************************************************************** */00000890
                                                                        00000900
        IF HJ_VIRK_DATO_ÅM < 9802             THEN                      00000910
           B02.PENSJON_FØR_9802(SØKER_IND) = 'J';                       00000920
                                                                        00000930
        IF U2S.TILL_EK = 'J' & HJ_VIRK_DATO_ÅM > 9104 THEN              00000940
           U2S.TILL_EK = ' ';    /*JD 07.91*/                           00000950
                                                                        00000960
        IF U2S.BT_ANT > 0    & HJ_VIRK_DATO_ÅM > 9104 THEN              00000970
           U2S.BT_ANT = 0;       /*JD 07.91*/                           00000980
                                                                        00000990
        IF U2S.YSKADE_TILLEGG = 'J' THEN                                00001000
           B02.PENSJONSTYPE1(SØKER_IND) = 'Y';                          00001010
        ELSE                                                            00001020
                                                                        00001030
           B02.PENSJONSTYPE1(SØKER_IND) = 'U';                          00001040
                                                                        00001050
       IF U2S.TILL_EK = 'J' THEN                                        00001060
          B02.PENSJONSTYPE2(SØKER_IND) = 'F';                           00001070
       ELSE                                                             00001080
          B02.PENSJONSTYPE2(SØKER_IND) = 'P';                           00001090
                                                                        00001100
 /* **************************************************************** */ 00001110
 /* TIDLIGERE FORSØRGET EKTEFELLE STOD IGJEN MED PENSJONSTYPE1 = 'F' */ 00001120
 /* OGSÅ ETTER AT TOTALGRADEN BLE UNDER 50 PROSENT.  DET SOM ER      */ 00001130
 /* RIKTIG, ER AT EKTEFELLEN SKAL HA PENSJONSTYPE1 = 'G'.            */ 00001140
 /* PENSJONISTEN SELV SKAL HA PENSJONSTYPE2 = 'P'.                   */ 00001150
 /* ERIK, 11.1.1990.                                                 */ 00001160
 /* **************************************************************** */ 00001170
                                                                        00001180
       IF U2S.TILL_EK = ' ' &                                           00001190
          B01.PENSJONSTYPE2(SØKER_IND) = 'F' &                          00001200
          U2S.UFG < 50   THEN                                           00001210
          DO;                                                           00001220
             B02.PENSJONSTYPE2(SØKER_IND) = 'P';                        00001230
             B02.PENSJONSTYPE1(EKTEF_IND) = 'G';                        00001240
             B02.PENSJONSTYPE2(EKTEF_IND) = ' ';                        00001250
          END;                                                          00001260
                                                                        00001270
       HJ_UFT_MÅ      = U2S.UFT_MÅ;                                     00001280
       ÅR_FØR_UFØRHET = HJ_UFT_Å - 1;                                   00001290
                                                                        00001300
       IF U2SP.STI_MÅ > 0           THEN                                00001310
          HJ_MÅ = U2SP.STI_MÅ;                                          00001320
       ELSE                                                             00001330
          HJ_MÅ = U2S.UFT_MÅ;                                           00001340
                                                                        00001350
       HJ_ÅM = F_SNU_DATO(HJ_MÅ);                                       00001360
       HJ_ÅM_FIX = HJ_ÅM;                                               00001370
                                                                        00001380
       B02.SIVILSTAND(SØKER_IND)           = U2S.SIVILSTAND;            00001390
       B02.NAVN      (SØKER_IND)           = U2S.NAVN;                  00001400
       B02.SPRÅK     (SØKER_IND)           = U2S.SPRÅK;                 00001410
       B02.TKNR      (SØKER_IND)           = U2S.TKNR;                  00001420
                                                                        00001430
       /*TRUDE LEGGE INN INNT_DATO_ÅM  */                               00001440
       B02.INNT_DATO_ÅM(SØKER_IND)   = F_SNU_DATO(U2S.UFT_MÅ);          00001450
                                                                        00001460
       IF U2S.YRKE                      > 0 THEN     /*TS 171094*/      00001470
          B02.YRKES_KODE(SØKER_IND)     = U2S.YRKE;                     00001480
                                                                        00001490
       IF U2S.INNTEKT_FØR_UP            > 0 THEN     /*SP 200296*/      00001500
          B02.INNTEKT_FØR_UP(SØKER_IND) = U2S.INNTEKT_FØR_UP / 100;     00001510
                                                                        00001520
 /* ***************************************************************** */00001530
 /* VERNEPLIKTSOPPLYSNINGER                                           */00001540
 /* ***************************************************************** */00001550
                                                                        00001560
       DO I = 1 TO 4 WHILE (U2S.VP_ÅR(I) > 0);                          00001570
          B02.VERNEPLIKTÅR(SØKER_IND,I) = U2S.VP_ÅR(I);                 00001580
       END;                                                             00001590
                                                                        00001600
       B02.UFØRPENS.VILKÅR_8_4_3A(SØKER_IND) = U2S.VILKÅR_8_4_3A;       00001610
       B02.UFØRPENS.UFG          (SØKER_IND) = U2S.UFG;                 00001620
       B02.VIRK_DATO_ÅM          (SØKER_IND) = HJ_VIRK_DATO_ÅM;         00001630
       B02.UFØRPENS.UTDANNING    (SØKER_IND) = U2S.UTDANNING;           00001640
       B02.UFØRPENS.YRKESM_ATTF  (SØKER_IND) = U2S.YRKESM_ATTF;         00001650
       /* ENDRET 17/10-84 AV KARIN  */                                  00001660
       /* ENDRET 07/12-84 AV KARIN  */                                  00001670
       IF STATUS_TYPE_SØKER = 'I' ! STATUS_TYPE_SØKER = 'K' THEN        00001680
                /* SØKER HAR UFØREHISTORIKK SOM ALLTID MÅ OVERFØRES */  00001690
                                                                        00001700
     DO;                                                                00001710
                                                                        00001720
 /*YS---------------------------------------------------------------*/  00001730
 /*YS  OPPHØRSDATO OG KODE SETTES I UFØRHIST-SEGMENTET              */  00001740
 /*YS  DETTE ER BARE AKTUELT FOR TIDLIGER ENGANGSUTLØSNING . TRUDE  */  00001750
 /*YS---------------------------------------------------------------*/  00001760
                                                                        00001770
                                                                        00001780
          DO I = 1 TO 7;            /*0697 HL*/                         00001790
             IF B01.UFØRHIST.UFT_ÅM(SØKER_IND,I)          > 0 &         00001800
                B01.UFØRHIST.OPPHØRSDATO_ÅM(SØKER_IND,I)   = 0 THEN     00001810
                DO;                                                     00001820
                                                                        00001830
                   IF B01.UFØRHIST.UFT_ÅM(SØKER_IND,I)  =               00001840
                      HJ_UFT_Å!!HJ_UFT_M      THEN                      00001850
        L261:            DO;                                            00001860
                             FEIL_VED_LABEL = '261';                    00001870
                             FEIL_MELD_NR   =  1609;                    00001880
                             GO TO RETUR;                               00001890
                         END;                                           00001900
                                                                        00001910
                   ELSE                                                 00001920
                   DO;                                                  00001930
                      B02.UFØRHIST.OPPHØRSDATO_ÅM(SØKER_IND,I) =        00001940
                                                   HJ_UFT_Å!!HJ_UFT_M;  00001950
                      B02.UFØRHIST.OPPHØRSKODE(SØKER_IND,I)    =  'J';  00001960
                      I                         =   7 ;  /*0697 HL*/    00001970
                   END;                                                 00001980
                END;                                                    00001990
          END;                                                          00002000
                                                                        00002010
 /*YS---------------------------------------------------------------*/  00002020
 /*YS  OPPHØRSDATO OG KODE SETTES I YRKEHIST-SEGMENTET              */  00002030
 /*YS  DETTE ER BARE AKTUELT FOR TIDLIGER ENGANGSUTLØSNING . TRUDE  */  00002040
 /*YS---------------------------------------------------------------*/  00002050
                                                                        00002060
                                                                        00002070
          DO I = 1 TO 5;                                                00002080
             IF B01.YRKEHIST.YUFT_ÅM(SØKER_IND,I)          > 0 &        00002090
                B01.YRKEHIST.OPPH_DATO_ÅM(SØKER_IND,I)   = 0 THEN       00002100
                DO;                                                     00002110
                   B02.YRKEHIST.OPPH_DATO_ÅM(SØKER_IND,I) =             00002120
                                                HJ_UFT_Å!!HJ_UFT_M;     00002130
                   B02.YRKEHIST.OPPH_KODE(SØKER_IND,I)    =  'J';       00002140
                   I                                        =   5 ;     00002150
                END;                                                    00002160
          END;                                                          00002170
                                                                        00002180
                                                                        00002190
                                                                        00002200
                                                                        00002210
                                                                        00002220
          B02.FØRSTE_GANG_REG    (SØKER_IND) = 'N';                     00002230
     END;                                                               00002240
       ELSE                                                             00002250
       IF B02.STATUS_KODE_HIST (SØKER_IND)  = 'X'THEN /*0296HL*/        00002260
          B02.FØRSTE_GANG_REG    (SØKER_IND) = 'N';                     00002270
       ELSE                                                             00002280
          B02.FØRSTE_GANG_REG    (SØKER_IND) = 'J';                     00002290
                                                                        00002300
                                                                        00002310
 /* **************************************************************** */ 00002320
 /* ENDRET 14/1-84 AV KARIN                                          */ 00002330
 /* STATUS_KODE_HIST SETTES LIK BLANK                                */ 00002340
 /* FEIL NÅR TIDLIGERE AVSLUTTET UFØRETILFELLE BLIR UFØR IGJEN       */ 00002350
 /* **************************************************************** */ 00002360
                                                                        00002370
       B02.STATUS_KODE_HIST (SØKER_IND) = ' ';                          00002380
                                                                        00002390
       B02.TT_16_66(SØKER_IND) = U2SP.TT_FRA1937_ÅR * 12 +              00002400
                                 U2SP.TT_FRA1937_MND;                   00002410
                                                                        00002420
       IF B02.TT_16_66(SØKER_IND) > 480     THEN                        00002430
          B02.TT_16_66(SØKER_IND) = 480;   /*HL 080694*/                00002440
                                                                        00002450
 /* ***************************************************************** */00002460
 /* SPESIELLE OPPLYSNINGER                                            */00002470
 /* ***************************************************************** */00002480
  %SKIP;                                                                00002490
       IF U2S.NORSK_BOSATT = 'N'  THEN                                  00002500
         DO;                                                            00002510
           IF U2SP.TT_KONVENSJON_ÅR > 0            THEN                 00002520
              DO;                                                       00002530
                 B02.TT_16_66(SØKER_IND) = U2SP.TT_KONVENSJON_ÅR * 12;  00002540
                 IF B02.TT_16_66(SØKER_IND) > 480     THEN              00002550
                    B02.TT_16_66(SØKER_IND) = 480;                      00002560
              END;                                                      00002570
                                                                        00002580
          /*-----------------------------------------------------*/     00002590
          /*FRAVIK FLYKTN GAV REDUSERT ANT_BUP_ÅR. TRUDE 091092--*/     00002600
          /*-----------------------------------------------------*/     00002610
                                                                        00002620
          IF U2SP.FRAVIK_FLYKT  = 'J' THEN                              00002630
             B02.STATUS.TT_FRAMT(SØKER_IND) =                           00002640
                            (ALDER_67.ÅR * 12) - (HJ_Å * 12 + HJ_M);    00002650
          ELSE                                                          00002660
             B02.STATUS.TT_FRAMT(SØKER_IND) = F_BEREGN_TT_FRAMT_UTLAND  00002670
                     (B02.FNR(SØKER_IND),HJ_ÅM_FIX,SØKER_IND);          00002680
                                                                        00002690
          B02.SPESOPPL.STATSBORGER(SØKER_IND)   = U2SP.STATSBORGER;     00002700
          B02.SPESOPPL.BOSATT(SØKER_IND)        = U2SP.BOSATT;          00002710
       B02.SPESOPPL.PENSJONSTRYGDET(SØKER_IND) = U2SP.PENSJONSTRYGDET;  00002720
          B02.SPESOPPL.MINST_20ÅR_BOTID(SØKER_IND) = U2SP.MINST_20_ÅR;  00002730
          B02.SPESOPPL.FRAVIK_BOSATT_KONVENSJON(SØKER_IND) =            00002740
                                                     U2SP.KONVENSJON;   00002750
          B02.SPESOPPL.FRAVIK_FLYKTN(SØKER_IND) = U2SP.FRAVIK_FLYKT;    00002760
                                                                        00002770
          IF U2SP.OVERKOMP_UTL = 'J'      THEN                          00002780
             B02.SPESOPPL.OVERKOMP_UTL(SØKER_IND)  = 'J';               00002790
          ELSE                                                          00002800
             B02.SPESOPPL.OVERKOMP_UTL(SØKER_IND)  = 'N';               00002810
          B02.SPESOPPL.IKKE_GP      (SØKER_IND) = U2SP.IKKE_GP;         00002820
          B02.SPESOPPL.KONVENSJON(SØKER_IND) =  U2SP.BEREGNING_KONV;    00002830
          B02.SPESOPPL.FRAVIK_8_1(SØKER_IND)  =  U2SP.FRAVIK_8_1_NR3;   00002840
          B02.UFØRPENS.STI(SØKER_IND) = F_SNU_DATO(U2SP.STI_MÅ);        00002850
                                                                        00002860
         END;                                                           00002870
                                                                        00002880
       ELSE                                                             00002890
                                                                        00002900
          B02.STATUS.TT_FRAMT(SØKER_IND) =                              00002910
              (ALDER_67.ÅR * 12) - (HJ_Å * 12 + HJ_M);                  00002920
                                                                        00002930
                                                                        00002940
 /* ***************************************************************** */00002950
 /*                                                                   */00002960
 /* YRKESSKADEOPPLYSNINGER.  ERIK 2.7.87                              */00002970
 /*                                                                   */00002980
 /* ***************************************************************** */00002990
                                                                        00003000
  %SKIP;                                                                00003010
                                                                        00003020
        IF U2S.YSKADE_TILLEGG = 'J' THEN                                00003030
           DO;                                                          00003040
              DO I = 1 TO 5;                                            00003050
                IF B01.YRKEHIST.YUFT_ÅM(SØKER_IND,I) = 0 THEN           00003060
                   DO;                                                  00003070
                      IF (I > 1)  & (B01.YRKEHIST.OPPH_DATO_ÅM          00003080
                                    (SØKER_IND,(I-1)) >                 00003090
                                   F_SNU_DATO(U2S.UFT_MÅ)) THEN         00003100
                         DO;                                            00003110
                                                                        00003120
         /*  ********************************************* */           00003130
         /*  Y-UFØRETIDSPUNKT LIGGER FØR OPPHØRSTIDSPUNKT  */           00003140
         /*  ********************************************* */           00003150
                                                                        00003160
                                                                        00003170
        L264:                                                           00003180
                             FEIL_VED_LABEL = '264';                    00003190
                             FEIL_MELD_NR   =  1719;                    00003200
                             GO TO RETUR;                               00003210
                         END;                                           00003220
                      ELSE                                              00003230
                       DO;                                              00003240
                          YRK_IND = I;                                  00003250
                          W_VILKÅR_1_2_2A =                             00003260
                                          U2Y.VILKÅR_1_2_2A;            00003270
                          W_VILKÅR_1_2_2B =                             00003280
                                          U2Y.VILKÅR_1_2_2B;            00003290
                          B02.VILKÅR_1_2_2(SØKER_IND,YRK_IND) =         00003300
                                                  VILKÅR_DEF;           00003310
                                    /*    W_VILKÅR_1_2_2AB  */          00003320
                                                                        00003330
  /* ******************************************************* */         00003340
  /* HUSK:                                                   */         00003350
  /* TESTE PÅ OM B02.VILKÅR_1_2_2 = '  '. HVIS JA, SÅ VANLIG */         00003360
  /* ALDERSKONV.  HVIS NEI, SÅ SPESIELL ALDERSKONV.BEHANDLING*/         00003370
  /* ERIK .                                                  */         00003380
  /* ******************************************************* */         00003390
                                                                        00003400
                          B02.YRKEHIST.YUFT_ÅM(SØKER_IND,I) =           00003410
                                          F_SNU_DATO(U2S.UFT_MÅ);       00003420
                          B02.YST_ÅM(SØKER_IND,YRK_IND) =               00003430
                                          F_SNU_DATO(U2Y.YST_MÅ);       00003440
                                                                        00003450
                          B02.YRKEPENS.YSYKDOM(SØKER_IND) =             00003460
                                          U2Y.YSYKDOM;                  00003470
                          DIV_PARAM_OMR.YSYKDOM  =                      00003480
                                          U2Y.YSYKDOM;                  00003490
                                                                        00003500
                          B02.YRKEPENS.YUG(SØKER_IND) = U2Y.YUG;        00003510
                          B02.YRKEHIST.YUG(SØKER_IND,YRK_IND) =         00003520
                                          U2Y.YUG;                      00003530
                          B02.KAP_11_7_UTLØST(SØKER_IND,YRK_IND) =      00003540
                                          U2Y.KAP_11_7_UTLØST;          00003550
                          B02.YRKE11(SØKER_IND,YRK_IND) = U2Y.YRKE11;   00003560
                          B02.YRKEHIST.AÅI(SØKER_IND,YRK_IND)           00003570
                                                    = U2Y.AÅI;          00003580
                       END;                                             00003590
                     I = 5;                                             00003600
                                                                        00003610
                  END;                                                  00003620
              ELSE                                                      00003630
                                                                        00003640
                    IF I = 5 THEN                                       00003650
                       DO;                                              00003660
                                                                        00003670
 /* ***************************************************************** */00003680
 /* FEIL, ALLE YRKEPERIODENE ER UTFYLT, IKKE PLASS TIL EN TIL         */00003690
 /* ***************************************************************** */00003700
                                                                        00003710
         L267:                                                          00003720
                          FEIL_VED_LABEL = '267';                       00003730
                          FEIL_MELD_NR   = 1715;                        00003740
                          GO TO RETUR;                                  00003750
                       END;                                             00003760
                  END;                                                  00003770
            END;                                                        00003780
                                                                        00003790
                                                                        00003800
 /* ***************************************************************** */00003810
 /* PENSJONSGIVENDE INNTEKT                                           */00003820
 /* HER MÅ VI TESTE PÅ EN PI-KODE FOR Å SE OM VI HAR FÅTT RAPPORTERT  */00003830
 /* INNTEKT = 0                                                       */00003840
 /* ***************************************************************** */00003850
                                                                        00003860
          IF ÅR_FØR_UFØRHET            > 66     THEN                    00003870
             IF B01.PINNTEKT.PI_KODE(                                   00003880
                               SØKER_IND,ÅR_FØR_UFØRHET) = ' ' !        00003890
                B01.PINNTEKT.PI_KODE(                                   00003900
                               SØKER_IND,ÅR_FØR_UFØRHET) = 'F' THEN     00003910
                DO;                                                     00003920
                   IF U2S.PI > 0 THEN                                   00003930
                      DO;                                               00003940
                         B02.PI_KODE(SØKER_IND,ÅR_FØR_UFØRHET) = 'F';   00003950
                         B02.PI(SØKER_IND,ÅR_FØR_UFØRHET) =             00003960
                                                           U2S.PI / 100;00003970
                      END;                                              00003980
                END;                                                    00003990
                                                                        00004000
 /* ***************************************************************** */00004010
 /* UFØREHISTORIKK                                                    */00004020
 /* ***************************************************************** */00004030
    DO I = 1 TO 7;        /*0697 HL*/                                   00004040
       IF (B01.UFØRHIST.UFT_ÅM(SØKER_IND,I) = F_SNU_DATO(U2S.UFT_MÅ))   00004050
          THEN                                                          00004060
 /* ***************************************************************** */00004070
 /* D.V.S VI HAR EN PERIODE FRA FØR MED SAMME UFTIDSPUNKT             */00004080
 /* ***************************************************************** */00004090
                                                                        00004100
         DO;                                                            00004110
            DIV_PARAM_OMR.REGN_1291 = ' ';    /*HL*/                    00004120
                                                                        00004130
            UF_IND = I;                                                 00004140
            B02.UFØRHIST.UFG(SØKER_IND,I)= U2S.UFG;                     00004150
                                                                        00004160
 /*HL : UFKRIT BLE ALLTID SATT > 0 FOR YRKESSKADDE - RETTET 2.4.91*/    00004170
                                                                        00004180
            IF U2S.VILKÅR_8_4_3A = 'J' THEN                             00004190
               IF U2S.YSKADE_TILLEGG = 'J' THEN                         00004200
                  IF U2Y.KAP_11_7_UTLØST = 'J'    THEN                  00004210
                     B02.UFKRITERIER(SØKER_IND,I) = 5;                  00004220
                  ELSE                                                  00004230
                     B02.UFKRITERIER(SØKER_IND,I) = 4;                  00004240
               ELSE                                                     00004250
                  B02.UFKRITERIER(SØKER_IND,I) = 2;                     00004260
            ELSE                                                        00004270
               B02.UFKRITERIER(SØKER_IND,I) = 0;                        00004280
            IF B01.BUP_GAR_KODE(SØKER_IND,I) = 'A' THEN                 00004290
               DO;                                                      00004300
                  IF HJ_VIRK_DATO_ÅM >= TJUEÅRSDATO  THEN               00004310
                     B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';               00004320
               END;                                                     00004330
            B02.UFØRHIST.OPPHØRSDATO_ÅM(SØKER_IND,UF_IND) = 0;          00004340
            B02.UFØRHIST.OPPHØRSKODE   (SØKER_IND,UF_IND) = ' ';        00004350
            I = 7;            /*0697 HL*/                               00004360
         END;                                                           00004370
 /*   END;                                                        */    00004380
 /*         DO I = 1 TO 7;                                        */    00004390
      ELSE     IF B01.UFØRHIST.UFT_ÅM(SØKER_IND,I) = 0 THEN             00004400
                  DO;                                                   00004410
                                                                        00004420
 /* ***************************************************************** */00004430
 /* D.V.S. FINNER FØRSTE LEDIGE PLASS.                                */00004440
 /* ***************************************************************** */00004450
                                                                        00004460
                     UF_IND = I;                                        00004470
                     B02.UFØRHIST.UFT_ÅM(SØKER_IND,I) =                 00004480
                                                F_SNU_DATO(U2S.UFT_MÅ); 00004490
                     B02.UFØRHIST.UFG(SØKER_IND,I) = U2S.UFG;           00004500
                                                                        00004510
 /*HL : UFKRIT BLE ALLTID SATT > 0 FOR YRKESSKADDE - RETTET 2.4.91*/    00004520
                                                                        00004530
                     IF U2S.VILKÅR_8_4_3A = 'J' THEN                    00004540
                        IF U2S.YSKADE_TILLEGG = 'J' THEN                00004550
                           IF U2Y.KAP_11_7_UTLØST = 'J'    THEN         00004560
                              B02.UFKRITERIER(SØKER_IND,I) = 5;         00004570
                           ELSE                                         00004580
                              B02.UFKRITERIER(SØKER_IND,I) = 4;         00004590
                        ELSE                                            00004600
                           B02.UFKRITERIER(SØKER_IND,I) = 2;            00004610
                     ELSE;                                              00004620
                                                                        00004630
 /* ***************************************************************** */00004640
 /* DETT ER FØRSTE PERIODE : 9708 HL :                                */00004650
 /* ***************************************************************** */00004660
                                                                        00004670
                     IF UF_IND = 1 THEN                                 00004680
                        CALL UNGE_UFØRE;                                00004690
                                                                        00004700
 /* ***************************************************************** */00004710
 /* DET FINNES EN FORRIGE PERIODE                                     */00004720
 /* ***************************************************************** */00004730
                                                                        00004740
                     ELSE                                               00004750
                        DO;                                             00004760
                           IF B02.UFØRHIST.OPPHØRSDATO_ÅM(              00004770
                              SØKER_IND,UF_IND - 1 ) >                  00004780
                                        F_SNU_DATO(U2S.UFT_MÅ) THEN     00004790
                           DO;                                          00004800
                                                                        00004810
 /* ***************************************************************** */00004820
 /* FEIL, UFØRETIDSPUNKTET LIGGER FØR OPPHØRSTIDSPUNKTET.             */00004830
 /* ***************************************************************** */00004840
                                                                        00004850
  L265:                                                                 00004860
                              FEIL_VED_LABEL = '265';                   00004870
                              FEIL_MELD_NR   = 1719;                    00004880
                              GO TO RETUR;                              00004890
                           END;                                         00004900
                                                                        00004910
 /* ***************************************************************** */00004920
 /* HER OVERFØRES BUP-GARANTI OG KODE FRA FORRIGE PERIODE             */00004930
 /* ***************************************************************** */00004940
                                                                        00004950
                           B02.BUP_GARANTI(SØKER_IND,I) =               00004960
                                    B02.BUP_GARANTI(SØKER_IND,(I-1));   00004970
                           B02.BUP_GAR_KODE(SØKER_IND,I) =              00004980
                                   B02.BUP_GAR_KODE(SØKER_IND,(I-1));   00004990
                           END;                                         00005000
                                                                        00005010
                        I = 7;         /*0697 HL*/                      00005020
                  END;                                                  00005030
               ELSE                                                     00005040
                  DO;                                                   00005050
                                                                        00005060
 /* ***************************************************************** */00005070
 /* ALLE UFØREPERIODENE ER UTFYLT                                     */00005080
 /* ***************************************************************** */00005090
                                                                        00005100
                    IF I = 7 THEN        /*0697 HL*/                    00005110
                       DO;                                              00005120
                                                                        00005130
 /* ***************************************************************** */00005140
 /* FEIL, ALLE UFØREPERIODENE ER UTFYLT, IKKE PLASS TIL EN TIL        */00005150
 /* ***************************************************************** */00005160
                                                                        00005170
  L270:                                                                 00005180
                          FEIL_VED_LABEL = '270';                       00005190
                          FEIL_MELD_NR   = 1715;                        00005200
                          GO TO RETUR;                                  00005210
                       END;                                             00005220
                  END;                                                  00005230
            END;                                                        00005240
                                                                        00005250
              /* NY 93 */                                               00005260
    IF B02.BOSATT(SØKER_IND)         > 0 &                      /*93*/  00005270
       B02.VIRK_DATO_ÅM(SØKER_IND)   > 9212 &                   /*93*/  00005280
       B02.PENSJONSTRYGDET(SØKER_IND) ^= 'J' &                  /*93*/  00005290
      (B02.UFØRHIST.BUP_GAR_KODE(SØKER_IND,1) = 'B'   !         /*93*/  00005300
       B02.UFØRHIST.BUP_GAR_KODE(SØKER_IND,1) = 'E')  THEN      /*93*/  00005310
         DO;                                                    /*93*/  00005320
            DO M = 1 TO 7;            /*0697 HL*/                       00005330
             B02.BUP_GAR_KODE(SØKER_IND,M) = ' ';                /*93*/ 00005340
             B02.BUP_GARANTI(SØKER_IND,M) = 0;                  /*93*/  00005350
            END;                                                /*93*/  00005360
          IF B02.UFØRPENS.STI(SØKER_IND) > 0 THEN               /*93*/  00005370
     L271:                                                              00005380
              DO;                                                       00005390
                  FEIL_VED_LABEL = '271';                               00005400
                  FEIL_MELD_NR   =  386;                                00005410
                  GO TO RETUR;                                          00005420
              END;                                                      00005430
         END;                                                           00005440
 /* ***************************************************************** */00005450
 /* EKTEFELLES STATUS                                                 */00005460
 /* ***************************************************************** */00005470
                                                                        00005480
    IF B02.FNR(EKTEF_IND) > 0 THEN                                      00005490
       DO;                                                              00005500
          B02.SIVILSTAND(EKTEF_IND)   = B02.SIVILSTAND(SØKER_IND);      00005510
          B02.NAVN      (EKTEF_IND)   = B02.NAVN(EKTEF_IND);            00005520
          B02.SPRÅK     (EKTEF_IND)   = B02.SPRÅK(SØKER_IND);           00005530
          B02.VIRK_DATO_ÅM(EKTEF_IND) = F_SNU_DATO(U2S.VIRK_DATO_MÅ);   00005540
          /* KS 5/6-84 */                                               00005550
          IF U2S.MINST4G = 'J' THEN                                     00005560
             B02.PENSJONSTYPE2  (EKTEF_IND) = 'M';                      00005570
          ELSE                                                          00005580
             B02.PENSJONSTYPE2  (EKTEF_IND) = 'U';                      00005590
          B02.PENSJONSTYPE3  (EKTEF_IND) = ' ';                         00005600
          B02.SUM_YTELSE     (EKTEF_IND) = 0;                           00005610
          /* ENDRET 22/10-84 AV KARIN */                                00005620
          B02.FØRSTE_GANG_REG(EKTEF_IND) =                              00005630
          B02.FØRSTE_GANG_REG(SØKER_IND);                               00005640
  /*0296 HL : */                                                        00005650
          IF B01.STATUS_KODE_HIST(EKTEF_IND) = 'X'  THEN                00005660
             B02.FØRSTE_GANG_REG(EKTEF_IND) = 'N';                      00005670
                                                                        00005680
          IF U2S.TILL_EK = 'J' THEN                                     00005690
             DO;                                                        00005700
                B02.STATUS.PENSJONSTYPE1(EKTEF_IND) = 'F';              00005710
                B02.STATUS.PENSJONSTYPE2(EKTEF_IND) = ' ';              00005720
              END;                                                      00005730
          ELSE                                                          00005740
             B02.STATUS.PENSJONSTYPE1(EKTEF_IND) = 'G';                 00005750
        END;                                                            00005760
                                                                        00005770
    IF U2S.ATT_UF = 'A' THEN                                            00005780
       IF (B01.PENSJONSTYPE1(SØKER_IND)    = 'U' !                      00005790
           B01.PENSJONSTYPE1(SØKER_IND)    = 'Y')  &                    00005800
          B01.PENSJONSTYPE3(SØKER_IND)   ^= 'A'    &                    00005810
          B01.VIRK_DATO_ÅM(SØKER_IND)    ^=                             00005820
          F_SNU_DATO(U2S.VIRK_DATO_MÅ)          &                       00005830
          B01.STATUS_KODE_HIST(SØKER_IND) = ' ' THEN                    00005840
          DO;                                                           00005850
                                                                        00005860
 /* ***************************************************************** */00005870
 /* FEIL,SØKEREN HAR UFØRPENSJON FRA FØR.                             */00005880
 /* ***************************************************************** */00005890
                                                                        00005900
  L275:                                                                 00005910
             FEIL_VED_LABEL = '275';                                    00005920
             FEIL_MELD_NR   = 1717;                                     00005930
             GO TO RETUR;                                               00005940
          END;                                                          00005950
       ELSE                                                             00005960
  /* DENNE TESTEN ER BEGRENSET I FORB. MED FRAPP. 274. ERIK 16.1.86 */  00005970
          IF B01.PENSJONSTYPE3(SØKER_IND) = 'A'     &                   00005980
             (B01.PENSJONSTYPE1(SØKER_IND)   ^= 'U' &                   00005990
              B01.PENSJONSTYPE1(SØKER_IND)   ^= 'Y') &                  00006000
        /*   B01.VIRK_DATO_ÅM(SØKER_IND)    ^=                          00006010
             F_SNU_DATO(U2S.VIRK_DATO_MÅ)          THEN */              00006020
             B01.STATUS_KODE_HIST(SØKER_IND) = ' ' THEN                 00006030
             DO;                                                        00006040
                                                                        00006050
 /* ***************************************************************** */00006060
 /* FEIL,SØKEREN HAR ATTFØRING FRA FØR.                               */00006070
 /* ***************************************************************** */00006080
                                                                        00006090
 L277:                                                                  00006100
                FEIL_VED_LABEL = '277';                                 00006110
                FEIL_MELD_NR   = 1718;                                  00006120
                GO TO RETUR;                                            00006130
             END;                                                       00006140
          ELSE                                                          00006150
             B02.PENSJONSTYPE3(SØKER_IND) = 'A';                        00006160
                                                                        00006170
  RETUR:                                                                00006180
  END OPPRETT_STATUS_U2_SØKER;                                          00006190
