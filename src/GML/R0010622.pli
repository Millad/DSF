 /*       SIST ENDRET 13/03-98 13.33.52 AV   JDA7339                  */00000000
 /*       SIST ENDRET 13/03-98 13.19.14 AV   JDA7339                  */00000010
 /*       SIST ENDRET 05/12-97 12.28.31 AV   JDA7339                  */00000020
 /*       SIST ENDRET 27/11-97 10.58.51 AV   JDA7339                  */00000030
 /*       SIST ENDRET 29/08-97 12.03.04 AV   JDA7339                  */00000040
 /*       SIST ENDRET 29/08-97 11.07.07 AV   HLA7339                  */00000050
 /*       SIST ENDRET 28/07-97 12.32.40 AV   HLA7339                  */00000060
 /*       SIST ENDRET 16/05-97 10.50.39 AV   JDA7339                  */00000070
 /*       SIST ENDRET 09/10-96 11.37.56 AV   JDA0310                  */00000080
 /*       SIST ENDRET 04/03-96 12.50.49 AV   JDA0310                  */00000090
 /*       SIST ENDRET 29/03-95 14.43.51 AV   JDA0310                  */00000100
 /*       SIST ENDRET 17/11-94 12.05.26 AV   JDA0310                  */00000110
 /*       SIST ENDRET 25/02-94 12.22.35 AV   HERMAN                   */00000120
 /*       SIST ENDRET 23/09-93 13.04.06 AV   DYBVIK                   */00000130
 /*       SIST ENDRET 12/06-92 13.51.25 AV   TRUDE                    */00000140
 /*       SIST ENDRET 01/08-91 14.15.17 AV   DYBVIK                   */00000150
 /*       SIST ENDRET 14/06-91 13.24.40 AV   DYBVIK                   */00000160
 /*       SIST ENDRET 26/04-91 11.44.48 AV   DYBVIK                   */00000170
 /*       SIST ENDRET 02/04-91 09.54.18 AV   DYBVIK                   */00000180
 /*       SIST ENDRET 05/02-91 11.59.23 AV   DYBVIK                   */00000190
 /*       SIST ENDRET 12/11-90 13.13.55 AV   DYBVIK                   */00000200
 /*       SIST ENDRET 31/07-90 13.36.22 AV   DYBVIK                   */00000210
 /*       SIST ENDRET 13/03-90 10.09.27 AV   DYBVIK                   */00000220
 /*       SIST ENDRET 18/01-90 08.36.16 AV   DYBVIK                   */00000230
 /*       SIST ENDRET 02/11-89 08.36.15 AV   DYBVIK                   */00000240
 /*       SIST ENDRET 20/07-89 12.47.20 AV   DYBVIK                   */00000250
 /*       SIST ENDRET 02/06-89 15.42.18 AV   DYBVIK                   */00000260
 /*       SIST ENDRET 14/04-89 13.35.03 AV   HERMAN                   */00000270
 /*       SIST ENDRET 26/05-87 08.11.19 AV   DYBVIK                   */00000280
 /*       SIST ENDRET 11/03-87 14.38.44 AV   DYBVIK                   */00000290
 /*       SIST ENDRET 12/06-86 11.30.28 AV   FARVIK                   */00000300
 /*       SIST ENDRET 17/01-86 08.56.14 AV   TASSEN                   */00000310
 /*       SIST ENDRET 05/12-85 15.28.22 AV   FARVIK                   */00000320
 /*       SIST ENDRET 30/10-85 15.09.17 AV   HERMAN                   */00000330
 /* ***************************************************************** */00000340
 /*IDENTIFIKASJON:                                                    */00000350
 /*    R0010622 - PROSEDYRE I PLI                                     */00000360
 /*    PROGRAMMERER: JAN, OKTOBER 1981                                */00000370
 /* *****************************************                         */00000380
 /*ENDRINGSDATO : 31/1-84                                             */00000390
 /*ENDRINGEN GJELDER :                                                */00000400
 /*    OPPDATERING AV UFKRIT NÅR SAMME UFØRETIDSPUNKT SOM TIDLIGERE   */00000410
 /*    RAPPORTERT. FELTET BLE IKKE JUSTERT NÅR VILKÅR8_4 = N, BARE    */00000420
 /*    NÅR = J.                                                       */00000430
 /*ENDRINGEN UTFØRT AV KARIN                                          */00000440
 /* ********************************************************          */00000450
 /*ENDRINGSDATO : 5/6-84                                              */00000460
 /*ENDRINGEN GJELDER :                                                */00000470
 /*    REDUSERT BARNETILLEGG MED VIRKNING FRA 1/7-84                  */00000480
 /*    DET INNFØRES OPPLYSNINGER OM EKTEFELLENS INNTEKT I             */00000490
 /*    EKTEFELLENS PENSJONSKODE2.(BARE PT2(EK) = G)                   */00000500
 /*    PENSJONSKODE2(EKTEF) SETTES LIK 'M' NÅR INNT >= 4G.            */00000510
 /*    PENSJONSKODE2(EKTEF) SETTES LIK 'U' NÅR INNT <  4G.            */00000520
 /*ENDRINGEN BLE UTFØRT AV KARIN                                      */00000530
 /* ********************************************************          */00000540
 /*ENDRINGSDATO : 18/1-85                                             */00000550
 /*ENDRINGEN GJELDER :                                                */00000560
 /*    BARNEPENSJONISTER SOM BLE UFØRE FIKK IKKE MED UFØREPENSJONEN.  */00000570
 /*    DETTE SKYLTES AT PENSJONSTYPE3 ALLTID BLE SATT TIL BLANK NÅR   */00000580
 /*    DET IKKE VAR ET ATTFØRINGSTILFELLE.                            */00000590
 /*ENDRINGEN BLE UTFØRT AV KARIN                                      */00000600
 /* ********************************************************          */00000610
 /*ENDRINGSDATO : SOMMEREN 1987.  ERIK.                               */00000620
 /*ENDRINGEN GJELDER :                                                */00000630
 /*    UTVIDELSE AV TESTER I FORBINDELSE MED INNBAKING AV             */00000640
 /*    YRKESSKADEPENSJON I SYSTEMET.                                  */00000650
 /* *********************************************************         */00000660
 /*HENSIKT:                                                           */00000670
 /*    PROSEDYREN AJOURFØRER SØKERS PENSJONSSTATUS MED INFO FRA TRANS */00000680
 /*    UFØREPENSJON.                                                  */00000690
 /* ****************************************************************  */00000700
 /*PROGRAMTILKNYTNING:                                                */00000710
 /*    PROSEDYREN INCLUDES I R0010620.                                */00000720
 /*BRUK:                                                              */00000730
 /*    CALL AJOURFØR_B02_MED_UPTRANS                                  */00000740
 /*                                                                   */00000750
 /* ***************************************************************** */00000760
                                                                        00000770
 %SKIP(2);                                                              00000780
 AJOURFØR_B02_MED_UPTRANS:                                              00000790
   PROC OPTIONS(REENTRANT);                                             00000800
   PROGRAM_ID = 'R0010622';    /* LETTER FEILSØK, MHA7339, 171296 */    00000810
                                                                        00000820
 %SKIP;                                                                 00000830
   DCL                                                                  00000840
      UF_IND           FIXED BIN(15),                                   00000850
 /*YS*/ YUF_IND        FIXED BIN(15),                                   00000860
      J                FIXED BIN(15),                                   00000870
      K                FIXED BIN(15),                                   00000880
      ÅR_FØR_UFØRHET   PIC '99';                                        00000890
   DCL                                                                  00000900
      HJ_UFT_MÅ                     PIC '9999',                         00000910
      HJ_UFT_M DEF HJ_UFT_MÅ POS(1) PIC '99',                           00000920
      HJ_UFT_Å DEF HJ_UFT_MÅ POS(3) PIC '99';                           00000930
                                                                        00000940
    IF HJ_VIRK_DATO_ÅM < 9802                 THEN                      00000950
       B02.PENSJON_FØR_9802(SØKER_IND) = 'J';                           00000960
                                                                        00000970
    B02.NAVN(SØKER_IND)            = UPS.NAVN;                          00000980
    B02.SPRÅK(SØKER_IND)           = UPS.SPRÅK;                         00000990
    B02.TKNR(SØKER_IND)            = UPS.TKNR;                          00001000
                                                                        00001010
    IF UPS.YRKE                    > 0   THEN          /*TS171094*/     00001020
       B02.YRKES_KODE(SØKER_IND)   = UPS.YRKE;                          00001030
                                                                        00001040
                                                                        00001050
    IF F_SNU_DATO(UPS.UFT_MÅ) < 9100         THEN        /*HL*/         00001060
       B02.PENSJONSRETT_FØR_91(SØKER_IND) = 'J';                        00001070
                                                                        00001080
    B02.FØRSTE_GANG_REG(SØKER_IND) = 'N';                               00001090
    DO I = 1 TO 13;                                                     00001100
       IF B02.FNR(I) > 0 THEN                                           00001110
          B02.FØRSTE_GANG_REG(I) = 'N';                                 00001120
    END;                                                                00001130
                                                                        00001140
 /* ***************************************************************** */00001150
 /* YTELSE_SEGMENTET                                                  */00001160
 /* ***************************************************************** */00001170
                                                                        00001180
 %SKIP;                                                                 00001190
    IF B01.PENSJONSTYPE1(SØKER_IND) = 'N' !                             00001200
                           B01.PENSJONSTYPE1(SØKER_IND) = 'B' THEN      00001210
       B02.PENSJONSTYPE3(SØKER_IND) = 'U';                              00001220
    /*    PT1 ER UENDRET                                              */00001230
    ELSE                                                                00001240
       B02.PENSJONSTYPE1(SØKER_IND) = 'U';                              00001250
                                                                        00001260
  L270:                                                                 00001270
 /*YS*/  IF UPY.KAP_11_7_UTLØST          = 'J'   &   /*TRUDE, 31.5.89*/ 00001280
 /*YS*/     B01.PENSJONSTYPE1(SØKER_IND) = 'F'   THEN                   00001290
 /*YS*/       DO;                                                       00001300
 /*YS*/         FEIL_VED_LABEL           = '270';                       00001310
 /*YS*/         FEIL_MELD_NR             = '1732';                      00001320
 /*YS*/       END;                                                      00001330
                                                                        00001340
                                                                        00001350
 /*YS*/   IF UPS.YSKADE_TILLEGG           = 'J'  !                      00001360
 /*YS*/      B01.PENSJONSTYPE1(SØKER_IND) = 'Y'     THEN                00001370
 /*YS*/      B02.PENSJONSTYPE1(SØKER_IND) = 'Y';                        00001380
                                                                        00001390
 /*YS*/    IF UPS.ATT_UF = 'A' THEN                                     00001400
 /*YS*/       IF (B01.PENSJONSTYPE1(SØKER_IND)     = 'U' !              00001410
 /*YS*/           B01.PENSJONSTYPE1(SØKER_IND)     = 'Y' ) &            00001420
 /*YS*/          B01.PENSJONSTYPE3(SØKER_IND)    ^= 'A' &               00001430
                                                                        00001440
          B01.STATUS_KODE_HIST(SØKER_IND)  = ' ' THEN                   00001450
          DO;                                                           00001460
                                                                        00001470
             IF  (STATUS_TYPE = 'B' !                                   00001480
                 STATUS_TYPE = 'I')  &                                  00001490
                 TRANS_LISTE_INDEX = 1  THEN                            00001500
 /* ***************************************************************** */00001510
 /* FEIL,SØKEREN HAR UFØRPENSJON FRA FØR.                             */00001520
 /* ***************************************************************** */00001530
                 DO;                                                    00001540
  L275:                                                                 00001550
                    FEIL_VED_LABEL = '275';                             00001560
                    FEIL_MELD_NR   = 1717;                              00001570
                    GO TO RETUR;                                        00001580
                 END;                                                   00001590
 /* ***************************************************************** */00001600
 /* SØKEREN HAR ATTFØRING FRA FØR.TRANHIST BLIR DA FJERNET.           */00001610
 /* ***************************************************************** */00001620
             ELSE                                                       00001630
                 DO;                                                    00001640
                                                                        00001650
                                                                        00001660
                    SEARCH_FNR                  =                       00001670
                                   TRANS_OPPL_OMR.FØDSNUMMER        ;   00001680
                                                                        00001690
                                                                        00001700
                    FJERN_ALLE                  = '0'B              ;   00001710
                                                                        00001720
                                                                        00001730
                    EXEC CICS LINK PROGRAM                              00001740
                               ('R0015501') COMMAREA(LOKAL_KOM_OMR) ;   00001750
                                                                        00001760
                    IF FEIL_MELD_NR > 0 THEN                            00001770
                       GO TO RETUR                                  ;   00001780
                                                                        00001790
                                                                        00001800
  /*9712 HL - FJERNET FOR Å RETTE FEIL NR. 3 : *************            00001810
                    ANTALL_TRANS_I_TRANS_LISTE =                        00001820
                                      ANTALL_TRANS_I_TRANS_LISTE - 1;   00001830
   *********************************************************** */       00001840
                                                                        00001850
                 END;                                                   00001860
          END;                                                          00001870
       ELSE                                                             00001880
  /* DENNE TESTEN ER BEGRENSET I FORB. MED FEILM.274. ERIK 16.1.86 */   00001890
 /*YS*/          IF B01.PENSJONSTYPE3(SØKER_IND) = 'A'  &               00001900
 /*YS*/             (B01.PENSJONSTYPE1(SØKER_IND)    ^= 'Y' &           00001910
                     B01.PENSJONSTYPE1(SØKER_IND)    ^= 'U' ) &         00001920
               /*   B01.VIRK_DATO_ÅM(SØKER_IND)     ^=                  00001930
                    F_SNU_DATO(UPS.VIRK_DATO_MÅ)           THEN  */     00001940
                    B01.STATUS_KODE_HIST(SØKER_IND)  = ' ' THEN         00001950
                 DO;                                                    00001960
                                                                        00001970
 /* ***************************************************************** */00001980
 /* FEIL,SØKEREN HAR ATTFØRING FRA FØR.                               */00001990
 /* ***************************************************************** */00002000
                                                                        00002010
  L277:                                                                 00002020
                FEIL_VED_LABEL = '277';                                 00002030
                FEIL_MELD_NR   = 1718;                                  00002040
                GO TO RETUR;                                            00002050
             END;                                                       00002060
          ELSE                                                          00002070
             B02.PENSJONSTYPE3(SØKER_IND) = 'A';                        00002080
    ELSE                                                                00002090
       DO;                                                              00002100
          IF B01.PENSJONSTYPE3(SØKER_IND) = 'A' THEN                    00002110
             DO;                                                        00002120
                                                                        00002130
                DO I = 1 TO 7;               /*0697 HL*/                00002140
                   IF B01.UFØRHIST.UFT_ÅM(SØKER_IND,I) = 0 THEN         00002150
                      DO;                                               00002160
                         B00.UFØRHIST(SØKER_IND,I-1) =                  00002170
                                 B01.UFØRHIST(SØKER_IND,I-1);           00002180
                         B01.UFØRHIST(SØKER_IND,I-1) = '';              00002190
                         K = I - 1;                                     00002200
                         I = 8;                 /*0697 HL*/             00002210
                      END;                                              00002220
                END;                                                    00002230
             END;                                                       00002240
                                                                        00002250
 /* ***************************************************************** */00002260
 /* NYE FORS-TILL BARN SKAL IKKE REGISTRERES,BRUK F7-BL  (JD 7.91)    */00002270
 /* ***************************************************************** */00002280
                                                                        00002290
    IF UPS.BT_ANT > B01.ANTALL_BARN (SØKER_IND) &                       00002300
       HJ_VIRK_DATO_ÅM > 9104 THEN                                      00002310
                 DO;                                                    00002320
  L378:                                                                 00002330
                    FEIL_VED_LABEL = '378';                             00002340
                    FEIL_MELD_NR   = 1738;                              00002350
                    GO TO RETUR;                                        00002360
                 END;                                                   00002370
                                                                        00002380
 /* ENDRET 18/1-85 AV KARIN                                           */00002390
 /*YS*/   IF B02.PENSJONSTYPE1(SØKER_IND) = 'U' !                       00002400
 /*YS*/      B02.PENSJONSTYPE1(SØKER_IND) = 'Y' THEN                    00002410
             B02.PENSJONSTYPE3(SØKER_IND) = ' ';                        00002420
       END;                                                             00002430
 /* ***************************************************************** */00002440
 /* TIDLIGERE REGISTERT SOM ETTERLATT EKTEFELLE                       */00002450
 /* ***************************************************************** */00002460
                                                                        00002470
    IF B01.PENSJONSTYPE1(SØKER_IND) = 'E' THEN                          00002480
       B02.PENSJONSTYPE2(SØKER_IND) = 'E';                              00002490
                                                                        00002500
 /* ***************************************************************** */00002510
 /* HVIS SØKER HAR EKTEFELLE I TRANS                                  */00002520
 /* ***************************************************************** */00002530
                                                                        00002540
    IF UPS.FNR_EK > 0 THEN                                              00002550
       DO;                                                              00002560
          IF  UPS.SIVILSTAND               = 'A' THEN                   00002570
             DO;                                                        00002580
                B02.SIVILSTAND(SØKER_IND)      = 'A';                   00002590
                B02.SIVILSTAND(EKTEF_IND)      = 'A';                   00002600
             END;                                                       00002610
          ELSE                                                          00002620
          IF  UPS.SIVILSTAND               = 'P' THEN                   00002630
             DO;                                                        00002640
                B02.SIVILSTAND(SØKER_IND)      = 'P';                   00002650
                B02.SIVILSTAND(EKTEF_IND)      = 'P';                   00002660
             END;                                                       00002670
          ELSE                                                          00002680
          IF  UPS.SIVILSTAND               = 'W' THEN                   00002690
             DO;                                                        00002700
                B02.SIVILSTAND(SØKER_IND)      = 'W';                   00002710
                B02.SIVILSTAND(EKTEF_IND)      = 'W';                   00002720
             END;                                                       00002730
          ELSE                                                          00002740
          IF  UPS.SIVILSTAND               = 'V' THEN                   00002750
             DO;                                                        00002760
                B02.SIVILSTAND(SØKER_IND)      = 'V';                   00002770
                B02.SIVILSTAND(EKTEF_IND)      = 'V';                   00002780
             END;                                                       00002790
          ELSE                                                          00002800
             DO;                                                        00002810
                B02.SIVILSTAND(SØKER_IND)      = 'G';                   00002820
                B02.SIVILSTAND(EKTEF_IND)      = 'G';                   00002830
             END;                                                       00002840
                                                                        00002850
 /* ***************************************************************** */00002860
 /* HVIS FORSØRGINGSTILLEGG EKTEFELLE                                 */00002870
 /* PENSJONSTYPE1 FOR EKTEFELLEN OG PENSJONSTYPE2 FOR PENSJONISTEN    */00002880
 /* BLE GALT FOR YRKESKADEPENSJONER.  ENDRET 11.1.1990, ERIK.         */00002890
 /* ***************************************************************** */00002900
                                                                        00002910
          IF UPS.TILL_EK = 'J' & HJ_VIRK_DATO_ÅM > 9104 &               00002920
             B01.PENSJONSTYPE2(SØKER_IND) ^= 'F' THEN                   00002930
             UPS.TILL_EK = ' ' ; /* JD 7.91*/                           00002940
          IF UPS.TILL_EK = 'J' THEN /*TEST PÅ B01.ET FJERNET 7.90 JD */ 00002950
       /* IF UPS.TILL_EK = 'J' ! B01.UFØRPENS.ET(SØKER_IND)             00002960
                                                     > 0 THEN */        00002970
             DO;                                                        00002980
                B02.PENSJONSTYPE2(SØKER_IND)   = 'F';                   00002990
                IF UPS.UFG < 50 THEN                                    00003000
                 DO;                                                    00003010
                    B02.PENSJONSTYPE2(SØKER_IND)   = 'P';               00003020
                    B02.PENSJONSTYPE1(EKTEF_IND)   = 'G';               00003030
                    B02.PENSJONSTYPE2(EKTEF_IND)   = ' ';               00003040
                 END;                                                   00003050
               ELSE                                                     00003060
                 B02.PENSJONSTYPE1(EKTEF_IND)   = 'F';                  00003070
                 B02.PENSJONSTYPE2(EKTEF_IND)   = ' ';                  00003080
             END;                                                       00003090
          ELSE                                                          00003100
             DO;                                                        00003110
                                                                        00003120
 /* ***************************************************************** */00003130
 /* HVIS EKTEFELLEN HAR EGEN PENSJON                                  */00003140
 /* ***************************************************************** */00003150
 /*YS*/                                                                 00003160
                                                                        00003170
                IF  B01.PENSJONSTYPE1(EKTEF_IND)    = 'A' !             00003180
 /*YS*/             B01.PENSJONSTYPE1(EKTEF_IND)    = 'Y' !             00003190
 /*AFP*/            B01.PENSJONSTYPE1(EKTEF_IND)    = 'K' !             00003200
                    B01.PENSJONSTYPE1(EKTEF_IND)    = 'U' THEN          00003210
                                                                        00003220
 /* ***************************************************************** */00003230
 /* EKTEFELLEN HAR AVTALEFESTET PENSJON SOM IKKE UTBETALES            */00003240
 /* ***************************************************************** */00003250
                                                                        00003260
 /*AFP*/            IF B01.PENSJONSTYPE1(EKTEF_IND)    = 'K'  &         00003270
 /*AFP*/               B01.PENSJONSTYPE2(EKTEF_IND)    = 'N'  THEN      00003280
 /*AFP*/               DO;                                              00003290
 /*AFP*/                  B02.PENSJONSTYPE2(SØKER_IND)    = 'P';        00003300
 /*AFP*/                  B02.PENSJONSTYPE2(EKTEF_IND)    = 'N';        00003310
 /*AFP*/               END;                                             00003320
 /*AFP*/            ELSE                                                00003330
                       IF  UPS.SIVILSTAND               = 'A'   !       00003340
                           UPS.SIVILSTAND               = 'V' THEN      00003350
                          DO;                                           00003360
                             B02.PENSJONSTYPE2(SØKER_IND)   = 'P';      00003370
                             B02.PENSJONSTYPE2(EKTEF_IND)   = 'P';      00003380
                          END;                                          00003390
                       ELSE                                             00003400
                          DO;                                           00003410
          /*YS*/             IF UPY.KAP_11_7_UTLØST = 'J'  THEN         00003420
          /*YS*/                                                        00003430
          /*YS*/               DO;                                      00003440
          /*YS*/                B02.PENSJONSTYPE2(SØKER_IND) = ' ';     00003450
          /*YS*/                B02.PENSJONSTYPE2(EKTEF_IND) = 'P';     00003460
          /*YS*/               END;                                     00003470
          /*YS*/             ELSE                                       00003480
          /*YS*/               DO;                                      00003490
                             B02.PENSJONSTYPE2(SØKER_IND)   = 'S';      00003500
                             B02.PENSJONSTYPE2(EKTEF_IND)   = 'S';      00003510
                                                                        00003520
  /*AFP1093*/               IF B02.PENSJONSTYPE3(EKTEF_IND) = 'S' &     00003530
                               B02.PENSJONSTYPE2(EKTEF_IND) ^= 'N' THEN 00003540
                                  B02.PENSJONSTYPE2(SØKER_IND)   = 'P'; 00003550
                               END;                                     00003560
                          END;                                          00003570
                ELSE                                                    00003580
                   DO;                                                  00003590
                                                                        00003600
 /* ***************************************************************** */00003610
 /* EKTEFELLEN HAR IKKE PENSJON                                       */00003620
 /* ***************************************************************** */00003630
                                                                        00003640
    /*YS*/             IF UPY.KAP_11_7_UTLØST = 'J'  THEN               00003650
    /*YS*/                B02.PENSJONSTYPE2(SØKER_IND) = ' ';           00003660
    /*YS*/             ELSE                                             00003670
                          B02.PENSJONSTYPE2(SØKER_IND)   = 'P';         00003680
                      B02.PENSJONSTYPE1(EKTEF_IND)   = 'G';             00003690
                      IF UPS.EK_INNT = 'J' THEN                         00003700
                         B02.PENSJONSTYPE2(EKTEF_IND)   = 'M';          00003710
                      ELSE                                              00003720
                         B02.PENSJONSTYPE2(EKTEF_IND)   = 'U';          00003730
                   END;                                                 00003740
            END;                                                        00003750
            B02.NAVN(EKTEF_IND)            = UPS.NAVN_EK;               00003760
            B02.SPRÅK(EKTEF_IND)           = UPS.SPRÅK;                 00003770
                                                                        00003780
 /* ***************************************************************** */00003790
 /* TILKN-KODE TIL EKTEFELLENE OPPDATERES MED RESPEKTIVE NYE STATUSER.*/00003800
 /* ***************************************************************** */00003810
                                                                        00003820
            DO I = 1 TO 13;                                             00003830
               IF (B02.FNR_TILKN(SØKER_IND,I)=                          00003840
                                        B02.FNR(EKTEF_IND))THEN         00003850
                  DO;                                                   00003860
                     B02.TILKN.TILKNYTNINGSKODE(SØKER_IND,I)            00003870
                                  =  B02.PENSJONSTYPE1(EKTEF_IND);      00003880
                     I=13;                                              00003890
                  END;                                                  00003900
            END;                                                        00003910
            DO I = 1 TO 13;                                             00003920
               IF (B02.FNR_TILKN(EKTEF_IND,I)=                          00003930
                                        B02.FNR(SØKER_IND))THEN         00003940
                  DO;                                                   00003950
                     B02.TILKNYTNINGSKODE(EKTEF_IND,I)                  00003960
                            =  B02.PENSJONSTYPE1(SØKER_IND);            00003970
  /*HL*/             B02.FT_FØR_91(EKTEF_IND,I) = ' ';                  00003980
                     I=13;                                              00003990
                  END;                                                  00004000
            END;                                                        00004010
       END;                                                             00004020
    ELSE                                                                00004030
                                                                        00004040
 /* **************************************************************** */ 00004050
 /* SØKER HAR IKKE EKTEFELLE                                         */ 00004060
 /* **************************************************************** */ 00004070
                                                                        00004080
       IF ^(B01.PENSJONSTYPE1(SØKER_IND) = 'N' !                        00004090
            B01.PENSJONSTYPE1(SØKER_IND) = 'E' !                        00004100
            B01.PENSJONSTYPE1(SØKER_IND) = 'B')    &                    00004110
          B01.PENSJONSTYPE2(SØKER_IND)  ^= 'E'         THEN             00004120
                                                                        00004130
    /*YS*/             IF UPY.KAP_11_7_UTLØST = 'J'  THEN               00004140
    /*YS*/                B02.PENSJONSTYPE2(SØKER_IND) = ' ';           00004150
    /*YS*/             ELSE                                             00004160
          B02.PENSJONSTYPE2(SØKER_IND) = 'P';                           00004170
                                                                        00004180
 /* ***************************************************************** */00004190
 /* UFØREPENSJON                                                      */00004200
 /* ***************************************************************** */00004210
                                                                        00004220
    B02.UFØRPENS.UFG(SØKER_IND)           = UPS.UFG;                    00004230
    B02.UFØRPENS.VILKÅR_8_4_3A(SØKER_IND) = UPS.VILKÅR_8_4;             00004240
    B02.VILKÅR_8_1B(SØKER_IND)            = UPS.VILKÅR_8_1;             00004250
                                                                        00004260
                                                                        00004270
 /* ***************************************************************** */00004280
 /* TRYGDETID                                                         */00004290
 /* ***************************************************************** */00004300
                                                                        00004310
    B02.STATUS.TT_FØR_1967(SØKER_IND) = UPSP.TT_F67;                    00004320
    B02.TT_ETTER_1966(SØKER_IND)      = UPSP.TT_E66_Å * 12 +            00004330
                                        UPSP.TT_E66_M;                  00004340
                                                                        00004350
    HJ_UFT_MÅ      = UPS.UFT_MÅ;                                        00004360
                                                                        00004370
    IF HJ_UFT_Å > 72 THEN                                               00004380
       B02.STATUS.TT_FRAMT(SØKER_IND)    =                              00004390
                                (ALDER_67.ÅR * 12 + ALDER_67.MND) -     00004400
                                             (HJ_UFT_Å * 12 + HJ_UFT_M);00004410
    ELSE                                                                00004420
       B02.STATUS.TT_FRAMT(SØKER_IND)    =                              00004430
                                (ALDER_70.ÅR * 12 + ALDER_70.MND) -     00004440
                                             (HJ_UFT_Å * 12 + HJ_UFT_M);00004450
                                                                        00004460
 /* ***************************************************************** */00004470
 /* HVIS SPESIELLE OPPLYSNINGER                                       */00004480
 /* ***************************************************************** */00004490
                                                                        00004500
    IF UPS.NORSK_BOSATT = 'N' ! UPS.VILKÅR_8_1 = 'N' THEN               00004510
       DO;                                                              00004520
          B02.SPESOPPL.STATSBORGER(SØKER_IND) = UPSP.                   00004530
                                                           STATSBORGER; 00004540
          B02.SPESOPPL.BOSATT(SØKER_IND)      = UPSP.BOSATT;            00004550
          B02.FRAVIK_BOSATT(SØKER_IND)        = UPSP.                   00004560
                                                         FRAVIK_BOSATT; 00004570
          B02.SPESOPPL.FRAVIK_TRYGDET_3ÅR(SØKER_IND) =                  00004580
                                                      UPSP.FRA_TRY_3ÅR; 00004590
          B02.FRAVIK_8_1(SØKER_IND)       = UPSP.FRAVIK_8_1;            00004600
          B02.SPESOPPL.KONVENSJON(SØKER_IND) = UPSP.KONVENSJON; /*TS*/  00004610
          B02.SPESOPPL.FRAVIK_19_3(SØKER_IND)   = UPSP.                 00004620
                                                           FRAVIK_19_3; 00004630
          B02.SPESOPPL.FRAVIK_FLYKTN(SØKER_IND) =                       00004640
                                                     UPSP.FRAVIK_FLYKT; 00004650
          B02.SPESOPPL.OVERKOMP_UTL(SØKER_IND)  = UPSP.                 00004660
                                                          OVERKOMP_UTL; 00004670
          B02.UFØR_UNDER_BOTID(SØKER_IND)        = UPSP.                00004680
                                                          UFØR_U_BOTID; 00004690
          IF B02.STATUS.PENSJONSTYPE1(EKTEF_IND) = 'F' THEN             00004700
             DO;                                                        00004710
                B02.STATUS.TT_FØR_1967(EKTEF_IND) = UPSP.               00004720
                                                        TT_F67_EK;      00004730
                IF UPSP.TT_E66_Å_EK > 0 THEN                            00004740
                   B02.TT_ETTER_1966(EKTEF_IND) = UPSP.                 00004750
                                    TT_E66_M_EK + UPSP.TT_E66_Å_EK * 12;00004760
             END;                                                       00004770
          IF UPSP.TT_ETTER_UFT > 0 THEN                                 00004780
             DO;                                                        00004790
                B02.SPESOPPL.TT_FRAMT_UFT(SØKER_IND) =                  00004800
                                                      UPSP.TT_ETTER_UFT;00004810
                B02.STATUS.TT_FRAMT(SØKER_IND) =                        00004820
                                                      UPSP.TT_ETTER_UFT;00004830
             END;                                                       00004840
          ELSE                                                          00004850
             DO;                                                        00004860
                IF UPSP.TT_FRAMT_8_1_Å > 0 THEN                         00004870
                   DO;                                                  00004880
                      B02.SPESOPPL.TT_FRAMT_UFT(SØKER_IND) =            00004890
                                                     UPSP.TT_ETTER_UFT; 00004900
                      B02.STATUS.TT_FRAMT(SØKER_IND) =                  00004910
                                                    UPSP.TT_ETTER_UFT;  00004920
                   END;                                                 00004930
             END;                                                       00004940
          B02.IKKE_GP(SØKER_IND)      = UPSP.IKKE_GP;                   00004950
       END;                                                             00004960
    ELSE                                                                00004970
       B02.SPESOPPL(SØKER_IND) = '';                                    00004980
                                                                        00004990
 /* ***************************************************************** */00005000
 /* PENSJONSGIVENDE INNTEKT                                           */00005010
 /* ***************************************************************** */00005020
                                                                        00005030
 %SKIP;                                                                 00005040
    ÅR_FØR_UFØRHET = HJ_UFT_Å - 1;                                      00005050
                                                                        00005060
 /* ***************************************************************** */00005070
 /* HER MÅ VI TESTE PÅ EN KODE FOR Å SE OM VI HAR FÅTT RAPP. INNTEKT  */00005080
 /* ***************************************************************** */00005090
                                                                        00005100
    IF ÅR_FØR_UFØRHET            > 66     THEN                          00005110
       IF B01.PINNTEKT.PI_KODE(SØKER_IND,ÅR_FØR_UFØRHET) = ' ' !        00005120
          B01.PINNTEKT.PI_KODE(SØKER_IND,ÅR_FØR_UFØRHET) = 'F' THEN     00005130
          DO;                                                           00005140
             IF UPS.PI > 0 THEN                                         00005150
                DO;                                                     00005160
                   B02.PI_KODE(SØKER_IND,ÅR_FØR_UFØRHET) = 'F';         00005170
                   B02.PI(SØKER_IND,ÅR_FØR_UFØRHET)      =              00005180
                                                          UPS.PI / 100; 00005190
                END;                                                    00005200
          END;                                                          00005210
                                                                        00005220
 /* ***************************************************************** */00005230
 /* UFØREHISTORIKK                                                    */00005240
 /* ***************************************************************** */00005250
                                                                        00005260
 DO I = 1 TO 7;              /*0697 HL*/                                00005270
    SELECT;                                                             00005280
       WHEN (B01.UFØRHIST.UFT_ÅM(SØKER_IND,I) =  F_SNU_DATO(UPS.UFT_MÅ))00005290
                                                                        00005300
 /* ***************************************************************** */00005310
 /* D.V.S VI HAR EN PERIODE FRA FØR MED SAMME UFTIDSPUNKT             */00005320
 /* ***************************************************************** */00005330
                                                                        00005340
       DO;                                                              00005350
           DO J = 1 TO 7;    /*0697 HL*/                                00005360
              IF B02.UFG_ØVRIGE(SØKER_IND,I,J) > 0 THEN                 00005370
                 DO;                                                    00005380
                    B02.UFG_ØVRIGE(SØKER_IND,I,J) = 0;                  00005390
                    B02.UFG_DATO_ÅM(SØKER_IND,I,J) = 0;                 00005400
                 END;                                                   00005410
              ELSE                                                      00005420
                 J=7;        /*0697 HL*/                                00005430
            END;                                                        00005440
          UF_IND = I;                                                   00005450
          B02.UFØRHIST.UFG(SØKER_IND,I)= UPS.UFG;                       00005460
                                                                        00005470
 /*HL : UFKRIT FOR YRKESSKADDE BLE ALLTID SATT > 0 - RETTET 2.4.91*/    00005480
                                                                        00005490
          IF UPS.VILKÅR_8_4 = 'J' THEN                                  00005500
             IF UPS.YSKADE_TILLEGG = 'J' THEN                           00005510
                IF UPY.KAP_11_7_UTLØST = 'J'    THEN                    00005520
                   B02.UFKRITERIER(SØKER_IND,I) = 5;                    00005530
                ELSE                                                    00005540
                   B02.UFKRITERIER(SØKER_IND,I) = 4;                    00005550
             ELSE                                                       00005560
                B02.UFKRITERIER(SØKER_IND,I) = 2;                       00005570
          ELSE                                                          00005580
             B02.UFKRITERIER(SØKER_IND,I) = 0;                          00005590
          IF B01.BUP_GAR_KODE(SØKER_IND,I) = 'A' THEN                   00005600
             DO;                                                        00005610
                IF HJ_VIRK_DATO_ÅM >= TJUEÅRSDATO    &                  00005620
                   HJ_VIRK_DATO_ÅM > 8104           THEN                00005630
                   B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';                 00005640
             END;                                                       00005650
          I = 7;            /*0697 HL*/                                 00005660
       END;                                                             00005670
       WHEN (B01.UFØRHIST.UFT_ÅM(SØKER_IND,I) = 0)                      00005680
       DO;                                                              00005690
                                                                        00005700
 /* ***************************************************************** */00005710
 /* D.V.S. DETTE ER FØRSTE LEDIGE PLASS.                              */00005720
 /* ***************************************************************** */00005730
                                                                        00005740
          UF_IND = I;                                                   00005750
          B02.UFØRHIST.UFT_ÅM(SØKER_IND,I) = F_SNU_DATO(UPS.UFT_MÅ);    00005760
          B02.UFØRHIST.UFG(SØKER_IND,I)    = UPS.UFG;                   00005770
          IF UPS.VILKÅR_8_4 = 'J' THEN                                  00005780
             B02.UFKRITERIER(SØKER_IND,I) = 2;                          00005790
          IF UF_IND > 1 THEN                                            00005800
             DO;                                                        00005810
                                                                        00005820
 /* ***************************************************************** */00005830
 /* DET FINNES EN FORRIGE PERIODE SOM VI NÅ OPPHØRER                  */00005840
 /* ***************************************************************** */00005850
                                                                        00005860
                IF B01.OPPHØRSDATO_ÅM(SØKER_IND,(I-1)) = 0    THEN      00005870
                   DO;                                                  00005880
                      B02.OPPHØRSDATO_ÅM(SØKER_IND,(                    00005890
                                        I-1)) = F_SNU_DATO(UPS.UFT_MÅ); 00005900
                      B02.OPPHØRSKODE(SØKER_IND,(I-1)) = 'J';           00005910
                      DO J = 1 TO 7 WHILE            /*0697 HL*/        00005920
                         (B02.UFG_ØVRIGE(SØKER_IND,(I-1),J) > 0);       00005930
                         IF B02.UFG_DATO_ÅM(SØKER_IND,(I-1),J) =        00005940
                            B02.UFØRHIST.UFT_ÅM(SØKER_IND,I) THEN       00005950
                                       /* DET NYE UFØRETIDSPT ER LIK */ 00005960
                                       /* TIDSPT TIL SISTE UFØREGRAD */ 00005970
                                       /* I FORRIGE PERIODE OG MÅ    */ 00005980
                                       /* SLETTES                    */ 00005990
                            DO;                                         00006000
                               B02.UFG_ØVRIGE (SØKER_IND,(I-1),J) = 0;  00006010
                               B02.UFG_DATO_ÅM (SØKER_IND,(I-1),J) = 0; 00006020
                               B01.UFG_ØVRIGE (SØKER_IND,(I-1),J) = 0;  00006030
                               B01.UFG_DATO_ÅM (SØKER_IND,(I-1),J) = 0; 00006040
                            END;                                        00006050
                         ELSE                                           00006060
                            IF B02.UFG_DATO_ÅM(SØKER_IND,(I-1),J) >     00006070
                               B02.UFØRHIST.UFT_ÅM(SØKER_IND,I) THEN    00006080
                               DO;                                      00006090
 /* ***************************************************************** */00006100
 /* FEIL, UFØREDATO I FORRIGE PERIODE ER ETTER DET NYE UFØRETIDSPUNKT */00006110
 /* ***************************************************************** */00006120
                                                                        00006130
  L278:                                                                 00006140
                                   FEIL_VED_LABEL = '278';              00006150
                                   FEIL_MELD_NR   = 1711;               00006160
                                   GO TO RETUR;                         00006170
                               END;                                     00006180
                      END;  /* DO J = 1 TO 5 */                         00006190
                   END;                                                 00006200
                                                                        00006210
 /* ***************************************************************** */00006220
 /* HER OVERFØRES BUP-GARANTI OG KODE FRA FORRIGE PERIODE             */00006230
 /* ***************************************************************** */00006240
                                                                        00006250
                B02.BUP_GARANTI(SØKER_IND,I) =                          00006260
                                    B02.BUP_GARANTI(SØKER_IND,(I-1));   00006270
                B02.BUP_GAR_KODE(SØKER_IND,I) =                         00006280
                                   B02.BUP_GAR_KODE(SØKER_IND,(I-1));   00006290
                IF B02.BUP_GAR_KODE(SØKER_IND,I) = 'A'        THEN      00006300
                   DO;                                                  00006310
                      IF HJ_VIRK_DATO_ÅM >= TJUEÅRSDATO      &          00006320
                         HJ_VIRK_DATO_ÅM >  8104          THEN          00006330
                         B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';           00006340
                   END;                                                 00006350
                ELSE                                                    00006360
                IF B02.BUP_GAR_KODE(SØKER_IND,I) = 'C' THEN             00006370
                   DO;                                                  00006380
                      IF HJ_VIRK_DATO_ÅM > 8312 THEN                    00006390
                         B02.BUP_GAR_KODE(SØKER_IND,I) = 'B';           00006400
                   END;                                                 00006410
             END;                                                       00006420
          CALL UNGE_UFØRE; /*U623 - 9708 HL */                          00006430
          I = 7;               /*0697 HL*/                              00006440
       END;                                                             00006450
       OTHERWISE                                                        00006460
       DO;                                                              00006470
                                                                        00006480
 /* ***************************************************************** */00006490
 /* ALLE UFØREPERIODENE ER UTFYLT                                     */00006500
 /* ***************************************************************** */00006510
                                                                        00006520
                      IF I = 7 THEN         /*0697 HL*/                 00006530
                         DO;                                            00006540
                                                                        00006550
 /* ***************************************************************** */00006560
 /* FEIL, ALLE UFØREPERIODENE ER UTFYLT, IKKE PLASS TIL EN TIL        */00006570
 /* ***************************************************************** */00006580
                                                                        00006590
  L279:                                                                 00006600
                            FEIL_VED_LABEL = '279';                     00006610
                            FEIL_MELD_NR   = 1715;                      00006620
                            GO TO RETUR;                                00006630
                         END;                                           00006640
                 END;                                                   00006650
               END;                                                     00006660
          END;                                                          00006670
    IF B01.PENSJONSTYPE3(SØKER_IND) = 'A' THEN                          00006680
       B01.UFØRHIST(SØKER_IND,K) =                                      00006690
                                   B00.UFØRHIST(SØKER_IND,K);           00006700
                                                                        00006710
 /* ***************************************************************** */00006720
 /* SØKEREN HAR ATTFØRING FRA FØR.SS = NS OG NS BLIR FJERNET.         */00006730
 /* ***************************************************************** */00006740
                                                                        00006750
    IF UPS.ATT_UF = 'A' THEN                                            00006760
       IF (STATUS_TYPE = 'B' &                                          00006770
          TRANS_LISTE_INDEX > 1)  THEN                                  00006780
          IF B01.PENSJONSTYPE1(SØKER_IND)  = 'U' &                      00006790
             B01.PENSJONSTYPE3(SØKER_IND) ^= 'A' THEN                   00006800
             DO;                                                        00006810
                B02                         = B01                  ;    00006820
                B01 = '';                                               00006830
                B00 = '';                                               00006840
             END;                                                       00006850
                                                                        00006860
 /* ***************************************************************** */00006870
 /* VERNEPLIKTOPPLYSNINGER                                            */00006880
 /* ***************************************************************** */00006890
                                                                        00006900
    DO I = 1 TO 4 WHILE (UPS.VP_ÅR(I) > 0);                             00006910
       B02.VERNEPLIKTÅR(SØKER_IND,I) = UPS.VP_ÅR(I);                    00006920
    END;                                                                00006930
                                                                        00006940
 /* ***************************************************************** */00006950
 /*                                                                   */00006960
 /* OPPDATERE INNTEKT_FØR_UP MED 0 PGA ABEND I SEGMENTET.             */00006970
 /*           INNTEKT_FØR_UP MÅ OPPDATERES I EGET SKJERMBLIDE         */00006980
 /*           TRUDE 030295                                            */00006990
 /* ***************************************************************** */00007000
                                                                        00007010
 /* B02.INNTEKT_FØR_UP(SØKER_IND) =  0; */                              00007020
    IF UPS.INNTEKT_FØR_UP          > 0   THEN          /*SP210296*/     00007030
       B02.INNTEKT_FØR_UP(SØKER_IND) = UPS.INNTEKT_FØR_UP / 100;        00007040
                                                                        00007050
    IF   B02.UFØRHIST.UFT_ÅM(SØKER_IND,1) > 0 THEN                      00007060
         B02.INNT_DATO_ÅM(SØKER_IND)  =                                 00007070
                                    B02.UFØRHIST.UFT_ÅM(SØKER_IND,1);   00007080
    ELSE                                                                00007090
         B02.INNT_DATO_ÅM(SØKER_IND) =   HJ_UFT_Å!!HJ_UFT_M;            00007100
                                                                        00007110
 /* ***************************************************************** */00007120
 /*                                                                   */00007130
 /* YRKESSKADEOPPLYSNINGER.  ERIK 2.7.87.                             */00007140
 /*                                                                   */00007150
 /* ***************************************************************** */00007160
                                                                        00007170
                                                                        00007180
  %SKIP;                                                                00007190
                                                                        00007200
 /*YS*/ IF UPS.YSKADE_TILLEGG = 'J' THEN                                00007210
 /*YS*/                                                                 00007220
 /*YS ENDRET 20.7.89 HL - BARE KAP.8 - GRAD ER ENDRET */                00007230
 /*YS*/                                                                 00007240
 /*YS*/    IF B01.YRKEPENS.YUG(SØKER_IND) = UPY.YUG     &               00007250
 /*YS*/       B01.UFØRPENS.UFG(SØKER_IND)^= UPS.UFG     THEN ;          00007260
 /*YS*/    ELSE                                                         00007270
                                                                        00007280
 /*TILLEGG 13.3.90 HL */                                                00007290
                                                                        00007300
 /*YS*/    IF B01.YRKEPENS.YUG(SØKER_IND) > UPY.YUG     THEN            00007310
              DO;                                                       00007320
        L280:                                                           00007330
 /*YS*/          FEIL_VED_LABEL = '280';                                00007340
 /*YS*/          FEIL_MELD_NR   =  1737;                                00007350
 /*YS*/          GO TO RETUR;                                           00007360
 /*YS*/       END;                                                      00007370
 /*YS*/    ELSE                                                         00007380
 /*YS*/                                                                 00007390
 /*HIT 13.3.90 HL*/                                                     00007400
 /*YS*/                                                                 00007410
 /*YS*/ DO I = 1 TO 5;                                                  00007420
 /*YS*/    YUF_IND = I;                                                 00007430
 /*YS*/ SELECT;                                                         00007440
 /*YS*/    WHEN (B01.YRKEHIST.YUFT_ÅM(SØKER_IND,I) =                    00007450
 /*YS*/                 F_SNU_DATO(UPS.UFT_MÅ))                         00007460
 /*YS*/       DO;                                                       00007470
 /*YS*/          B02.YRKEHIST.YUG(SØKER_IND,I)    = UPY.YUG;            00007480
 /*YS*/          I = 5;                                                 00007490
 /*YS*/       END;                                                      00007500
 /*YS*/    WHEN (B01.YRKEHIST.YUFT_ÅM(SØKER_IND,I) = 0)                 00007510
 /*YS*/       DO;                                                       00007520
 /*YS*/          B02.YRKEHIST.YUFT_ÅM(SØKER_IND,I) =                    00007530
 /*YS*/                                F_SNU_DATO(UPS.UFT_MÅ);          00007540
 /*YS*/          B02.YRKEHIST.YUG(SØKER_IND,I)    = UPY.YUG;            00007550
 /*YS*/                                                                 00007560
 /*YS*/          IF (I > 1)  & (B01.YRKEHIST.OPPH_DATO_ÅM               00007570
 /*YS*/                   (SØKER_IND,(I-1)) = 0 ) THEN                  00007580
 /*YS*/             DO;                                                 00007590
 /*YS*/                                                                 00007600
 /*YS*/                B02.YRKEHIST.OPPH_DATO_ÅM(SØKER_IND,(I-1)) =     00007610
 /*YS*/                                F_SNU_DATO(UPS.UFT_MÅ);          00007620
 /*YS*/                B02.YRKEHIST.OPPH_KODE(SØKER_IND,(I-1)) = 'J';   00007630
 /*YS*/                                                                 00007640
 /*YS*/                DO J = 1 TO 5 WHILE                              00007650
 /*YS*/                   (B02.YUG_ØVRIGE(SØKER_IND,(I-1),J) > 0);      00007660
 /*YS*/                                                                 00007670
 /*YS*/                   IF B02.YUG_DATO_ÅM(SØKER_IND,(I-1),J) =       00007680
 /*YS*/                      B02.YRKEHIST.YUFT_ÅM(SØKER_IND,I) THEN     00007690
 /*YS*/                      DO;                                        00007700
 /*YS*/                         B02.YUG_ØVRIGE(SØKER_IND,(I-1),J) = 0;  00007710
 /*YS*/                         B02.YUG_DATO_ÅM(SØKER_IND,(I-1),J)= 0;  00007720
 /*YS*/                         B01.YUG_ØVRIGE(SØKER_IND,(I-1),J) = 0;  00007730
 /*YS*/                         B01.YUG_DATO_ÅM(SØKER_IND,(I-1),J)= 0;  00007740
 /*YS*/                      END;                                       00007750
 /*YS*/                   IF B02.YUG_DATO_ÅM(SØKER_IND,(I-1),J) >       00007760
 /*YS*/                      B02.YRKEHIST.YUFT_ÅM(SØKER_IND,I) THEN     00007770
 /*YS*/                      DO;                                        00007780
 /*YS*/  /*  ********************************************* */           00007790
 /*YS*/  /*  Y-UFØRETIDSPUNKT LIGGER FØR OPPHØRSTIDSPUNKT  */           00007800
 /*YS*/  /*  ********************************************* */           00007810
                                                                        00007820
                                                                        00007830
        L281:                                                           00007840
 /*YS*/                         FEIL_VED_LABEL = '281';                 00007850
 /*YS*/                         FEIL_MELD_NR   =  1711;                 00007860
 /*YS*/                         GO TO RETUR;                            00007870
 /*YS*/                      END;                                       00007880
 /*YS*/                END;                                             00007890
 /*YS*/        /*   I = 5    TRUDE */                                   00007900
 /*YS*/          END;                                                   00007910
 /*YS*/             I = 5;                                              00007920
 /*YS*/       END;                                                      00007930
 /*YS*/    OTHERWISE                                                    00007940
 /*YS*/       DO;                                                       00007950
 /*YS*/          IF I = 5 THEN                                          00007960
                                                                        00007970
 /*YS*/  /*  ********************************************* */           00007980
 /*YS*/  /*  ALLE PERIODENE UTFYLT.  IKKE MER PLASS.       */           00007990
 /*YS*/  /*  ********************************************* */           00008000
                                                                        00008010
        L282:                                                           00008020
 /*YS*/             DO;                                                 00008030
 /*YS*/                FEIL_VED_LABEL = '282';                          00008040
 /*YS*/                FEIL_MELD_NR   =  1715;                          00008050
 /*YS*/                GO TO RETUR;                                     00008060
 /*YS*/             END;                                                00008070
 /*YS*/       END;                                                      00008080
 /*YS*/ END; /*SELECT*/                                                 00008090
 /*YS*/ END;    /*DO I= 1 TO 5*/                                        00008100
                                                                        00008110
 /*YS*/  IF UPS.YSKADE_TILLEGG = 'J' THEN                               00008120
 /*YS*/                                                                 00008130
 /*YS ENDRET 20.7.89 HL - BARE KAP.8 - GRAD ER ENDRET */                00008140
 /*YS*/                                                                 00008150
 /*YS*/    IF B01.YRKEPENS.YUG(SØKER_IND) = UPY.YUG     &               00008160
 /*YS*/       B01.UFØRPENS.UFG(SØKER_IND)^= UPS.UFG     THEN ;          00008170
 /*YS*/    ELSE                                                         00008180
 /*YS*/    DO;                                                          00008190
 /*YS*/       B02.YRKEPENS.YUG(SØKER_IND) = UPY.YUG;                    00008200
 /*YS*/       B02.YRKEHIST.YST_ÅM(SØKER_IND,YUF_IND) =                  00008210
 /*YS*/                                F_SNU_DATO(UPY.YST_MÅ);          00008220
 /*YS*/       B02.YRKEHIST.AÅI(SØKER_IND,YUF_IND) = UPY.AÅI;            00008230
 /*YS*/       B02.YRKEHIST.YRKE11(SØKER_IND,YUF_IND) = UPY.YRKE11;      00008240
 /*YS*/       B02.YRKEHIST.VILKÅR_1_2_2(SØKER_IND,YUF_IND)=             00008250
 /*YS*/                          UPY.VILKÅR_1_2_2A !! UPY.VILKÅR_1_2_2B;00008260
 /*YS*/       B02.YRKEHIST.KAP_11_7_UTLØST(SØKER_IND,YUF_IND) =         00008270
                                                    UPY.KAP_11_7_UTLØST;00008280
              B02.YRKEPENS.YSYKDOM(SØKER_IND) = UPY.YSYKDOM;            00008290
              DIV_PARAM_OMR.YSYKDOM        = UPY.YSYKDOM        ;       00008300
 /* ***************************************************************** */00008310
 /*YS - VI SKAL AVVISE :  1) NY YRKESSKADE FOR EN SOM HAR Y FRA FØR   */00008320
 /*YS                     2) ENGANGSUTLØSNING FOR EN SOM HAR UFØRHIST */00008330
 /*YS                                                                 */00008340
 /* ***************************************************************** */00008350
                                                                        00008360
 /*YS*        IF B01.PENSJONSTYPE1(SØKER_IND) = 'Y'      &              00008370
 /*YS*           YUF_IND                      > 1        &              00008380
 /*YS*           B02.YRKEHIST.YST_ÅM(SØKER_IND,YUF_IND) ^=              00008390
 /*YS*           B02.YRKEHIST.YST_ÅM(SØKER_IND,YUF_IND-1) THEN          00008400
 /*YS*                                                                  00008410
 /*YS*           DO;                                                    00008420
 /*YS*  L283:                                                           00008430
 /*YS*              FEIL_VED_LABEL = '283';                             00008440
 /*YS*              FEIL_MELD_NR   = 1728;                              00008450
 /*YS*              GO TO RETUR;                                        00008460
 /*YS*           END;                                                   00008470
 /*YS*  --- LABEL 283 LAGT SOM KOMMENTAR PÅ TEST 171296, MHA7339.       00008480
 /*YS*  --- FLERE YRKESSKADER, MÅ IKKJE FJERNES PÅ PROD FORELØBIG.      00008490
 /*YS*                                                                  00008500
 /*YS*/       IF (B01.PENSJONSTYPE1(SØKER_IND) = 'Y'      !             00008510
 /*YS*/           B01.PENSJONSTYPE1(SØKER_IND) = 'U'  )   &             00008520
 /*YS*/          UPY.KAP_11_7_UTLØST ^= ' '             THEN            00008530
 /*YS*/                                                                 00008540
 /*YS*/          DO;                                                    00008550
 /*YS*/ L284:                                                           00008560
 /*YS*/             FEIL_VED_LABEL = '284';                             00008570
 /*YS*/             FEIL_MELD_NR   = 1729;                              00008580
 /*YS*/             GO TO RETUR;                                        00008590
 /*YS*/          END;                                                   00008600
 /*YS*/                                                                 00008610
 /*YS*/                                                                 00008620
 /*YS*/                                                                 00008630
 /*YS*/                                                                 00008640
 /*YS*/                                                                 00008650
 /*YS*/                                                                 00008660
 /*YS*/    END;                                                         00008670
                                                                        00008680
                                                                        00008690
  /*RULLERING AV INNTEKTER - 9802 HL : */                               00008700
    IF B02.FORVENTET(SØKER_IND) > 0          THEN                       00008710
       CALL RULL_FORVENTET(B02.G_DATO_ÅM(SØKER_IND),                    00008720
                           B02.VIRK_DATO_ÅM(SØKER_IND),                 00008730
                           B02.FORVENTET(SØKER_IND));                   00008740
                                                                        00008750
    IF B02.FORSI.PENSJONSINNTEKT(SØKER_IND) > 0  THEN                   00008760
       B02.FORSI.PENSJONSINNTEKT(SØKER_IND) =                           00008770
           F_RULL_FORSI(B02.G_DATO_ÅM(SØKER_IND),                       00008780
                 B02.VIRK_DATO_ÅM(SØKER_IND),                           00008790
                 B02.FORSI.PENSJONSINNTEKT(SØKER_IND));                 00008800
                                                                        00008810
    IF B02.FORSI.ARBEIDSINNTEKT(SØKER_IND) > 0  THEN                    00008820
       B02.FORSI.ARBEIDSINNTEKT(SØKER_IND) =                            00008830
           F_RULL_FORSI(B02.G_DATO_ÅM(SØKER_IND),                       00008840
                 B02.VIRK_DATO_ÅM(SØKER_IND),                           00008850
                 B02.FORSI.ARBEIDSINNTEKT(SØKER_IND));                  00008860
                                                                        00008870
    IF B02.FORSI.PENSJONSINNTEKT_EK(SØKER_IND) > 0  THEN                00008880
       B02.FORSI.PENSJONSINNTEKT_EK(SØKER_IND) =                        00008890
           F_RULL_FORSI(B02.G_DATO_ÅM(SØKER_IND),                       00008900
                  B02.VIRK_DATO_ÅM(SØKER_IND),                          00008910
                  B02.FORSI.PENSJONSINNTEKT_EK(SØKER_IND));             00008920
                                                                        00008930
    IF B02.FORSI.ARBEIDSINNTEKT_EK(SØKER_IND) > 0  THEN                 00008940
       B02.FORSI.ARBEIDSINNTEKT_EK(SØKER_IND) =                         00008950
           F_RULL_FORSI(B02.G_DATO_ÅM(SØKER_IND),                       00008960
                 B02.VIRK_DATO_ÅM(SØKER_IND),                           00008970
                 B02.FORSI.ARBEIDSINNTEKT_EK(SØKER_IND));               00008980
                                                                        00008990
 /* RULLERING AV EKTEFELLES INNTEKTER - 9802 HL */                      00009000
    IF B02.ALDERSP.FAI(EKTEF_IND) > 0   THEN                            00009010
       CALL RULL_FAI(B02.G_DATO_ÅM(EKTEF_IND),                          00009020
                     B02.VIRK_DATO_ÅM(EKTEF_IND),                       00009030
                     B02.ALDERSP.FAI(EKTEF_IND));                       00009040
                                                                        00009050
    IF B02.FORSI.PENSJONSINNTEKT(EKTEF_IND) > 0  THEN                   00009060
       B02.FORSI.PENSJONSINNTEKT(EKTEF_IND) =                           00009070
           F_RULL_FORSI(B02.G_DATO_ÅM(EKTEF_IND),                       00009080
                 B02.VIRK_DATO_ÅM(EKTEF_IND),                           00009090
                 B02.FORSI.PENSJONSINNTEKT(EKTEF_IND));                 00009100
                                                                        00009110
    IF B02.FORSI.ARBEIDSINNTEKT(EKTEF_IND) > 0  THEN                    00009120
       B02.FORSI.ARBEIDSINNTEKT(EKTEF_IND) =                            00009130
           F_RULL_FORSI(B02.G_DATO_ÅM(EKTEF_IND),                       00009140
                 B02.VIRK_DATO_ÅM(EKTEF_IND),                           00009150
                 B02.FORSI.ARBEIDSINNTEKT(EKTEF_IND));                  00009160
                                                                        00009170
    IF B02.FORSI.PENSJONSINNTEKT_EK(EKTEF_IND) > 0  THEN                00009180
       B02.FORSI.PENSJONSINNTEKT_EK(EKTEF_IND) =                        00009190
           F_RULL_FORSI(B02.G_DATO_ÅM(EKTEF_IND),                       00009200
                  B02.VIRK_DATO_ÅM(EKTEF_IND),                          00009210
                  B02.FORSI.PENSJONSINNTEKT_EK(EKTEF_IND));             00009220
                                                                        00009230
    IF B02.FORSI.ARBEIDSINNTEKT_EK(EKTEF_IND) > 0  THEN                 00009240
       B02.FORSI.ARBEIDSINNTEKT_EK(EKTEF_IND) =                         00009250
           F_RULL_FORSI(B02.G_DATO_ÅM(EKTEF_IND),                       00009260
                 B02.VIRK_DATO_ÅM(EKTEF_IND),                           00009270
                 B02.FORSI.ARBEIDSINNTEKT_EK(EKTEF_IND));               00009280
                                                                        00009290
                                                                        00009300
                                                                        00009310
  RETUR:                                                                00009320
   END AJOURFØR_B02_MED_UPTRANS;                                        00009330
