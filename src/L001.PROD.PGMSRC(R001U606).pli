 /*   SIST ENDRET PÅ PROD   2006.04.07  9.57.16 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2006.01.05  8.37.32 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2005.06.08 13.17.50 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2004.12.17 14.32.39 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2004.07.13 12.58.34 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2002.04.19 12.15.07 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2000.04.05 10.17.59 AV   SPA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.04.05  9.02.30 AV   SPA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.04.04 12.56.27 AV   JDA7339          */        
 /*   SIST ENDRET PÅ PROD   1999.11.23 15.22.43 AV   JDA7339          */        
 /*       SIST ENDRET 09/06-98 08.31.40 AV   SPA7339                  */        
 /*       SIST ENDRET 04/05-98 12.23.57 AV   JDA7339                  */        
 /* ***************************************************************** */        
 /*               R 0 0 1 U 6 0 6                                     */        
 /* ***************************************************************** */        
 /*IDENTIFIKASJON:                                                    */        
 /* **********************                                            */        
 /*  PROGRAM-IDENT : R001U606   U3_TRANS_TIL_MAP   SUBPROGRAM         */        
 /*  PROGRAM-SPRÅK : PLI                                              */        
 /*  PROGRAMMERER  : SATISH                                           */        
 /*  PROGRAMMET BLE LAGET : JULI 1993                                 */        
 /*                                                                   */        
 /* ***************************************************************** */        
 /*HENSIKT:                                                           */        
 /* **********                                                        */        
 /*  BRUKES VED REGISTRERING AV GRUNNBLANKETT U3. (UP)                */        
 /*  OVERFØRER DATA FRA U3_TRANS_OMR TIL SKJERMBILDET.                */        
 /*  BRUKER MAP S001U61 MAPSET S001U6.                                */        
 /*  BRUKER MAP S001201 MAPSET S00120.                                */        
 /*                                                                   */        
 /* ***************************************************************** */        
 /*PROGRAMTILKNYTTING:                                                */        
 /* ********************                                              */        
 /*  PROGRAMMET INCLUDES AV R001U601 - KONTROLL_GRUNNBLANKETT_U3 !    */        
 /*                         R001C470                             !    */        
 /*                         R00104U3                             ;    */        
 /*  ALLE CICS-KOMMANDOS LIGGER I HOVEDPROG.                          */        
 /*  ARBEIDSOMRÅDET P001U601, OG MAPEN ER INCLUDET I HOVEDPROG.       */        
 /*  PROGRAMMET HAR CALL TIL :                                        */        
 /*    R0019944 - SKRIV_FEIL          INCLUDE I HOVEDPROG             */        
 /*    R0019963 - SKRIV_FEIL_YP       INCLUDE I HOVEDPROG       */              
 /*    R0019969 - SKRIV_FEIL_SP       INCLUDE I HOVEDPROG       */              
 /*                                                                   */        
 /*  PROGRAMMET BRUKER FUNKSJONEN :                                   */        
 /*    R0019912 - F_FELT_PIC_CHARNN   INCLUDE I HOVEDPROG             */        
 /*                                                                   */        
 /*  INTERNE PROSEDYRER :                                             */        
 /*    OVERFØR_U3SØKER_MAP:    OVERFØRING AV APDELEN                  */        
 /*    OVERFØR_U3SPES_MAP:     OVERFØRING AV SPESIELL DEL             */        
 /*    OVERFØR_YP_MAP    :     OVERFØRING YRKESSKADE                  */        
 /*                                                                   */        
 /* ***************************************************************** */        
 /*DATASETTOPPLYSNINGER:                                              */        
 /* ***********************                                           */        
 /*    INGEN                                                          */        
 /* ***************************************************************** */        
 /*FEILMELDINGER:                                                     */        
 /* *******************                                               */        
 /*    I PROSEDYREN OVERFØR_YP_MAP LEGGES FEILMELDINGER UT VED  */              
 /*    CALL TIL R0019963 - SKRIV_FEIL_YP.  I DE ANDRE           */              
 /*    LEGGES DE UT PÅ SKJERMBILDET (MAP S001U61) VED CALL      */              
 /*    TIL R0019944 - SKRIV_FEIL           OG                         */        
 /*    TIL R0019969 - SKRIV_FEIL_SP                                   */        
 /*                                                                   */        
 /* ***************************************************************** */        
 % PAGE;                                                                        
 /* ***************************************************************** */        
 /*   PROSEDYRA OVERFØRER DATA FRA U3_TRANS_OMR TIL                   */        
 /*   SKJERMBILDE U3_SØKER DELEN.                                     */        
 /*   MAP: S001U61                                                    */        
 /*   MAPSET: S00106                                                  */        
 /* ***************************************************************** */        
 % SKIP (2);                                                                    
   OVERFØR_U3_SØKER_MAP:                                                        
    PROC;                                                                       
    DCL                                                                         
       NORMAL  CHAR (1) INIT(' '),                                              
       NOR_NUM CHAR (1) INIT('&'),                                              
       BRI_NUM CHAR (1) INIT('Q');                                              
  DCL  HJ_DATO   CHAR(6);                                                       
                                                                                
       S001U61O.REGDATOO      = KONV_HÅMD_ÅMD(U3S.REGDATO_ÅMD);                 
       S001U61O.TERMIDO       = U3S.TERMID;                                     
       S001U61O.ATT_UFO       = U3S.ATT_UF;                                     
       S001U61O.FNRO          = F_FELT_PIC_CHAR11(U3S.FNR);                     
       S001U61O.NAVNO         = U3S.NAVN;                                       
       S001U61O.SPRÅKO        = U3S.SPRÅK;                                      
       S001U61O.TKNRO         = F_FELT_PIC_CHAR4(U3S.TKNR);                     
       S001U61O.SIVILSTANDO   = U3S.SIVILSTAND;                                 
       S001U61O.NORSK_BOSATTO = U3S.NORSK_BOSATT;                               
       S001U61O.TILL_EKO      = U3S.TILL_EK;                                    
       S001U61O.TILL_BARNO    = U3S.TILL_BARN;                                  
                                                                                
       IF (U3S.VP_ÅR(1)) ^=  0     THEN                                         
          S001U61O.VP_ÅR1O    = (U3S.VP_ÅR(1));                                 
       IF (U3S.VP_ÅR(2)) ^=  0     THEN                                         
          S001U61O.VP_ÅR2O    = (U3S.VP_ÅR(2));                                 
       IF (U3S.VP_ÅR(3)) ^=  0     THEN                                         
          S001U61O.VP_ÅR3O    = (U3S.VP_ÅR(3));                                 
       IF (U3S.VP_ÅR(4)) ^=  0     THEN                                         
          S001U61O.VP_ÅR4O    = (U3S.VP_ÅR(4));                                 
                                                                                
       S001U61O.VILKÅR_8_4_3AO = U3S.VILKÅR_8_4_3A;                             
       IF F_FELT_PIC_CHAR7(U3S.PI) ^= (7)'0' THEN                               
          S001U61O.PIO        = F_FELT_PIC_CHAR7(U3S.PI);                       
   /*  IF F_FELT_PIC_CHAR2(U3S.YNGSTE_BARN_FÅR ) ^= (2)'0' THEN */              
          S001U61O.YNGSTE_BARN_FÅRO  =                                          
                                F_FELT_PIC_CHAR4(U3S.YNGSTE_BARN_FÅR);;         
                                                                                
       S001U61O.YSKADE_TILLEGGO = U3S.YSKADE_TILLEGG;                           
       S001U61O.YRKESM_ATTFO     = U3S.YRKESM_ATTF;                             
       S001U61O.UTDANNINGO    = U3S.UTDANNING;                                  
       S001U61O.YRKEO         = F_FELT_PIC_CHAR2(U3S.YRKE);                     
       IF F_FELT_PIC_CHAR3(U3S.UFG) ^= '000' THEN                               
          S001U61O.UFGO       = F_FELT_PIC_CHAR3(U3S.UFG);                      
                                                                                
       S001U61O.UFT_MÅO       = KONV_HÅMD_MÅ(U3S.UFT_ÅMD);                      
       S001U61O.FRIINNTEKT_DATO_DMÅO                                            
                          = KONV_HÅMD_DMÅ(U3S.FRIINNTEKT_DATO_ÅMD);             
       S001U61O.GARANTERT_TPO = U3S.GARANTERT_TP ;                              
       S001U61O.VIRK_DATO_MÅO = KONV_HÅMD_MÅ(U3S.VIRK_DATO_ÅMD);                
                                                                                
       IF  F_FELT_PIC_CHAR7(U3S.INNTEKT_FØR_UP)^='0000000'  THEN                
       S001U61O.INNTEKT_FØR_UPO = F_FELT_PIC_CHAR7(U3S.INNTEKT_FØR_UP);         
                                                                                
       S001U61O.REAKTIVISERINGO = U3S.REAKTIVISERING ;                          
       S001U61O.UNNTAK_VENTETIDO = U3S.UNNTAK_VENTETID ;                        
       S001U61O.FRYSP_5ÅR_ARBO = U3S.FRYSP_5ÅR_ARB ;                            
       S001U61O.FRYSP_TIDSBO = U3S.FRYSP_TIDSB ;                                
       S001U61O.LØNNSTILSKO = U3S.LØNNSTILSKUDD;                                
                                                                                
       IF F_FELT_PIC_CHAR11(U3S.FNR_EK) ^= '00000000000' THEN                   
          S001U61O.FNR_EKO    = F_FELT_PIC_CHAR11(U3S.FNR_EK);                  
       S001U61O.NAVN_EKO      = U3S.NAVN_EK;                                    
       S001U61O.EK_INNT_OVER_2GO = U3S.EK_INNT_OVER_2G;                         
       S001U61O.RED_GP_3_2_5O = U3S.RED_GP_3_2_5;                               
    /* S001U61O.RED_GP_3_2_5O = ' '; */                                         
                                                                                
                                                                                
 /* FEILMELDINGER MARKERING AV FELT (ATTRIBUTTENE)                    */        
       S001U61O.DUMMYA = '_';                                                   
                                                                                
 /*DERSOM FEIL FRA BEHANDLE-TRANS OVERFØRES FEIL HER, BARE FØRSTE GANG*/        
                                                                                
       IF ^ FRA_CICS  THEN                                                      
          DO;                                                                   
             IF FEIL_MELD_NR > 0 THEN                                           
                CALL SKRIV_FEIL(FEIL_MELD_NR);                                  
             FEIL_MELD_NR = 0;                                                  
          END;                                                                  
       IF U3S.ATT_UFNR = 0 THEN                                                 
          S001U61O.ATT_UFA = NORMAL;                                            
       ELSE                                                                     
          DO;                                                                   
             S001U61O.ATT_UFA = DFHBMBRY;                                       
             S001U61I.ATT_UFL = CURSOR_POS;                                     
             IF U3S.ATT_UFNR ^= 999 THEN                                        
                CALL SKRIV_FEIL(U3S.ATT_UFNR);                                  
          END;                                                                  
   /*  S001U61O.REGDATOA = DFHBMASK;                                            
       S001U61O.TERMIDA  = DFHBMASK;                                            
  */                                                                            
       IF U3S.FNRNR = 0 THEN                                                    
          S001U61O.FNRA = NOR_NUM;                                              
       ELSE                                                                     
          DO;                                                                   
             S001U61O.FNRA = BRI_NUM;                                           
             S001U61I.FNRL = CURSOR_POS;                                        
             IF U3S.FNRNR ^= 999 THEN                                           
                CALL SKRIV_FEIL(U3S.FNRNR);                                     
          END;                                                                  
       IF U3S.NAVNNR = 0 THEN                                                   
          S001U61O.NAVNA = NORMAL;                                              
       ELSE                                                                     
          DO;                                                                   
            S001U61O.NAVNA = DFHBMBRY;                                          
            S001U61I.NAVNL = CURSOR_POS;                                        
            IF U3S.NAVNNR ^= 999 THEN                                           
               CALL SKRIV_FEIL(U3S.NAVNNR);                                     
          END;                                                                  
       IF U3S.SPRÅKNR = 0 THEN                                                  
          S001U61O.SPRÅKA = NORMAL;                                             
       ELSE                                                                     
          DO;                                                                   
            S001U61O.SPRÅKA = DFHBMBRY;                                         
            S001U61I.SPRÅKL = CURSOR_POS;                                       
            IF U3S.SPRÅKNR ^= 999 THEN                                          
               CALL SKRIV_FEIL(U3S.SPRÅKNR);                                    
          END;                                                                  
       IF U3S.TKNRNR = 0 THEN                                                   
          S001U61O.TKNRA = NOR_NUM;                                             
       ELSE                                                                     
          DO;                                                                   
            S001U61O.TKNRA = BRI_NUM;                                           
            S001U61I.TKNRL = CURSOR_POS;                                        
            IF U3S.TKNRNR ^= 999 THEN                                           
               CALL SKRIV_FEIL(U3S.TKNRNR);                                     
          END;                                                                  
       IF U3S.SIVILSTANDNR = 0 THEN                                             
          S001U61O.SIVILSTANDA = NORMAL;                                        
       ELSE                                                                     
          DO;                                                                   
            S001U61O.SIVILSTANDA = DFHBMBRY;                                    
            S001U61I.SIVILSTANDL = CURSOR_POS;                                  
            IF U3S.SIVILSTANDNR ^= 999 THEN                                     
               CALL SKRIV_FEIL(U3S.SIVILSTANDNR);                               
          END;                                                                  
       IF U3S.TILL_EKNR = 0 THEN                                                
          S001U61O.TILL_EKA = NORMAL;                                           
       ELSE                                                                     
          DO;                                                                   
            S001U61O.TILL_EKA = DFHBMBRY;                                       
            S001U61I.TILL_EKL = CURSOR_POS;                                     
            IF U3S.TILL_EKNR ^= 999 THEN                                        
               CALL SKRIV_FEIL(U3S.TILL_EKNR);                                  
          END;                                                                  
       IF U3S.NORSK_BOSATTNR = 0 THEN                                           
          S001U61O.NORSK_BOSATTA = NORMAL;                                      
       ELSE                                                                     
          DO;                                                                   
            S001U61O.NORSK_BOSATTA = DFHBMBRY;                                  
            S001U61I.NORSK_BOSATTL = CURSOR_POS;                                
            IF U3S.NORSK_BOSATTNR ^= 999 THEN                                   
               CALL SKRIV_FEIL(U3S.NORSK_BOSATTNR);                             
          END;                                                                  
       IF U3S.UTDANNINGNR = 0 THEN                                              
          S001U61O.UTDANNINGA = NOR_NUM;                                        
       ELSE                                                                     
          DO;                                                                   
            S001U61O.UTDANNINGA = BRI_NUM;                                      
            S001U61I.UTDANNINGL = CURSOR_POS;                                   
            IF U3S.UTDANNINGNR ^= 999 THEN                                      
               CALL SKRIV_FEIL(U3S.UTDANNINGNR);                                
          END;                                                                  
       IF U3S.YRKESM_ATTFNR = 0 THEN                                            
          S001U61O.YRKESM_ATTFA = NORMAL ;                                      
       ELSE                                                                     
          DO;                                                                   
            S001U61O.YRKESM_ATTFA = DFHBMBRY;                                   
            S001U61I.YRKESM_ATTFL = CURSOR_POS;                                 
            IF U3S.YRKESM_ATTFNR ^= 999 THEN                                    
               CALL SKRIV_FEIL(U3S.YRKESM_ATTFNR);                              
          END;                                                                  
       IF U3S.YSKADE_TILLEGGNR = 0 THEN                                         
          S001U61O.YSKADE_TILLEGGA = NORMAL;                                    
       ELSE                                                                     
          DO;                                                                   
            S001U61O.YSKADE_TILLEGGA = DFHBMBRY;                                
            S001U61I.YSKADE_TILLEGGL = CURSOR_POS;                              
            IF U3S.YSKADE_TILLEGGNR ^= 999 THEN                                 
               CALL SKRIV_FEIL(U3S.YSKADE_TILLEGGNR);                           
          END;                                                                  
       IF U3S.VP_ÅRNR(1) = 0 THEN                                               
          S001U61O.VP_ÅR1A = NOR_NUM;                                           
       ELSE                                                                     
          DO;                                                                   
            S001U61O.VP_ÅR1A = BRI_NUM;                                         
            S001U61I.VP_ÅR1L = CURSOR_POS;                                      
            IF U3S.VP_ÅRNR(1) ^= 999 THEN                                       
               CALL SKRIV_FEIL(U3S.VP_ÅRNR(1));                                 
          END;                                                                  
       IF U3S.VP_ÅRNR(2) = 0 THEN                                               
          S001U61O.VP_ÅR2A = NOR_NUM;                                           
       ELSE                                                                     
          DO;                                                                   
            S001U61O.VP_ÅR2A = BRI_NUM;                                         
            S001U61I.VP_ÅR2L = CURSOR_POS;                                      
            IF U3S.VP_ÅRNR(2) ^= 999 THEN                                       
               CALL SKRIV_FEIL(U3S.VP_ÅRNR(2));                                 
          END;                                                                  
       IF U3S.VP_ÅRNR(3) = 0 THEN                                               
          S001U61O.VP_ÅR3A = NOR_NUM;                                           
       ELSE                                                                     
          DO;                                                                   
            S001U61O.VP_ÅR3A = BRI_NUM;                                         
            S001U61I.VP_ÅR3L = CURSOR_POS;                                      
            IF U3S.VP_ÅRNR(3) ^= 999 THEN                                       
               CALL SKRIV_FEIL(U3S.VP_ÅRNR(3));                                 
          END;                                                                  
       IF U3S.VP_ÅRNR(4) = 0 THEN                                               
          S001U61O.VP_ÅR4A = NOR_NUM;                                           
       ELSE                                                                     
          DO;                                                                   
            S001U61O.VP_ÅR4A = BRI_NUM;                                         
            S001U61I.VP_ÅR4L = CURSOR_POS;                                      
            IF U3S.VP_ÅRNR(4) ^= 999 THEN                                       
               CALL SKRIV_FEIL(U3S.VP_ÅRNR(4));                                 
          END;                                                                  
       IF U3S.VILKÅR_8_4_3ANR = 0 THEN                                          
          S001U61O.VILKÅR_8_4_3AA = NORMAL;                                     
       ELSE                                                                     
          DO;                                                                   
            S001U61O.VILKÅR_8_4_3AA = DFHBMBRY;                                 
            S001U61I.VILKÅR_8_4_3AL = CURSOR_POS;                               
            IF U3S.VILKÅR_8_4_3ANR ^= 999 THEN                                  
               CALL SKRIV_FEIL(U3S.VILKÅR_8_4_3ANR);                            
          END;                                                                  
       IF U3S.UFGNR = 0 THEN                                                    
          S001U61O.UFGA = NOR_NUM;                                              
       ELSE                                                                     
          DO;                                                                   
            S001U61O.UFGA = BRI_NUM;                                            
            S001U61I.UFGL = CURSOR_POS;                                         
            IF U3S.UFGNR ^= 999 THEN                                            
               CALL SKRIV_FEIL(U3S.UFGNR);                                      
          END;                                                                  
       IF U3S.UFT_ÅMDNR = 0 THEN                                                
          S001U61O.UFT_MÅA = NOR_NUM;                                           
       ELSE                                                                     
          DO;                                                                   
            S001U61O.UFT_MÅA = BRI_NUM;                                         
            S001U61I.UFT_MÅL = CURSOR_POS;                                      
            IF U3S.UFT_ÅMDNR ^= 999 THEN                                        
               CALL SKRIV_FEIL(U3S.UFT_ÅMDNR);                                  
          END;                                                                  
       IF U3S.FRIINNTEKT_DATO_ÅMDNR = 0 THEN                                    
          S001U61O.FRIINNTEKT_DATO_DMÅA = NOR_NUM;                              
       ELSE                                                                     
          DO;                                                                   
            S001U61O.FRIINNTEKT_DATO_DMÅA = BRI_NUM;                            
            S001U61I.FRIINNTEKT_DATO_DMÅL = CURSOR_POS;                         
            IF U3S.FRIINNTEKT_DATO_ÅMDNR ^= 999 THEN                            
               CALL SKRIV_FEIL(U3S.FRIINNTEKT_DATO_ÅMDNR);                      
          END;                                                                  
       IF U3S.GARANTERT_TPNR = 0 THEN                                           
          S001U61O.GARANTERT_TPA = NORMAL ;                                     
       ELSE                                                                     
          DO;                                                                   
            S001U61O.GARANTERT_TPA = DFHBMBRY;                                  
            S001U61I.GARANTERT_TPL = CURSOR_POS;                                
            IF U3S.GARANTERT_TPNR ^= 999 THEN                                   
               CALL SKRIV_FEIL(U3S.GARANTERT_TPNR);                             
          END;                                                                  
       IF U3S.PINR = 0 THEN                                                     
          S001U61O.PIA = NOR_NUM;                                               
       ELSE                                                                     
          DO;                                                                   
            S001U61O.PIA = BRI_NUM;                                             
            S001U61I.PIL = CURSOR_POS;                                          
            IF U3S.PINR ^= 999 THEN                                             
               CALL SKRIV_FEIL(U3S.PINR);                                       
          END;                                                                  
       IF U3S.YNGSTE_BARN_FÅRNR = 0 THEN                                        
          S001U61O.YNGSTE_BARN_FÅRA = NOR_NUM;                                  
       ELSE                                                                     
          DO;                                                                   
            S001U61O.YNGSTE_BARN_FÅRA = BRI_NUM;                                
            S001U61I.YNGSTE_BARN_FÅRL = CURSOR_POS;                             
            IF U3S.YNGSTE_BARN_FÅRNR ^= 999 THEN                                
               CALL SKRIV_FEIL(U3S.YNGSTE_BARN_FÅRNR);                          
          END;                                                                  
       IF U3S.YRKENR = 0 THEN                                                   
          S001U61O.YRKEA = NOR_NUM;                                             
       ELSE                                                                     
          DO;                                                                   
            S001U61O.YRKEA = BRI_NUM;                                           
            S001U61I.YRKEL = CURSOR_POS;                                        
            IF U3S.YRKENR ^= 999 THEN                                           
               CALL SKRIV_FEIL(U3S.YRKENR);                                     
          END;                                                                  
       IF U3S.VIRK_DATO_ÅMDNR = 0 THEN                                          
          S001U61O.VIRK_DATO_MÅA = NOR_NUM;                                     
       ELSE                                                                     
          DO;                                                                   
            S001U61O.VIRK_DATO_MÅA = BRI_NUM;                                   
            S001U61I.VIRK_DATO_MÅL = CURSOR_POS;                                
            IF U3S.VIRK_DATO_ÅMDNR ^= 999 THEN                                  
               CALL SKRIV_FEIL(U3S.VIRK_DATO_ÅMDNR);                            
          END;                                                                  
                                                                                
       IF U3S.INNTEKT_FØR_UPNR = 0 THEN                                         
          S001U61O.INNTEKT_FØR_UPA = NOR_NUM;                                   
       ELSE                                                                     
          DO;                                                                   
            S001U61O.INNTEKT_FØR_UPA = BRI_NUM;                                 
            S001U61I.INNTEKT_FØR_UPL = CURSOR_POS;                              
            IF U3S.INNTEKT_FØR_UPNR ^= 999 THEN                                 
               CALL SKRIV_FEIL(U3S.INNTEKT_FØR_UPNR);                           
          END;                                                                  
                                                                                
       IF U3S.REAKTIVISERINGNR = 0 THEN                                         
          S001U61O.REAKTIVISERINGA = NORMAL ;                                   
       ELSE                                                                     
          DO;                                                                   
            S001U61O.REAKTIVISERINGA = DFHBMBRY;                                
            S001U61I.REAKTIVISERINGL = CURSOR_POS;                              
            IF U3S.REAKTIVISERINGNR ^= 999 THEN                                 
               CALL SKRIV_FEIL(U3S.REAKTIVISERINGNR);                           
          END;                                                                  
                                                                                
                                                                                
       IF U3S.UNNTAK_VENTETIDNR = 0 THEN                                        
          S001U61O.UNNTAK_VENTETIDA = NORMAL ;                                  
       ELSE                                                                     
          DO;                                                                   
            S001U61O.UNNTAK_VENTETIDA = DFHBMBRY;                               
            S001U61I.UNNTAK_VENTETIDL = CURSOR_POS;                             
            IF U3S.UNNTAK_VENTETIDNR ^= 999 THEN                                
               CALL SKRIV_FEIL(U3S.UNNTAK_VENTETIDNR);                          
          END;                                                                  
                                                                                
       IF U3S.FRYSP_5ÅR_ARBNR = 0 THEN                                          
          S001U61O.FRYSP_5ÅR_ARBA = NORMAL ;                                    
       ELSE                                                                     
          DO;                                                                   
            S001U61O.FRYSP_5ÅR_ARBA =   DFHBMBRY;                               
            S001U61I.FRYSP_5ÅR_ARBL = CURSOR_POS;                               
            IF U3S.FRYSP_5ÅR_ARBNR ^= 999 THEN                                  
               CALL SKRIV_FEIL(U3S.FRYSP_5ÅR_ARBNR);                            
          END;                                                                  
                                                                                
       IF U3S.FRYSP_TIDSBNR = 0 THEN                                            
          S001U61O.FRYSP_TIDSBA = NORMAL ;                                      
       ELSE                                                                     
          DO;                                                                   
            S001U61O.FRYSP_TIDSBA =   DFHBMBRY;                                 
            S001U61I.FRYSP_TIDSBL = CURSOR_POS;                                 
            IF U3S.FRYSP_TIDSBNR ^= 999 THEN                                    
               CALL SKRIV_FEIL(U3S.FRYSP_TIDSBNR);                              
          END;                                                                  
                                                                                
                                                                                
       IF U3S.LØNNSTILSKUDDNR = 0 THEN                                          
          S001U61O.LØNNSTILSKA = NORMAL ;                                       
       ELSE                                                                     
          DO;                                                                   
            S001U61O.LØNNSTILSKA =    DFHBMBRY;                                 
            S001U61I.LØNNSTILSKL = CURSOR_POS;                                  
            IF U3S.LØNNSTILSKUDDNR ^= 999 THEN                                  
               CALL SKRIV_FEIL(U3S.LØNNSTILSKUDDNR);                            
          END;                                                                  
                                                                                
                                                                                
       IF U3S.FNR_EKNR = 0 THEN                                                 
          S001U61O.FNR_EKA = NOR_NUM;                                           
       ELSE                                                                     
          DO;                                                                   
            S001U61O.FNR_EKA = BRI_NUM;                                         
            S001U61I.FNR_EKL = CURSOR_POS;                                      
            IF U3S.FNR_EKNR ^= 999 THEN                                         
               CALL SKRIV_FEIL(U3S.FNR_EKNR);                                   
          END;                                                                  
       IF U3S.NAVN_EKNR = 0 THEN                                                
          S001U61O.NAVN_EKA = NORMAL;                                           
       ELSE                                                                     
          DO;                                                                   
            S001U61O.NAVN_EKA = DFHBMBRY;                                       
            S001U61I.NAVN_EKL = CURSOR_POS;                                     
            IF U3S.NAVN_EKNR ^= 999 THEN                                        
               CALL SKRIV_FEIL(U3S.NAVN_EKNR);                                  
          END;                                                                  
                                                                                
       IF U3S.EK_INNT_OVER_2GNR = 0 THEN                                        
          S001U61O.EK_INNT_OVER_2GA = NORMAL;                                   
       ELSE                                                                     
          DO;                                                                   
            S001U61O.EK_INNT_OVER_2GA = DFHBMBRY;                               
            S001U61I.EK_INNT_OVER_2GL = CURSOR_POS;                             
            IF U3S.EK_INNT_OVER_2GNR ^= 999 THEN                                
               CALL SKRIV_FEIL(U3S.EK_INNT_OVER_2GNR);                          
          END;                                                                  
                                                                                
       IF U3S.RED_GP_3_2_5NR = 0 THEN                                           
          S001U61O.RED_GP_3_2_5A = NORMAL;                                      
       ELSE                                                                     
          DO;                                                                   
            S001U61O.RED_GP_3_2_5A = DFHBMBRY;                                  
            S001U61I.RED_GP_3_2_5L = CURSOR_POS;                                
            IF U3S.RED_GP_3_2_5NR ^= 999 THEN                                   
               CALL SKRIV_FEIL(U3S.RED_GP_3_2_5NR);                             
          END;                                                                  
                                                                                
                                                                                
       IF TRANS_OPPL_OMR.NY_GML_TRANS_IND = 'G' & FRA_MED_DIALOG THEN           
          DO;                                                                   
             S001U61O.VIRK_DATO_MÅA = '0'; /* PROTECTED AND ASKIP     */        
             S001U61O.FNRA          = DFHBMASK;                                 
          END;                                                                  
       ELSE                                                                     
          IF FRA_UTEN_DIALOG THEN     /* BLOKKER ALT SAMMEN !         */        
             DO;                                                                
                S001U61O.ATT_UFA         = DFHBMASK;                            
         /*     S001U61O.REGDATOA        = DFHBMASK;                            
                S001U61O.TERMIDA         = DFHBMASK; */                         
                S001U61O.FNRA            = DFHBMASK;                            
                S001U61O.NAVNA           = DFHBMASK;                            
                S001U61O.SPRÅKA          = DFHBMASK;                            
                S001U61O.TKNRA           = DFHBMASK;                            
                S001U61O.SIVILSTANDA     = DFHBMASK;                            
                S001U61O.TILL_EKA        = DFHBMASK;                            
                S001U61O.TILL_BARNA      = DFHBMASK;                            
                S001U61O.NORSK_BOSATTA   = DFHBMASK;                            
                S001U61O.UTDANNINGA      = DFHBMASK;                            
                S001U61O.YRKESM_ATTFA    = DFHBMASK;                            
                S001U61O.YSKADE_TILLEGGA = DFHBMASK;                            
                S001U61O.YNGSTE_BARN_FÅRA = DFHBMASK;                           
                S001U61O.VP_ÅR1A         = DFHBMASK;                            
                S001U61O.VP_ÅR2A         = DFHBMASK;                            
                S001U61O.VP_ÅR3A         = DFHBMASK;                            
                S001U61O.VP_ÅR4A         = DFHBMASK;                            
                S001U61O.VILKÅR_8_4_3AA  = DFHBMASK;                            
                S001U61O.UFGA            = DFHBMASK;                            
                S001U61O.UFT_MÅA         = DFHBMASK;                            
                S001U61O.FRIINNTEKT_DATO_DMÅA = DFHBMASK;                       
                S001U61O.GARANTERT_TPA    = DFHBMASK;                           
                S001U61O.PIA             = DFHBMASK;                            
                S001U61O.YRKEA           = DFHBMASK;                            
                S001U61O.VIRK_DATO_MÅA   = DFHBMASK;                            
                S001U61O.INNTEKT_FØR_UPA = DFHBMASK;                            
                S001U61O.REAKTIVISERINGA = DFHBMASK;                            
                S001U61O.UNNTAK_VENTETIDA = DFHBMASK;                           
                S001U61O.FRYSP_5ÅR_ARBA    = DFHBMASK;                          
                S001U61O.FRYSP_TIDSBA      = DFHBMASK;                          
                S001U61O.LØNNSTILSKA       = DFHBMASK;                          
                S001U61O.FNR_EKA         = DFHBMASK;                            
                S001U61O.NAVN_EKA        = DFHBMASK;                            
                S001U61O.EK_INNT_OVER_2GA = DFHBMASK;                           
                S001U61O.RED_GP_3_2_5A = DFHBMASK;                              
                MELDING6O =                                                     
                          'TRYKK PF1 FOR OPPBEVAR, PF2 FOR FORKASTE.';          
             END;                                                               
       IF ^FRA_CICS THEN                                                        
          DO;                                                                   
             S001U61O.STYRE_KODEA    = DFHBMASK;                                
             S001U61O.FUNKSJONSKODEA = DFHBMASK;                                
          END;                                                                  
   END OVERFØR_U3_SØKER_MAP;                                                    
  % PAGE;                                                                       
  /* **************************************************************** */        
  /*                                                                  */        
  /*   PROSEDYRA OVERFØRER DATA FRA UP_TRANS_OMR.U3SP TIL             */        
  /*   SKJERMBILDE UP_SPES. DELEN.                                    */        
  /*   MAP: S001U61                                                   */        
  /*   MAPSET: S00106                                                 */        
  /*                                                                  */        
  /* **************************************************************** */        
  % SKIP (2);                                                                   
  OVERFØR_U3_SP_MAP:   PROC;                                                    
                                                                                
    DCL                                                                         
       NORMAL  CHAR (1) INIT(' '),                                              
       NOR_NUM CHAR (1) INIT('&'),                                              
       BRI_NUM CHAR (1) INIT('Q');                                              
   DCL HJ_DATO         CHAR (6);                                                
                                                                                
  % SKIP;                                                                       
       S001U62O.REGDATOO      = KONV_HÅMD_ÅMD(U3S.REGDATO_ÅMD);                 
       IF F_FELT_PIC_CHAR3(U3SP.STATSBORGER) ^= '000' THEN                      
          S001U62O.STATSBORGERO   =  F_FELT_PIC_CHAR3(U3SP.STATSBORGER);        
       IF F_FELT_PIC_CHAR3(U3SP.BOSATT) ^= '000' THEN                           
          S001U62O.BOSATTO        = F_FELT_PIC_CHAR3(U3SP.BOSATT);              
       S001U62O.UNNTAK_12_2O = U3SP.UNNTAK_12_2 ;                               
       IF F_FELT_PIC_CHAR8(U3SP.STI_ÅMD_3B) ^= '00000000' THEN                  
          S001U62O.STI_MÅ_3BO   =  KONV_HÅMD_MÅ(U3SP.STI_ÅMD_3B);               
                                                                                
       S001U62O.FRAVIK_8_1O              =  U3SP.FRAVIK_8_1       ;             
       S001U62O.TT_PÅO                   =  U3SP.TT_PÅ ;                        
       S001U62O.TT_LIK_PÅO               =  U3SP.TT_LIK_PÅ ;                    
       S001U62O.TT_FRAMTIDIGO            =  U3SP.TT_FRAMTIDIG ;                 
       S001U62O.TT_FAKTISKO              =  U3SP.TT_FAKTISK ;                   
       S001U62O.UNG_UFØRO                =  U3SP.UNG_UFØR ;                     
       S001U62O.FRAVIK_19_3O             =  U3SP.FRAVIK_19_3 ;                  
                                                                                
       S001U62O.PENSJONSTRYGDETO  = U3SP.PENSJONSTRYGDET;                       
       S001U62O.MINST_20_ÅRO      = U3SP.MINST_20_ÅR ;                          
       S001U62O.KONVENSJONO       = U3SP.KONVENSJON ;                           
       S001U62O.KONVENSJON_LANDO  = U3SP.KONVENSJON_LAND ;                      
       S001U62O.FRAVI_BOSAT_EØSO = U3SP.FRAVIK_BOSATT_EØS;                      
       S001U62O.FRAVIK_FLYKTO     = U3SP.FRAVIK_FLYKT ;                         
       S001U62O.OVERKOMP_UTLO     = U3SP.OVERKOMP_UTL ;                         
       S001U62O.TT_FRA1937_ÅRO    = U3SP.TT_FRA1937_ÅR ;                        
       S001U62O.TT_FRA1937_MNDO   = U3SP.TT_FRA1937_MND ;                       
       S001U62O.TT_F67O           = U3SP.TT_F67    ;                            
       S001U62O.TT_E66_ÅO         = U3SP.TT_E66_Å    ;                          
       S001U62O.TT_E66_MO         = U3SP.TT_E66_M   ;                           
       S001U62O.TT_F67_EKO        = U3SP.TT_F67_EK   ;                          
       S001U62O.TT_E66_Å_EKO      = U3SP.TT_E66_Å_EK    ;                       
       S001U62O.TT_E66_M_EKO      = U3SP.TT_E66_M_EK   ;                        
       S001U62O.TT_ENDRESO        = U3SP.TT_ENDRES ;                            
       S001U62O.TT_NORDEN_ANNETO  = U3SP.TT_NORDEN_ANNET ;                      
       S001U62O.IKKE_GPO          = U3SP.IKKE_GP ;                              
       S001U62O.AVKORT_SÆRTILLO   = U3SP.AVKORT_SÆRTILL  ;                      
       S001U62O.TP_NORDISKO       = U3SP.TP_NORDISK      ;                      
       S001U62O.TP_NORDISK_LANDO  = U3SP.TP_NORDISK_LAND ;                      
       S001U62O.BEREGNING_KONVO   = U3SP.BEREGNING_KONV ;                       
       S001U62O.TT_KONVENSJON_ÅRO  = U3SP.TT_KONVENSJON_ÅR;                     
       S001U62O.EØS_OPPLYSNO       = U3SP.EØS_OPPLYSN     ;                     
                                                                                
       IF ^ FRA_CICS  THEN                                                      
          DO;                                                                   
             IF FEIL_MELD_NR > 0 THEN                                           
                CALL SKRIV_FEIL_SP(FEIL_MELD_NR);                               
             FEIL_MELD_NR = 0;                                                  
          END;                                                                  
                                                                                
 % SKIP (3);                                                                    
 /* MARKERING AV ATTRIBUTTER                                          */        
  % SKIP;                                                                       
       IF U3SP.STATSBORGERNR = 0 THEN                                           
          S001U62O.STATSBORGERA = NOR_NUM;                                      
       ELSE                                                                     
          DO;                                                                   
            S001U62O.STATSBORGERA = BRI_NUM;                                    
            S001U62I.STATSBORGERL = CURSOR_POS;                                 
            IF U3SP.STATSBORGERNR ^= 999 THEN                                   
               CALL SKRIV_FEIL_SP(U3SP.STATSBORGERNR);                          
          END;                                                                  
       IF U3SP.BOSATTNR = 0 THEN                                                
          S001U62O.BOSATTA = NOR_NUM;                                           
       ELSE                                                                     
          DO;                                                                   
            S001U62O.BOSATTA = BRI_NUM;                                         
            S001U62I.BOSATTL = CURSOR_POS;                                      
            IF U3SP.BOSATTNR ^= 999 THEN                                        
               CALL SKRIV_FEIL_SP(U3SP.BOSATTNR);                               
          END;                                                                  
       IF U3SP.UNNTAK_12_2NR = 0 THEN                                           
          S001U62O.UNNTAK_12_2A = NORMAL;                                       
       ELSE                                                                     
          DO;                                                                   
            S001U62O.UNNTAK_12_2A = DFHBMBRY;                                   
            S001U62I.UNNTAK_12_2L = CURSOR_POS;                                 
            IF U3SP.UNNTAK_12_2NR ^= 999 THEN                                   
               CALL SKRIV_FEIL_SP(U3SP.UNNTAK_12_2NR);                          
          END;                                                                  
       IF U3SP.PENSJONSTRYGDETNR = 0 THEN                                       
          S001U62O.PENSJONSTRYGDETA = NORMAL;                                   
       ELSE                                                                     
          DO;                                                                   
            S001U62O.PENSJONSTRYGDETA = DFHBMBRY;                               
            S001U62I.PENSJONSTRYGDETL = CURSOR_POS;                             
            IF U3SP.PENSJONSTRYGDETNR ^= 999 THEN                               
               CALL SKRIV_FEIL_SP(U3SP.PENSJONSTRYGDETNR);                      
          END;                                                                  
       IF U3SP.TT_LIK_PÅNR = 0 THEN                                             
          S001U62O.TT_LIK_PÅA = NORMAL;                                         
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_LIK_PÅA = DFHBMBRY;                                     
            S001U62I.TT_LIK_PÅL = CURSOR_POS;                                   
            IF U3SP.TT_LIK_PÅNR ^= 999 THEN                                     
               CALL SKRIV_FEIL_SP(U3SP.TT_LIK_PÅNR);                            
          END;                                                                  
                                                                                
       IF U3SP.MINST_20_ÅRNR = 0 THEN                                           
          S001U62O.MINST_20_ÅRA = NORMAL;                                       
       ELSE                                                                     
          DO;                                                                   
            S001U62O.MINST_20_ÅRA = DFHBMBRY;                                   
            S001U62I.MINST_20_ÅRL = CURSOR_POS;                                 
            IF U3SP.MINST_20_ÅRNR ^= 999 THEN                                   
               CALL SKRIV_FEIL_SP(U3SP.MINST_20_ÅRNR);                          
          END;                                                                  
       IF U3SP.KONVENSJONNR = 0 THEN                                            
          S001U62O.KONVENSJONA = NORMAL;                                        
       ELSE                                                                     
          DO;                                                                   
            S001U62O.KONVENSJONA = DFHBMBRY;                                    
            S001U62I.KONVENSJONL = CURSOR_POS;                                  
            IF U3SP.KONVENSJONNR ^= 999 THEN                                    
               CALL SKRIV_FEIL_SP(U3SP.KONVENSJONNR);                           
          END;                                                                  
       IF U3SP.KONVENSJON_LANDNR = 0 THEN                                       
          S001U62O.KONVENSJON_LANDA = NORMAL;                                   
       ELSE                                                                     
          DO;                                                                   
            S001U62O.KONVENSJON_LANDA = DFHBMBRY;                               
            S001U62I.KONVENSJON_LANDL = CURSOR_POS;                             
            IF U3SP.KONVENSJON_LANDNR ^= 999 THEN                               
               CALL SKRIV_FEIL_SP(U3SP.KONVENSJON_LANDNR);                      
          END;                                                                  
       IF U3SP.FRAVIK_BOSATT_EØSNR = 0 THEN                                     
          S001U62O.FRAVI_BOSAT_EØSA = NORMAL;                                   
       ELSE                                                                     
          DO;                                                                   
            S001U62O.FRAVI_BOSAT_EØSA = DFHBMBRY;                               
            S001U62I.FRAVI_BOSAT_EØSL = CURSOR_POS;                             
            IF U3SP.FRAVIK_BOSATT_EØSNR ^= 999 THEN                             
               CALL SKRIV_FEIL_SP(U3SP.FRAVIK_BOSATT_EØSNR);                    
          END;                                                                  
                                                                                
       IF U3SP.FRAVIK_8_1NR = 0 THEN                                            
          S001U62O.FRAVIK_8_1A = NORMAL;                                        
       ELSE                                                                     
          DO;                                                                   
            S001U62O.FRAVIK_8_1A = DFHBMBRY;                                    
            S001U62I.FRAVIK_8_1L = CURSOR_POS;                                  
            IF U3SP.FRAVIK_8_1NR ^= 999 THEN                                    
               CALL SKRIV_FEIL_SP(U3SP.FRAVIK_8_1NR);                           
          END;                                                                  
                                                                                
       IF U3SP.TT_PÅNR = 0 THEN                                                 
          S001U62O.TT_PÅA = NORMAL;                                             
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_PÅA = DFHBMBRY;                                         
            S001U62I.TT_PÅL = CURSOR_POS;                                       
            IF U3SP.TT_PÅNR ^= 999 THEN                                         
               CALL SKRIV_FEIL_SP(U3SP.TT_PÅNR);                                
          END;                                                                  
                                                                                
       IF U3SP.TT_FRAMTIDIGNR = 0 THEN                                          
          S001U62O.TT_FRAMTIDIGA = NORMAL;                                      
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_FRAMTIDIGA = DFHBMBRY;                                  
            S001U62I.TT_FRAMTIDIGL = CURSOR_POS;                                
            IF U3SP.TT_FRAMTIDIGNR ^= 999 THEN                                  
               CALL SKRIV_FEIL_SP(U3SP.TT_FRAMTIDIGNR);                         
          END;                                                                  
                                                                                
       IF U3SP.TT_FAKTISKNR = 0 THEN                                            
          S001U62O.TT_FAKTISKA = NORMAL;                                        
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_FAKTISKA = DFHBMBRY;                                    
            S001U62I.TT_FAKTISKL = CURSOR_POS;                                  
            IF U3SP.TT_FAKTISKNR ^= 999 THEN                                    
               CALL SKRIV_FEIL_SP(U3SP.TT_FAKTISKNR);                           
          END;                                                                  
    /* UTGÅR :                                                                  
       IF U3SP.FRAVIK_5_1NR = 0 THEN                                            
          S001U62O.FRAVIK_5_1A = NORMAL;                                        
       ELSE                                                                     
          DO;                                                                   
            S001U62O.FRAVIK_5_1A = DFHBMBRY;                                    
            S001U62I.FRAVIK_5_1L = CURSOR_POS;                                  
            IF U3SP.FRAVIK_5_1NR ^= 999 THEN                                    
               CALL SKRIV_FEIL_SP(U3SP.FRAVIK_5_1NR);                           
          END;                                                                  
   ************************************* */                                     
                                                                                
       IF U3SP.UNG_UFØRNR = 0 THEN                                              
          S001U62O.UNG_UFØRA = NORMAL;                                          
       ELSE                                                                     
          DO;                                                                   
            S001U62O.UNG_UFØRA = DFHBMBRY;                                      
            S001U62I.UNG_UFØRL = CURSOR_POS;                                    
            IF U3SP.UNG_UFØRNR ^= 999 THEN                                      
               CALL SKRIV_FEIL_SP(U3SP.UNG_UFØRNR);                             
          END;                                                                  
                                                                                
       IF U3SP.FRAVIK_19_3NR = 0 THEN                                           
          S001U62O.FRAVIK_19_3A = NORMAL;                                       
       ELSE                                                                     
          DO;                                                                   
            S001U62O.FRAVIK_19_3A = DFHBMBRY;                                   
            S001U62I.FRAVIK_19_3L = CURSOR_POS;                                 
            IF U3SP.FRAVIK_19_3NR ^= 999 THEN                                   
               CALL SKRIV_FEIL_SP(U3SP.FRAVIK_19_3NR);                          
          END;                                                                  
                                                                                
                                                                                
       IF U3SP.FRAVIK_FLYKTNR = 0 THEN                                          
          S001U62O.FRAVIK_FLYKTA = NORMAL;                                      
       ELSE                                                                     
          DO;                                                                   
            S001U62O.FRAVIK_FLYKTA = DFHBMBRY;                                  
            S001U62I.FRAVIK_FLYKTL = CURSOR_POS;                                
            IF U3SP.FRAVIK_FLYKTNR ^= 999 THEN                                  
               CALL SKRIV_FEIL_SP(U3SP.FRAVIK_FLYKTNR);                         
          END;                                                                  
       IF U3SP.OVERKOMP_UTLNR = 0 THEN                                          
          S001U62O.OVERKOMP_UTLA = NORMAL;                                      
       ELSE                                                                     
          DO;                                                                   
            S001U62O.OVERKOMP_UTLA = DFHBMBRY;                                  
            S001U62I.OVERKOMP_UTLL = CURSOR_POS;                                
            IF U3SP.OVERKOMP_UTLNR ^= 999 THEN                                  
               CALL SKRIV_FEIL_SP(U3SP.OVERKOMP_UTLNR);                         
          END;                                                                  
       IF U3SP.IKKE_GPNR = 0 THEN                                               
          S001U62O.IKKE_GPA = NORMAL;                                           
       ELSE                                                                     
          DO;                                                                   
            S001U62O.IKKE_GPA = DFHBMBRY;                                       
            S001U62I.IKKE_GPL = CURSOR_POS;                                     
            IF U3SP.IKKE_GPNR ^= 999 THEN                                       
               CALL SKRIV_FEIL_SP(U3SP.IKKE_GPNR);                              
          END;                                                                  
       IF U3SP.BEREGNING_KONVNR = 0 THEN                                        
          S001U62O.BEREGNING_KONVA = NORMAL;                                    
       ELSE                                                                     
          DO;                                                                   
            S001U62O.BEREGNING_KONVA = DFHBMBRY;                                
            S001U62I.BEREGNING_KONVL = CURSOR_POS;                              
            IF U3SP.BEREGNING_KONVNR ^= 999 THEN                                
               CALL SKRIV_FEIL_SP(U3SP.BEREGNING_KONVNR);                       
          END;                                                                  
       IF U3SP.TT_KONVENSJON_ÅRNR = 0 THEN                                      
          S001U62O.TT_KONVENSJON_ÅRA = NOR_NUM;                                 
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_KONVENSJON_ÅRA = DFHBMBRY;                              
            S001U62I.TT_KONVENSJON_ÅRL = CURSOR_POS;                            
            IF U3SP.TT_KONVENSJON_ÅRNR ^= 999 THEN                              
               CALL SKRIV_FEIL_SP(U3SP.TT_KONVENSJON_ÅRNR);                     
          END;                                                                  
       IF U3SP.TT_FRA1937_ÅRNR = 0 THEN                                         
          S001U62O.TT_FRA1937_ÅRA = NOR_NUM;                                    
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_FRA1937_ÅRA = DFHBMBRY;                                 
            S001U62I.TT_FRA1937_ÅRL = CURSOR_POS;                               
            IF U3SP.TT_FRA1937_ÅRNR ^= 999 THEN                                 
               CALL SKRIV_FEIL_SP(U3SP.TT_FRA1937_ÅRNR);                        
          END;                                                                  
       IF U3SP.TT_FRA1937_MNDNR = 0 THEN                                        
          S001U62O.TT_FRA1937_MNDA = NOR_NUM;                                   
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_FRA1937_MNDA = DFHBMBRY;                                
            S001U62I.TT_FRA1937_MNDL = CURSOR_POS;                              
            IF U3SP.TT_FRA1937_MNDNR ^= 999 THEN                                
               CALL SKRIV_FEIL_SP(U3SP.TT_FRA1937_MNDNR);                       
          END;                                                                  
       IF U3SP.TT_F67NR = 0 THEN                                                
          S001U62O.TT_F67A = NOR_NUM;                                           
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_F67A = DFHBMBRY;                                        
            S001U62I.TT_F67L = CURSOR_POS;                                      
            IF U3SP.TT_F67NR ^= 999 THEN                                        
               CALL SKRIV_FEIL_SP(U3SP.TT_F67NR);                               
          END;                                                                  
       IF U3SP.TT_E66_ÅNR = 0 THEN                                              
          S001U62O.TT_E66_ÅA = NOR_NUM;                                         
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_E66_ÅA = DFHBMBRY;                                      
            S001U62I.TT_E66_ÅL = CURSOR_POS;                                    
            IF U3SP.TT_E66_ÅNR ^= 999 THEN                                      
               CALL SKRIV_FEIL_SP(U3SP.TT_E66_ÅNR);                             
          END;                                                                  
       IF U3SP.TT_E66_MNR = 0 THEN                                              
          S001U62O.TT_E66_MA = NOR_NUM;                                         
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_E66_MA = DFHBMBRY;                                      
            S001U62I.TT_E66_ML = CURSOR_POS;                                    
            IF U3SP.TT_E66_MNR ^= 999 THEN                                      
               CALL SKRIV_FEIL_SP(U3SP.TT_E66_MNR);                             
          END;                                                                  
       IF U3SP.TT_F67_EKNR = 0 THEN                                             
          S001U62O.TT_F67_EKA = NOR_NUM;                                        
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_F67_EKA = DFHBMBRY;                                     
            S001U62I.TT_F67_EKL = CURSOR_POS;                                   
            IF U3SP.TT_F67_EKNR ^= 999 THEN                                     
               CALL SKRIV_FEIL_SP(U3SP.TT_F67_EKNR);                            
          END;                                                                  
       IF U3SP.TT_E66_Å_EKNR = 0 THEN                                           
          S001U62O.TT_E66_Å_EKA = NOR_NUM;                                      
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_E66_Å_EKA = DFHBMBRY;                                   
            S001U62I.TT_E66_Å_EKL = CURSOR_POS;                                 
            IF U3SP.TT_E66_Å_EKNR ^= 999 THEN                                   
               CALL SKRIV_FEIL_SP(U3SP.TT_E66_Å_EKNR);                          
          END;                                                                  
       IF U3SP.TT_E66_M_EKNR = 0 THEN                                           
          S001U62O.TT_E66_M_EKA = NOR_NUM;                                      
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_E66_M_EKA = DFHBMBRY;                                   
            S001U62I.TT_E66_M_EKL = CURSOR_POS;                                 
            IF U3SP.TT_E66_M_EKNR ^= 999 THEN                                   
               CALL SKRIV_FEIL_SP(U3SP.TT_E66_M_EKNR);                          
          END;                                                                  
       IF U3SP.TT_ENDRESNR = 0 THEN                                             
          S001U62O.TT_ENDRESA = NOR_NUM;                                        
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_ENDRESA = DFHBMBRY;                                     
            S001U62I.TT_ENDRESL = CURSOR_POS;                                   
            IF U3SP.TT_ENDRESNR ^= 999 THEN                                     
               CALL SKRIV_FEIL_SP(U3SP.TT_ENDRESNR);                            
          END;                                                                  
       IF U3SP.TT_NORDEN_ANNETNR = 0 THEN                                       
          S001U62O.TT_NORDEN_ANNETA = NORMAL;                                   
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TT_NORDEN_ANNETA = DFHBMBRY;                               
            S001U62I.TT_NORDEN_ANNETL = CURSOR_POS;                             
            IF U3SP.TT_NORDEN_ANNETNR ^= 999 THEN                               
               CALL SKRIV_FEIL_SP(U3SP.TT_NORDEN_ANNETNR);                      
          END;                                                                  
       IF U3SP.AVKORT_SÆRTILLNR = 0 THEN                                        
          S001U62O.AVKORT_SÆRTILLA = NORMAL;                                    
       ELSE                                                                     
          DO;                                                                   
            S001U62O.AVKORT_SÆRTILLA = DFHBMBRY;                                
            S001U62I.AVKORT_SÆRTILLL = CURSOR_POS;                              
            IF U3SP.AVKORT_SÆRTILLNR ^= 999 THEN                                
               CALL SKRIV_FEIL_SP(U3SP.AVKORT_SÆRTILLNR);                       
          END;                                                                  
       IF U3SP.TP_NORDISKNR = 0 THEN                                            
          S001U62O.TP_NORDISKA = NORMAL;                                        
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TP_NORDISKA = DFHBMBRY;                                    
            S001U62I.TP_NORDISKL = CURSOR_POS;                                  
            IF U3SP.TP_NORDISKNR ^= 999 THEN                                    
               CALL SKRIV_FEIL_SP(U3SP.TP_NORDISKNR);                           
          END;                                                                  
       IF U3SP.TP_NORDISK_LANDNR = 0 THEN                                       
          S001U62O.TP_NORDISK_LANDA = NORMAL;                                   
       ELSE                                                                     
          DO;                                                                   
            S001U62O.TP_NORDISK_LANDA = DFHBMBRY;                               
            S001U62I.TP_NORDISK_LANDL = CURSOR_POS;                             
            IF U3SP.TP_NORDISK_LANDNR ^= 999 THEN                               
               CALL SKRIV_FEIL_SP(U3SP.TP_NORDISK_LANDNR);                      
          END;                                                                  
       IF U3SP.STI_ÅMD_3BNR = 0 THEN                                            
          S001U62O.STI_MÅ_3BA = NOR_NUM;                                        
       ELSE                                                                     
          DO;                                                                   
            S001U62O.STI_MÅ_3BA = DFHBMBRY;                                     
            S001U62I.STI_MÅ_3BL = CURSOR_POS;                                   
            IF U3SP.STI_ÅMD_3BNR ^= 999 THEN                                    
               CALL SKRIV_FEIL_SP(U3SP.STI_ÅMD_3BNR);                           
          END;                                                                  
                                                                                
       IF U3SP.EØS_OPPLYSNNR = 0 THEN                                           
          S001U62O.EØS_OPPLYSNA = NORMAL ;                                      
       ELSE                                                                     
          DO;                                                                   
            S001U62O.EØS_OPPLYSNA = DFHBMBRY;                                   
            S001U62I.EØS_OPPLYSNL = CURSOR_POS;                                 
            IF U3SP.EØS_OPPLYSNNR ^= 999 THEN                                   
               CALL SKRIV_FEIL_SP(U3SP.EØS_OPPLYSNNR);                          
          END;                                                                  
                                                                                
     /* *****  BLOKKERE_SPES_U3;  ********************* */                      
                                                                                
          IF FRA_UTEN_DIALOG THEN                                               
             DO;                                                                
                S001U62O.REGDATOA                =    DFHBMASK;                 
                S001U62O.STATSBORGERA            =    DFHBMASK;                 
                S001U62O.BOSATTA                 =    DFHBMASK;                 
                S001U62O.UNNTAK_12_2A            =    DFHBMASK;                 
                S001U62O.STI_MÅ_3BA              =    DFHBMASK;                 
                S001U62O.PENSJONSTRYGDETA        =    DFHBMASK;                 
                S001U62O.MINST_20_ÅRA            =    DFHBMASK;                 
                S001U62O.KONVENSJONA             =    DFHBMASK;                 
                S001U62O.KONVENSJON_LANDA        =    DFHBMASK;                 
                S001U62O.FRAVI_BOSAT_EØSA        =    DFHBMASK;                 
                S001U62O.FRAVIK_FLYKTA           =    DFHBMASK;                 
                S001U62O.OVERKOMP_UTLA           =    DFHBMASK;                 
                S001U62O.TT_FRA1937_ÅRA          =    DFHBMASK;                 
                S001U62O.TT_FRA1937_MNDA         =    DFHBMASK;                 
                S001U62O.TT_F67A                 =    DFHBMASK;                 
                S001U62O.TT_E66_ÅA               =    DFHBMASK;                 
                S001U62O.TT_E66_MA               =    DFHBMASK;                 
                S001U62O.TT_F67_EKA              =    DFHBMASK;                 
                S001U62O.TT_E66_Å_EKA            =    DFHBMASK;                 
                S001U62O.TT_E66_M_EKA            =    DFHBMASK;                 
                S001U62O.TT_ENDRESA              =    DFHBMASK;                 
                S001U62O.TT_NORDEN_ANNETA        =    DFHBMASK;                 
                S001U62O.IKKE_GPA                =    DFHBMASK;                 
                S001U62O.AVKORT_SÆRTILLA         =    DFHBMASK;                 
                S001U62O.TP_NORDISKA             =    DFHBMASK;                 
                S001U62O.TP_NORDISK_LANDA        =    DFHBMASK;                 
                S001U62O.BEREGNING_KONVA         =    DFHBMASK;                 
                S001U62O.TT_KONVENSJON_ÅRA        =    DFHBMASK;                
                                                                                
                S001U62O.FRAVIK_8_1A        =         DFHBMASK;                 
                S001U62O.TT_PÅA           =            DFHBMASK;                
                S001U62O.TT_LIK_PÅA       =            DFHBMASK;                
                S001U62O.TT_FRAMTIDIGA    =            DFHBMASK;                
                S001U62O.TT_FAKTISKA      =            DFHBMASK;                
              /* S001U62O.FRAVIK_5_1A  =      DFHBMASK;  */                     
                S001U62O.UNG_UFØRA        =            DFHBMASK;                
                S001U62O.FRAVIK_19_3A     =            DFHBMASK;                
                S001U62O.EØS_OPPLYSNA            =    DFHBMASK;                 
                                                                                
             END;                                                               
       IF ^FRA_CICS THEN                                                        
          DO;                                                                   
             S001U62O.STYRE_KODEA    = DFHBMASK;                                
             S001U62O.FUNKSJONSKODEA = DFHBMASK;                                
          END;                                                                  
                                                                                
       IF (U3S.VIRK_DATO_ÅMD > 19910000) THEN                                   
          DO;  /* VI SPERRER UAKTUELLE FELT ? */                                
          /* S001U61O.VIRK_DATO_MÅA = '0'  /* PROTECTED AND ASKIP     */        
             S001U62O.TT_E66_ÅA               =    DFHBMASK;                    
             S001U62O.TT_E66_MA               =    DFHBMASK;                    
          END; /* VI SPERRER UAKTUELLE FELT ? */                                
       ELSE                                                                     
          DO;  /* VI SPERRER UAKTUELLE FELT ? */                                
             S001U62O.TT_F67A                 =    DFHBMASK;                    
          END; /* VI SPERRER UAKTUELLE FELT ? */                                
  END OVERFØR_U3_SP_MAP;                                                        
                                                                                
  OVERFØR_U3_EØS_MAP:   PROC;                                                   
                                                                                
    DCL                                                                         
       NORMAL  CHAR (1) INIT(' '),                                              
       NOR_NUM CHAR (1) INIT('&'),                                              
       BRI_NUM CHAR (1) INIT('Q');                                              
   DCL HJ_DATO         CHAR (6);                                                
                                                                                
       S001U63O.BEREGN_FOLKETRYGDO  = U3EØS.BEREGN_FOLKETRYGD;                  
       S001U63O.EØS_8_4_3AO       = U3EØS.EØS_8_4_3A     ;                      
       S001U63O.TT_TERO_EØS_ÅRO   = U3EØS.TT_TEORETISK_EØS_ÅR;                  
       S001U63O.TT_TERO_EØS_MNDO  = U3EØS.TT_TEORETISK_EØS_MND;                 
       S001U63O.TT_PRORATA_EØS_ÅRO   = U3EØS.TT_PRORATA_EØS_ÅR ;                
       S001U63O.TT_PRORATA_EØS_MNDO  = U3EØS.TT_PRORATA_EØS_MND ;               
       S001U63O.PENSJON_EØSO      = U3EØS.PENSJON_EØS    ;                      
                                                                                
       S001U63O.TT_FAKTISK_NORDISK_ÅRO  =  U3EØS.TT_FAKTISK_NORDISK_ÅR;         
       S001U63O.TT_FAKTISK_NORDISK_MNDO =  U3EØS.TT_FAKTISK_NORDISK_MND;        
       S001U63O.PÅ_FAKTISK_NORDISKO     =  U3EØS.PÅ_FAKTISK_NORDISK;            
                                                                                
   /* BILDE HAR BARE 33 FELT           */                                       
       DO K = 1 TO HBOUND(U3EØS.TAB_EØS );                                      
          IF (U3EØS.EØS_ÅR (K) > 0) THEN                                        
             S001U63O.EØS_ÅRO(K)  = U3EØS.EØS_ÅR(K);                            
          ELSE                                                                  
              S001U63O.EØS_ÅRO(K) = '0000';                                     
       END;                                                                     
                                                                                
       DO K = 1 TO HBOUND(U3EØS.IKKE_PRO_TAB);                                  
          IF (U3EØS.EØS_ÅR_IKKE_PRO_RATA(K) > 0) THEN                           
             S001U63O.EØS_ÅR_IKKE_PRO_RATAO(K) =                                
                U3EØS.EØS_ÅR_IKKE_PRO_RATA(K);                                  
          ELSE                                                                  
             S001U63O.EØS_ÅR_IKKE_PRO_RATAO (K) = '0000';                       
       END;                                                                     
                                                                                
       IF U3EØS.BEREGN_FOLKETRYGDNR = 0 THEN                                    
          S001U63O.BEREGN_FOLKETRYGDA = NORMAL;                                 
       ELSE                                                                     
          DO;                                                                   
            S001U63O.BEREGN_FOLKETRYGDA = DFHBMBRY;                             
            S001U63I.BEREGN_FOLKETRYGDL = CURSOR_POS;                           
            IF U3EØS.BEREGN_FOLKETRYGDNR ^= 999 THEN                            
               CALL SKRIV_FEIL_EØS(U3EØS.BEREGN_FOLKETRYGDNR);                  
          END;                                                                  
       IF U3EØS.EØS_8_4_3ANR = 0 THEN                                           
          S001U63O.EØS_8_4_3AA = NORMAL;                                        
       ELSE                                                                     
          DO;                                                                   
            S001U63O.EØS_8_4_3AA = DFHBMBRY;                                    
            S001U63I.EØS_8_4_3AL = CURSOR_POS;                                  
            IF U3EØS.EØS_8_4_3ANR ^= 999 THEN                                   
               CALL SKRIV_FEIL_EØS(U3EØS.EØS_8_4_3ANR);                         
          END;                                                                  
                                                                                
       DO K = 1 TO HBOUND(U3EØS.TAB_EØS );                                      
          IF U3EØS.EØS_ÅRNR(K) = 0 THEN                                         
             S001U63O.EØS_ÅRA(K) = NORMAL;                                      
          ELSE                                                                  
             DO;                                                                
                S001U63O.EØS_ÅRA(K) = DFHBMBRY;                                 
                S001U63I.EØS_ÅRL(K) = CURSOR_POS;                               
                IF U3EØS.EØS_ÅRNR(K) ^= 999 THEN                                
                   CALL SKRIV_FEIL_EØS(U3EØS.EØS_ÅRNR(K));                      
             END;                                                               
       END;                                                                     
                                                                                
       DO K = 1 TO HBOUND(U3EØS.IKKE_PRO_TAB);                                  
          IF (U3EØS.EØS_ÅR_IKKE_PRO_RATANR(K) = 0) THEN                         
             S001U63O.EØS_ÅR_IKKE_PRO_RATAA(K) = NORMAL;                        
          ELSE                                                                  
             DO;                                                                
                S001U63O.EØS_ÅR_IKKE_PRO_RATAA(K) = DFHBMBRY;                   
                S001U63I.EØS_ÅR_IKKE_PRO_RATAL(K) = CURSOR_POS;                 
                IF (U3EØS.EØS_ÅR_IKKE_PRO_RATANR(K) ^= 999) THEN                
                   CALL SKRIV_FEIL_EØS(U3EØS.EØS_ÅR_IKKE_PRO_RATANR(K));        
             END;                                                               
       END;                                                                     
                                                                                
       IF U3EØS.TT_TEORETISK_EØS_ÅRNR = 0 THEN                                  
          S001U63O.TT_TERO_EØS_ÅRA = NORMAL;                                    
       ELSE                                                                     
          DO;                                                                   
            S001U63O.TT_TERO_EØS_ÅRA = DFHBMBRY;                                
            S001U63I.TT_TERO_EØS_ÅRL = CURSOR_POS;                              
            IF U3EØS.TT_TEORETISK_EØS_ÅRNR ^= 999 THEN                          
               CALL SKRIV_FEIL_EØS(U3EØS.TT_TEORETISK_EØS_ÅRNR);                
          END;                                                                  
       IF U3EØS.TT_TEORETISK_EØS_MNDNR = 0 THEN                                 
          S001U63O.TT_TERO_EØS_MNDA = NORMAL;                                   
       ELSE                                                                     
          DO;                                                                   
            S001U63O.TT_TERO_EØS_MNDA = DFHBMBRY;                               
            S001U63I.TT_TERO_EØS_MNDL = CURSOR_POS;                             
            IF U3EØS.TT_TEORETISK_EØS_MNDNR ^= 999 THEN                         
               CALL SKRIV_FEIL_EØS(U3EØS.TT_TEORETISK_EØS_MNDNR);               
          END;                                                                  
       IF U3EØS.TT_PRORATA_EØS_ÅRNR = 0 THEN                                    
          S001U63O.TT_PRORATA_EØS_ÅRA = NORMAL;                                 
       ELSE                                                                     
          DO;                                                                   
            S001U63O.TT_PRORATA_EØS_ÅRA = DFHBMBRY;                             
            S001U63I.TT_PRORATA_EØS_ÅRL = CURSOR_POS;                           
            IF U3EØS.TT_PRORATA_EØS_ÅRNR ^= 999 THEN                            
               CALL SKRIV_FEIL_EØS(U3EØS.TT_PRORATA_EØS_ÅRNR);                  
          END;                                                                  
       IF U3EØS.TT_PRORATA_EØS_MNDNR = 0 THEN                                   
          S001U63O.TT_PRORATA_EØS_MNDA = NORMAL;                                
       ELSE                                                                     
          DO;                                                                   
            S001U63O.TT_PRORATA_EØS_MNDA = DFHBMBRY;                            
            S001U63I.TT_PRORATA_EØS_MNDL = CURSOR_POS;                          
            IF U3EØS.TT_PRORATA_EØS_MNDNR ^= 999 THEN                           
               CALL SKRIV_FEIL_EØS(U3EØS.TT_PRORATA_EØS_MNDNR);                 
          END;                                                                  
                                                                                
       IF U3EØS.PENSJON_EØSNR = 0 THEN                                          
          S001U63O.PENSJON_EØSA = NORMAL;                                       
       ELSE                                                                     
          DO;                                                                   
            S001U63O.PENSJON_EØSA = DFHBMBRY;                                   
            S001U63I.PENSJON_EØSL = CURSOR_POS;                                 
            IF U3EØS.PENSJON_EØSNR ^= 999 THEN                                  
               CALL SKRIV_FEIL_EØS(U3EØS.PENSJON_EØSNR);                        
          END;                                                                  
                                                                                
                                                                                
       IF U3EØS.TT_FAKTISK_NORDISK_ÅRNR = 0 THEN                                
          S001U63O.TT_FAKTISK_NORDISK_ÅRA = NORMAL;                             
       ELSE                                                                     
          DO;                                                                   
            S001U63O.TT_FAKTISK_NORDISK_ÅRA = DFHBMBRY;                         
            S001U63I.TT_FAKTISK_NORDISK_ÅRL = CURSOR_POS;                       
            IF U3EØS.TT_FAKTISK_NORDISK_ÅRNR ^= 999 THEN                        
               CALL SKRIV_FEIL_EØS(U3EØS.TT_FAKTISK_NORDISK_ÅRNR);              
          END;                                                                  
                                                                                
       IF U3EØS.TT_FAKTISK_NORDISK_MNDNR = 0 THEN                               
          S001U63O.TT_FAKTISK_NORDISK_MNDA = NORMAL;                            
       ELSE                                                                     
          DO;                                                                   
            S001U63O.TT_FAKTISK_NORDISK_MNDA = DFHBMBRY;                        
            S001U63I.TT_FAKTISK_NORDISK_MNDL = CURSOR_POS;                      
            IF U3EØS.TT_FAKTISK_NORDISK_MNDNR ^= 999 THEN                       
               CALL SKRIV_FEIL_EØS(U3EØS.TT_FAKTISK_NORDISK_MNDNR);             
          END;                                                                  
                                                                                
       IF U3EØS.PÅ_FAKTISK_NORDISKNR = 0 THEN                                   
          S001U63O.PÅ_FAKTISK_NORDISKA = NORMAL;                                
       ELSE                                                                     
          DO;                                                                   
            S001U63O.PÅ_FAKTISK_NORDISKA = DFHBMBRY;                            
            S001U63I.PÅ_FAKTISK_NORDISKL = CURSOR_POS;                          
            IF U3EØS.PÅ_FAKTISK_NORDISKNR ^= 999 THEN                           
               CALL SKRIV_FEIL_EØS(U3EØS.PÅ_FAKTISK_NORDISKNR);                 
          END;                                                                  
                                                                                
          IF FRA_UTEN_DIALOG THEN                                               
             DO;  /* FRA_UTEN_DIALOG */                                         
                S001U63O.BEREGN_FOLKETRYGDA      =    DFHBMASK;                 
                S001U63O.EØS_8_4_3AA             =    DFHBMASK;                 
                S001U63O.TT_TERO_EØS_ÅRA         =    DFHBMASK;                 
                S001U63O.TT_TERO_EØS_MNDA        =    DFHBMASK;                 
                S001U63O.TT_PRORATA_EØS_ÅRA      =    DFHBMASK;                 
                S001U63O.TT_PRORATA_EØS_MNDA     =    DFHBMASK;                 
                S001U63O.PENSJON_EØSA            =    DFHBMASK;                 
                S001U63O.TT_FAKTISK_NORDISK_ÅRA    =    DFHBMASK;               
                S001U63O.TT_FAKTISK_NORDISK_MNDA   =    DFHBMASK;               
                S001U63O.PÅ_FAKTISK_NORDISKA       =    DFHBMASK;               
                                                                                
                DO K = 1 TO HBOUND(S001U63O.EØS_ÅRA);                           
                   S001U63O.EØS_ÅRA(K)           =    DFHBMASK;                 
                END;                                                            
                DO K = 1 TO HBOUND(S001U63O.EØS_ÅR_IKKE_PRO_RATAA);             
                   S001U63O.EØS_ÅR_IKKE_PRO_RATAA(K) = DFHBMASK;                
                END;                                                            
                                                                                
            END; /* FRA_UTEN_DIALOG */                                          
                                                                                
                                                                                
       IF ^FRA_CICS THEN                                                        
          DO;                                                                   
             S001U63O.STYRE_KODEA    = DFHBMASK;                                
             S001U63O.FUNKSJONSKODEA = DFHBMASK;                                
          END;                                                                  
       END OVERFØR_U3_EØS_MAP;                                                  
                                                                                
 % PAGE;                                                                        
 /* ***************************************************************** */        
 /*   PROSEDYRA OVERFØRER DATA FRA UP_TRANS_OMR TIL                   */        
 /*   SKJERMBILDE YRKESSKADE.                                         */        
 /*    */      /*   O B S.  NY PROSEDYRE.                             */        
 /*   MAP: S001201                                                    */        
 /*   MAPSET: S00120                                                  */        
 /* ***************************************************************** */        
 % SKIP (2);                                                                    
   OVERFØR_U3_YP_MAP:                                                           
    PROC;                                                                       
    DCL                                                                         
       NORMAL  CHAR (1) INIT(' '),                                              
       NOR_NUM CHAR (1) INIT('&'),                                              
       BRI_NUM CHAR (1) INIT('Q');                                              
   DCL HJ_DATO  CHAR(6);                                                        
                                                                                
       S001201O.REGDATOO        = KONV_HÅMD_ÅMD(U3S.REGDATO_ÅMD);               
       S001201O.TERMIDO         = U3S.TERMID;                                   
       S001201O.FNRO            = F_FELT_PIC_CHAR11(U3S.FNR);                   
       S001201O.NAVNO           = U3S.NAVN;                                     
       S001201O.TKNRO           = F_FELT_PIC_CHAR4(U3S.TKNR);                   
       S001201O.UFTO            = KONV_HÅMD_MÅ(U3S.UFT_ÅMD);                    
       S001201O.VIRK_DATOO      = KONV_HÅMD_MÅ(U3S.VIRK_DATO_ÅMD);              
       S001201O.VILKÅR_1_2_2AO  = U3Y.VILKÅR_1_2_2A;                            
       S001201O.VILKÅR_1_2_2BO  = U3Y.VILKÅR_1_2_2B;                            
       S001201O.YST_MÅO         = KONV_HÅMD_MÅ(U3Y.YST_ÅMD);                    
       S001201O.YSYKDOMO        = U3Y.YSYKDOM;                                  
       IF F_FELT_PIC_CHAR3(U3Y.YUG) ^= '000' THEN                               
          S001201O.YUGO         = F_FELT_PIC_CHAR3(U3Y.YUG);                    
       S001201O.KAP11_7_UTLØSTO = U3Y.KAP_11_7_UTLØST;                          
       S001201O.YRKE11O         = U3Y.YRKE11;                                   
       IF F_FELT_PIC_CHAR7(U3Y.AÅI) ^= (7)'9' THEN                              
          S001201O.AÅIO         = F_FELT_PIC_CHAR7(U3Y.AÅI);                    
       IF F_FELT_PIC_CHAR11(U3Y.FNR_EK) ^= '00000000000' THEN                   
          S001201O.FNR_EKO      = F_FELT_PIC_CHAR11(U3Y.FNR_EK);                
       IF F_FELT_PIC_CHAR11(U3Y.FNR_SAMBOER) ^= '00000000000' THEN              
          S001201O.FNR_SAMBOERO = F_FELT_PIC_CHAR11(U3Y.FNR_SAMBOER);           
       IF F_FELT_PIC_CHAR11(U3Y.FNR_Y_BARN) ^= '00000000000' THEN               
          S001201O.FNR_Y_BARNO  = F_FELT_PIC_CHAR11(U3Y.FNR_Y_BARN);            
       S001201O.PLEIEBARNO      = U3Y.PLEIEBARN;                                
   % SKIP (3);                                                                  
                                                                                
 /* FEILMELDINGER MARKERING AV FELT (ATTRIBUTTENE)                    */        
       S001201O.DUMMYA = '_';                                                   
                                                                                
       IF ^ FRA_CICS  THEN                                                      
          DO;                                                                   
             IF FEIL_MELD_NR > 0 THEN                                           
                CALL SKRIV_FEIL_YP(FEIL_MELD_NR);                               
                IF FEIL_MELD_NR     =  1732  THEN                               
                  DO;                                                           
                     CALL SKRIV_FEIL_YP(1732);                                  
                     FEIL_MELD_NR = 0;                                          
                     CALL SKRIV_FEIL_YP(1733);                                  
                     FEIL_MELD_NR = 0;                                          
                     CALL SKRIV_FEIL_YP(1734);                                  
                  END;                                                          
             FEIL_MELD_NR = 0;                                                  
          END;                                                                  
                                                                                
       S001201O.REGDATOA   = DFHBMASK;                                          
       S001201O.TERMIDA    = DFHBMASK;                                          
       S001201O.FNRA       = DFHBMASK;                                          
       S001201O.TKNRA      = DFHBMASK;                                          
       S001201O.NAVNA      = DFHBMASK;                                          
       S001201O.UFTA       = DFHBMASK;                                          
       S001201O.VIRK_DATOA = DFHBMASK;                                          
                                                                                
       IF U3Y.VILKÅR_1_2_2ANR = 0 THEN                                          
          S001201O.VILKÅR_1_2_2AA = NORMAL;                                     
       ELSE                                                                     
          DO;                                                                   
             S001201O.VILKÅR_1_2_2AA = DFHBMBRY;                                
             S001201I.VILKÅR_1_2_2AL = CURSOR_POS;                              
             IF U3Y.VILKÅR_1_2_2ANR ^= 999 THEN                                 
                CALL SKRIV_FEIL_YP(U3Y.VILKÅR_1_2_2ANR);                        
          END;                                                                  
       IF U3Y.VILKÅR_1_2_2BNR = 0 THEN                                          
          S001201O.VILKÅR_1_2_2BA = NORMAL;                                     
       ELSE                                                                     
          DO;                                                                   
             S001201O.VILKÅR_1_2_2BA = DFHBMBRY;                                
             S001201I.VILKÅR_1_2_2BL = CURSOR_POS;                              
             IF U3Y.VILKÅR_1_2_2BNR ^= 999 THEN                                 
                CALL SKRIV_FEIL_YP(U3Y.VILKÅR_1_2_2BNR);                        
          END;                                                                  
       IF U3Y.YST_ÅMDNR = 0 THEN                                                
          S001201O.YST_MÅA = NOR_NUM;                                           
       ELSE                                                                     
          DO;                                                                   
             S001201O.YST_MÅA = BRI_NUM;                                        
             S001201I.YST_MÅL = CURSOR_POS;                                     
             IF U3Y.YST_ÅMDNR ^= 999 THEN                                       
                CALL SKRIV_FEIL_YP(U3Y.YST_ÅMDNR);                              
          END;                                                                  
       IF U3Y.YSYKDOMNR = 0 THEN                                                
          S001201O.YSYKDOMA = NORMAL;                                           
       ELSE                                                                     
          DO;                                                                   
             S001201O.YSYKDOMA = DFHBMBRY;                                      
             S001201I.YSYKDOML = CURSOR_POS;                                    
             IF U3Y.YSYKDOMNR ^= 999 THEN                                       
                CALL SKRIV_FEIL_YP(U3Y.YSYKDOMNR);                              
          END;                                                                  
       IF U3Y.YUGNR = 0 THEN                                                    
          S001201O.YUGA = NOR_NUM;                                              
       ELSE                                                                     
          DO;                                                                   
             S001201O.YUGA = BRI_NUM;                                           
             S001201I.YUGL = CURSOR_POS;                                        
             IF U3Y.YUGNR ^= 999 THEN                                           
                CALL SKRIV_FEIL_YP(U3Y.YUGNR);                                  
          END;                                                                  
       IF U3Y.KAP_11_7_UTLØSTNR = 0 THEN                                        
          S001201O.KAP11_7_UTLØSTA = NORMAL;                                    
       ELSE                                                                     
          DO;                                                                   
             S001201O.KAP11_7_UTLØSTA = DFHBMBRY;                               
             S001201I.KAP11_7_UTLØSTL = CURSOR_POS;                             
             IF U3Y.KAP_11_7_UTLØSTNR ^= 999 THEN                               
                CALL SKRIV_FEIL_YP(U3Y.KAP_11_7_UTLØSTNR);                      
          END;                                                                  
       IF U3Y.YRKE11NR = 0 THEN                                                 
          S001201O.YRKE11A = NORMAL;                                            
       ELSE                                                                     
          DO;                                                                   
             S001201O.YRKE11A = DFHBMBRY;                                       
             S001201I.YRKE11L = CURSOR_POS;                                     
             IF U3Y.YRKE11NR ^= 999 THEN                                        
                CALL SKRIV_FEIL_YP(U3Y.YRKE11NR);                               
          END;                                                                  
       IF U3Y.AÅINR = 0 THEN                                                    
          S001201O.AÅIA = NOR_NUM;                                              
       ELSE                                                                     
          DO;                                                                   
             S001201O.AÅIA = BRI_NUM;                                           
             S001201I.AÅIL = CURSOR_POS;                                        
             IF U3Y.AÅINR ^= 999 THEN                                           
                CALL SKRIV_FEIL_YP(U3Y.AÅINR);                                  
          END;                                                                  
       IF U3Y.FNR_EKNR = 0 THEN                                                 
          S001201O.FNR_EKA = NOR_NUM;                                           
       ELSE                                                                     
          DO;                                                                   
             S001201O.FNR_EKA = BRI_NUM;                                        
             S001201I.FNR_EKL = CURSOR_POS;                                     
             IF U3Y.FNR_EKNR ^= 999 THEN                                        
                CALL SKRIV_FEIL_YP(U3Y.FNR_EKNR);                               
          END;                                                                  
       IF U3Y.FNR_SAMBOERNR = 0 THEN                                            
          S001201O.FNR_SAMBOERA = NOR_NUM;                                      
       ELSE                                                                     
          DO;                                                                   
             S001201O.FNR_SAMBOERA = BRI_NUM;                                   
             S001201I.FNR_SAMBOERL = CURSOR_POS;                                
             IF U3Y.FNR_SAMBOERNR ^= 999 THEN                                   
                CALL SKRIV_FEIL_YP(U3Y.FNR_SAMBOERNR);                          
          END;                                                                  
       IF U3Y.FNR_Y_BARNNR = 0 THEN                                             
          S001201O.FNR_Y_BARNA = NOR_NUM;                                       
       ELSE                                                                     
          DO;                                                                   
             S001201O.FNR_Y_BARNA = BRI_NUM;                                    
             S001201I.FNR_Y_BARNL = CURSOR_POS;                                 
             IF U3Y.FNR_Y_BARNNR ^= 999 THEN                                    
                CALL SKRIV_FEIL_YP(U3Y.FNR_Y_BARNNR);                           
          END;                                                                  
       IF U3Y.PLEIEBARNNR = 0 THEN                                              
          S001201O.PLEIEBARNA = NORMAL;                                         
       ELSE                                                                     
          DO;                                                                   
             S001201O.PLEIEBARNA = DFHBMBRY;                                    
             S001201I.PLEIEBARNL = CURSOR_POS;                                  
             IF U3Y.PLEIEBARNNR ^= 999 THEN                                     
                CALL SKRIV_FEIL_YP(U3Y.PLEIEBARNNR);                            
          END;                                                                  
 /* VED GAMLE TRANS SKAL FELTER BLOKKERES                             */        
                                                                                
       IF ^(TRANS_OPPL_OMR.NY_GML_TRANS_IND = 'G' & FRA_MED_DIALOG) THEN        
          IF FRA_UTEN_DIALOG THEN     /* BLOKKER ALT SAMMEN !         */        
             DO;                                                                
                S001201O.VILKÅR_1_2_2AA  = DFHBMASK;                            
                S001201O.VILKÅR_1_2_2BA  = DFHBMASK;                            
                S001201O.YST_MÅA         = DFHBMASK;                            
                S001201O.YSYKDOMA        = DFHBMASK;                            
                S001201O.YUGA            = DFHBMASK;                            
                S001201O.KAP11_7_UTLØSTA = DFHBMASK;                            
                S001201O.YRKE11A         = DFHBMASK;                            
                S001201O.AÅIA            = DFHBMASK;                            
                S001201O.FNR_EKA         = DFHBMASK;                            
                S001201O.FNR_SAMBOERA    = DFHBMASK;                            
                S001201O.FNR_Y_BARNA     = DFHBMASK;                            
                S001201O.PLEIEBARNA      = DFHBMASK;                            
                YMELDING6O =                                                    
                          'TRYKK PF1 FOR OPPBEVAR, PF2 FOR FORKASTE.';          
             END;                                                               
       IF ^FRA_CICS THEN                                                        
          DO;                                                                   
             S001201O.STYRE_KODEA    = DFHBMASK;                                
             S001201O.FUNKSJONSKODEA = DFHBMASK;                                
          END;                                                                  
   END OVERFØR_U3_YP_MAP;                                                       
