 /*   SIST ENDRET PÅ PROD   2008.11.05 16.23.47 AV   SPA2990          */        
 /*   SIST ENDRET PÅ PROD   2007.12.21 12.20.22 AV   JDA2990          */        
 /*   SIST ENDRET PÅ PROD   2006.07.18 11.37.05 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2006.04.24  9.43.40 AV   SPA2970          */        
 /*   SIST ENDRET PÅ QASS   2006.04.19 12.11.00 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2006.03.24  8.44.01 AV   SPA2970          */        
 /*   SIST ENDRET PÅ QASS   2006.01.19 12.37.31 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2006.01.19 12.35.26 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2005.11.22  9.53.23 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2005.11.21  9.39.49 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2005.11.04  8.03.11 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2005.11.02 11.36.24 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2005.09.11 13.31.30 AV   SPA2970          */        
 /*   SIST ENDRET PÅ TEST   2005.09.11 13.30.17 AV   SPA2970          */        
 /*   SIST ENDRET PÅ PROD   2004.12.17 14.09.30 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2004.11.15 12.24.01 AV   JDA2970          */        
 /*   SIST ENDRET PÅ QASS   2004.08.06 13.01.14 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2004.07.13 12.59.10 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2004.01.09 13.43.04 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2003.11.19  9.09.25 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2003.04.09  8.40.11 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2003.04.04  8.55.35 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2003.03.21 12.33.37 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2003.03.17 12.22.29 AV   JDA2970          */        
 /*   SIST ENDRET PÅ QASS   2003.03.03 11.49.57 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2002.12.20  8.56.25 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2002.04.19 12.28.48 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2001.07.30 14.40.10 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2001.04.25  9.51.22 AV   HLA7339          */        
 /*   SIST ENDRET PÅ PROD   2001.02.20  9.02.30 AV   JDA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.12.06  8.50.11 AV   HLA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.08.16 12.06.30 AV   JDA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.07.07 13.01.16 AV   JDA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.05.23 13.09.09 AV   JDA7339          */        
 /*       SIST ENDRET 07/07-99 12.29.46 AV   JDA7339                  */        
 /*       SIST ENDRET 26/02-99 09.13.19 AV   JDA7339                  */        
 /*       SIST ENDRET 04/05-98 13.15.47 AV   JDA7339                  */        
 /* ***************************************************************** */        
 /* IDENTIFIKASJON:                                                   */        
 /*     R0017044 - PROSEDYRE I PLI                                    */        
 /*     PROGRAMMERER: JAN JANUAR 83                                   */        
 /* HENSIKT:                                                          */        
 /*     RUTINEN SETTER INN KODER FOR TEKSTTYPE U I TEKSTTABELLEN      */        
 /*     FOR STØNADSBREV.                                              */        
 /*     TEKSTTYPE U FORTELLER OM AT FASTSETTELSE AV STØRRELSEN PÅ     */        
 /*     PENSJONEN.                                                    */        
 /* PROGRAMTILKNYTNING:                                               */        
 /*     INCLUDES I R0017001                                           */        
 /* BRUK:                                                             */        
 /*     CALL PLASSER_TEKSTTYPE_U_KODE(IND,EK_IND)                     */        
 /* ***************************************************************** */        
 PLASSER_TEKSTTYPE_U_KODE : PROC(IND,IND_EK);                                   
                                                                                
    DCL                                                                         
       IND                                        FIXED BIN (15),               
       W_VIRK                                     PIC '( 8)9',                  
       IND_EK                                     FIXED BIN (15),               
       F_NUM13                                    PIC '(13)9',                  
       F_AAR  DEF F_NUM13 POS (5)                 PIC '( 4)9',                  
       F_NUM13_EK                                 PIC '(13)9',                  
       UFØR_ALDER                                 FIXED DEC(4),                 
       HJ_VIRK_DATO_ÅMD                           PIC '( 8)9',                  
       VIRK_DATO_Å   DEF HJ_VIRK_DATO_ÅMD POS (1) PIC '( 4)9',                  
       VIRK_DATO_M   DEF HJ_VIRK_DATO_ÅMD POS (5) PIC '( 2)9',                  
       HJ_UFT_ÅMD                                 PIC '( 8)9',                  
       UFT_Å          DEF HJ_UFT_ÅMD      POS (1) PIC '( 4)9',                  
       UFT_M          DEF HJ_UFT_ÅMD      POS (5) PIC '( 2)9',                  
       SISTE                                      FIXED BIN(15),                
       UFØR_ALDER_DØD                             FIXED DEC(5) INIT(0),         
       W_DØDSDATO_ÅMD                             PIC  '(8)9',                  
       ALDER                                      FIXED DEC (5),                
       SAMMENSTØT                         BIT (1) ALIGNED INIT ('0'B);          
    /* ============================================================== */        
    /* PROGRAMMET STARTER HER                                         */        
    /* ============================================================== */        
                                                                                
    F_NUM13             = KONV_FNR11_FNR13((B02.FNR(IND)));                     
    F_NUM13_EK          = KONV_FNR11_FNR13((B02.FNR(IND_EK)));                  
    UFØR_ALDER          = F_ALDER((B02.FNR(IND)),                               
                           (B02.UFØRHIST.UFT_ÅMD(IND,1)));                      
    HJ_VIRK_DATO_ÅMD    = B01.VIRK_DATO_ÅMD(IND);                               
    W_VIRK              = B02.VIRK_DATO_ÅMD(IND);                               
    ALDER               = F_ALDER((B02.FNR(IND)),W_VIRK);                       
    TEKSTTYPE_U_KODE    = '';                                                   
    J                   = 1;                                                    
    M                   = 1;                                                    
       /*------------------------------------------------------------ */        
       /*VI MÅ FINNE ALDER PÅ DØDSTIDSPUNKTET PÅ AVDØDE DERSOM AVDØDE */        
       /*IKKE HADDE BUP-GARANTI FRA FØR. TIDLIGERE I PGM ER DET FUNNET*/        
       /*UFØR_ALDER PÅ SØKER. TRUDE 120692                            */        
       /*NB!! DENNE TEST SKAL NOK OGSÅ GJELDE  FLERE TILFELLER!!      */        
       /*------------------------------------------------------------ */        
                                                                                
    IF (B02.PENSJONSTYPE2(IND)  = 'S'           !                               
        /* SAMMENSTØTENDE PENSJON */                                            
        DIV_PARAM_OMR.REDUSERT_GP_2G(IND) = 'X' !                               
        /* samboer har innt > 2G eller pensjon-200010 */                        
        DIV_PARAM_OMR.REDUSERT_GP_2G(IND) = 'J' !                               
        /* REDUSERT EKTEF/SAMBOER HAR INNTEKT > 2G */                           
        DIV_PARAM_OMR.REDUSERT_GP_2G(IND) = 'V' !                               
        /* REDUSERT EKTEF/SAMBOER (SIVILSTAND V) ER PENSJONIST */               
        DIV_PARAM_OMR.REDUSERT_GP_2G(IND) = 'K' ) THEN                          
        /* REDUSERT EKTEF/SAMBOER HAR AFP */                                    
       SAMMENSTØT = '1'B;                                                       
                                                                                
    W_DØDSDATO_ÅMD  = B02.STATUS.DØDSDATO_ÅMD(IND_EK);                          
    IF B02.BUP_GARANTI(IND_EK,1) > 0  THEN                                      
       UFØR_ALDER_DØD  = F_ALDER((B02.FNR(IND_EK)),                             
                         (B02.UFØRHIST.UFT_ÅMD(IND_EK,1)));                     
    ELSE                                                                        
       UFØR_ALDER_DØD  = F_ALDER((B02.FNR(IND_EK)),                             
                         (W_DØDSDATO_ÅMD));                                     
    /* -------------------------------------------------------------- */        
    /* PENSJONEN/OVERGANGSSTØNADEN BEREGNES UT FRA GRUNNBELØPET       */        
    /* -------------------------------------------------------------- */        
    IF B02.PENSJONSTYPE2(IND) = 'O' THEN                                        
       CALL NY_U('U002');                                                       
    ELSE                                                                        
       CALL NY_U('U001');                                                       
                                                                                
    /* -------------------------------------------------------------- */        
    /* TULL OG TØYS????                                               */        
    /* -------------------------------------------------------------- */        
    IF B02.PENSJONSTYPE1(IND) = 'Y' &                                           
       DIV_PARAM_OMR.ENGANGSBELØP_11_7(IND) > 0 THEN                            
       CALL NY_U('U300');                                                       
                                                                                
    /* -------------------------------------------------------------- */        
    /* HAR VI TATT HENSYN TIL AVDØDES OPPTJENING VED BEREGNINGEN ?    */        
    /* -------------------------------------------------------------- */        
    IF B02.PENSJONSTYPE2(IND) = 'E' THEN                                        
       DO;  /* PENSJONSTYPE2 = 'E' */                                           
          IF B02.ETTEPENS.TP_BRUTTO(IND) > 0   &                                
             B02.PENSJONSTYPE3     (IND) ^= 'A' THEN                            
             CALL NY_U('U005');  /* HENSYN TIL AVD. OPPTJENTE RETTER */         
          ELSE                                                                  
             IF (B02.YRKEPENS.TP(IND)  +                                        
                 B02.UFØRPENS.TP(IND)) > B02.ETTEPENS.TP_BRUTTO(IND) &          
                 B02.PENSJONSTYPE1    (IND) = 'Y'                    &          
                 B02.PENSJONSTYPE3     (IND) ^= 'A'                 &           
                B02.ETTEPENS.TP_PROSENT(IND) > 0 THEN                           
                CALL NY_U('U336'); /* AVD. RETTIGHETER GIR IKKE + */            
             ELSE                                                               
                IF B02.ETTEPENS.TP_PROSENT(IND) > 0        &                    
  /* JFA 16.1.2000 (B02.ALDERSP.FAI      (IND)                                  
                 + B02.ETTEPENS.FORVENTET (IND) = 0)       &   */               
                   B02.PENSJONSTYPE3    (IND) ^= 'A'       &                    
                   DIV_PERIODE.BEREGNINGS_ALT_EGEN ^= '5'  &  /*9812*/          
                   B02.PENSJONSTYPE1    (IND) ^= 'Y'      THEN                  
                   CALL NY_U('U006'); /* AVD. RETTIGHETER GIR IKKE + */         
       END; /* PENSJONSTYPE2 = 'E' */                                           
                                                                                
    /* -------------------------------------------------------------- */        
    /* NY TEKST EK/SAMB/PARTNER INNTEKT >2G (JD 10.97)                */        
    /* -------------------------------------------------------------- */        
           /* DIV.PARAM. EK-INNT ERSTATTET MED B02.EK-INNT JD 310502*/          
    IF B02.EK_INNT_OVER_2G(IND) = 'J' &                                         
       (B02.PENSJONSTYPE1(IND)  ^= 'K' &      /*JFA 5.7.00 */                   
        B02.PENSJONSTYPE2(IND_EK) ^= 'N' &      /*JD 270103 R.159*/             
        B02.PENSJON_FØR_9802(IND) ^= 'J' &   /*jd 11.04-R627 */                 
             B02.PENSJONSTYPE2(IND)  ^= 'S') THEN                               
             CALL NY_U('U134');                                                 
    ELSE                                                                        
    IF B02.GP_REDUKSJON_KODE(IND) = 'I'    then  /*200410 HL */                 
       CALL NY_U('U134');                                                       
    ELSE                                                                        
    IF DIV_PARAM_OMR.REDUSERT_GP_2G(IND) = 'X'      THEN                        
       CALL NY_U('U138');           /*200010*/                                  
                                                                                
    /* -------------------------------------------------------------- */        
    /* INFORMASJON OM EVENTUELLE GARANTITILLEGG                       */        
    /* -------------------------------------------------------------- */        
    IF VERIFY (B02.PENSJONSTYPE1(IND),'AEJUY') = 0 THEN                         
       DO;  /* KAN HA GARANTITILLEGG */                                         
          IF W_HENDELSE.GARANTITILLEGG_TP > 0 THEN                              
             /* GARANTITILLEGG TP, KORREKSJON AV TIDL. INNTEKTER */             
             CALL NY_U('U108'); /* OK MH 1 STK */                               
                                                                                
          IF B02.FORSI.GARANTITILLEGG_EK(IND) > 0        !                      
             B02.FORSI.GARANTITILLEGG_BARN(IND) > 0      !                      
             B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) > 0   THEN                   
             /* GARANTITILLEGG FORSØRGING PR. 30.04.91 */                       
             CALL NY_U('U110'); /* OK MH 1 STK */                               
       END; /* KAN HA GARANTITILLEGG */                                         
                                                                                
    SELECT(B02.PENSJONSTYPE1(IND));                                             
       WHEN('A')                                                                
          DO;  /* ALDERSPENSJONIST */                                           
             /* ----------------------------------------------------- */        
             IF F_AAR > 1924 THEN                                               
                DO;  /* FØDT ETTER 1924 */                                      
                   IF (B02.SUM_YTELSE(IND) = 0) THEN                            
                      CALL NY_U('U115'); /* AP FASTSATT TIL NULL */             
                /* IF (ALDER < 7001) THEN                                       
                      CALL NY_U('U113'); /* AP FASTSATT PGRLA FAI */            
                END; /* FØDT ETTER 1924 */                                      
             /* ----------------------------------------------------- */        
             IF B02.P67_KODE(IND) = '1'  & F_AAR < 1925 THEN                    
                CALL NY_U('U009');                                              
             ELSE                                                               
                DO;                                                             
                   IF B02.P67_KODE(IND) = '2' THEN                              
                      IF B02.KONV_P_KODE(IND) = 'U' THEN                        
                         IF IND = SØKER_IND THEN                                
                            CALL NY_U('U010');                                  
                         ELSE                                                   
                         IF B02.APD(IND) > B02.KONV_GRAD(IND) THEN              
                            CALL NY_U('U012');                                  
                END;                                                            
             /* ----------------------------------------------------- */        
             IF B02.ETTEPENS.GP_BRUTTO(IND) ^= 0 &                              
                B02.ALDERSP .GP       (IND) ^= 0  THEN                          
                IF B02.PENSJONSTYPE2(IND) ^= 'E'    THEN                        
                   CALL NY_U('U019');                                           
                ELSE                                                            
                IF B02.ETTEPENS.GP_BRUTTO(IND) ^= 0 &                           
                   B02.ALDERSP .GP       (IND) ^= 0  THEN                       
                   CALL NY_U('U090');                                           
             /* ----------------------------------------------------- */        
             IF (B02.APD(IND) ^= 0 & B02.YRKEPENS.YUG(IND) ^= 0) &              
                (B02.APD(IND) = B02.YRKEPENS.YUG(IND))  THEN                    
                CALL NY_U('U323');                                              
             /* -----------------------JFA 14.9.2000----------------- */        
             IF (B02.KONV_P_KODE(IND) = 'E'   &                                 
                 B02.TKNR(IND)        > 2100  &                                 
                 B02.TT_ANV(IND)      <  40   ) THEN                            
                 CALL NY_U('U575');                                             
             /* ----------------------------------------------------- */        
             IF  B02.PENSJONSTYPE2(IND   )  = 'E' &                             
                (B02.DØD_AV_YRKESSKADE(IND) = 'E' !                             
                 B02.DØD_AV_YRKESSKADE(IND) = 'Y' ) THEN                        
                CALL NY_U('U361');                                              
             /* ----------------------------------------------------- */        
             IF B02.YRKEPENS.YUG(IND) >   0 &                                   
                B02.YRKEPENS.YUG(IND) < 100 THEN                                
                CALL NY_U('U324');                                              
             /* ----------------------------------------------------- */        
             IF B02.BEREGN_FOLKETRYGD(IND) ^= ' ' THEN                          
                CALL EØS_TEKSTER_UP_AP(IND,IND_EK);                             
             /* ----------------------------------------------------- */        
          END; /* ALDERSPENSJONIST */                                           
                                                                                
       WHEN('K')                                                                
          DO;  /* AVTALEFESTET PENSJON */                                       
             IF (DIV_PARAM_OMR.AP_KODE_AEY(IND) = 'W' !                         
                 DIV_PARAM_OMR.AP_KODE_AEY(IND) = 'P' ) THEN                    
                DO;  /* NYE REGLER GJELDER */                                   
                   CALL NY_U('U220');                                           
                   CALL NY_U('U221');                                           
                   IF (B02.ALDERSP.FAI(IND) > 40) THEN                          
                      CALL NY_U('U223');                                        
                   ELSE                                                         
                      CALL NY_U('U222');                                        
                   IF (B02.ALDERSP.GP(IND) > 0) THEN                            
                      DO;  /* HAR GRUNNPENSJON */                               
                         /* OVERSKRIFT GP */                                    
                         CALL NY_U('U505');                                     
                         /* FOR ENSLIG TILSVARER */                             
                         CALL NY_U('U019');                                     
                         IF (B02.TT_ANV(IND) < 40) THEN                         
                            DO;  /* TT REDUSERT */                              
                               /* RED GRUNNA TT - TT ER */                      
                               CALL NY_U('U020');                               
                               IF (B02.ALDERSP.ST(IND) > 0) THEN                
                                  /* OGSÅ SÆRTILLEGGET */                       
                                  CALL NY_U('U040');                            
                            END; /* TT REDUSERT */                              
                      END; /* HAR GRUNNPENSJON */                               
                END; /* NYE REGLER GJELDER */                                   
             ELSE                                                               
                DO;  /* UTTAK FØR 01.08.2000 */                                 
                   /* ----------------------------------------------- */        
                   IF (B02.ALDERSP.UTTAKSDATO_ÅMD(IND) > 19920000 &             
                       B02.SUM_YTELSE(IND)            = 0 )  THEN               
                      /* AFP ER FASTSATT TIL 0 */                               
                      CALL NY_U('U223');                                        
                   /* ----------------------------------------------- */        
                   IF (B02.ALDERSP.UTTAKSDATO_ÅMD(IND) > 19980000 ) !           
                      (B02.ALDERSP.UTTAKSDATO_ÅMD(IND) > 19970900 &             
                      B02.PENSJONSTYPE3(IND)       ^= 'B' )        THEN         
                      /* 70 PROSENTREGELEN */                                   
                      CALL NY_U('U214');                                        
                   ELSE                                                         
                   IF B02.ALDERSP.UTTAKSDATO_ÅMD(IND) > 19920000 THEN           
                      CALL NY_U('U213');                                        
                   ELSE                                                         
                   IF B02.ALDERSP.FAI(IND) > 0  &                               
                      B02.APD        (IND) < 100  THEN                          
                      CALL NY_U('U208');                                        
                   ELSE                                                         
                      CALL NY_U('U288');                                        
                   /* ----------------------------------------------- */        
                   IF B02.P67_KODE(IND) = '1' THEN                              
                      CALL NY_U('U009');                                        
                   ELSE                                                         
                      CALL NY_U('U019');                                        
                END; /* UTTAK FØR 01.08.2000 */                                 
             /* ----------------------------------------------------- */        
          END; /* AVTALEFESTET PENSJON */                                       
       WHEN('U')                                                                
          DO;  /* UFØREPENSJONIST */                                            
             /* ----------------------------------------------------- */        
             IF B02.PENSJONSTYPE2(IND) = 'E' THEN                               
                DO;  /* UFØR/ETTERLATT */                                       
                   IF VERIFY(B02.DØD_AV_YRKESSKADE(IND),'EY') = 0 THEN          
                      CALL NY_U('U361');                                        
                                                                                
                   IF B02.PENSJONSTYPE3(IND) = 'A'                   &          
                      B02.DØD_AV_YRKESSKADE(IND) = 'E'           &              
                      (B02.ETTEPENS.TP_BRUTTO(IND) >                            
                       B02.YRKEPENS.TP(IND) + B02.UFØRPENS.TP(IND))THEN         
                      CALL NY_U('U407');                                        
                                                                                
                   IF B02.ETTEPENS.GP_BRUTTO(IND) ^= 0 &                        
                      B02.UFØRPENS.GP       (IND) ^= 0  THEN                    
                      CALL NY_U('U090');                                        
                                                                                
                   IF B02.ETTEPENS.TP_BRUTTO(IND) > 0   &                       
  /* JFA 17.2.2000 */ B02.ETTEPENS.ST       (IND) = 0   &                       
                      B02.PENSJONSTYPE3     (IND) ^= 'A' THEN                   
                    IF (B02.ETTEPENS.FORVENTET(IND) * 100) > (G/2) THEN         
                       CALL NY_U('U093');                                       
                     ELSE                                                       
                       CALL NY_U('U092');                                       
                END;                                                            
             ELSE                                                               
                DO;  /* REIN UFØREPENSJON */                                    
                                                                                
                   /* ----------------------------------------------- */        
                   /* UFØREPENSJONEN ER UTMÅLT I SAMSVAR MED EN       */        
                   /* UFØREGRAD SOM ER FASTSATT TIL XXX PROSENT       */        
                   /* ----------------------------------------------- */        
                   CALL NY_U('U014');                                           
                                                                                
                   /* ----------------------------------------------- */        
                   /* FOR ENSLIG PENSJONIST SVARER ÅRLIG UGRADERT/    */        
                   /* UREDUSERT GRUNNPENSJON TIL GRUNNBELØPET         */        
                   /* ----------------------------------------------- */        
        /*JD 8.90*/IF B02.ETTEPENS.GP_BRUTTO(IND) ^= 0 &                        
                      B02.UFØRPENS.GP       (IND) ^= 0  THEN                    
                      CALL NY_U('U019');                                        
                END; /* REIN UFØREPENSJON */                                    
             /* ----------------------------------------------------- */        
             IF B02.BEREGN_FOLKETRYGD(IND) ^= ' ' THEN                          
                CALL EØS_TEKSTER_UP(IND,IND_EK);                                
             /* ----------------------------------------------------- */        
          END; /* UFØREPENSJONIST */                                            
       WHEN('Y')                                                                
          DO;  /* YRKESSKADEFORDELER */                                         
             /** FINNE SISTE UTFYLTE YUFT_ÅM   **/                              
          DO L = 10 TO 1 BY -1 UNTIL(B02.YRKEHIST.YUFT_ÅMD(IND,L) > 0);         
                 SISTE = L;                                                     
            END;                                                                
             /* ----------------------------------------------------- */        
             IF B02.YRKEHIST.KAP_11_7_UTLØST(IND,SISTE) = 'J' THEN              
                DO;  /* ENGANGSUTLØST YRKESSKADE */                             
                   CALL NY_U('U014');                                           
                   IF B02.YRKEHIST.PAÅ(IND,SISTE) >                             
                           B02.UFØRPENS.SPT(IND)    THEN                        
                      CALL NY_U('U301');                                        
                   ELSE                                                         
                      CALL NY_U('U340');                                        
                END; /* ENGANGSUTLØST YRKESSKADE */                             
             /* ----------------------------------------------------- */        
             IF B02.YRKEHIST.KAP_11_7_UTLØST(IND,1)   ^= 'J' &                  
               ( B02.YRKEPENS.YUG(IND) < B02.UFØRPENS.UFG(IND)) THEN            
                CALL NY_U('U303');                                              
                                                                                
             IF (B02.TT_ANV(IND)        < 40                     &              
                 (B02.UFØRPENS.UFG(IND) ^= B02.YRKEPENS.YUG(IND))) THEN         
                SELECT(B02.PENSJONSTYPE2(IND));                                 
                   WHEN('S') CALL NY_U('U306');                                 
                   WHEN('E') CALL NY_U('U307');                                 
                   OTHER     CALL NY_U('U305');                                 
                END;                                                            
                                                                                
             IF B02.PENSJONSTYPE2(IND) = 'P' THEN                               
                DO;  /* PENSJONSTYPE2 = 'P' */                                  
                   IF B02.BEREGN_FOLKETRYGD(IND) = ' ' THEN                     
                      CALL NY_U('U199');                                        
                   CALL NY_U('U360');                                           
                END; /* PENSJONSTYPE2 = 'P' */                                  
             /* ----------------------------------------------------- */        
             IF B02.YRKEPENS.YUG(IND) = B02.UFØRPENS.UFG(IND)   THEN            
                DO;                                                             
                   /* ----------------------------------------------- */        
                   CALL NY_U('U302');                                           
                   /* ----------------------------------------------- */        
                   IF B02.YRKEPENS.YUG(IND) < 50 THEN                           
                  /*  IF B02.YRKEPENS.TP (IND) > 0 THEN                         
                         DO;                                                    
                            TEKSTTYPE_U_KODE(J) = 'U310';                       
                            J                   = J + 1;                        
                         END;                                                   
                      ELSE */                                                   
                      IF B02.YRKEPENS.TP (IND) = 0 THEN                         
                         CALL NY_U('U309');                                     
                END;                                                            
             /* ----------------------------------------------------- */        
             IF B02.YRKEHIST.YRKE11(IND,SISTE) = 'A'  &                         
                B02.YRKEPENS.TP    (IND) > 0    THEN                            
                CALL NY_U('U363');                                              
             /* ----------------------------------------------------- */        
             IF B02.YRKEPENS.TP(IND)     > 0 &                                  
                B02.PENSJONSTYPE2(IND)   = 'S' THEN                             
                SELECT(B02.YRKEPENS.YPT_KODE(IND));                             
                   WHEN('A')                                                    
                      DO;  /* ANTATT ÅRLIG INNTEKT */                           
                         SELECT(B02.POENGTILLEGG_KODE(IND));                    
                            WHEN('A') CALL NY_U('U316');                        
                            WHEN('B') CALL NY_U('U315');                        
                            OTHER;                                              
                         END; /* SELECT POENGTILLEGG_KODE(IND) */               
                      END; /* ANTATT ÅRLIG INNTEKT */                           
                   WHEN('V')                                                    
                      DO;  /* VANLIG BEREGNING */                               
                         SELECT(B02.POENGTILLEGG_KODE(IND));                    
                            WHEN('A') CALL NY_U('U312');                        
                            WHEN('B')                                           
                               IF ( B02.UFØRPENS.UFG(IND)                       
                                  = B02.YRKEPENS.YUG(IND) ) THEN                
                                  CALL NY_U('U311');                            
                            OTHER;                                              
                         END; /* SELECT POENGTILLEGG_KODE(IND) */               
                      END; /* VANLIG BEREGNING */                               
                   OTHER;                                                       
                END; /* SELECT YPT_KODE */                                      
             /* ----------------------------------------------------- */        
             IF B02.UFØRPENS.UFG(IND) > B02.YRKEPENS.YUG(IND) &                 
                B02.UFØRPENS.TP(IND)  >   0                   THEN              
                DO;                                                             
                   IF B02.PENSJONSTYPE3(IND)    ^= 'A' &                        
                      B02.POENGTILLEGG_KODE(IND) = ' ' THEN                     
                      CALL NY_U('U317');                                        
                   IF B02.PENSJONSTYPE2(IND)     = 'S' &                        
                      B02.POENGTILLEGG_KODE(IND) = 'B' THEN                     
                      CALL NY_U('U318');                                        
                END;                                                            
             /* ----------------------------------------------------- */        
             IF B02.ETTEPENS.TP_BRUTTO (IND) > 0 THEN                           
                IF B02.YRKEPENS.TP    (IND) > 0 THEN                            
                   CALL NY_U('U349');                                           
                ELSE                                                            
                   CALL NY_U('U348');                                           
             /* ----------------------------------------------------- */        
             IF (B02.UFØRPENS.UFG(IND) > B02.YRKEPENS.YUG(IND)) &               
                (B02.UFØRPENS.TP    (IND) > 0     ) &                           
                (B02.YRKEPENS.YPT_KODE(IND) ^= 'V' ) &                          
                (B02.PENSJONSTYPE2  (IND)   = 'S' ) &                           
                (B02.POENGTILLEGG_KODE(IND) = 'A' ) THEN                        
                CALL NY_U('U319');                                              
             /* ----------------------------------------------------- */        
             IF B02.PENSJONSTYPE3(IND) = 'A' THEN                               
                DO;  /* PENSJONSTYPE3 = 'A' */                                  
                   IF B02.YRKEPENS.YPT_KODE(IND) = 'A' &                        
                      (B02.UFØRPENS.UFG(IND) >                                  
                       B02.YRKEPENS.YUG(IND)           ) THEN                   
                      CALL NY_U('U333');                                        
                   IF B02.YRKEPENS.YPT_KODE(IND) = 'V' THEN                     
                      CALL NY_U('U332');                                        
                   IF B02.DØD_AV_YRKESSKADE(IND) = 'E' THEN                     
                      CALL NY_U('U334');                                        
                END; /* PENSJONSTYPE3 = 'A' */                                  
             /* ----------------------------------------------------- */        
             IF  B02.PENSJONSTYPE2(IND)     = 'E' &                             
                (B02.DØD_AV_YRKESSKADE(IND) = 'E' !                             
                 B02.DØD_AV_YRKESSKADE(IND) = 'Y' ) THEN                        
                CALL NY_U('U361');                                              
             /* ----------------------------------------------------- */        
             IF B02.YRKEPENS.YPT_KODE(IND) = 'V' THEN                           
                DO;  /* YPT_KODE = 'V' */                                       
                   IF B01.PENSJONSTYPE1(IND) = ' ' THEN                         
                      CALL NY_U('U370');                                        
                END; /* YPT_KODE = 'V' */                                       
             ELSE                                                               
                IF B02.YRKEPENS.TP(IND) > 0  THEN                               
                   CALL NY_U('U373');                                           
                                                                                
             /* ----------------------------------------------------- */        
             IF B02.YRKEPENS.YPT_KODE(IND) = 'A' THEN                           
                DO;                                                             
                   CALL NY_U('U368');                                           
                   IF B02.YRKEPENS.SPT(IND) > 0                       &         
                      (B02.UFØRPENS.UFG(IND) = B02.YRKEPENS.YUG(IND))           
                                                            THEN                
                      CALL NY_U('U314');                                        
                END;                                                            
             IF B02.PENSJONSTYPE2(IND) = 'E' &                                  
                B02.PENSJONSTYPE3(IND) = 'A' THEN                               
                DO;  /* PT2 = 'E' & PT3 = 'A' */                                
                   IF (B02.YRKEPENS.TP(IND) + B02.UFØRPENS.TP(IND)) <           
                       B02.ETTEPENS.TP_BRUTTO(IND)              THEN            
                      DO;                                                       
                         CALL NY_U('U405');                                     
                         IF B02.DØD_AV_YRKESSKADE(IND) = 'E' THEN               
                            CALL NY_U('U407');                                  
                      END;                                                      
                   ELSE                                                         
                      IF (B02.YRKEPENS.TP(IND)  +                               
                          B02.UFØRPENS.TP(IND))                                 
                         >B02.ETTEPENS.TP_BRUTTO(IND) THEN                      
                         CALL NY_U('U406');                                     
                END; /* PT2 = 'E' & PT3='A' */                                  
             /* ----------------------------------------------------- */        
             IF (B02.BUP_GARANTI(IND_EK,1) > 0     &                            
                 B02.BUP_GARANTI(IND_EK,1) = B02.YPT(IND_EK)) &                 
                (B02.YRKEHIST.YUG(IND,SISTE) > 0 ) THEN                         
                CALL NY_U('U352');                                              
             /* ----------------------------------------------------- */        
             IF (UFØR_ALDER < 2001) &                                           
                (B02.BUP_GARANTI(IND,1) = 3.00) THEN                            
                CALL NY_U('U379');                                              
             /* ----------------------------------------------------- */        
             IF (B02.BUP_GARANTI(IND_EK,1) > 0     &                            
                 B02.BUP_GARANTI(IND_EK,1) = B02.ETTEPENS.SPT_AVD(IND))         
                                              &                                 
                (B02.BUP_GARANTI(IND,1) > 0 )   &                               
                (B02.BUP_GARANTI(IND,1) = B02.UFØRPENS.SPT(IND) !               
                 B02.BUP_GARANTI(IND,1) = B02.YRKEPENS.YPT(IND)) &              
                (B02.YRKEHIST.YUG(IND,SISTE) > 0 ) THEN                         
                CALL NY_U('U353');                                              
             /* dum test:-pensjonstype1 er jo 'y'-------------------- */        
             IF B02.PENSJONSTYPE1(IND) = 'U' THEN                               
                SELECT(B02.YRKEPENS.YPT_KODE(IND));                             
                   WHEN('A') CALL NY_U('U572');                                 
                   WHEN('V') CALL NY_U('U395');                                 
                   OTHER;                                                       
                END; /* SELECT YPT_KODE */                                      
             /* ----------------------------------------------------- */        
             SELECT(B02.YRKEHIST.YRKE11(IND,SISTE));                            
                WHEN('E')                                                       
                   DO;  /* YRKE11 = 'E' */                                      
                      IF B02.DØD_AV_YRKESSKADE(IND) = 'E' THEN                  
                         CALL NY_U('U389');                                     
                      IF B02.DØD_AV_YRKESSKADE(IND) = ' ' THEN                  
                         CALL NY_U('U394');                                     
                   END; /* YRKE11 = 'E' */                                      
                WHEN('F')                                                       
                   DO;  /* YRKE11 = 'F' */                                      
                      IF B02.YRKEPENS.YPT_KODE(IND) = 'V' THEN                  
                         CALL NY_U('U585');                                     
                      ELSE                                                      
                         DO;                                                    
                            CALL NY_U('U384');                                  
                            CALL NY_U('U385');                                  
                         END;                                                   
                      CALL NY_U('U383');                                        
                    END; /* YRKE11 = 'F' */                                     
                WHEN('M')                                                       
                   DO;  /* YRKE11 = 'M' */                                      
                      IF B02.YRKEPENS.YPT_KODE(IND) = 'Y' THEN                  
                         CALL NY_U('U388');                                     
                      IF B02.DØD_AV_YRKESSKADE(IND) = 'E' THEN                  
                         CALL NY_U('U389');                                     
                   END; /* YRKE11 = 'M' */                                      
                WHEN('S')                                                       
                   DO;  /* YRKE11 = 'S' */                                      
                      IF B02.DØD_AV_YRKESSKADE(IND) = ' ' THEN                  
                         CALL NY_U('U381');                                     
                   END; /* YRKE11 = 'S' */                                      
                WHEN('U')                                                       
                   DO;  /* YRKE11 = 'U' */                                      
                      IF B02.DØD_AV_YRKESSKADE(IND) = 'E' THEN                  
                         CALL NY_U('U389');                                     
                      IF B02.DØD_AV_YRKESSKADE(IND) = ' '  THEN                 
                         CALL NY_U('U390');                                     
                   END; /* YRKE11 = 'U' */                                      
                WHEN('V')                                                       
                   DO;  /* YRKE11 = 'V' */                                      
                      IF B02.YRKEPENS.YPT_KODE(IND) = 'Y' THEN                  
                         CALL NY_U('U393');                                     
                      IF B02.DØD_AV_YRKESSKADE(IND) = 'E' THEN                  
                         CALL NY_U('U389');                                     
                      CALL NY_U('U392');                                        
                   END; /* YRKE11 = 'V' */                                      
                OTHER;                                                          
             END; /* SELECT YRKE11 */                                           
             /* ----------------------------------------------------- */        
             IF (B02.YRKEPENS.SPT   (IND)   >  0  &                             
                 B02.UFØRPENS.UFG(IND) = B02.YRKEPENS.YUG(IND) &                
                 B02.YRKEPENS.YPT_KODE(IND) ^= 'A') then                        
                 CALL NY_U('U313');                                             
             /* ----------------------------------------------------- */        
             IF B02.YRKEPENS.YPT_KODE(IND) = 'Y' THEN                           
                CALL NY_U('U374');                                              
             /* ----------------------------------------------------- */        
             SELECT (B02.YRKEHIST.YRKE11(IND,SISTE));                           
                WHEN('E')                                                       
                   DO;  /* YRKE11 = 'E' */                                      
                      IF B01.YRKEPENS.YPT(IND)                                  
                         <B02.YRKEPENS.SPT(IND) THEN                            
                         CALL NY_U('U378');                                     
                      IF B02.YRKEPENS.TP(IND) > 0 THEN                          
                         CALL NY_U('U364');                                     
                      IF B02.YRKEPENS.YPT_KODE(IND) = 'Y' THEN                  
                         DO;                                                    
                            CALL NY_U('U377');                                  
                            CALL NY_U('U391');                                  
                         END;                                                   
                   END; /* YRKE11 = 'E' */                                      
                WHEN('F')                                                       
                   DO;  /* YRKE11 = 'F' */                                      
                      IF B02.YRKEPENS.TP(IND) > 0 THEN                          
                         CALL NY_U('U364');                                     
                   END; /* YRKE11 = 'F' */                                      
                WHEN('M')                                                       
                   DO;  /* YRKE11 = 'M' */                                      
                      CALL NY_U('U386');                                        
                      CALL NY_U('U587');                                        
                      IF B02.YRKEPENS.TP(IND) > 0 THEN                          
                         CALL NY_U('U364');                                     
                   END; /* YRKE11 = 'M' */                                      
                WHEN('U')                                                       
                   DO;  /* YRKE11 = 'U' */                                      
                      IF B01.YRKEPENS.YPT(IND)                                  
                         <B02.YRKEPENS.SPT(IND) THEN                            
                         CALL NY_U('U378');                                     
                      IF B02.YRKEPENS.TP(IND) > 0 THEN                          
                         CALL NY_U('U364');                                     
                      IF B02.YRKEPENS.YPT_KODE(IND) = 'Y' THEN                  
                         DO;                                                    
                            CALL NY_U('U377');                                  
                            CALL NY_U('U391');                                  
                         END;                                                   
                   END; /* YRKE11 = 'U' */                                      
                WHEN('V')                                                       
                   DO;  /* YRKE11 = 'V' */                                      
                      IF B01.YRKEPENS.YPT(IND)                                  
                         <B02.YRKEPENS.SPT(IND) THEN                            
                         CALL NY_U('U378');                                     
                      IF B02.YRKEPENS.TP(IND) > 0 THEN                          
                         CALL NY_U('U364');                                     
                      IF B02.YRKEPENS.YPT_KODE(IND) = 'Y' THEN                  
                         DO;                                                    
                            CALL NY_U('U377');                                  
                            CALL NY_U('U391');                                  
                         END;                                                   
                   END; /* YRKE11 = 'V' */                                      
                OTHER;                                                          
             END; /* SELECT YRKE11 */                                           
             /* ----------------------------------------------------- */        
             IF B02.BUP_GARANTI   (IND,1) > B02.YPT(IND)   THEN                 
                CALL NY_U('U380');                                              
             /* ----------------------------------------------------- */        
             IF (B02.ETTEPENS.SPT_AVD(IND) = 3.30 &                             
                 B02.ETTEPENS.TP_BRUTTO(IND) > 0  &                             
                 B02.PENSJONSTYPE2   (IND) = 'E') THEN                          
                 DO;  /* ETTERLATTE RETTIGHETER UNGE DØDE */                    
                    SELECT;                                                     
                       WHEN (UFØR_ALDER_DØD < 2001) CALL NY_U('U051');          
                       WHEN (UFØR_ALDER_DØD < 2101) CALL NY_U('U095');          
                       WHEN (UFØR_ALDER_DØD < 2201) CALL NY_U('U100');          
                       WHEN (UFØR_ALDER_DØD < 2401) CALL NY_U('U121');          
                       WHEN (UFØR_ALDER_DØD < 2601) CALL NY_U('U132');          
                       OTHER;                                                   
                    END; /* SELECT UFØR_ALDER_DØD */                            
                 END; /* ETTERLATTE RETTIGHETER UNGE DØDE */                    
             /*   U303 ER FLYTTET LENGER FRAM I PROGRAMMET JD 05.2000           
             IF B02.YRKEHIST.KAP_11_7_UTLØST(IND,1)   ^= 'J' &                  
               ( B02.YRKEPENS.YUG(IND) < B02.UFØRPENS.UFG(IND)) THEN            
                DO;                                                             
                   TEKSTTYPE_U_KODE(J) = 'U303';                                
                   J                   = J + 1;                                 
                END;                                                            
                ----------------------------------------------------- */        
             IF (B02.YRKEPENS.TP(IND)  +                                        
                 B02.UFØRPENS.TP(IND)) < B02.ETTEPENS.TP_BRUTTO(IND) &          
                 B02.PENSJONSTYPE2    (IND) = 'E'                    &          
                 B02.DØD_AV_YRKESSKADE(IND) = 'E'                 THEN          
                CALL NY_U('U337');                                              
             /* ----------------------------------------------------- */        
             IF VERIFY(B02.DØD_AV_YRKESSKADE(IND),'EY') = 0 THEN                
                DO;  /* DØD AV YRKESSKADE */                                    
                   /* ----------------------------------------------- */        
                   SELECT (B02.YRKEPENS.YPT_KODE(IND_EK));                      
                      WHEN ('A')                                                
                         DO;  /* WHEN 'A' */                                    
                            SELECT (B02.POENGTILLEGG_KODE(IND));                
                               WHEN('A') CALL NY_U('U526');                     
                               WHEN('B') CALL NY_U('U525');                     
                               WHEN('C') CALL NY_U('U327');                     
                               OTHER;                                           
                            END; /* SELECT POENGTILLEGG_KODE(IND) */            
                         END; /* WHEN 'A' */                                    
                      WHEN ('V')                                                
                         DO;  /* WHEN 'V' */                                    
                            SELECT (B02.POENGTILLEGG_KODE(IND));                
                               WHEN('A') CALL NY_U('U321');                     
                               WHEN('B') CALL NY_U('U320');                     
                               WHEN('C') CALL NY_U('U322');                     
                               OTHER;                                           
                            END; /* SELECT POENGTILLEGG_KODE(IND) */            
                         END; /* WHEN 'V' */                                    
                       OTHER; /*  endret 09.09.2005 satish  */                  
                   END; /* SELECT YRKEPENS.YPT_KODE(IND_EK) */                  
                   /* ----------------------------------------------- */        
                   SELECT (B02.YRKEHIST.YRKE11(IND_EK,1));                      
                      WHEN('A') CALL NY_U('U366');                              
                      WHEN('S') CALL NY_U('U582');                              
                      OTHER;                                                    
                   END; /* SELECT YRKEHIS.YRKE11(IND_EK,1) */                   
                   /* ----------------------------------------------- */        
                   IF B02.YRKEPENS.YPT_KODE(IND_EK) = 'A' &                     
                      B02.YRKEPENS.YUG(IND_EK)      < 100 THEN                  
                      SELECT(B02.POENGTILLEGG_KODE(IND));                       
                         WHEN('A') CALL NY_U('U329');                           
                         WHEN('B') CALL NY_U('U328');                           
                         WHEN('C') CALL NY_U('U330');                           
                         OTHER;                                                 
                      END; /* SELECT POENGTILLEGG_KODE */                       
                   ELSE                                                         
                   IF (B02.YRKEPENS.YPT_KODE(IND_EK) = 'V' ) &                  
                      (B02.POENGTILLEGG_KODE(IND) = ' ' ) THEN                  
                      CALL NY_U('U331');                                        
                END; /* DØD AV YRKESSKADE */                                    
          END; /* YRKESSKADEFORDELER */                                         
       WHEN('E','J')   /*PENSJONSTYPE1 = E ELLER J   */                         
          DO;  /* ETTERLATTEPENSJONIST ELLER ETTERLATT FAMILIEPL. */            
             /* ----------------------------------------------------- */        
             IF VERIFY(B02.DØD_AV_YRKESSKADE(IND),'EY') = 0 THEN                
                CALL NY_U('U361');                                              
             /* ----------------------------------------------------- */        
             IF B02.PENSJONSTYPE2(IND) = 'O' THEN                               
                CALL NY_U('U091');                                              
             ELSE                                                               
             IF B02.ETTEPENS.GP_BRUTTO(IND) ^= 0 THEN                           
                CALL NY_U('U090');                                              
             /* ----------------------------------------------------- */        
             IF B02.ETTEPENS.GP_NETTO (IND) ^=                                  
                B02.ETTEPENS.GP_BRUTTO(IND)        THEN                         
                DO;                                                             
                          /*20030207 HL : */                                    
                   IF DIV_PARAM_OMR.FRADRAG_2G = 'J'    then                    
                      CALL NY_U('U139');                                        
                   ELSE                                                         
                   IF B02.PENSJONSTYPE2(IND) = 'O' THEN                         
                      CALL NY_U('U016');                                        
      /*           ELSE                                                         
                   IF B02.PENSJONSTYPE1(IND) = 'A' THEN                         
                      CALL NY_U('U015');                  */                    
                   ELSE                                                         
                      CALL NY_U('U509');                                        
                                                                                
                   IF (B02.INNT_PRØVET_EØS_PENS(IND_EK) = 'J' &                 
                      (B02.GUNSTIGSTE_ALTERNATIV(IND_EK) = '1' !                
                       B02.GUNSTIGSTE_ALTERNATIV(IND_EK) = '4' ) &              
                       B02.FORVENTET(IND) > 0                 ) THEN            
                      CALL NY_U('U565');                                        
                END;                                                            
             ELSE                                                               
                DO;                                                             
                   IF B02.PENSJONSTYPE2(IND) = 'O' THEN                         
                      CALL NY_U('U018');                                        
                   ELSE                                                         
                      CALL NY_U('U017');                                        
                END;                                                            
             /* ----------------------------------------------------- */        
             IF B02.BEREGN_FOLKETRYGD(IND_EK) ^= ' ' THEN                       
                CALL EØS_TEKSTER_ETTERL(IND_EK,IND);                            
          END; /* ETTERLATTEPENSJONIST ELLER ETTERLATT FAMILIEPL. */            
                                                                                
       WHEN('N')                                                                
          DO;  /* BARNEPENSJONIST EN AV FORELDRENE DØD */                       
              CALL NY_U('U109');                                                
          END; /* BARNEPENSJONIST EN AV FORELDRENE DØD */                       
                                                                                
       WHEN('B')                                                                
          DO;  /* BARNEPENSJONIST BEGGE FORELDRE DØDE */                        
             IF B02.DØD_AV_YRKESSKADE(IND) = 'E'  THEN                          
                CALL NY_U('U375');                                              
             ELSE                                                               
                CALL NY_U('U075');                                              
                                                                                
             IF (B02.BUP_GARANTI(IND_EK,1) > 0) &                               
                (B02.BUP_GARANTI(IND_EK,1) =                                    
                 B02.ETTEPENS.SPT_AVD(IND)) THEN                                
                SELECT; /* UFØR_ALDER */                                        
                   WHEN(UFØR_ALDER < 2001) CALL NY_U('U051');                   
                   WHEN(UFØR_ALDER < 2101) CALL NY_U('U095');                   
                   OTHER;                                                       
                END; /* SELECT UFØR_ALDER */                                    
             ELSE                                                               
             IF B02.ETTEBARN.SPT_MOR(IND) > 0 !                                 
                B02.ETTEBARN.SPT_FAR(IND) > 0 THEN                              
                CALL NY_U('U047');                                              
          END; /* BARNEPENSJONIST BEGGE FORELDRE DØDE */                        
       OTHERWISE;                                                               
    END;  /*SELECT*/                                                            
                                                                                
                                                                                
    IF B02.BEREGN_FOLKETRYGD(IND)      = ' ' THEN      /*HL 1194*/              
    /*!B02.GUNSTIGSTE_ALTERNATIV(IND)  = '1' THEN */   /*MH 0298 */             
       SELECT(B02.PENSJONSTYPE1(IND));                                          
 /* ***************************************************************** */        
 /* INNSETTING AV TEKSTKODER FOR PERSONER SOM AV EN ELLER ANNEN GRUNN */        
 /* FÅR REDUSERT GRUNNPENSJON.                                        */        
 /* ***************************************************************** */        
          WHEN('A')                                                             
             DO;  /* ALDERSPENSJON */                                           
                IF B02.ALDERSP.APD(IND) = 100 THEN                              
                   DO;  /* APD = 100 */                                         
                      IF B02.PENSJONSTYPE2(IND) ^= 'S'     &                    
                         DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'V' &             
                         DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'K' THEN          
                         DO;                                                    
                            IF B02.TT_ANV(IND) < 40 THEN                        
                               DO;  /* TT_ANV < 40 */                           
                                  CALL NY_U('U505');                            
                                                                                
                 /*JD 8.90*/      IF B02.ETTEPENS.GP_BRUTTO(IND) ^= 0 !         
  /*ENDRET TIL ! 0891 TRUDE*/        B02.ALDERSP .GP       (IND) ^= 0           
  /*TEKST ANG TT RED KOM IKKE*/      THEN                                       
                                        CALL NY_U('U020');                      
                                                                                
                                  IF B02.ALDERSP.ST(IND) > 0 THEN               
                                     CALL NY_U('U040');                         
                               END; /* TT_ANV < 40 */                           
                         END;                                                   
                      ELSE     /*PT2 ER DA = 'S' */                             
                         DO;                                                    
                            IF B02.TT_ANV(IND) = 40 THEN                        
                               DO;  /* TT ANV LIK 40 */                         
                                  CALL NY_U('U021');                            
                                                                                
                                  IF ((B02.TT_FØR_1967(IND) +                   
                                    (B02.TT_ETTER_1966(IND) +11) / 12 +         
                                   (B02.TT_FRAMT (IND) +11) / 12 +              
                                    B02.TT_16_66(IND)  +                        
                                    B02.TT_67_TIL_70 (IND))                     
                                    < 40)THEN                                   
                                    CALL NY_U('U022');                          
                                  IF B02.ALDERSP.ST(IND) > 0 THEN               
                                     CALL NY_U('U040');                         
                               END; /* TT ANV LIK 40 */                         
                            ELSE                                                
                               DO;  /* TT ANV ULIK 40 */                        
                                                                                
                               IF B02.ETTEPENS.GP_BRUTTO(IND) ^= 0 !            
  /*ENDRES TIL ! TRUDE 0891*/     B02.ALDERSP .GP       (IND) ^= 0              
  /*TEKST ANG TT RED KOM IKKE*/   THEN                                          
                                  CALL NY_U('U020');                            
                               IF B02.ALDERSP.ST(IND) > 0 THEN                  
                                  CALL NY_U('U040');                            
                            END; /* TT ANV ULIK 40 */                           
                      END;                                                      
             END;                                                               
          ELSE                                                                  
             DO;                                                                
                IF B02.PENSJONSTYPE2(IND) = 'S' THEN                            
                   DO;                                                          
                      CALL NY_U('U029');                                        
                      IF B02.TT_ANV(IND) < 40 THEN                              
                         DO;                                                    
                            CALL NY_U('U030');                                  
                            IF  (B02.TT_FØR_1967(IND) +                         
                                (B02.TT_ETTER_1966(IND) +11) / 12 +             
                                (B02.TT_FRAMT (IND) +11) / 12 +                 
                                 B02.TT_16_66 (IND)   +                         
                                 B02.TT_67_TIL_70 (IND)) <                      
                                 B02.TT_ANV(IND) THEN                           
                                 CALL NY_U('U031');                             
                         END;                                                   
                   END;                                                         
                ELSE                                                            
                   DO;                                                          
                      IF B02.TT_ANV(IND) < 40 THEN                              
                         CALL NY_U('U074');                                     
                      IF B02.PENSJONSTYPE1(IND_EK) = 'K' &                      
 /*R159 0103 jd */       B02.PENSJONSTYPE2(IND_EK) ^='N' THEN                   
                         CALL NY_U('U021');                                     
                   END;                                                         
                                                                                
                IF B02.TT_ANV(IND) < 40 THEN                                    
                   IF B02.ALDERSP.ST(IND) > 0 THEN                              
                      CALL NY_U('U040');                                        
                END;                                                            
          END;                                                                  
       WHEN('K')                                                                
          DO;  /* AFP          */                                               
             /* ----------------------------------------------------- */        
             /* INNSETTING AV TEKSTER SOM GJELDER GP - AFP            */        
             /* ----------------------------------------------------- */        
             IF B02.PENSJONSTYPE2(IND) = 'S'       !                            
                DIV_PARAM_OMR.REDUSERT_GP_2G(IND) = 'V' !  /*9711 HL*/          
                DIV_PARAM_OMR.REDUSERT_GP_2G(IND) = 'K' !  /*9802 HL*/          
                (B02.PENSJONSTYPE2(IND) = 'N'  &                                
                 B02.PENSJONSTYPE2(IND_EK) = 'P'  &                             
                (B02.SIVILSTAND   (IND) = 'W' !                                 
                 B02.SIVILSTAND   (IND) = 'P' !                                 
                 B02.SIVILSTAND   (IND) = 'G'    ))  THEN                       
                CALL NY_U('U021');                                              
             ELSE                                                               
             IF (B02.EK_INNT_OVER_2G(IND) = 'J') THEN                           
                   /* GP MINDRE ENN G GRUNNA EK 2G */                           
                 CALL NY_U('U134');                                             
          END;                                                                  
       WHEN('U')                                                                
          DO;  /* UFØREPENSJON */                                               
             IF B02.UFØRPENS.UFG(IND) = 100 THEN                                
                DO;  /* 100 % UFG */                                            
                   IF B02.PENSJONSTYPE2(IND) ^= 'S'   &                         
                      DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'V'  &               
                      DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'K'  THEN            
                      DO;  /* IKKE SAMMENSTØT */                                
                         IF B02.TT_ANV(IND) < 40 THEN                           
                            DO;  /* TT_ANV < 40 */                              
                    /*JD 8.90*/IF B02.ETTEPENS.GP_BRUTTO(IND) ^= 0 !            
                                  B02.UFØRPENS.GP       (IND) ^= 0              
                                  THEN                                          
                                  CALL NY_U('U020');                            
                               IF (B02.UFØRPENS.ST(IND) > 0 ) THEN              
                                  DO;  /* HAR SÆRTILLEGG */                     
                                     IF (B02.UFØRPENS.ET(IND)+                  
                                         B02.UFØRPENS.BT(IND)+                  
                                        B02.BT_SÆRBARN(IND)  > 0 ) THEN         
                                        /* ST MED FT */                         
                                        CALL NY_U('U554');                      
                                     ELSE                                       
                                        /* ST UTEN FT */                        
                                        CALL NY_U('U040');                      
                                  END; /* HAR SÆRTILLEGG */                     
                               ELSE                                             
                                  IF (B02.UFØRPENS.ET(IND) > 0 !                
                                      B02.UFØRPENS.ET(IND) > 0 !                
                                      B02.BT_SÆRBARN(IND)  > 0 ) THEN           
                                     CALL NY_U('U135');                         
                            END; /* TT ANV < 40 */                              
                      END;                                                      
                   ELSE                                                         
                      DO;                                                       
                         IF B02.TT_ANV(IND) = 40 THEN                           
                            DO;  /* TT_ANV = 40 */                              
                               CALL NY_U('U021');                               
                                                                                
                               IF  (B02.TT_FØR_1967(IND) +                      
                                   (B02.TT_ETTER_1966(IND) +11) / 12 +          
                                   (B02.TT_FRAMT (IND) +11) / 12 +              
                                    B02.TT_16_66 (IND)   +                      
                                    B02.TT_67_TIL_70 (IND))                     
                                   < 40 THEN                                    
                                    CALL NY_U('U022');                          
                               IF B02.UFØRPENS.ST(IND) > 0 THEN                 
                                  CALL NY_U('U040');                            
                            END; /* TT_ANV = 40 */                              
                         ELSE                                                   
                            DO;  /* TT_ANV ^= 40 */                             
                               IF (B02.ETTEPENS.GP_BRUTTO(IND) ^= 0 !           
                                  B02.UFØRPENS.GP       (IND) ^= 0) &           
                                  B02.PENSJONSTYPE3(IND) = ' '                  
                                                                                
       /* JFA 2.2.2000            THEN                                          
          DISSE 4 LINJENE ER      DO;                                           
          ERSTATTET MED NESTE 7      TEKSTTYPE_U_KODE(J) = 'U020';              
                                     J                   = J + 1;               
                                  END;                              */          
                                  THEN                                          
                                  DO;                                           
                                     CALL NY_U('U029');                         
                                     CALL NY_U('U030');                         
                                  END;                                          
                                                                                
                                                                                
                                                                                
                               IF B02.UFØRPENS.ST(IND) > 0 THEN                 
                                  CALL NY_U('U040');                            
                            END; /* TT_ANV ^= 40 */                             
                      END;                                                      
             END; /* 100 % UFG */                                               
          ELSE                                                                  
             DO;  /* UFG ^= 100 % */                                            
                IF B02.PENSJONSTYPE2(IND) = 'S' THEN                            
                   DO;  /* SAMMENSTØTENDE PENSJON */                            
 /* JFA 30.5.00 */    IF B02.TT_ANV(IND) = 40      THEN                         
                         CALL NY_U('U024');                                     
                      IF B02.TT_ANV(IND) < 40 THEN                              
                         DO;                                                    
                            CALL NY_U('U025');                                  
                            IF  (B02.TT_FØR_1967(IND) +                         
                                (B02.TT_ETTER_1966(IND) +11) / 12 +             
                                (B02.TT_FRAMT (IND) +11) / 12 +                 
                                 B02.TT_16_66 (IND)   +                         
                                 B02.TT_67_TIL_70 (IND)) <                      
                                 B02.TT_ANV(IND) THEN                           
                                 CALL NY_U('U026');                             
                        END;                                                    
                   END; /* SAMMENSTØTENDE PENSJON */                            
                ELSE                                                            
                   DO;  /* IKKE SAMMENSTØTENDE PENSJON */                       
                      IF (B02.TT_ANV(IND) < 40) THEN                            
                         DO;  /* TT UNDER 40 */                                 
                            CALL NY_U('U020');                                  
                           IF B02.ETTEPENS.GP_BRUTTO(IND) ^= 0 &                
                              B02.UFØRPENS.GP       (IND) ^= 0  THEN            
                              CALL NY_U('U073');                                
                            IF  (B02.TT_FØR_1967(IND) +                         
                                 B02.TT_16_66   (IND) +                         
                                (B02.TT_ETTER_1966(IND) +11) / 12 +             
                                (B02.TT_FRAMT (IND) +11) / 12 +                 
                                 B02.TT_67_TIL_70 (IND)) <                      
                                 B02.TT_ANV(IND) &                              
                                 B02.SIVILSTAND(IND) ='E' THEN                  
                                 CALL NY_U('U027');                             
                         END;  /* TT UNDER 40 */                                
                   END; /* IKKE SAMMENSTØTENDE PENSJON */                       
                IF (B02.TT_ANV(IND) < 40     &                                  
                    B02.UFØRPENS.ST(IND) > 0 ) THEN                             
                   CALL NY_U('U040');                                           
              END;                                                              
          END; /* UFØREPENSJON */                                               
       WHEN('Y')                                                                
          DO;                                                                   
             /* tekst u305 , u306 og u307 flyttet lenger fram         */        
             /* jd 05. 2000                                           */        
          END;                                                                  
       WHEN('E','J')                                                            
          DO;  /* ETTERLATT EKTEFELLE ELLER FAMILIEPLEIER */                    
             IF B02.GUNSTIGSTE_ALTERNATIV(IND_EK) = ' ' THEN                    
                DO;  /* UTLAND BEHANDLES FOR SEG SELV */                        
             IF B02.PENSJONSTYPE2(IND) = 'O' THEN                               
                DO;  /* OVERGANGSSTØAD */                                       
                   IF B02.ETTEPENS.GP_NETTO(IND) <                              
                      B02.ETTEPENS.GP_BRUTTO(IND)     THEN                      
                      DO;                                                       
                         IF (W_HENDELSE.TT < 40) THEN                           
                            /* FRADRAG I GP - INNT & TT */                      
                            CALL NY_U('U037');                                  
                         ELSE                                                   
                            /* FRADAG I GP - INNT */                            
                            CALL NY_U('U036');                                  
                      END;                                                      
                   ELSE                                                         
                      IF (W_HENDELSE.TT < 40) THEN                              
                         /* FRADRAG I GP - TT */                                
                         CALL NY_U('U082');                                     
                END; /* OVERGANGSSTØNAD */                                      
             ELSE                                                               
                DO;  /* PENSJON */                                              
                   IF B02.ETTEPENS.GP_NETTO(IND) <                              
                      B02.ETTEPENS.GP_BRUTTO(IND)     THEN                      
                      DO;                                                       
                         IF W_HENDELSE.TT   < 40  &                             
    /* r1457 1105 jd */     B02.DØD_AV_YRKESSKADE(IND) = ' ' then               
                            DO;                                                 
                               IF   B02.TT_ANV(IND) >                           
                                    B02.TT_ANV(IND_EK) THEN                     
                                    CALL NY_U('U034');                          
                                ELSE                                            
                                       CALL NY_U('U035');                       
                            END;                                                
                         ELSE                                                   
                            CALL NY_U('U033');                                  
                      END;                                                      
                   ELSE /* GP_NETTO = GP_BRUTTO */                              
 /*1195 HL*/         IF W_HENDELSE.TT   < 40 THEN                               
                                                                                
                       DO;                                                      
                         IF (B02.YRKEPENS.YUG(IND_EK) > 0   &                   
           /*JD 8.90*/      B02.YRKEPENS.YUG(IND_EK) < 100)                     
                            THEN                                                
                            CALL NY_U('U308');                                  
                         ELSE                                                   
                            DO;                                                 
 /*TEST FLYTTET HIT :*/                                                         
                               IF B02.ETTEPENS.GP_BRUTTO(IND) ^= 0  &           
                                  B02.DØD_AV_YRKESSKADE(IND) = ' '              
                                  THEN                                          
                                  DO;                                           
                                    IF B02.TT_ANV(IND) = 0  THEN                
                                       CALL NY_U('U130');                       
                                    ELSE                                        
                                      DO;                                       
                                         IF B02.TT_ANV(IND) >                   
                                            B02.TT_ANV(IND_EK) THEN             
                                            CALL NY_U('U020');                  
                                         ELSE                                   
                                            CALL NY_U('U032');                  
                                      END;                                      
                                  END;                                          
                            END;                                                
                       END;                                                     
                                                                                
                END;                                                            
                                                                                
                                                                                
 /*HL*/      IF W_HENDELSE.TT   < 40 THEN                                       
                                                                                
                DO;                                                             
                   IF B02.ETTEPENS.ST(IND) > 0 THEN                             
                      CALL NY_U('U040');                                        
                                                                                
                END;                                                            
                                                                                
                END;  /* UTLAND BEHANDLES FOR SEG SELV */                       
          END;                                                                  
       WHEN('B')                                                                
          DO; /* FORELDRELØSE BARN */                                           
             IF B02.TT_ANV(IND) < 40 THEN                                       
                DO;                                                             
                   CALL NY_U('U020');                                           
                   IF B02.ETTEBARN.ST(IND) > 0 THEN                             
                      CALL NY_U('U040');                                        
                END;                                                            
          END; /* FORELDRELØSE BARN */                                          
       OTHERWISE;                                                               
    END; /*SELECT*/                                                             
 /* ***************************************************************** */        
 /* HVIS INNVILGET REDUSERT BARNETILLEGG                              */        
 /* ***************************************************************** */        
                                                                                
    IF (B02.PENSJONSTYPE1(IND) = 'A' !                                          
        B02.PENSJONSTYPE1(IND) = 'U') &                                         
        W_HENDELSE.ANT_BT_REDUSERT > 0 THEN                                     
       CALL NY_U('U098');                                                       
                                                                                
    IF B02.ALDERSP.TP (IND) > 0 !                                               
       B02.UFØRPENS.TP(IND) > 0 !                                               
       B02.YRKEPENS.TP(IND) > 0 !                                               
       B02.ETTEPENS.TP_BRUTTO(IND) > 0 !                                        
       B02.ETTEBARN.TP(IND) > 0  THEN                                           
       DO;  /* TESTER VED TILLEGGSPENSJON */                                    
          SELECT(B02.PENSJONSTYPE1(IND));                                       
             WHEN('A')                                                          
                DO;  /* ALDERSPENSJON TEST PÅ SPT OG OPT 4.99 JD*/              
                   IF B02.BEREGN_FOLKETRYGD(IND) = ' ' &                        
                     (B02.ALDERSP.SPT      (IND) ^= 0  !                        
                      B02.ALDERSP.OPT      (IND) ^= 0 ) THEN                    
                      DO;                                                       
                         CALL NY_U('U199');                                     
                         CALL NY_U('U180');                                     
                      END;                                                      
                                                                                
                   IF B02.YRKEPENS.YUG(IND) > 0 THEN                            
                      CALL NY_U('U354');                                        
                                                                                
                  IF B02.DØD_AV_YRKESSKADE(IND) = 'E' !                         
                     B02.DØD_AV_YRKESSKADE(IND) = 'Y' THEN                      
                     DO;  /* DØD AV YRKESSKADE */                               
                        SELECT(B02.YRKEPENS.YPT_KODE(IND_EK));                  
                           WHEN('A')                                            
                              SELECT(B02.POENGTILLEGG_KODE(IND));               
                                 WHEN('A') CALL NY_U('U526');                   
                                 WHEN('B') CALL NY_U('U525');                   
                                 WHEN('C') CALL NY_U('U527');                   
                                 OTHER;                                         
                              END; /* SELECT POENGTILLEGG_KODE(IND) */          
                           WHEN('V')                                            
                              SELECT(B02.POENGTILLEGG_KODE(IND));               
                                 WHEN('A') CALL NY_U('U321');                   
                                 WHEN('B') CALL NY_U('U320');                   
                                 WHEN('C') CALL NY_U('U522');                   
                                 OTHER;                                         
                              END; /* SELECT POENGTILLEGG_KODE */               
                           OTHER;                                               
                        END; /* SELECT YPT_KODE(IND_EK)) */                     
                                                                                
                        SELECT (B02.YRKEHIST.YRKE11(IND_EK,1));                 
                           WHEN('A') CALL NY_U('U366');                         
                           WHEN('S') CALL NY_U('U382');                         
                           OTHER;                                               
                        END; /* SELECT YRKE11 */                                
                                                                                
                        IF (B02.YRKEPENS.YPT_KODE(IND_EK) = 'A' ) &             
                           (B02.YRKEPENS.YUG(IND_EK) < 100)       THEN          
                           SELECT(B02.POENGTILLEGG_KODE(IND));                  
                              WHEN('A') CALL NY_U('U329');                      
                              WHEN('B') CALL NY_U('U328');                      
                              WHEN('C') CALL NY_U('U330');                      
                              OTHER;                                            
                           END; /* SELECT POENGTILLEGG_KODE */                  
                        ELSE                                                    
                        IF (B02.YRKEPENS.YPT_KODE(IND_EK) = 'V' ) &             
                           (B02.POENGTILLEGG_KODE(IND) = ' ' ) THEN             
                           CALL NY_U('U331');                                   
                                                                                
                     END; /* DØD AV YRKESSKADE */                               
                                                                                
                 IF B02.PENSJONSTYPE2(IND) = 'S' THEN                           
                    DO;  /* SAMMENSTØTSBEREGNING */                             
                       IF B02.TP_GAR_KODE(IND) = 'E' THEN                       
                          DO;                                                   
                             IF F_AAR < 1925 THEN                               
                                CALL NY_U('U104');                              
                             ELSE                                               
                             IF (F_AAR = 1925) THEN                             
                               DO;                                              
                                 CALL NY_U('U104');                             
                              /* CALL NY_U('U105');   */                        
                               end;                                             
                             ELSE                                               
                             IF F_AAR > 1925      &                             
                                UFØR_ALDER < 2201            THEN               
                                DO;                                             
                                   CALL NY_U('U104');                           
                               /*  CALL NY_U('U105');                           
                                   CALL NY_U('U116');                           
                                   CALL NY_U('U126');    */                     
                                /* IF F_AAR > 1930      THEN                    
                                      CALL NY_U('U127'); */                     
                                   IF F_AAR > 1940      THEN                    
                                      CALL NY_U('U128');                        
                                END;                                            
                             ELSE                                               
                             IF UFØR_ALDER < 2401 THEN                          
                                DO;                                             
                                   CALL NY_U('U125');                           
                               /*  IF F_AAR > 1930      THEN                    
                                      CALL NY_U('U127'); */                     
                                   IF F_AAR > 1940      THEN                    
                                      CALL NY_U('U128');                        
                                END;                                            
                             ELSE                                               
                             IF UFØR_ALDER < 2601 THEN                          
                                CALL NY_U('U133');                              
                                                                                
                             IF B02.TT_ANV(IND) < 40  THEN                      
                                CALL NY_U('U107');                              
                            END; /* TP_GAR_KODE = 'E' */                        
                       ELSE                                                     
                          IF B02.ALDERSP.TP(IND_EK) > 0 !                       
                             B02.YRKEPENS.TP(IND_EK) > 0 !                      
                             B02.UFØRPENS.TP(IND_EK) > 0 THEN                   
                             DO;  /* TP_EK > 0 */                               
                                IF B02.POENGTILLEGG_KODE(IND) = 'B' &           
                                   B02.YPT_KODE(IND)      = ' ' THEN            
                                   CALL NY_U('U045');                           
                                ELSE                                            
                                IF B02.POENGTILLEGG_KODE(IND) = 'A' &           
                                   B02.YPT_KODE(IND) = ' ' THEN                 
                                   CALL NY_U('U046');                           
                                ELSE                                            
                                   CALL NY_U('U047');                           
                             END; /* TP_EK > 0 */                               
                          ELSE                                                  
                             /* TP_EK = 0 */                                    
                             CALL NY_U('U047');                                 
                    END; /* SAMMENSTØTSBEREGNING */                             
                 ELSE                                                           
                    DO;  /* IKKE SAMMENSTØTSBEREGNING */                        
                       IF B02.PENSJONSTYPE2(IND) = 'E' &                        
                          (B02.SIVILSTAND   (IND) = 'E'  !                      
  /* FEILRAPP 277 */       B02.SIVILSTAND   (IND) = 'S')          THEN          
                          DO;                                                   
                             IF B02.TP_GAR_KODE(IND) = 'E' THEN                 
                                DO;                                             
                                   IF F_AAR < 1925 THEN                         
                                      CALL NY_U('U104');                        
                                   ELSE                                         
                                   IF (F_AAR = 1925) THEN                       
                                      DO;                                       
                                         CALL NY_U('U104');                     
                                     /*  CALL NY_U('U105'); */                  
                                      END;                                      
                                   ELSE                                         
                                   IF F_AAR > 1925 &                            
  /*HL 060397*/                       UFØR_ALDER < 2201            THEN         
                                      DO;                                       
                                         CALL NY_U('U104');                     
                                     /*  CALL NY_U('U105');                     
                                         CALL NY_U('U116');                     
                                         CALL NY_U('U126');   */                
                                      /* IF F_AAR > 1930      THEN              
                                            CALL NY_U('U127'); */               
                                         IF F_AAR > 1940      THEN              
                                            CALL NY_U('U128');                  
                                      END;                                      
                                   ELSE                                         
                                   IF UFØR_ALDER < 2401 THEN                    
                                      DO;                                       
                                         CALL NY_U('U125');                     
                                      /* IF F_AAR > 1930      THEN              
                                            CALL NY_U('U127'); */               
                                         IF F_AAR > 1940      THEN              
                                            CALL NY_U('U128');                  
                                      END;                                      
                                   ELSE                                         
                                   IF UFØR_ALDER < 2601 THEN                    
                                      CALL NY_U('U133');                        
                                                                                
                                   IF B02.TT_ANV(IND) < 40  THEN                
                                      CALL NY_U('U107');                        
                                END; /* TP_GAR_KODE = 'E' */                    
                             ELSE                                               
                                IF B02.ETTEPENS.TP_BRUTTO(IND) > 0 THEN         
                                   IF B02.ALDERSP.TP(IND) > 0  THEN             
                                      DO;                                       
                                                                                
                      IF B02.POENGTILLEGG_KODE(IND) = 'B'  &                    
                         B02.YPT_KODE(IND_EK)       = ' ' THEN                  
                         CALL NY_U('U084');                                     
                      ELSE                                                      
                      IF B02.POENGTILLEGG_KODE(IND) = 'A'   &                   
                         B02.YPT_KODE(IND_EK)       = ' ' THEN                  
                         CALL NY_U('U085');                                     
                      ELSE                                                      
                      IF B02.POENGTILLEGG_KODE(IND) = 'C'  &                    
                         B02.YPT_KODE(IND_EK)       = ' '  THEN                 
                         CALL NY_U('U089');                                     
                      ELSE                                                      
                         DO;                                                    
                            CALL NY_U('U047');                                  
                            CALL NY_U('U049');                                  
                         END;                                                   
                         END;                                                   
                                                                                
                                ELSE   /* BARE TP ETTER AVDØDE   */             
                                                                                
                                   DO;                                          
                                      CALL NY_U('U047');                        
                                      CALL NY_U('U048');                        
                                   END;                                         
                             ELSE   /*TP_BRUTTO = 0    */                       
                                CALL NY_U('U047');                              
                          END;                                                  
                       ELSE   /*PT2 ^=E ELLER SIVILSTAND ^=E/S */               
                          DO;                                                   
                            IF B02.TP_GAR_KODE(IND) = 'E' THEN                  
                               DO;                                              
                                  IF F_AAR < 1925 THEN                          
                                     CALL NY_U('U104');                         
                                  ELSE                                          
                                  IF (F_AAR = 1925 ) THEN                       
                                      DO;                                       
                                         CALL NY_U('U104');                     
                                      /* CALL NY_U('U105');  */                 
                                      END;                                      
                                  ELSE                                          
                                  IF F_AAR > 1925 &                             
  /*HL 060397*/                      UFØR_ALDER < 2201            THEN          
                                      DO;                                       
                                         CALL NY_U('U104');                     
                                     /*  CALL NY_U('U105');                     
                                         CALL NY_U('U116');                     
                                         CALL NY_U('U126');   */                
                                      /* IF F_AAR > 1930      THEN              
                                            CALL NY_U('U127'); */               
                                         IF F_AAR > 1940      THEN              
                                            CALL NY_U('U128');                  
                                      END;                                      
                                  ELSE                                          
                                  IF UFØR_ALDER < 2401 THEN                     
                                      DO;                                       
                                         CALL NY_U('U125');                     
                                      /* IF F_AAR > 1930      THEN              
                                            CALL NY_U('U127'); */               
                                         IF F_AAR > 1940      THEN              
                                            CALL NY_U('U128');                  
                                      END;                                      
                                  ELSE                                          
                                  IF UFØR_ALDER < 2601 THEN                     
                                     CALL NY_U('U133');                         
                                  IF B02.TT_ANV(IND) < 40  THEN                 
                                     CALL NY_U('U107');                         
                              END;                                              
                           ELSE                                                 
                             DO;                                                
                                CALL NY_U('U047');                              
                                IF B02.ETTEPENS.TP_BRUTTO(IND) > 0 THEN         
                                   IF (B02.ALDERSP.TP(IND) > 0) THEN            
                                      CALL NY_U('U349');                        
                                   ELSE   /* BARE TP ETTER AVDØDE   */          
                                      CALL NY_U('U348');                        
                             END;                                               
                          END;                                                  
                    END;                                                        
                END; /* ALDERSPENSJON */                                        
                                                                                
             WHEN('K')                                                          
                DO;  /* AVTALEFESTET PENSJON */                                 
                   IF B02.BEREGN_FOLKETRYGD(IND) = ' ' THEN                     
                      DO;                                                       
                         CALL NY_U('U199');                                     
                         CALL NY_U('U180');                                     
                      END;                                                      
                   CALL NY_U('U047');                                           
                END; /* AVTALEFESTET PENSJON */                                 
                                                                                
             WHEN('U')                                                          
                DO;                                                             
    IF B02.BEREGN_FOLKETRYGD(IND) = ' ' THEN                                    
       DO;                                                                      
          CALL NY_U('U199');                                                    
          CALL NY_U('U180');                                                    
       END;                                                                     
                                                                                
    IF VERIFY(B02.DØD_AV_YRKESSKADE(IND),'EY') = 0 THEN                         
       DO;  /* DØD AV YRKESSKADE */                                             
          SELECT (B02.YRKEPENS.YPT_KODE(IND_EK));                               
             WHEN('A')                                                          
                SELECT (B02.POENGTILLEGG_KODE(IND));                            
                   WHEN ('A') CALL NY_U('U326');                                
                   WHEN ('B') CALL NY_U('U325');                                
                   WHEN ('C') CALL NY_U('U327');                                
                   OTHER;                                                       
                END; /* SELECT POENTILLEGG_KODE */                              
             WHEN('V')                                                          
                SELECT (B02.POENGTILLEGG_KODE(IND));                            
                   WHEN ('A') CALL NY_U('U321');                                
                   WHEN ('B') CALL NY_U('U320');                                
                   WHEN ('C') CALL NY_U('U322');                                
                   OTHER;                                                       
                END; /* SELECT POENTILLEGG_KODE */                              
             OTHER;                                                             
          END; /* SELECT YPT_KODE */                                            
                                                                                
          SELECT(B02.YRKEHIST.YRKE11(IND_EK,1));                                
             WHEN('A') CALL NY_U('U366');                                       
             WHEN('S') CALL NY_U('U382');                                       
             OTHER;                                                             
          END; /* SELECT YRKE11 */                                              
                                                                                
          IF B02.YRKEPENS.YUG(IND_EK) < 100      &                              
             B02.YRKEPENS.YPT_KODE(IND_EK) = 'A' THEN                           
             SELECT (B02.POENGTILLEGG_KODE(IND));                               
                WHEN('A') CALL NY_U('U329');                                    
                WHEN('B') CALL NY_U('U328');                                    
                WHEN('C') CALL NY_U('U330');                                    
                OTHER;                                                          
             END; /* SELECT POENGTILLEGG_KODE */                                
                                                                                
          IF (B02.YRKEPENS.YPT_KODE(IND_EK) = 'V' ) &                           
             (B02.POENGTILLEGG_KODE(IND) = ' ' ) THEN                           
             CALL NY_U('U331');                                                 
                                                                                
       END; /* DØD AV YRKESSKADE */                                             
                                                                                
    IF B02.TP_GAR_KODE(IND) = 'E' THEN                                          
       IF (B02.PENSJONSTYPE2(IND) = 'S' )  !                                    
          (B02.PENSJONSTYPE2(IND) = 'E' &                                       
           VERIFY(B02.SIVILSTAND(IND),'ES') = 0 )  THEN                         
          SELECT;                                                               
             WHEN(F_AAR < 1925 )                                                
                CALL NY_U('U104');                                              
             WHEN(F_AAR = 1925 )                                                
                DO;                                                             
                   CALL NY_U('U104');                                           
               /*  CALL NY_U('U105');  */                                       
                END;                                                            
             OTHER                                                              
                DO;  /* FØDT 1926 - 1940 */                                     
                   SELECT; /* UFØR_ALDER */                                     
                      WHEN(UFØR_ALDER < 2201)                                   
                         DO;  /* UFØR FØR FYLTE 22 */                           
                            CALL NY_U('U104');                                  
                       /*   CALL NY_U('U105');                                  
                            CALL NY_U('U116');                                  
                            CALL NY_U('U126'); */                               
                         /* IF F_AAR > 1930      THEN                           
                               CALL NY_U('U127'); */                            
                            IF F_AAR > 1940      THEN                           
                               CALL NY_U('U128');                               
                         END; /* UFØR FØR FYLTE 22 */                           
                      WHEN(UFØR_ALDER < 2401)                                   
                         DO;  /* UFØR FØR FYLTE 24 */                           
                            CALL NY_U('U125');                                  
                         /* IF F_AAR > 1930      THEN                           
                               CALL NY_U('U127'); */                            
                            IF F_AAR > 1940      THEN                           
                               CALL NY_U('U128');                               
                         END;                                                   
                      WHEN(UFØR_ALDER < 2601)                                   
                         CALL NY_U('U133');                                     
                      OTHER;                                                    
                   END;                                                         
                                                                                
                   IF B02.TT_ANV(IND) < 40  THEN                                
                      CALL NY_U('U107');                                        
                END;                                                            
          END; /* SELECT F_AAR GAMLE UFØRE */                                   
                                                                                
    IF B02.PENSJONSTYPE2(IND) = 'S' THEN                                        
       DO;  /* SAMMENSTØTSBEREGNING */                                          
          IF B02.TP_GAR_KODE(IND) ^= 'E' THEN                                   
             IF (B02.BUP_GARANTI(IND,1) > 0) &                                  
                (B02.BUP_GARANTI(IND,1) =                                       
                 B02.ETTEPENS.SPT_AVD(IND)) THEN                                
                DO; /* GARANTI */                                               
                   SELECT;                                                      
                      WHEN(UFØR_ALDER < 2001) CALL NY_U('U050');                
                      WHEN(UFØR_ALDER < 2101) CALL NY_U('U094');                
                      WHEN(UFØR_ALDER < 2201) CALL NY_U('U099');                
                      WHEN(UFØR_ALDER < 2401) CALL NY_U('U120');                
                      WHEN(UFØR_ALDER < 2401) CALL NY_U('U131');                
                      OTHER;                                                    
                   END; /* SELECT UFØR_ALDER */                                 
                END; /* GARANTI */                                              
             ELSE                                                               
                DO;                                                             
                   IF B02.ALDERSP.TP(IND_EK) > 0 !                              
                      B02.YRKEPENS.TP(IND_EK) > 0  !                            
                      B02.UFØRPENS.TP(IND_EK) > 0 THEN                          
                      DO;  /* EKTEFELLEN HAR TILLEGGSPENSJON */                 
                         IF B02.POENGTILLEGG_KODE(IND) = 'B' &                  
                            B02.YPT_KODE(IND)  = ' ' THEN                       
                            /* DELER POENGTILLEGG */                            
                            CALL NY_U('U045');                                  
                         ELSE                                                   
                         IF B02.POENGTILLEGG_KODE(IND) = 'A'  &                 
                            B02.YRKEPENS.YPT_KODE(IND)  = ' '  THEN             
                            /* FÅR HELE POENGTILLEGGET */                       
                            CALL NY_U('U046');                                  
                         ELSE                                                   
                            /* FÅR IKKE POENGTILLEGG */                         
                            CALL NY_U('U047');                                  
                      END; /* EKTEFELLEN HAR TILLEGGSPENSJON */                 
                   ELSE                                                         
                      /* EKTEFELLEN HAR IKKE TILLEGGSPENSJON */                 
                      CALL NY_U('U047');                                        
                END;                                                            
       END; /* SAMMENSTØTSBEREGNING */                                          
    ELSE   /*PT2^=S*/                                                           
       DO;  /* IKKE SAMMENSTØTSBEREGNING */                                     
          IF  B02.PENSJONSTYPE2(IND) = 'E' &                                    
             (B02.SIVILSTAND   (IND) = 'E'     !                                
              B02.SIVILSTAND   (IND) = 'S'   )      THEN                        
             DO;  /* PT2 = 'E' & SIVILSTAND = 'E' ! 'S' */                      
             /* IF B02.TP_GAR_KODE(IND) = 'E' THEN                              
                   DO;                                                          
                      IF F_AAR > 1925 THEN                                      
                         DO;                                                    
                            TEKSTTYPE_U_KODE(J) = 'U126';                       
                            J                   = J + 1;                        
                         END;                                                   
                      IF F_AAR > 1930      THEN                                 
                         DO;                                                    
                            TEKSTTYPE_U_KODE(J) = 'U127';                       
                            J                   = J + 1;                        
                         END;                                                   
                      ELSE                                                      
                         DO;                                                    
                            TEKSTTYPE_U_KODE(J) = 'U125';                       
                            J                   = J + 1;                        
                            IF F_AAR > 1930      THEN                           
                               DO;                                              
                                  TEKSTTYPE_U_KODE(J) = 'U127';                 
                                  J                   = J + 1;                  
                               END;                                             
                         END;                                                   
                   END;      */                                                 
                /* -------------------------------------------------- */        
  /* JFA 24.2.2000    */                                                        
                IF B02.ETTEPENS.TP_BRUTTO(IND) = 0 &                            
                   B02.UFØRPENS.TP(IND)        > 0  THEN                        
                   DO;                                                          
                     CALL NY_U('U047');                                         
                     IF (B01.POENGTILLEGG_KODE(IND) = 'A'  !                    
                         B01.POENGTILLEGG_KODE(IND) = 'B') &                    
                        B02.POENGTILLEGG_KODE(IND)  = ' ' THEN                  
                        CALL NY_U('U136');                                      
                   END;                                                         
  /* HIT 24.2   */                                                              
                IF B02.ETTEPENS.TP_BRUTTO(IND) > 0 THEN                         
                   IF B02.UFØRPENS.TP(IND)  > 0  THEN                           
                      DO;  /* UFØRPENS.TP > 0 */                                
                         IF B02.YRKEPENS.YPT_KODE(IND_EK) = ' ' THEN            
                            SELECT(B02.POENGTILLEGG_KODE(IND));                 
                               WHEN('A') CALL NY_U('U085');                     
                               WHEN('B') CALL NY_U('U084');                     
                               WHEN('C') CALL NY_U('U089');                     
                               OTHER /* UFF 67 */                               
                                  IF B02.TP_GAR_KODE(IND) = ' '    THEN         
                                     CALL NY_U('U047');                         
                            END; /* SELECT POENGTILLEGG_KODE */                 
                                                                                
                         IF (B02.BUP_GARANTI(IND_EK,1) > 0 &                    
                             B02.BUP_GARANTI(IND_EK,1) =                        
                             B02.ETTEPENS.SPT_AVD(IND))    &                    
                            (B02.BUP_GARANTI(IND,1) > 0 &                       
                             B02.BUP_GARANTI(IND,1) =                           
                             B02.UFØRPENS.SPT(IND)) THEN                        
                            CALL NY_U('U053');                                  
                                                                                
                         CALL NY_U('U049');                                     
                                                                                
                         IF (B02.ETTEPENS.SPT_AVD(IND) = 3.30 &                 
                             B02.ETTEPENS.TP_BRUTTO(IND) > 0  &                 
                             B02.PENSJONSTYPE2   (IND) = 'E') THEN              
                            SELECT; /* UFØR_ALDER_DØD */                        
                               WHEN(UFØR_ALDER_DØD < 2001)                      
                                  CALL NY_U('U051');                            
                               WHEN(UFØR_ALDER_DØD < 2101)                      
                                  CALL NY_U('U095');                            
                               WHEN(UFØR_ALDER_DØD < 2201)                      
                                  CALL NY_U('U100');                            
                               WHEN(UFØR_ALDER_DØD < 2401)                      
                                  CALL NY_U('U121');                            
                               WHEN(UFØR_ALDER_DØD < 2601)                      
                                  CALL NY_U('U132');                            
                               OTHER;                                           
                            END; /* SELECT UFØR_ALDER_DØD */                    
                      END; /* UFØRPENS.TP > 0 */                                
                   ELSE                                                         
                      DO;  /* BARE TP ETTER AVDØDE */                           
                         IF B02.TP_GAR_KODE(IND) = ' '   THEN                   
                            CALL NY_U('U047');                                  
                                                                                
                         IF (B02.ETTEPENS.SPT_AVD(IND) = 3.30 &                 
                             B02.ETTEPENS.TP_BRUTTO(IND) > 0  &                 
                             B02.PENSJONSTYPE2   (IND) = 'E') THEN              
                            DO;  /* SPT_AVD = 3.3 ... */                        
                               SELECT; /* UFØR_ALDER_DØD */                     
                                  WHEN(UFØR_ALDER_DØD < 2001)                   
                                     CALL NY_U('U051');                         
                                  WHEN(UFØR_ALDER_DØD < 2101)                   
                                     CALL NY_U('U095');                         
                                  WHEN(UFØR_ALDER_DØD < 2201)                   
                                     CALL NY_U('U100');                         
                                  WHEN(UFØR_ALDER_DØD < 2401)                   
                                     CALL NY_U('U121');                         
                                  WHEN(UFØR_ALDER_DØD < 2601)                   
                                     CALL NY_U('U132');                         
                                  OTHER;                                        
                               END; /* SELECT UFØR_ALDER_DØD */                 
    /* TIL HIT UNGE DØDE JD 10.92   */                                          
                               CALL NY_U('U048');                               
                            END; /* SPT_AVD = 3.3 ... */                        
                         ELSE                                                   
                            DO;                                                 
 /*UFF67*/                     IF B02.TP_GAR_KODE(IND) = ' '  THEN              
                                  DO;                                           
   /* JFA 9.5.00 SATT 047 = 199 */   TEKSTTYPE_U_KODE(J)  = 'U199';             
                                     J = J + 1 ;                                
                                  END;                                          
                                                                                
                               IF B02.BUP_GARANTI(IND,1) > 0 &                  
                                  (B02.BUP_GARANTI(IND,1) =                     
                                   B02.UFØRPENS.SPT(IND)     ) THEN             
                                  SELECT; /* UFØR_ALDER */                      
                                     WHEN(UFØR_ALDER < 2001)                    
                                        CALL NY_U('U050');                      
                                     WHEN(UFØR_ALDER < 2101)                    
                                        CALL NY_U('U094');                      
                                     WHEN(UFØR_ALDER < 2201)                    
                                        CALL NY_U('U099');                      
                                     WHEN(UFØR_ALDER < 2401)                    
                                        CALL NY_U('U120');                      
                                     WHEN(UFØR_ALDER < 2601)                    
                                        CALL NY_U('U131');                      
                                     OTHER;                                     
                                  END; /* SELECT UFØR_ALDER */                  
                            END;                                                
                      END; /* BARE TP ETTER AVDØDE */                           
                                                                                
             END; /* PT2 = 'E' & SIVILSTAND = 'E' ! 'S' */                      
                                                                                
          ELSE                                                                  
             DO;  /* PT2 ^= 'E' ! SIVILSTAND ^= ('E' ! 'S') */                  
                IF B02.ETTEPENS.TP_BRUTTO(IND) > 0   THEN                       
                   IF B02.UFØRPENS.TP(IND)      > 0   THEN                      
                      DO;  /* HAR EGEN TP */                                    
                         CALL NY_U('U047');                                     
                         CALL NY_U('U349');                                     
                      END; /* HAR EGEN TP */                                    
                   ELSE                                                         
                      DO;  /* HAR KUN TP ETTER AVDØDE */                        
                         CALL NY_U('U047');                                     
                                                                                
                         IF (B02.BUP_GARANTI(IND_EK,1) > 0 ) &                  
                            (B02.BUP_GARANTI(IND_EK,1) =                        
                             B02.ETTEPENS.SPT_AVD(IND)     ) THEN               
                            DO;  /* EKTEFELLENS GARANTI SLÅR TIL */             
                               SELECT; /* UFØR_ALDER */                         
                                  WHEN(UFØR_ALDER < 2001)                       
                                     CALL NY_U('U051');                         
                                  WHEN(UFØR_ALDER < 2101)                       
                                     CALL NY_U('U091');                         
                                  WHEN(UFØR_ALDER < 2201)                       
                                     CALL NY_U('U100');                         
                                  WHEN(UFØR_ALDER < 2401)                       
                                     CALL NY_U('U121');                         
                                  WHEN(UFØR_ALDER < 2601)                       
                                     CALL NY_U('U132');                         
                                  OTHER;                                        
                               END; /* SELECT UFØR_ALDER */                     
                                                                                
                               CALL NY_U('U348');                               
                            END; /* EKTEFELLENS GARANTI SLÅR TIL */             
                      END; /* HAR KUN TP ETTER AVDØDE */                        
                   ELSE                                                         
                      DO;  /* HAR IKKE ETTERLATT TP            */               
                         IF B02.TP_GAR_KODE(IND) = 'E' THEN                     
                            DO;  /* TP_GAR_KODE = 'E' */                        
                                IF F_AAR < 1925 THEN                            
                                   CALL NY_U('U104');                           
                                ELSE                                            
                                IF (F_AAR = 1925) THEN                          
                                   DO;                                          
                                      CALL NY_U('U104');                        
                                 /*   CALL NY_U('U105');   */                   
                                  END;                                          
                               ELSE                                             
                               IF F_AAR > 1925 &                                
  /*     DIV_PARAM_OMR.U_TEXT_KODE = 'F' THEN */                                
  /*HL 060397*/                   UFØR_ALDER < 2201         THEN                
                                  DO;  /* UFØR ALDER UNDER 22 */                
                                     CALL NY_U('U104');                         
                               /*    CALL NY_U('U105');                         
                                     CALL NY_U('U116');                         
                                     CALL NY_U('U126');  */                     
                                 /*  IF F_AAR > 1930 THEN                       
                                        CALL NY_U('U127'); */                   
                                     IF F_AAR > 1940 THEN                       
                                        CALL NY_U('U128');                      
                                  END; /* UFØR ALDER UNDER 22 */                
                               ELSE                                             
                               IF UFØR_ALDER < 2401 THEN                        
                                  DO; /* UFØR FØR 24 ÅR */                      
                                     CALL NY_U('U125');                         
                                 /*  IF F_AAR > 1930      THEN                  
                                        CALL NY_U('U127'); */                   
                                     IF F_AAR > 1940      THEN                  
                                        CALL NY_U('U128');                      
                                  END; /* UFØR FØR 24 ÅR */                     
                               ELSE                                             
                               IF UFØR_ALDER < 2601 THEN                        
                                  CALL NY_U('U133');                            
                                                                                
                               IF B02.TT_ANV(IND) < 40  THEN                    
                                  CALL NY_U('U107');                            
                            END; /* TP_GAR_KODE = 'E' */                        
                         ELSE                                                   
                            DO;  /* TP_GAR_KODE ^= 'E' */                       
                                  CALL NY_U('U047');                            
                                                                                
                               IF B02.BUP_GARANTI(IND,1) > 0 &                  
                                  B02.BUP_GARANTI(IND,1) =                      
                                  B02.UFØRPENS.SPT(IND)      THEN               
                                  SELECT; /* UFØR_ALDER */                      
                                     WHEN(UFØR_ALDER < 2001)                    
                                        CALL NY_U('U050');                      
                                     WHEN(UFØR_ALDER < 2101)                    
                                        CALL NY_U('U094');                      
                                     WHEN(UFØR_ALDER < 2201)                    
                                        CALL NY_U('U099');                      
                                     WHEN(UFØR_ALDER < 2401)                    
                                        CALL NY_U('U120');                      
                                     WHEN(UFØR_ALDER < 2601)                    
                                        CALL NY_U('U131');                      
                                     OTHER;                                     
                                  END; /* SELECT UFØR_ALDER */                  
                            END; /* TP_GAR_KODE ^= 'E' */                       
                      END; /* HAR IKKE ETTERLATT TP            */               
             END; /* PT2 ^= 'E' ! SIVILSTAND ^= ('E' ! 'S') */                  
       END; /* IKKE SAMMENSTØTSBEREGNING */                                     
                                                                                
     IF ( B02.GUNSTIGSTE_ALTERNATIV(IND) = '2' ) THEN                           
        DO;                                                                     
           IF DIV_PARAM_OMR.PÅ_NORSK_FAKTISK(IND) > 20 THEN                     
              CALL NY_U('U539');                                                
           ELSE                                                                 
              CALL NY_U('U538');                                                
        END;                                                                    
                END;                                                            
                                                                                
             WHEN('E')                                                          
                DO;  /* ETTERLATT EKTEFELLE */                                  
                   IF (B02.GUNSTIGSTE_ALTERNATIV(IND_EK) = ' ' !                
                       B02.GUNSTIGSTE_ALTERNATIV(IND_EK) = '1' ) THEN           
                      DO;  /* TEKSTER KUN VED NASJONAL YTELSE */                
                         IF (B02.BEREGN_FOLKETRYGD(IND) = ' ') THEN             
                            DO;                                                 
                               /* U199: EKSTRA BLANK LINJE */                   
                               CALL NY_U('U199');                               
                                                                                
                               /* U180: OVERSKRIFT TILLEGGSPENSJON */           
                               CALL NY_U('U180');                               
                            END;                                                
                                                                                
                         IF (B02.SIVILSTAND(IND) = 'U') THEN                    
                            CALL NY_U('U348');                                  
                         ELSE                                                   
                            CALL NY_U('U048');                                  
                                                                                
                         IF B02.ETTEPENS.SPT_AVD(IND) = 3.30 !                  
                            B02.TP_GAR_KODE(IND_EK)   = 'E'  THEN               
                            SELECT; /* UFØR_ALDER_DØD */                        
                               WHEN(UFØR_ALDER_DØD < 2001)                      
                                  CALL NY_U('U051');                            
                               WHEN(UFØR_ALDER_DØD < 2101)                      
                                  CALL NY_U('U095');                            
                               WHEN(UFØR_ALDER_DØD < 2201)                      
                                  CALL NY_U('U100');                            
                               WHEN(UFØR_ALDER_DØD < 2401)                      
                                  CALL NY_U('U121');                            
                               WHEN(UFØR_ALDER_DØD < 2601)                      
                                  CALL NY_U('U132');                            
                               OTHER;                                           
                            END; /* SELECT UFØR_ALDER_DØD */                    
                         CALL NY_U('U047');                                     
                      END; /* TEKSTER KUN VED NASJONAL YTELSE */                
                                                                                
                  /* DØD AV YRKESSKADE */                                       
                                                                                
                  DO L = 10 TO 1 BY -1 UNTIL(B02.YRKEHIST.YUFT_ÅMD              
                                            (IND_EK,L) > 0);                    
                     SISTE = L;                                                 
                  END;                                                          
                                                                                
                  IF B02.DØD_AV_YRKESSKADE(IND) = 'E' !                         
                     B02.DØD_AV_YRKESSKADE(IND) = 'Y' THEN                      
                     DO;  /* DØD AV YRKESSKADE */                               
                        SELECT(B02.YRKEPENS.YPT_KODE(IND));                     
                           WHEN('A')                                            
                              SELECT(B02.POENGTILLEGG_KODE(IND));               
                                 WHEN('A') CALL NY_U('U326');                   
                                 WHEN('B') CALL NY_U('U325');                   
                                 WHEN('C') CALL NY_U('U327');                   
                                 OTHER;                                         
                              END; /* SELECT POENGTILLEGG_KODE */               
                           WHEN('V')                                            
                              SELECT(B02.POENGTILLEGG_KODE(IND));               
                                 WHEN('A') CALL NY_U('U321');                   
                                 WHEN('B') CALL NY_U('U320');                   
                                 WHEN('C') CALL NY_U('U322');                   
                                 OTHER;                                         
                              END; /* SELECT POENGTILLEGG_KODE */               
                           OTHER;                                               
                        END; /* SELECT YPT_KODE */                              
                                                                                
                        SELECT (B02.YRKEHIST.YRKE11(IND_EK,SISTE));             
                           WHEN('A') CALL NY_U('U366');                         
                           WHEN('S') CALL NY_U('U382');                         
                           OTHER;                                               
                        END; /* SELECT YRKE11 */                                
                                                                                
                        SELECT(B02.YRKEPENS.YPT_KODE(IND));                     
                           WHEN('A')                                            
                              IF (B02.YRKEPENS.YUG(IND) < 100) THEN             
                                 SELECT(B02.POENGTILLEGG_KODE(IND));            
                                    WHEN('A') CALL NY_U('U329');                
                                    WHEN('B') CALL NY_U('U328');                
                                    WHEN('C') CALL NY_U('U330');                
                                    OTHER;                                      
                                 END; /* SELECT POENGTILLEGG_KODE */            
                           WHEN('V')                                            
                              IF B02.POENGTILLEGG_KODE(IND) = ' ' THEN          
                                 CALL NY_U('U331');                             
                           OTHER;                                               
                        END; /* SELECT YPT_KODE */                              
                    END; /* DØD AV YRKESSKADE */                                
                END; /* ETTERLATT EKTEFELLE */                                  
             OTHERWISE;                                                         
          END; /*SELECT */                                                      
                                                                                
     SELECT(B02.PENSJONSTYPE1(IND));                                            
        WHEN('A')                                                               
           DO;                                                                  
              IF B02.PRO_RATA_BEREGNING(IND) ^= 'A'  THEN                       
                 IF B02.ALDERSP.OPT(IND) > 0     THEN                           
                   DO;                                                          
                      CALL NY_U('U065');                                        
                      CALL NY_U('U067');                                        
                   END;                                                         
                 ELSE                                                           
                    CALL NY_U('U066');                                          
           END;                                                                 
        WHEN('K')                                                               
           DO;                                                                  
              IF B02.ALDERSP.OPT(IND) > 0     THEN                              
                DO;                                                             
                   CALL NY_U('U065');                                           
                   CALL NY_U('U067');                                           
                END;                                                            
              ELSE                                                              
                CALL NY_U('U066');                                              
           END;                                                                 
        WHEN('U')                                                               
           DO;                                                                  
              IF B02.GUNSTIGSTE_ALTERNATIV(IND) ^= '2' THEN                     
                 DO;                                                            
                    IF B02.UFØRPENS.OPT(IND) > 0     THEN                       
                      DO;                                                       
                         CALL NY_U('U065');                                     
                         CALL NY_U('U067');                                     
                      END;                                                      
                    ELSE                                                        
                      CALL NY_U('U066');                                        
                 END;                                                           
           END;                                                                 
        WHEN('E')                                                               
           DO;                                                                  
              IF B02.GUNSTIGSTE_ALTERNATIV(IND_EK) ^= '2' THEN                  
                 DO;                                                            
                    IF B02.ETTEPENS.OPT_AVD(IND) > 0     THEN                   
                      DO;                                                       
                         CALL NY_U('U065');                                     
                         CALL NY_U('U067');                                     
                      END;                                                      
                    ELSE                                                        
                      CALL NY_U('U066');                                        
                 END;                                                           
           END;                                                                 
        WHEN('Y')                                                               
           DO;                                                                  
              IF B02.GUNSTIGSTE_ALTERNATIV(IND) ^= '2' THEN                     
                 DO;                                                            
                    IF (B02.UFØRPENS.OPT(IND) > 0      !                        
                        B02.ETTEPENS.OPT_AVD(IND) > 0  !                        
                        B02.ALDERSP.OPT(IND) > 0 )        THEN                  
                        CALL NY_U('U067');                                      
                 END;                                                           
           END;                                                                 
        OTHER;                                                                  
     END; /*SELECT PT1 */                                                       
 /*HIT HL 9908 */                                                               
                                                                                
       IF B02.VT_TP(IND) > 0 &                                                  
          B02.ALDERSP.PÅ(IND) ^= B02.VT_PÅ(IND)    THEN                         
          CALL NY_U('U068');                                                    
                                                                                
       IF B02.ALDERSP.ST(IND) > 0 !                                             
          B02.UFØRPENS.ST(IND) > 0 !                                            
          B02.ETTEPENS.ST(IND) > 0 THEN                                         
          CALL NY_U('U070');                                                    
                                                                                
    END;                                                                        
                                                                                
    IF B02.VT_GP(IND) > 0 THEN                                                  
       CALL NY_U('U071');                                                       
                                                                                
   IF (B02.STATUS.GT_LOV92(IND) > B02.STATUS.GARANTI_TP(IND) &                  
       B02.STATUS.GT_TILLEGG_LOV92(IND) > 0                  ) THEN             
      IF (B02.FORSI.GARANTITILLEGG_EK(IND)      > 0 !                           
          B02.FORSI.GARANTITILLEGG_BARN(IND)    > 0 !                           
          B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) > 0 )  THEN                     
         DO;                                                                    
            CALL NY_U('U114');                                                  
            IF B02.PENSJONSTYPE1(IND) = 'Y'    THEN                             
               CALL NY_U('U118');                                               
         END;                                                                   
      ELSE                                                                      
         DO;                                                                    
            CALL NY_U('U119');                                                  
            IF B02.PENSJONSTYPE1(IND) = 'Y'    THEN                             
               CALL NY_U('U118');                                               
         END;                                                                   
                                                                                
    IF B02.FT_SKAL_BEREGNES(IND)   = 'J'       &                                
       B02.BEREGN_FOLKETRYGD(IND) ^= ' '     THEN                               
       CALL EØS_FORSØRG;                                                        
    IF B02.FT_SKAL_BEREGNES(IND) = 'J' &                                        
       B02.BEREGN_FOLKETRYGD(IND) = ' '  THEN                                   
  DO;                                                                           
                                                                                
   IF (B02.FORSI.GARANTITILLEGG_EK(IND) = 0 &                                   
       B02.ALDERSP.ET             (IND) = 0 &                                   
       B02.YRKEPENS.ET            (IND) = 0 &                                   
       B02.UFØRPENS.ET            (IND) = 0 ) &                                 
     (B02.FORSI.ARBEIDSINNTEKT_EK(IND)  > 0 !                                   
      W_HENDELSE.FOLKETRYGD_EK          > 0 !                                   
      B02.FORSI.PENSJONSINNTEKT_EK(IND) > 0) THEN                               
          DO;                                                                   
                IF (B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) > 0 !                 
                    B02.FORSI.BT_SÆRBARN            (IND) > 0 ) &               
                   (B02.UFØRPENS.BT(IND)   > 0 !                                
                    B02.ALDERSP.BT(IND)    > 0 !                                
                    B02.YRKEPENS.BT(IND)   > 0 !                                
                    B02.FORSI.GARANTITILLEGG_BARN(IND) > 0 )  THEN              
                    CALL NY_U('U112');                                          
                ELSE                                                            
                   DO;                                                          
                   IF (B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) +                  
                       B02.FORSI.BT_SÆRBARN            (IND) = 0)  THEN         
                      DO;                                                       
                       IF(B02.UFØRPENS.BT(IND)                  +               
                          B02.ALDERSP.BT(IND)                   +               
                          B02.YRKEPENS.BT(IND)                  +               
                          B02.FORSI.GARANTITILLEGG_BARN(IND) > 0 ) THEN         
                         CALL NY_U('U039');                                     
                      END;                                                      
                   ELSE                                                         
                   IF (B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) +                  
                       B02.FORSI.BT_SÆRBARN            (IND) > 0) THEN          
                      DO;                                                       
                    IF(B02.UFØRPENS.BT(IND)                  +                  
                       B02.ALDERSP.BT(IND)                   +                  
                       B02.YRKEPENS.BT(IND)                  +                  
                       B02.FORSI.GARANTITILLEGG_BARN(IND) = 0 ) THEN            
                         CALL NY_U('U041');                                     
                      END;                                                      
                  END;                                                          
          END;                                                                  
                                                                                
   IF (B02.FORSI.GARANTITILLEGG_EK(IND) > 0 !                                   
       B02.ALDERSP.ET             (IND) > 0 !                                   
       B02.YRKEPENS.ET            (IND) > 0 !                                   
       B02.UFØRPENS.ET            (IND) > 0 ) !                                 
     (B02.FORSI.ARBEIDSINNTEKT_EK(IND)  = 0 &                                   
      W_HENDELSE.FOLKETRYGD_EK          = 0 &                                   
      B02.FORSI.PENSJONSINNTEKT_EK(IND) = 0) THEN                               
       DO;                                                                      
          IF B02.PENSJONSTYPE1(IND) = 'K' THEN                                  
             CALL NY_U('U241');                                                 
          ELSE                                                                  
             DO;                                                                
                DO K = 1 TO 13 WHILE (B02.FNR_TILKN(IND,K) > 0);                
                IF (B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) > 0 !                 
                    B02.TILKNYTNINGSKODE          (IND,K) = 'V' !               
                    B02.FORSI.BT_SÆRBARN            (IND) > 0 ) &               
                   (B02.UFØRPENS.BT(IND)   > 0 !                                
                    B02.ALDERSP.BT(IND)    > 0 !                                
                    B02.YRKEPENS.BT(IND)   > 0 !                                
                    B02.TILKNYTNINGSKODE          (IND,K) = 'W' !               
                    B02.FORSI.GARANTITILLEGG_BARN(IND) > 0 )  THEN              
                    CALL NY_U('U111');                                          
                ELSE                                                            
                   DO;                                                          
                      IF (B02.FORSI.GARANTITILLEGG_EK(IND) +                    
                          B02.ALDERSP.ET             (IND) +                    
                          B02.YRKEPENS.ET            (IND) +                    
                          B02.UFØRPENS.ET            (IND) )  > 0 THEN          
                          CALL NY_U('U041');                                    
                   END;                                                         
                   K = 13;                                                      
                END;                                                            
             END;                                 /* F7 JD 5.91*/               
       END;                                       /* F7 JD 5.91*/               
    /* ***********TESTING           */                                          
   IF B02.FORSI.ARBEIDSINNTEKT_EK(IND)  > 0 !                                   
      W_HENDELSE.FOLKETRYGD_EK          > 0 !                                   
      B02.FORSI.PENSJONSINNTEKT_EK(IND) > 0  THEN                               
      DO;                                                                       
   /*  IF(B02.UFØRPENS.BT(IND)   = 0 &                                          
          B02.ALDERSP.BT(IND)   = 0 &                                           
          B02.YRKEPENS.BT(IND)   = 0 &                                          
          B02.FORSI.BT_SÆRBARN(IND) = 0)  &                                     
        ( B02.FORSI.GARANTITILLEGG_BARN(IND) > 0 &                              
          B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) = 0 ) THEN                      
             DO                                                                 
                TEKSTTYPE_U_KODE(J) = 'U039'                                    
                J                   = J + 1                                     
             END                                                                
                                                                                
       IF(B02.UFØRPENS.BT(IND)   = 0 &                                          
          B02.ALDERSP.BT(IND)   = 0 &                                           
          B02.YRKEPENS.BT(IND)   = 0 &                                          
          B02.FORSI.BT_SÆRBARN(IND) = 0)  &                                     
        ( B02.FORSI.GARANTITILLEGG_BARN(IND) = 0 &                              
          B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) > 0 ) THEN                      
             DO                                                                 
                TEKSTTYPE_U_KODE(J) = 'U039'                                    
                J                   = J + 1                                     
             END  */                                                            
     /* TESTER PAA U039 TATT BORT 18.3 93 JD*/                                  
     /*IF(B02.UFØRPENS.BT(IND)   = 0 &                                          
          B02.ALDERSP.BT(IND)   = 0 &                                           
          B02.YRKEPENS.BT(IND)   = 0 &                                          
          B02.FORSI.BT_SÆRBARN(IND) = 0)  &                                     
        ( B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) > 0   &                         
          B02.FORSI.GARANTITILLEGG_BARN(IND)    > 0 ) THEN                      
             DO                                                                 
                TEKSTTYPE_U_KODE(J) = 'U112'                                    
                J                   = J + 1                                     
             END      */                                                        
     /* TEST   PAA U112 TATT BORT 29.9 93 JD*/                                  
      END;                                                                      
    ELSE                                                                        
      DO;                                                                       
       IF(B02.UFØRPENS.BT(IND)   = 0 &                                          
          B02.ALDERSP.BT(IND)   = 0 &                                           
          B02.YRKEPENS.BT(IND)   = 0 &                                          
          B02.UFØRPENS.ET(IND)   = 0 &                                          
          B02.ALDERSP.ET(IND)   = 0 &                                           
          B02.YRKEPENS.ET(IND)   = 0 &                                          
          B02.FORSI.BT_SÆRBARN(IND) = 0)  &                                     
        ( B02.FORSI.GARANTITILLEGG_BARN(IND) > 0 &                              
          B02.FORSI.GARANTITILLEGG_EK(IND)   = 0 ) &                            
          B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) = 0   THEN                      
          CALL NY_U('U041');                                                    
       /* OVERFLØDIG ?? FJERNET 3.93 JD */                                      
     /*IF(B02.UFØRPENS.BT(IND)   = 0 &                                          
          B02.ALDERSP.BT(IND)   = 0 &                                           
          B02.YRKEPENS.BT(IND)   = 0 &                                          
          B02.UFØRPENS.ET(IND)   = 0 &                                          
          B02.ALDERSP.ET(IND)   = 0 &                                           
          B02.YRKEPENS.ET(IND)   = 0 &                                          
          B02.FORSI.BT_SÆRBARN(IND) = 0)  &                                     
        ( B02.FORSI.GARANTITILLEGG_BARN(IND) = 0 &                              
          B02.FORSI.GARANTITILLEGG_EK(IND)   = 0 &                              
          B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) > 0 ) THEN                      
             DO                                                                 
                TEKSTTYPE_U_KODE(J) = 'U041'                                    
                J                   = J + 1                                     
             END   */                                                           
       /* TRUDE  3.93                  */                                       
       IF(B02.UFØRPENS.BT(IND)   +                                              
          B02.ALDERSP.BT(IND)    +                                              
          B02.YRKEPENS.BT(IND)   +                                              
          B02.UFØRPENS.ET(IND)   +                                              
          B02.ALDERSP.ET(IND)    +                                              
          B02.YRKEPENS.ET(IND)   +                                              
          B02.FORSI.GARANTITILLEGG_BARN(IND) +                                  
          B02.FORSI.GARANTITILLEGG_EK(IND)   = 0) &                             
         (B02.FORSI.BT_SÆRBARN(IND) +                                           
          B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) > 0 ) THEN                      
          CALL NY_U('U041');                                                    
       /* TRUDE ???                    */                                       
       /* TRUDE 12.93                  */                                       
       IF(B02.UFØRPENS.BT(IND)   +                                              
          B02.FORSI.GARANTITILLEGG_BARN(IND) +                                  
          B02.ALDERSP.BT(IND)    +                                              
          B02.YRKEPENS.BT(IND) )  >  0   &                                      
         (B02.UFØRPENS.ET(IND)   +                                              
          B02.ALDERSP.ET(IND)    +                                              
          B02.YRKEPENS.ET(IND)   +                                              
          B02.FORSI.BT_SÆRBARN(IND) +                                           
          B02.FORSI.GARANTITILLEGG_EK(IND)  +                                   
          B02.FORSI.GARANTITILLEGG_SÆRBARN(IND)) =  0   THEN                    
          CALL NY_U('U041');                                                    
       /* TRUDE 12.93 ???              */                                       
       IF(B02.UFØRPENS.BT(IND)   = 0 &                                          
          B02.ALDERSP.BT(IND)   = 0 &                                           
          B02.YRKEPENS.BT(IND)   = 0 &                                          
          B02.UFØRPENS.ET(IND)   = 0 &                                          
          B02.ALDERSP.ET(IND)   = 0 &                                           
          B02.YRKEPENS.ET(IND)   = 0 &                                          
          B02.FORSI.BT_SÆRBARN(IND) = 0)  &                                     
          B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) > 0      &                      
        ( B02.FORSI.GARANTITILLEGG_EK(IND)      > 0      !                      
          B02.FORSI.GARANTITILLEGG_BARN(IND)    > 0 )    THEN                   
             CALL NY_U('U111');                                                 
      END;                                                                      
   /*****  TESTING HIT  TRUDE * ************* */                                
                                                                                
 END; /*IF FT_SKAL_BEREGNES = 'J' */                                            
                                                                                
 /* ***************************************************************** */        
 /* HVIS PTYPE3 = 'A' ENDRES TEKSTKODE TIL Å GJELDE ATTFØRING         */        
 /* ***************************************************************** */        
                                                                                
  IF (B02.STATUS.PENSJONSTYPE3(IND)   = 'A')    &                               
     (B02.STATUS.PENSJONSTYPE1(IND)  ^= 'Y')    THEN                            
     DO;                                                                        
        DO K = 1 TO J - 1;                                                      
           IF (TEKSTTYPE_U_KODE(K) = 'U100' !     /*JD 1.89 */                  
               TEKSTTYPE_U_KODE(K) = 'U101' !                                   
               TEKSTTYPE_U_KODE(K) = 'U102' !                                   
               TEKSTTYPE_U_KODE(K) = 'U112' !                                   
               TEKSTTYPE_U_KODE(K) = 'U120' !                                   
               TEKSTTYPE_U_KODE(K) = 'U121' !                                   
               TEKSTTYPE_U_KODE(K) = 'U132' !                                   
               TEKSTTYPE_U_KODE(K) = 'U134' !                                   
               TEKSTTYPE_U_KODE(K) = 'U135' !                                   
               TEKSTTYPE_U_KODE(K) = 'U138' !                                   
               TEKSTTYPE_U_KODE(K) = 'U199' ) THEN                              
              SUBSTR(TEKSTTYPE_U_KODE(K),2,1) = '7';                            
           ELSE                                                                 
              SUBSTR(TEKSTTYPE_U_KODE(K),2,1) = '6';                            
        END;                                                                    
     END;                                                                       
 /* ----------------------------------------------------------------- */        
 /* ***************************************************************** */        
 EØS_TEKSTER_UP:                                                                
    PROC(IND,IND_EK);                                                           
    /* -------------------------------------------------------------- */        
    /* GJELDER UFØREPENSJONISTER                                      */        
    /* -------------------------------------------------------------- */        
    DCL                                                                         
       IND      FIXED BIN (15),                                                 
       IND_EK   FIXED BIN (15);                                                 
                                                                                
    IF B02.UFØRPENS.UFG(IND) = 100 THEN                                         
       CALL NY_U('U540'); /* STØRELSEN AVHENGIG AV OPPTJENINGSTID */            
    ELSE                                                                        
       CALL NY_U('U543'); /* STØRELSEN OG AVHENGIG AV OPPTJENINGSTID */         
                                                                                
    /* -------------------------------------------------------------- */        
    /* OPPLYSER MEDLEMET OM HVILKE BEREGNINGSALT. SOM ER BENYTTA      */        
    /* -------------------------------------------------------------- */        
    IF B02.NORDISK_KONVENSJON(IND) = 'J' THEN                                   
       CALL NY_U('U551'); /* RETT TIL PENSJON NORDISK / EØS */                  
    ELSE                                                                        
    IF B02.BEREGN_FOLKETRYGD (IND) = 'J' THEN                                   
       CALL NY_U('U511'); /* RETT TIL PENSJON FOLKETYGD / EØS */                
    ELSE                                                                        
       CALL NY_U('U510'); /* RETT TIL PENSJON EØS */                            
                                                                                
    /* -------------------------------------------------------------- */        
    /* DERSOM FLERE "RETTIGHETER" OPPLYS HVILKET SOM VINNER / TAPER   */        
    /* -------------------------------------------------------------- */        
    IF B02.ALTERNATIV_SUM_PENSJON(IND) > 0 THEN                                 
       DO;  /* OPPLYSNINGER OM ALTERNATIV YTELSE */                             
          SELECT (B02.GUNSTIGSTE_ALTERNATIV(IND));                              
             WHEN('1') /* NORSK BEREGNING GUNSTIGST */                          
                DO;                                                             
                   CALL NY_U('U544');  /* ETTER FOLKETRYGDEN */                 
                   CALL NY_U('U513');  /* EØS VILLE GITT */                     
                END;                                                            
             WHEN('2') /* EøS BEREGNING GUNSTIGST */                            
                DO;                                                             
                   CALL NY_U('U541');  /* ETTER EØS */                          
                   IF B02.NORDISK_KONVENSJON(IND) = 'J' THEN                    
                      CALL NY_U('U552'); /* NORDISK VILLE GITT */               
                   ELSE                                                         
                      CALL NY_U('U512'); /* FOLKETRYGDEN VILLE GITT */          
                END;                                                            
             WHEN('4') /* NORDISK KONVENSJON VINNER */                          
                DO;                                                             
                   CALL NY_U('U553');  /* ETTER NORDISK KONVENSJON */           
                   CALL NY_U('U513');  /* EØS VILLE GITT */                     
                END;                                                            
             OTHER;                                                             
          END; /* SELECT GUNSTIGSTE ALTERNATIV */                               
                                                                                
          /* -------------------------------------------------------- */        
          /* DERETTER SKRIVER VI UT TAPENDE ALTERNATIV TIL ORIENERING */        
          /* -------------------------------------------------------- */        
                                                                                
          IF (B02.ALTERNATIV_GP(IND) > 0) THEN CALL NY_U('U514');               
          IF (B02.ALTERNATIV_TP(IND) > 0) THEN CALL NY_U('U515');               
          IF (B02.ALTERNATIV_ET(IND) > 0) THEN CALL NY_U('U516');               
          IF (B02.ALTERNATIV_BT(IND) > 0) THEN CALL NY_U('U517');               
          IF (B02.ALTERNATIV_ST(IND) > 0) THEN CALL NY_U('U518');               
          CALL NY_U('U522'); /* KONTROLLERES AT ER > 0 FØR INNGANG */           
       END; /* OPPLYSNINGER OM ALTERNATIV YTELSE */                             
                                                                                
    /* -------------------------------------------------------------- */        
    /* BEREGNINGEN AV GRUNNPENSJON                                    */        
    /* -------------------------------------------------------------- */        
    IF (B02.UFØRPENS.GP(IND)        > 0 !                                       
        B02.ETTEPENS.GP_BRUTTO(IND) > 0 ) THEN                                  
       DO;  /* TEKSTER VEDRØRENDE GRUNNPENSJONEN */                             
          CALL NY_U('U505');  /* OVERSKRIFT GP */                               
          SELECT (B02.GUNSTIGSTE_ALTERNATIV(IND));                              
             WHEN('1')                                                          
                DO;  /* NASJONAL YTELSE "VINNER" */                             
                    IF (B02.TT_ANV(IND) < 40) THEN                              
                       DO;  /* REDUSERT TT */                                   
                          CALL NY_U('U020');                                    
                          IF (B02.UFØRPENS.ST(IND) > 0 ) THEN                   
                             DO;  /* HAR SÆRTILLEGG */                          
                                IF (B02.UFØRPENS.ET(IND)+                       
                                    B02.UFØRPENS.BT(IND)+                       
                                    B02.BT_SÆRBARN(IND)  > 0 ) THEN             
                                   CALL NY_U('U554');                           
                                ELSE                                            
                                   CALL NY_U('U040');                           
                             END; /* HAR SÆRTILLEGG */                          
                          ELSE                                                  
                             IF (B02.UFØRPENS.ET(IND) > 0 !                     
                                 B02.UFØRPENS.ET(IND) > 0 !                     
                                 B02.BT_SÆRBARN(IND)  > 0 ) THEN                
                                CALL NY_U('U135');                              
                       END; /* REDUSERT TT */                                   
                END; /* NASJONAL YTELSE "VINNER" */                             
             WHEN('2')                                                          
                DO;  /* PRO RATA BEREGNING */                                   
                  if b02.EØS_GARANTI(IND) = 'B' !                               
                     b02.EØS_GARANTI(IND) = 'C'    THEN                         
                   CALL NY_U('U560'); /* VED FASTSETTELSEN AV .. */             
                  ELSE                                                          
                   CALL NY_U('U559'); /* VED FASTSETTELSEN AV .. */             
                END; /* PRO RATA BEREGNING */                                   
             WHEN('4')                                                          
                DO;  /* NORDISK KONVENSJON */                                   
                   IF (B02.TT_NORDISK_FAKT_MND(IND) > 0) THEN                   
                      DO;                                                       
                         /* U555 ------------------------------------ */        
                         /* DE FÅR GRUNNPENSJON FRA NORGE BEREGNET    */        
                         /* ----------------------------------------- */        
                         CALL NY_U('U555');                                     
                      END;                                                      
                   ELSE                                                         
                      DO;  /* GP BEREGNET NASJONALT */                          
                         IF (B02.TT_ANV(IND) < 40) THEN                         
                            DO;  /* REDUSERT TT */                              
                                                                                
                               CALL NY_U('U020');                               
                                                                                
                               IF (B02.UFØRPENS.ST(IND) > 0 ) THEN              
                                  DO;  /* HAR SÆRTILLEGG */                     
                                     IF (B02.UFØRPENS.ET(IND)+                  
                                         B02.UFØRPENS.BT(IND)+                  
                                        B02.BT_SÆRBARN(IND)  > 0 ) THEN         
                                        /* ST MED FT */                         
                                        CALL NY_U('U554');                      
                                     ELSE                                       
                                        /* ST UTEN FT */                        
                                        CALL NY_U('U040');                      
                                  END;                                          
                               ELSE                                             
                                  IF (B02.UFØRPENS.ET(IND) > 0 !                
                                      B02.UFØRPENS.ET(IND) > 0 !                
                                      B02.BT_SÆRBARN(IND)  > 0 ) THEN           
                                     CALL NY_U('U135');                         
                            END; /* REDUSERT TT */                              
                      END; /* GP BEREGNET NASJONALT */                          
                END; /* NORDISK KONVENSJON */                                   
             OTHER;                                                             
          END; /* SELECT GUNSTIGSTE ALTERNATIV */                               
          /* -------------------------------------------------------- */        
                                                                                
          IF (B02.PENSJONSTYPE2(IND)   = 'S' ) THEN                             
        /*    B02.EK_INNT_OVER_2G(IND) = 'J' ) THEN TATT UT 11.99 JD*/          
             DO;                                                                
                /* U029 --------------------------------------------- */        
                /* DERES GRUNNPENSJON ER LAVERE ENN GRUNNBELøPET ...  */        
                /* -------------------------------------------------- */        
                TEKSTTYPE_U_KODE(J) = 'U029';                                   
                J    = J + 1                ;                                   
                                                                                
             END;                                                               
                                                                                
       END; /* TEKSTER VEDRØRENDE GRUNNPENSJONEN */                             
                                                                                
    /* -------------------------------------------------------------- */        
    /* TEKSTER VEDRØRENDE EVENTUELL TILLEGGSPENSJON                   */        
    /* -------------------------------------------------------------- */        
    IF (B02.UFØRPENS.TP(IND) > 0            !                                   
        B02.ETTEPENS.TP_NETTO(IND_EK) > 0   ) THEN                              
    /* (B02.GUNSTIGSTE_ALTERNATIV(IND)= '2' !                                   
        B02.GUNSTIGSTE_ALTERNATIV(IND)= '3' !                                   
        B02.GUNSTIGSTE_ALTERNATIV(IND)= '4' ) */                                
       DO;  /* TEKSTER VEDRØRENDE TILLEGGSPENSJON */                            
          SELECT (B02.GUNSTIGSTE_ALTERNATIV(IND));                              
             WHEN('1')                                                          
                DO;  /* NASJONAL BEREGNING VINNER */                            
                                                                                
                   /* U530 ------------------------------------------ */        
                   /* BEREGNING AV TILLEGGSPENSJON (OVERSKRIFT )      */        
                   /* ----------------------------------------------- */        
                   TEKSTTYPE_U_KODE(J) = 'U530';                                
                   J    = J + 1                ;                                
                                                                                
                END; /* NASJONAL BEREGNING VINNER */                            
             WHEN('2')                                                          
                DO;  /* PRO RATA */                                             
                                                                                
                   /* U530 ------------------------------------------ */        
                   /* BEREGNING AV TILLEGGSPENSJON (OVERSKRIFT )      */        
                   /* ----------------------------------------------- */        
                   TEKSTTYPE_U_KODE(J) = 'U530';                                
                   J    = J + 1                ;                                
                                                                                
                   /* U520 ------------------------------------------ */        
                   /* TILLEGGSPENSJONEN ER BEREGNET PÅ GRUNNLAG ...   */        
                   /* ----------------------------------------------- */        
                   TEKSTTYPE_U_KODE(J) = 'U520';                                
                   J    = J + 1                ;                                
                                                                                
                   /* U561 ------------------------------------------ */        
                   /* VED FASTSETTELSEN AV DERES TILLEGGSPENSJON ...  */        
                   /* ----------------------------------------------- */        
                   TEKSTTYPE_U_KODE(J) = 'U561';                                
                   J    = J + 1                ;                                
                END; /* PRO RATA */                                             
             WHEN('4')                                                          
                DO;  /* NORDISK KONVENSJON */                                   
                                                                                
                   /* U530 ------------------------------------ */              
                   /* BEREGNING AV TP (OVERSKRIFT )             */              
                   /* ----------------------------------------- */              
                   TEKSTTYPE_U_KODE(J) = 'U530';                                
                   J    = J + 1                ;                                
                                                                                
                   IF (B02.PÅ_NORDISK_FAKT(BER_SØ_IND) > 0) THEN                
                      DO;  /* AVKORTET ETTER ARTIKKEL 15 */                     
                         /* U555 ------------------------------ */              
                         /* DE FÅR TP FRA NORGE BEREGNET ...    */              
                         /* ----------------------------------- */              
                         TEKSTTYPE_U_KODE(J) = 'U556';                          
                         J    = J + 1                ;                          
                      END; /* AVKORTET ETTER ARTIKKEL 15 */                     
                                                                                
                END; /* NORDISK KONVENSJON */                                   
             OTHER;                                                             
          END; /* SELECT GUNSTIGSTE ALTERNATIV */                               
       END; /* TEKSTER VEDRØRENDE TILLEGGSPENSJON */                            
 END EØS_TEKSTER_UP;                                                            
 /* ----------------------------------------------------------------- */        
 EØS_FORSØRG: PROC;                                                             
    /* -------------------------------------------------------------- */        
    /* BEREGNINGEN AV FORSøRGINGSTILLEGG                              */        
    /* -------------------------------------------------------------- */        
    IF B02.FT_SKAL_BEREGNES(IND) = 'J'  THEN                                    
      DO;  /* FT_SKAL_BEREGNES */                                               
        IF B02.BEREGN_FOLKETRYGD(IND)= 'N'  THEN                                
          DO;                                                                   
            IF B02.INNT_PRØVET_EØS_PENS  (IND)= 'J'  THEN                       
              DO;                                                               
                         TEKSTTYPE_U_KODE(J) = 'U503';                          
                         J    = J + 1                ;                          
                                                                                
              END;                                                              
            ELSE                                                                
              DO;                                                               
                         TEKSTTYPE_U_KODE(J) = 'U501';                          
                         J    = J + 1                ;                          
              END;                                                              
          END;                                                                  
        ELSE                                                                    
          DO;  /* BEREGN FOLKETRYGD ^= 'N' */                                   
          SELECT (B02.GUNSTIGSTE_ALTERNATIV(IND));                              
             WHEN('2')                                                          
                DO;  /* PRO RATA */                                             
                   IF B02.INNT_PRØVET_EØS_PENS  (IND)= 'J'  THEN                
                      DO;                                                       
                         TEKSTTYPE_U_KODE(J) = 'U503';                          
                         J    = J + 1                ;                          
                      END;                                                      
                   ELSE                                                         
                      DO;                                                       
                         TEKSTTYPE_U_KODE(J) = 'U041';                          
                         J    = J + 1                ;                          
                      END;                                                      
                END; /* PRO RATA */                                             
             WHEN('1','4',' ')   /*BLANK FOR AP*/                               
                   IF B02.INNT_PRØVET_EØS_PENS  (IND)= 'J'  THEN                
                      DO;                                                       
                         TEKSTTYPE_U_KODE(J) = 'U504';                          
                         J    = J + 1                ;                          
                      END;                                                      
                   ELSE                                                         
                      DO;                                                       
        /*               TEKSTTYPE_U_KODE(J) = 'U041';    */                    
                         TEKSTTYPE_U_KODE(J) = 'U039';                          
                         J    = J + 1                ;                          
                      END;                                                      
             OTHER;                                                             
          END; /* SELECT GUNSTIGSTE ALTERNATIV */                               
          END; /* BEREGN FOLKETRYGD ^= 'N' */                                   
      END;     /* FT-SKAL-BEREGNES */                                           
     IF (B02.INNT_PRØVET_EØS_PENS   (IND) = 'J' &                               
         B02.PENSJONSTYPE1          (IND) = 'A' &                               
         B02.FT_SKAL_BEREGNES       (IND) = 'J' &                               
         B02.BEREGN_FOLKETRYGD(IND) = 'J') THEN                                 
         CALL NY_U('U506');                                                     
 END EØS_FORSØRG;                                                               
 /* ***************************************************************** */        
 EØS_TEKSTER_ETTERL:                                                            
    PROC(IND,IND_EK);                                                           
    /* -------------------------------------------------------------- */        
    DCL                                                                         
       IND      FIXED BIN (15),                                                 
       IND_EK   FIXED BIN (15);                                                 
    /* -------------------------------------------------------------- */        
    /* NB! VI HAR HER "SNUDD" INDEKSENE I DENNE SUB HER ER:           */        
    /*          IND        =   AVDØDE                                 */        
    /*          IND_EK     =   SØKEREN (GJENLEVENDE)                  */        
    /* MENS VI I HOVEDPROSEDYREN HAR DESSE INDEKSENE - FORVIRRA ???   */        
    /*          IND_EK     =   AVDØDE                                 */        
    /*          IND        =   SØKEREN (GJENLEVENDE)                  */        
    /* -------------------------------------------------------------- */        
                                                                                
    /* -------------------------------------------------------------- */        
    /* STORLEIKEN PÅ PENSJONEN ER AVHENGIG AV AVDØDES OPPTJENINGSTID  */        
    /* -------------------------------------------------------------- */        
    CALL NY_U('U546'); /* STØRRELSEN AVHENGIG AV AVD. OPPTJENINGSTID */         
                                                                                
    /* -------------------------------------------------------------- */        
    /* OPPLYSER RETTIGHETER GJENLEVENDE (FTL/EØS/NORD - EVT I KOMB.)  */        
    /* -------------------------------------------------------------- */        
    IF (B02.BEREGN_FOLKETRYGD(IND) = 'J') THEN                                  
       IF (B02.PRO_RATA_BEREGNING(IND) = 'J') THEN                              
          IF (B02.NORDISK_KONVENSJON(IND) = 'J') THEN                           
             CALL NY_U('U546'); /* NORDISK & EØS */                             
          ELSE                                                                  
             CALL NY_U('U511'); /* FTL & EØS */                                 
       ELSE                                                                     
          IF (B02.NORDISK_KONVENSJON(IND) = 'J') THEN                           
             DO;  /* BEREGNET KUN ETTER NORDISK KONVENSJON */                   
                                                                                
                /* MANGLER VI TEKSTER PÅ NORDISK KONVENSJON ? */                
                /* VANSKELIG Å SEIE DÅ VI IKKJE HAR FÅTT EKS. HER */            
                                                                                
             END; /* BEREGNET KUN ETTER NORDISK KONVENSJON */                   
          ELSE                                                                  
             DO;  /* BEREGNET KUN ETTER NASJONALE REGLER */                     
                                                                                
                /* EG FORUTSETTER AT DETTE VIL ORDNE SEG ETTER  */              
                /* VANLIGE REGLER HAR IKKJE FÅTT OPPLYSNINGER OM ANNA */        
                                                                                
             END; /* BEREGNET KUN ETTER NASJONALE REGLER */                     
    ELSE                                                                        
       DO;  /* BEREGNET KUN ETTER EØS-REGLER */                                 
                                                                                
          /* DE FYLLER VILKÅRA ETTER EØS-REGLANE */                             
          TEKSTTYPE_U_KODE(J) = 'U510';                                         
          J    = J + 1                ;                                         
                                                                                
       END; /* BEREGNET KUN ETTER EØS-REGLER */                                 
                                                                                
    /* -------------------------------------------------------------- */        
    /* SKRIVER UT OPPLYSNINGER OM EVT. ALTERNATIV YTELSE              */        
    /* -------------------------------------------------------------- */        
  /*IF B02.ALTERNATIV_SUM_PENSJON(IND) > 0 THEN */                              
    IF B02.ALTERNATIV_SUM_PENSJON(IND) > 0 !                                    
       B02.ALTERNATIV_TP_BRUTTO(IND)   > 0 !                                    
       B02.ALTERNATIV_TP_BRUTTO(IND)   > 0 !                                    
       B02.ALTERNATIV_TP_BRUTTO(IND)   > 0 THEN                                 
       DO;  /* HAR ALTERNATIV YTELSE - KAN VÆRE REDUSERT TIL 0! */              
          IF (B02.GUNSTIGSTE_ALTERNATIV(IND) ^= '2') THEN                       
             DO;                                                                
                                                                                
                IF (B02.NORDISK_KONVENSJON(IND) = 'J') THEN                     
                   TEKSTTYPE_U_KODE(J) = 'U553';                                
                ELSE                                                            
                   TEKSTTYPE_U_KODE(J) = 'U544';                                
                J    = J + 1                ;                                   
                                                                                
                /* EØS VILLE GITT LAVERE BELØP */                               
                TEKSTTYPE_U_KODE(J) = 'U513';                                   
                J    = J + 1                ;                                   
                                                                                
             END;                                                               
          ELSE                                                                  
             DO;  /* EØS "VINNER" */                                            
                                                                                
                /* EØS GIR HØGSTE */                                            
                TEKSTTYPE_U_KODE(J) = 'U541';                                   
                J    = J + 1                ;                                   
                                                                                
                IF (B02.NORDISK_KONVENSJON(IND) = 'J') THEN                     
                   TEKSTTYPE_U_KODE(J) = 'U552';                                
                ELSE                                                            
                   TEKSTTYPE_U_KODE(J) = 'U512';                                
                J    = J + 1                ;                                   
                                                                                
             END; /* EØS "VINNER" */                                            
                                                                                
          IF (B02.EØSINFO.ALTERNATIV_GP_BRUTTO(IND) ^=                          
              B02.EØSINFO.ALTERNATIV_GP(IND)         ) !                        
             (B02.EØSINFO.ALTERNATIV_TP_BRUTTO(IND) ^=                          
              B02.EØSINFO.ALTERNATIV_TP(IND)         ) THEN                     
             DO;   /* REDUSERT PGA INNTEKT */                                   
                IF (B02.ALTERNATIV_GP_BRUTTO(IND) > 0) THEN                     
                   DO;  /* SKRIVER UT SUM ALTERNATIV GP OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U547';                             
                      J    = J + 1                ;                             
                   END; /* SKRIVER UT SUM ALTERNATIV GP OM > 0 */               
                                                                                
                IF (B02.ALTERNATIV_TP_BRUTTO(IND) > 0) THEN                     
                   DO;  /* SKRIVER UT SUM ALTERNATIV TP OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U548';                             
                      J    = J + 1                ;                             
                   END; /* SKRIVER UT SUM ALTERNATIV TP OM > 0 */               
                                                                                
                IF (B02.ALTERNATIV_ST_BRUTTO(IND) > 0) THEN                     
                   DO;  /* SKRIVER UT SUM ALTERNATIV ST OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U573';                             
                      J    = J + 1                ;                             
                   END; /* SKRIVER UT SUM ALTERNATIV ST OM > 0 */               
             END;  /* REDUSERT PGA INNTEKT */                                   
          ELSE                                                                  
             DO;   /* IKKE REDUSERT PGA INNTEKT */                              
                IF (B02.ALTERNATIV_GP(IND) > 0) THEN                            
                   DO;  /* SKRIVER UT SUM ALTERNATIV GP OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U584';                             
                      J    = J + 1                ;                             
                   END; /* SKRIVER UT SUM ALTERNATIV GP OM > 0 */               
                                                                                
                IF (B02.ALTERNATIV_TP(IND) > 0) THEN                            
                   DO;  /* SKRIVER UT SUM ALTERNATIV TP OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U585';                             
                      J    = J + 1                ;                             
                   END; /* SKRIVER UT SUM ALTERNATIV TP OM > 0 */               
                                                                                
                IF (B02.ALTERNATIV_BT(IND) > 0) THEN                            
                   DO;  /* SKRIVER UT SUM ALTERNATIV BT OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U587';                             
                      J    = J + 1                ;                             
                   END; /* SKRIVER UT SUM ALTERNATIV BT OM > 0 */               
                                                                                
                IF (B02.ALTERNATIV_ST(IND) > 0) THEN                            
                   DO;  /* SKRIVER UT SUM ALTERNATIV ST OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U588';                             
                      J    = J + 1                ;                             
                   END; /* SKRIVER UT SUM ALTERNATIV ST OM > 0 */               
             END;  /* IKKE REDUSERT PGA INNTEKT */                              
                                                                                
          /* SKRIVER UT SUM ALTERNATIV YTELSE */                                
          TEKSTTYPE_U_KODE(J) = 'U592';                                         
          J    = J + 1                ;                                         
       END; /* HAR ALTERNATIV YTELSE */                                         
                                                                                
    /* -------------------------------------------------------------- */        
    /* SKRIVER EVT. UT OPPLYSNINGER OM GRUNNPENSJON                   */        
    /* -------------------------------------------------------------- */        
    IF (B02.ETTEPENS.GP_BRUTTO(IND_EK) > 0) THEN                                
       DO;  /* HAR GRUNNPENSJON */                                              
                                                                                
          /* OVERSKRIFT GP */                                                   
          TEKSTTYPE_U_KODE(J) = 'U505';                                         
          J    = J + 1                ;                                         
                                                                                
          SELECT(B02.GUNSTIGSTE_ALTERNATIV(IND));                               
             WHEN ('1')                                                         
                DO;  /* SKRIV TEKSTER FOR GRUNNPENSJON NASJONAL */              
                   IF (B02.TT_ANV(IND) < 40) THEN                               
                      /* AVDØDES TT FASTSATT TIL */                             
                      CALL NY_U('U130');                                        
                   ELSE                                                         
                      /* PENSJONENS STØRRELSE ER AVHENGIG... */                 
                      CALL NY_U('U546');                                        
                END; /* SKRIV TEKSTER FOR GRUNNPENSJON NASJONAL */              
             WHEN ('2')                                                         
                DO;  /* SKRIV TEKSTER FOR GRUNNPENSJON EØS */                   
                                                                                
                   /* VED FASTSETTING AV GRUNNPENSJONEN */                      
                   TEKSTTYPE_U_KODE(J) = 'U570';                                
                   J    = J + 1                ;                                
                                                                                
                   IF (B02.INNT_PRØVET_EØS_PENS(IND) = 'J') &                   
                      (B02.FORVENTET(IND_EK) > 0          ) THEN                
                      /* FORHOLDSTALLET OGSÅ BRUKT VED INNTPR... */             
                      CALL NY_U('U542');                                        
                                                                                
                END; /* SKRIV GP TEKSTER FOR GRUNNPENSJON EØS */                
             WHEN ('4')                                                         
                DO;  /* SKRIV TEKSTER FOR GRUNNPENSJON NORDISK */               
                                                                                
                   IF (B02.TT_NORDISK_FAKT_MND(IND) > 0 ) THEN                  
                      /* ARTIKKEL 13 ER ANVENDT */                              
                      /* VED FASTSETTING AV GRUNNPENSJONEN */                   
                      CALL NY_U('U580');                                        
                   ELSE                                                         
                      IF (B02.STATUS.TT_ANV(IND) < 40) THEN                     
                         /* HAR REDUSERT TRYGDETID */                           
                         /* AVDØDES TT ER FASTSATT TIL */                       
                         CALL NY_U('U130');                                     
                      ELSE                                                      
                         /* PENSJONENS STØRRELSE ER AVHENGIG... */              
                         CALL NY_U('U546');                                     
                                                                                
                   /* FJERNA ETTER MØTE 091299 SKAL UTGÅ MARTIN                 
                   IF (B02.INNT_PRØVET_EØS_PENS(IND) = 'J') &                   
                      (B02.FORVENTET(IND_EK) > 0          ) THEN                
                      DO;                                                       
                         TEKSTTYPE_U_KODE(J) = 'U565';                          
                         J    = J + 1                ;                          
                      END;                                                      
                      FJERNA ETTER MØTE 091299 SKAL UTGÅ MARTIN */              
                END; /* SKRIV TEKSTER FOR GRUNNPENSJON NORDISK */               
             OTHER;                                                             
          END; /* SELECT(B02.GUNSTINGSTE ALTERNATIV(IND) */                     
                                                                                
          IF (B02.UFØRPENS.ST(IND) > 0 )      !                                 
             (B02.ETTEPENS.ST_BRUTTO(IND_EK) > 0 )   THEN                       
             DO;                                                                
                                                                                
                /* OVENNEVNTE ER OGSÅ LAGT TIL GRUNN VED         */             
                /* BEREGNING AV SÆRTILLEGGET                     */             
                TEKSTTYPE_U_KODE(J) = 'U040';                                   
                J    = J + 1                ;                                   
             END;                                                               
       END; /* HAR GRUNNPENSJON */                                              
                                                                                
    /* -------------------------------------------------------------- */        
    /* SKRIVER EVT. UT OPPLYSNINGER OM TILLEGGSPENSJON                */        
    /* -------------------------------------------------------------- */        
    IF (B02.ETTEPENS.TP_BRUTTO(IND_EK) > 0 !                                    
        B02.UFØRPENS.TP(IND_EK)        > 0 ) THEN                               
       DO;  /* HAR TILLEGGSPENSJON */                                           
                                                                                
          SELECT(B02.GUNSTIGSTE_ALTERNATIV(IND));                               
             WHEN ('1')                                                         
                DO;  /* SKRIV TEKSTER FOR TILLEGGSPENSJON NASJONAL */           
                                                                                
                   /* OVERSKRIFT TILLEGGSPENSJON - LIGG INNE */                 
                /* TEKSTTYPE_U_KODE(J) = 'U530'                                 
                   J    = J + 1                  */                             
                                                                                
                   /* TILLEGGSPENSJONEN ER BEREGNET P.GR. AV.. */               
                END; /* SKRIV TEKSTER FOR TILLEGGSPENSJON NASJONAL */           
             WHEN ('2')                                                         
                DO;  /* SKRIV TEKSTER FOR TILLEGGSPENSJON EØS */                
                   CALL NY_U('U530');  /* OVERSKRIFT TP */                      
                   CALL NY_U('U571');  /* TP ER BEREGENET PGRL AV */            
                   CALL NY_U('U572');  /* VED FASTSETTELSEN AV */               
                                       /* OPPSTILLINGA NEDENFOR */              
                   IF (DIV_PARAM_OMR.PÅ_NORSK_FAKTISK(IND) > 20) THEN           
                      CALL NY_U('U550'); /* SPT AV 20 BESTE */                  
                   ELSE                                                         
                      /* SPT GRL. ALLE POENGTALLA */                            
                      CALL NY_U('U549'); /* SPT AV ALLE */                      
                                                                                
                END; /* SKRIV TEKSTER FOR TIL1EGGSPENSJON EØS */                
             WHEN ('4')                                                         
                DO;  /* SKRIV TEKSTER FOR TILLEGGSPENSJON NORDISK */            
                   IF (B02.PÅ_NORDISK_FAKT(IND) > 0) THEN                       
                      DO;  /* "REDUSERT" ETTER ART 15 */                        
                         CALL NY_U('U530'); /* OVERSKRIFT TP */                 
                         CALL NY_U('U581'); /* AVKORTING M/POENGBOKS */         
                         CALL NY_U('U047'); /* OPPSTILLINGA NEDANFOR */         
                         CALL NY_U('U048'); /* TP BEREGNET PGRL AV   */         
                      END;  /* "REDUSERT" ETTER ART 15 */                       
                END; /* SKRIV TEKSTER FOR TILLEGGSPENSJON NORDISK */            
             OTHER;                                                             
          END; /* SELECT(B02.GUNSTINGSTE ALTERNATIV(IND) */                     
                                                                                
          /* PENSJONENS STØRRELSE ER AVHENIG AV DERES OPPTJENINGSTID */         
          /* DENNE BRUKES IKKE I EØS TILFELLER MARTIN                           
          TEKSTTYPE_U_KODE(J) = 'U540'                                          
          J    = J + 1                                                          
          */                                                                    
                                                                                
                                                                                
       END; /* HAR TILLEGGSPENSJON - NASJONAL VINNER IKKE */                    
                                                                                
 END EØS_TEKSTER_ETTERL;                                                        
 /* ----------------------------------------------------------------- */        
 EØS_TEKSTER_UP_AP:                                                             
    PROC(IND,IND_EK);                                                           
    /* -------------------------------------------------------------- */        
    /* GJELDER UP-AP                                                  */        
    /* -------------------------------------------------------------- */        
    DCL                                                                         
       IND      FIXED BIN (15),                                                 
       IND_EK   FIXED BIN (15);                                                 
                                                                                
 IF (B02.PENSJONSTYPE2(IND) ^= 'E' &                                            
     B02.KONV_P_KODE  (IND)  = 'U' )  THEN                                      
 DO;                                                                            
 /* IF B02.GUNSTIGSTE_ALTERNATIV(IND) ^= '2' &                                  
       B02.GUNSTIGSTE_ALTERNATIV(IND) ^= '3'  THEN         */                   
    IF B02.GUNSTIGSTE_ALTERNATIV(IND)  = '1' !                                  
       B02.GUNSTIGSTE_ALTERNATIV(IND)  = '4'  THEN                              
       DO; /*NORSK ALTERNATIV VANT I UFØRE-PENSJONEN*/                          
           /* ALTERNATIV 1*/                                                    
          TEKSTTYPE_U_KODE(J) = 'U540';                                         
          J    = J + 1                ;                                         
          TEKSTTYPE_U_KODE(J) = 'U511';                                         
          J    = J + 1                ;                                         
          TEKSTTYPE_U_KODE(J) = 'U544';                                         
          J    = J + 1                ;                                         
          IF B02.TT_ANV(IND) < 40 THEN                                          
             DO;                                                                
                /* OVERSKRIFT GP */                                             
                TEKSTTYPE_U_KODE(J) = 'U505';                                   
                J    = J + 1                ;                                   
                /* REDUSERT UNDER 40 ÅR TT */                                   
                IF B02.PENSJONSTYPE2(IND) ^= 'S'     &                          
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'V' &                   
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'K' THEN                
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U020';                             
                      J    = J + 1                ;                             
                   end;                                                         
                else  /*sammenstØtsberegning*/                                  
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U029';                             
                      J    = J + 1                ;                             
                      TEKSTTYPE_U_KODE(J) = 'U030';                             
                      J    = J + 1                ;                             
                   end;                                                         
                IF B02.ALDERSP.ST(IND) > 0 THEN                                 
                   DO;                                                          
                       /* OVENNEVNTE OGSÅ TIL GRUNN VED B. AV ST */             
                       TEKSTTYPE_U_KODE(J) = 'U040';                            
                       J    = J + 1                ;                            
                   END;                                                         
             END;                                                               
         IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN                             
             DO;                                                                
                /* OVERSKRIFT TP */                                             
                TEKSTTYPE_U_KODE(J) = 'U530';                                   
                J    = J + 1                ;                                   
             END;                                                               
       END;                                                                     
    ELSE                                                                        
    IF TRANS_OPPL_OMR.TRANSTYPE        = 24       THEN                          
           /* OVERGANG FRA UP TIL P67*/                                         
       IF B02.BEREGN_FOLKETRYGD(IND) = 'N' THEN                                 
          DO;   /*IKKE RETT TIL NORSK PENSJON*/                                 
             /* ALTERNATIV 2A  */                                               
             TEKSTTYPE_U_KODE(J) = 'U540';                                      
             J    = J + 1                ;                                      
             TEKSTTYPE_U_KODE(J) = 'U510';                                      
             J    = J + 1                ;                                      
             IF B02.TKNR(IND) = '2101'                  THEN                    
                DO;                                                             
                   IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN                   
                      DO;                                                       
                         TEKSTTYPE_U_KODE(J) = 'U535';                          
                         J    = J + 1                ;                          
                      END;                                                      
                   ELSE                                                         
                      DO;                                                       
                         TEKSTTYPE_U_KODE(J) = 'U537';                          
                         J    = J + 1                ;                          
                      END;                                                      
                END;                                                            
             ELSE                                                               
                DO;                                                             
                   TEKSTTYPE_U_KODE(J) = 'U536';                                
                   J    = J + 1                ;                                
                END;                                                            
             TEKSTTYPE_U_KODE(J) = 'U505';                                      
             J    = J + 1                ;                                      
             if b02.EØS_GARANTI(IND) = 'B' !                                    
                b02.EØS_GARANTI(IND) = 'C'    THEN                              
                  TEKSTTYPE_U_KODE(J) = 'U560';                                 
             ELSE                                                               
                  TEKSTTYPE_U_KODE(J) = 'U559';                                 
             J    = J + 1                ;                                      
             IF B02.ALDERSP.ST(IND) > 0 THEN                                    
                DO;                                                             
                   TEKSTTYPE_U_KODE(J) = 'U040';                                
                   J = J + 1;                                                   
                END;                                                            
             IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN                         
               DO;                                                              
                  TEKSTTYPE_U_KODE(J) = 'U530';                                 
                  J    = J + 1                ;                                 
                  TEKSTTYPE_U_KODE(J) = 'U561';                                 
                  J    = J + 1                ;                                 
                  IF DIV_PARAM_OMR.PÅ_NORSK_FAKTISK(IND) > 20 THEN              
                     TEKSTTYPE_U_KODE(J) = 'U539';                              
                  ELSE                                                          
                     TEKSTTYPE_U_KODE(J) = 'U538';                              
                  J    = J + 1                ;                                 
               END;                                                             
          END;                                                                  
       ELSE  /*BEREGN_FOLKETRYGD ER DA IKKE 'N' */                              
       IF B02.PRO_RATA_BEREGNING(IND) = 'A' THEN                                
          DO;   /*EØS-ALTERNATIVET VINNER */                                    
             /* ALTERNATIV 2B  */                                               
             TEKSTTYPE_U_KODE(J) = 'U540';                                      
             J    = J + 1                ;                                      
             TEKSTTYPE_U_KODE(J) = 'U511';                                      
             J    = J + 1                ;                                      
             TEKSTTYPE_U_KODE(J) = 'U541';                                      
             J    = J + 1                ;                                      
             IF B02.TKNR(IND) = '2101'                  THEN                    
                DO;                                                             
                   IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN                   
                      DO;                                                       
                         TEKSTTYPE_U_KODE(J) = 'U535';                          
                         J    = J + 1                ;                          
                      END;                                                      
                   ELSE                                                         
                      DO;                                                       
                         TEKSTTYPE_U_KODE(J) = 'U537';                          
                         J    = J + 1                ;                          
                      END;                                                      
                END;                                                            
             ELSE                                                               
                DO;                                                             
                   TEKSTTYPE_U_KODE(J) = 'U536';                                
                   J    = J + 1                ;                                
                END;                                                            
             TEKSTTYPE_U_KODE(J) = 'U512';                                      
             J    = J + 1                ;                                      
                                                                                
             IF (B02.EØSINFO.ALTERNATIV_GP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_GP(IND)         ) !                     
                (B02.EØSINFO.ALTERNATIV_TP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_TP(IND)         ) THEN                  
                DO;  /* SKRIVER SUM ALTERNATIV GP OG TP BRUTTO*/                
                    TEKSTTYPE_U_KODE(J) = 'U533';                               
                    J    = J + 1                ;                               
                    TEKSTTYPE_U_KODE(J) = 'U534';                               
                    J    = J + 1                ;                               
                    TEKSTTYPE_U_KODE(J) = 'U527';                               
                    J    = J + 1                ;                               
                END;                                                            
             ELSE /*IKKE INNTEKTSREDUSERT */                                    
             DO;                                                                
                IF B02.ALTERNATIV_GP(IND) > 0 THEN                              
                DO;  /* SKRIVER UT SUM ALTERNATIV GP OM > 0 */                  
                   TEKSTTYPE_U_KODE(J) = 'U514';                                
                   J    = J + 1                ;                                
                END;                                                            
                                                                                
                IF B02.ALTERNATIV_TP(IND) > 0 THEN                              
                DO;  /* SKRIV ALTERNATIV TP  */                                 
                   TEKSTTYPE_U_KODE(J) = 'U515';                                
                   J    = J + 1                ;                                
                END;                                                            
                                                                                
                IF B02.ALTERNATIV_ET(IND) > 0 THEN                              
                DO;  /* SKRIV ALTERNATIV ET */                                  
                   TEKSTTYPE_U_KODE(J) = 'U516';                                
                   J    = J + 1                ;                                
                END;                                                            
                                                                                
                IF B02.ALTERNATIV_BT(IND) > 0 THEN                              
                DO;  /* SKRIV ALTERNATIV BT  */                                 
                   TEKSTTYPE_U_KODE(J) = 'U517';                                
                   J    = J + 1                ;                                
                END;                                                            
                                                                                
                IF B02.ALTERNATIV_ST(IND) > 0 THEN                              
                DO;  /* SKRIVER UT SUM ALTERNATIV ST OM > 0 */                  
                   TEKSTTYPE_U_KODE(J) = 'U518';                                
                   J    = J + 1                ;                                
                END;                                                            
                                                                                
                IF B02.ALTERNATIV_SUM_PENSJON(IND) > 0 THEN                     
                DO;                                                             
                /* U522 --------------------------------------------- */        
                /* SUM               XXXXXXXX                         */        
                /* -------------------------------------------------- */        
                   TEKSTTYPE_U_KODE(J) = 'U522';                                
                   J    = J + 1                ;                                
                END;                                                            
             END;                                                               
                TEKSTTYPE_U_KODE(J) = 'U505';                                   
                J    = J + 1                ;                                   
                if b02.EØS_GARANTI(IND) = 'B' !                                 
                   b02.EØS_GARANTI(IND) = 'C'    THEN                           
                     TEKSTTYPE_U_KODE(J) = 'U560';                              
                ELSE                                                            
                     TEKSTTYPE_U_KODE(J) = 'U559';                              
                J    = J + 1                ;                                   
                IF B02.ALDERSP.ST(IND) > 0 THEN                                 
                   DO;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U040';                             
                      J = J + 1;                                                
                   END;                                                         
             IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN                         
               DO;                                                              
                  TEKSTTYPE_U_KODE(J) = 'U530';                                 
                  J    = J + 1                ;                                 
                  TEKSTTYPE_U_KODE(J) = 'U561';                                 
                  J    = J + 1                ;                                 
                  IF DIV_PARAM_OMR.PÅ_NORSK_FAKTISK(IND) > 20 THEN              
                     TEKSTTYPE_U_KODE(J) = 'U539';                              
                  ELSE                                                          
                     TEKSTTYPE_U_KODE(J) = 'U538';                              
                  J    = J + 1                ;                                 
               END;                                                             
          END;   /*IF B02.PRO_RATA_BEREGNING = 'A' */                           
       ELSE                                                                     
          DO;  /*NORSK ALTERNATIV VINNER*/                                      
             /* ALTERNATIV 2C  */                                               
                TEKSTTYPE_U_KODE(J) = 'U540';                                   
                J    = J + 1                ;                                   
                TEKSTTYPE_U_KODE(J) = 'U511';                                   
                J    = J + 1                ;                                   
                TEKSTTYPE_U_KODE(J) = 'U544';                                   
                J    = J + 1                ;                                   
             IF B02.TKNR(IND) = '2101'                  THEN                    
                DO;                                                             
                   IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN                   
                      DO;                                                       
                         TEKSTTYPE_U_KODE(J) = 'U535';                          
                         J    = J + 1                ;                          
                      END;                                                      
                   ELSE                                                         
                      DO;                                                       
                         TEKSTTYPE_U_KODE(J) = 'U537';                          
                         J    = J + 1                ;                          
                      END;                                                      
                END;                                                            
             IF B02.SUM_YTELSE(IND) = B02.ALTERNATIV_SUM_PENSJON(IND)           
                THEN DO;                                                        
                        TEKSTTYPE_U_KODE(J) = 'U593';                           
                        J    = J + 1                ;                           
                     END;                                                       
             ELSE    DO;                                                        
                        TEKSTTYPE_U_KODE(J) = 'U513';                           
                        J    = J + 1                ;                           
                     END;                                                       
             IF (B02.EØSINFO.ALTERNATIV_GP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_GP(IND)         ) !                     
                (B02.EØSINFO.ALTERNATIV_TP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_TP(IND)         ) THEN                  
                DO;  /* SKRIVER UT SUM ALTERNATIV GP OG TP BRUTTO*/             
                   TEKSTTYPE_U_KODE(J) = 'U533';                                
                   J    = J + 1                ;                                
                   TEKSTTYPE_U_KODE(J) = 'U534';                                
                   J    = J + 1                ;                                
                   TEKSTTYPE_U_KODE(J) = 'U527';                                
                   J    = J + 1                ;                                
                END;                                                            
             ELSE      /*IKKE INNTEKTS-REDUSERT*/                               
                DO;                                                             
                   IF B02.ALTERNATIV_GP(IND) > 0 THEN                           
                   DO;  /* SKRIVER UT SUM ALTERNATIV GP OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U514';                             
                      J    = J + 1                ;                             
                   END;                                                         
                                                                                
                   IF B02.ALTERNATIV_TP(IND) > 0 THEN                           
                   DO;  /* SKRIVER UT SUM ALTERNATIV TP OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U515';                             
                      J    = J + 1                ;                             
                   END;                                                         
                                                                                
                   IF B02.ALTERNATIV_ET(IND) > 0 THEN                           
                   DO;  /* SKRIVER UT SUM ALTERNATIV ET OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U516';                             
                      J    = J + 1                ;                             
                   END;                                                         
                                                                                
                   IF B02.ALTERNATIV_BT(IND) > 0 THEN                           
                   DO;  /* SKRIVER UT SUM ALTERNATIV BT OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U517';                             
                      J    = J + 1                ;                             
                   END;                                                         
                                                                                
                   IF B02.ALTERNATIV_ST(IND) > 0 THEN                           
                   DO;  /* SKRIVER UT SUM ALTERNATIV ST OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U518';                             
                      J    = J + 1                ;                             
                   END;                                                         
                   IF B02.ALTERNATIV_SUM_PENSJON(IND) > 0 THEN                  
                   DO;                                                          
                /* U522 --------------------------------------------- */        
                /* SUM               XXXXXXXX                         */        
                /* -------------------------------------------------- */        
                      TEKSTTYPE_U_KODE(J) = 'U522';                             
                      J    = J + 1                ;                             
                   END;                                                         
                END;                                                            
                       TEKSTTYPE_U_KODE(J) = 'U505';                            
                       J    = J + 1                ;                            
                IF B02.PENSJONSTYPE2(IND) ^= 'S'     &                          
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'V' &                   
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'K' THEN                
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U020';                             
                      J    = J + 1                ;                             
                   end;                                                         
                else  /*sammenstØtsberegning*/                                  
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U029';                             
                      J    = J + 1                ;                             
                      TEKSTTYPE_U_KODE(J) = 'U030';                             
                      J    = J + 1                ;                             
                   end;                                                         
                 IF B02.ALDERSP.ST(IND) > 0 THEN                                
                    DO;                                                         
                       TEKSTTYPE_U_KODE(J) = 'U040';                            
                       J    = J + 1                ;                            
                    END;                                                        
                 IF  B02.ALDERSP.SPT      (IND) ^= 0  THEN                      
                    DO;                                                         
                       TEKSTTYPE_U_KODE(J) = 'U530';                            
                       J    = J + 1                ;                            
                    END;                                                        
             END;                                                               
    ELSE                                                                        
    IF DIV_PERIODE.AP_TRANSTYPE_SPART(IND) = 1 THEN                             
             /*TRANSTYPE = 1 : NY AP-BLANKETT ER REGISTRERT*/                   
            IF ALDER < 7001 THEN                                                
               DO;                                                              
                  IF B01.PRO_RATA_BEREGNING(IND) = 'A' THEN                     
                    DO;                                                         
                       IF B02.PRO_RATA_BEREGNING(IND) = 'C' THEN                
                         DO;/*OVER FRA EØS TIL NORSK BEREGNING*/                
                  /* ALTERNATIV 3A  */                                          
                             TEKSTTYPE_U_KODE(J) = 'U540';                      
                             J    = J + 1                ;                      
                             TEKSTTYPE_U_KODE(J) = 'U511';                      
                             J    = J + 1                ;                      
                             TEKSTTYPE_U_KODE(J) = 'U544';                      
                             J    = J + 1                ;                      
             IF B02.SUM_YTELSE(IND) = B02.ALTERNATIV_SUM_PENSJON(IND)           
                THEN DO;                                                        
                        TEKSTTYPE_U_KODE(J) = 'U593';                           
                        J    = J + 1                ;                           
                     END;                                                       
             ELSE    DO;                                                        
                        TEKSTTYPE_U_KODE(J) = 'U513';                           
                        J    = J + 1                ;                           
                     END;                                                       
             IF (B02.EØSINFO.ALTERNATIV_GP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_GP(IND)         ) !                     
                (B02.EØSINFO.ALTERNATIV_TP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_TP(IND)         ) THEN                  
                              DO;  /*SUM ALTERNATIV GP OG TP BRUTTO*/           
                                TEKSTTYPE_U_KODE(J) = 'U533';                   
                                J    = J + 1                ;                   
                                TEKSTTYPE_U_KODE(J) = 'U534';                   
                                J    = J + 1                ;                   
                                TEKSTTYPE_U_KODE(J) = 'U527';                   
                                J    = J + 1                ;                   
                              END;                                              
                           ELSE                                                 
                              DO;                                               
                                IF B02.ALTERNATIV_GP(IND) > 0 THEN              
                                DO;/*SKRIV ALTERNATIV GP */                     
                                   TEKSTTYPE_U_KODE(J) = 'U514';                
                                   J    = J + 1                ;                
                                END;                                            
                                                                                
                                IF B02.ALTERNATIV_TP(IND) > 0 THEN              
                                DO;  /*SKRIV ALTERNATIV TP */                   
                                   TEKSTTYPE_U_KODE(J) = 'U515';                
                                   J    = J + 1                ;                
                                END;                                            
                                                                                
                                IF B02.ALTERNATIV_ET(IND) > 0 THEN              
                                DO;  /* SKRIV ALTERNATIV ET */                  
                                   TEKSTTYPE_U_KODE(J) = 'U516';                
                                   J    = J + 1                ;                
                                END;                                            
                                                                                
                                IF B02.ALTERNATIV_BT(IND) > 0 THEN              
                                DO;  /* SKRIV ALTERNATIV BT */                  
                                   TEKSTTYPE_U_KODE(J) = 'U517';                
                                   J    = J + 1                ;                
                                END;                                            
                                                                                
                                IF B02.ALTERNATIV_ST(IND) > 0 THEN              
                                DO;  /* SKRIV ALTERNATIV ST */                  
                                   TEKSTTYPE_U_KODE(J) = 'U518';                
                                   J    = J + 1                ;                
                                END;                                            
                                IF B02.ALTERNATIV_SUM_PENSJON(IND) > 0          
                                    THEN                                        
                                DO;                                             
                                   TEKSTTYPE_U_KODE(J) = 'U522';                
                                   J    = J + 1                ;                
                                END;                                            
                              END;                                              
                              TEKSTTYPE_U_KODE(J) = 'U505';                     
                              J    = J + 1                ;                     
                IF B02.PENSJONSTYPE2(IND) ^= 'S'     &                          
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'V' &                   
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'K' THEN                
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U020';                             
                      J    = J + 1                ;                             
                   end;                                                         
                else  /*sammenstØtsberegning*/                                  
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U029';                             
                      J    = J + 1                ;                             
                      TEKSTTYPE_U_KODE(J) = 'U030';                             
                      J    = J + 1                ;                             
                   end;                                                         
                           IF B02.ALDERSP.ST(IND) > 0 THEN                      
                              DO;                                               
                                 TEKSTTYPE_U_KODE(J) = 'U040';                  
                                 J    = J + 1                ;                  
                              END;                                              
                           IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN           
                               DO;                                              
                                  TEKSTTYPE_U_KODE(J) = 'U530';                 
                                  J    = J + 1                ;                 
                               END;                                             
                           END;  /*END 3A*/                                     
                        ELSE                                                    
                        DO;  /*EØS VINNER FORTSATT*/                            
                  /* ALTERNATIV 3C  */                                          
                           TEKSTTYPE_U_KODE(J) = 'U540';                        
                           J    = J + 1                ;                        
                           TEKSTTYPE_U_KODE(J) = 'U511';                        
                           J    = J + 1                ;                        
                           TEKSTTYPE_U_KODE(J) = 'U541';                        
                           J    = J + 1                ;                        
                           TEKSTTYPE_U_KODE(J) = 'U512';                        
                           J    = J + 1                ;                        
             IF (B02.EØSINFO.ALTERNATIV_GP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_GP(IND)         ) !                     
                (B02.EØSINFO.ALTERNATIV_TP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_TP(IND)         ) THEN                  
                              DO;  /* SKRIV ALTERNATIV GP OG TP BRUTTO*/        
                                 TEKSTTYPE_U_KODE(J) = 'U533';                  
                                 J    = J + 1                ;                  
                                 TEKSTTYPE_U_KODE(J) = 'U534';                  
                                 J    = J + 1                ;                  
                                 TEKSTTYPE_U_KODE(J) = 'U527';                  
                                 J    = J + 1                ;                  
                              END;                                              
                           ELSE                                                 
                           DO;                                                  
                              IF B02.ALTERNATIV_GP(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV GP */                    
                                 TEKSTTYPE_U_KODE(J) = 'U514';                  
                                 J    = J + 1                ;                  
                              END;                                              
                                                                                
                              IF B02.ALTERNATIV_TP(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV TP */                    
                                 TEKSTTYPE_U_KODE(J) = 'U515';                  
                                 J    = J + 1                ;                  
                              END;                                              
                                                                                
                              IF B02.ALTERNATIV_ET(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV ET */                    
                                 TEKSTTYPE_U_KODE(J) = 'U516';                  
                                 J    = J + 1                ;                  
                              END;                                              
                                                                                
                              IF B02.ALTERNATIV_BT(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV BT  */                   
                                 TEKSTTYPE_U_KODE(J) = 'U517';                  
                                 J    = J + 1                ;                  
                              END;                                              
                                                                                
                              IF B02.ALTERNATIV_ST(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV ST  */                   
                                 TEKSTTYPE_U_KODE(J) = 'U518';                  
                                 J    = J + 1                ;                  
                              END;                                              
                             IF B02.ALTERNATIV_SUM_PENSJON(IND) >0 THEN         
                              DO;                                               
                                 TEKSTTYPE_U_KODE(J) = 'U522';                  
                                 J    = J + 1                ;                  
                              END;                                              
                           END;                                                 
                           TEKSTTYPE_U_KODE(J) = 'U505';                        
                           J    = J + 1                ;                        
                           if b02.EØS_GARANTI(IND) = 'B' !                      
                              b02.EØS_GARANTI(IND) = 'C'    THEN                
                               TEKSTTYPE_U_KODE(J) = 'U560';                    
                           ELSE                                                 
                               TEKSTTYPE_U_KODE(J) = 'U559';                    
                           J    = J + 1                ;                        
                           IF B02.ALDERSP.ST(IND) > 0 THEN                      
                              DO;                                               
                                 TEKSTTYPE_U_KODE(J) = 'U040';                  
                                 J = J + 1;                                     
                              END;                                              
             IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN                         
               DO;                                                              
                  TEKSTTYPE_U_KODE(J) = 'U530';                                 
                  J    = J + 1                ;                                 
                  TEKSTTYPE_U_KODE(J) = 'U561';                                 
                  J    = J + 1                ;                                 
                  IF DIV_PARAM_OMR.PÅ_NORSK_FAKTISK(IND) > 20 THEN              
                     TEKSTTYPE_U_KODE(J) = 'U539';                              
                  ELSE                                                          
                     TEKSTTYPE_U_KODE(J) = 'U538';                              
                  J    = J + 1                ;                                 
               END;                                                             
                        END;                                                    
                     END; /*END 3C*/                                            
                  ELSE  /*B01.PRO_RATA_BEREGNING ER DA IKKE 'A'*/               
                    DO;                                                         
                       IF B02.PRO_RATA_BEREGNING(IND) = 'D' THEN                
                          DO;/*NORSK ER FORTSATT BEST*/                         
                  /* ALTERNATIV 3B  */                                          
                             TEKSTTYPE_U_KODE(J) = 'U540';                      
                             J    = J + 1                ;                      
                             TEKSTTYPE_U_KODE(J) = 'U511';                      
                             J    = J + 1                ;                      
                             TEKSTTYPE_U_KODE(J) = 'U544';                      
                             J    = J + 1                ;                      
                              TEKSTTYPE_U_KODE(J) = 'U505';                     
                              J    = J + 1                ;                     
                IF B02.PENSJONSTYPE2(IND) ^= 'S'     &                          
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'V' &                   
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'K' THEN                
                   CALL NY_U('U020');                                           
                ELSE  /*SAMMENSTØTSBEREGNING*/                                  
                   DO;                                                          
                      CALL NY_U('U029');                                        
                      CALL NY_U('U030');                                        
                   END;                                                         
                           IF B02.ALDERSP.ST(IND) > 0 THEN                      
                              CALL NY_U('U040');                                
                           IF B02.ALDERSP.SPT      (IND) ^= 0   THEN            
                              CALL NY_U('U530');                                
                          END;                                                  
                       ELSE                                                     
                          DO;                                                   
                          /*HVILKE TEKSTER FÅR VI NÅR VI REGISTRERER            
                            AP-BLANKETT PÅ EN PERSON SOM FRA FØR HAR            
                            NORSK BEREGNING SOM BESTE ALTERNATIV, OG            
                            EØS-ALTERNATIVET NÅ BLIR BEST ?       */            
                          END;                                                  
                    END;                                                        
               END;                                                             
            ELSE  /*ALDER ER OVER 70*/                                          
               DO;                                                              
                  IF B01.PRO_RATA_BEREGNING(IND) = 'A' THEN                     
                    DO;                                                         
                       IF B02.PRO_RATA_BEREGNING(IND) = 'A' THEN                
                         DO;                                                    
                  /* ALTERNATIV 6B  */                                          
                             TEKSTTYPE_U_KODE(J) = 'U540';                      
                             J    = J + 1                ;                      
                             TEKSTTYPE_U_KODE(J) = 'U511';                      
                             J    = J + 1                ;                      
                             TEKSTTYPE_U_KODE(J) = 'U541';                      
                             J    = J + 1                ;                      
                             TEKSTTYPE_U_KODE(J) = 'U512';                      
                             J    = J + 1                ;                      
             IF (B02.EØSINFO.ALTERNATIV_GP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_GP(IND)         ) !                     
                (B02.EØSINFO.ALTERNATIV_TP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_TP(IND)         ) THEN                  
                                DO;/*SKRIV ALTERNATIV GP OG TP BRUTTO*/         
                                   TEKSTTYPE_U_KODE(J) = 'U533';                
                                   J    = J + 1                ;                
                                   TEKSTTYPE_U_KODE(J) = 'U534';                
                                   J    = J + 1                ;                
                                   TEKSTTYPE_U_KODE(J) = 'U527';                
                                   J    = J + 1                ;                
                                END;                                            
                             ELSE                                               
                                DO;                                             
                                   IF B02.ALTERNATIV_GP(IND) > 0 THEN           
                                   DO;  /* SKRIV ALTERNATIV GP */               
                                      TEKSTTYPE_U_KODE(J) = 'U514';             
                                      J    = J + 1                ;             
                                   END;                                         
                                                                                
                                   IF B02.ALTERNATIV_TP(IND) > 0 THEN           
                                   DO;  /* SKRIV ALTERNATIV TP */               
                                      TEKSTTYPE_U_KODE(J) = 'U515';             
                                      J    = J + 1                ;             
                                   END;                                         
                                                                                
                                   IF B02.ALTERNATIV_ET(IND) > 0 THEN           
                                   DO;  /* SKRIV ALTERNATIV ET */               
                                      TEKSTTYPE_U_KODE(J) = 'U516';             
                                      J    = J + 1                ;             
                                   END;                                         
                                                                                
                                   IF B02.ALTERNATIV_BT(IND) > 0 THEN           
                                   DO;  /* SKRIV ALTERNATIV BT  */              
                                      TEKSTTYPE_U_KODE(J) = 'U517';             
                                      J    = J + 1                ;             
                                   END;                                         
                                                                                
                                   IF B02.ALTERNATIV_ST(IND) > 0 THEN           
                                   DO;  /* SKRIV ALTERNATIV ST  */              
                                      TEKSTTYPE_U_KODE(J) = 'U518';             
                                      J    = J + 1                ;             
                                   END;                                         
                                  IF B02.ALTERNATIV_SUM_PENSJON(IND) >0         
                                                       THEN                     
                                   DO;                                          
                                      TEKSTTYPE_U_KODE(J) = 'U522';             
                                      J    = J + 1                ;             
                                   END;                                         
                                END;                                            
                                TEKSTTYPE_U_KODE(J) = 'U505';                   
                                J    = J + 1                ;                   
                                if b02.EØS_GARANTI(IND) = 'B' !                 
                                   b02.EØS_GARANTI(IND) = 'C'    THEN           
                                    TEKSTTYPE_U_KODE(J) = 'U560';               
                                ELSE                                            
                                    TEKSTTYPE_U_KODE(J) = 'U559';               
                                J    = J + 1                ;                   
                                IF B02.ALDERSP.ST(IND) > 0 THEN                 
                                   DO;                                          
                                     TEKSTTYPE_U_KODE(J) = 'U040';              
                                     J = J + 1;                                 
                                   END;                                         
             IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN                         
               DO;                                                              
                  TEKSTTYPE_U_KODE(J) = 'U530';                                 
                  J    = J + 1                ;                                 
                  TEKSTTYPE_U_KODE(J) = 'U561';                                 
                  J    = J + 1                ;                                 
                  IF DIV_PARAM_OMR.PÅ_NORSK_FAKTISK(IND) > 20 THEN              
                     TEKSTTYPE_U_KODE(J) = 'U539';                              
                  ELSE                                                          
                     TEKSTTYPE_U_KODE(J) = 'U538';                              
                  J    = J + 1                ;                                 
               END;                                                             
                         END;                                                   
                       ELSE                                                     
                         DO;                                                    
                  /* ALTERNATIV 6A  */                                          
                              TEKSTTYPE_U_KODE(J) = 'U540';                     
                              J    = J + 1                ;                     
                              TEKSTTYPE_U_KODE(J) = 'U511';                     
                              J    = J + 1                ;                     
                              TEKSTTYPE_U_KODE(J) = 'U544';                     
                              J    = J + 1                ;                     
             IF B02.SUM_YTELSE(IND) = B02.ALTERNATIV_SUM_PENSJON(IND)           
                THEN DO;                                                        
                        TEKSTTYPE_U_KODE(J) = 'U593';                           
                        J    = J + 1                ;                           
                     END;                                                       
             ELSE    DO;                                                        
                        TEKSTTYPE_U_KODE(J) = 'U513';                           
                        J    = J + 1                ;                           
                     END;                                                       
                              IF B02.ALTERNATIV_GP(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV GP */                    
                                 TEKSTTYPE_U_KODE(J) = 'U514';                  
                                 J    = J + 1                ;                  
                              END;                                              
                                                                                
                              IF B02.ALTERNATIV_TP(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV TP */                    
                                 TEKSTTYPE_U_KODE(J) = 'U515';                  
                                 J    = J + 1                ;                  
                              END;                                              
                                                                                
                              IF B02.ALTERNATIV_ET(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV ET */                    
                                 TEKSTTYPE_U_KODE(J) = 'U516';                  
                                 J    = J + 1                ;                  
                              END;                                              
                                                                                
                              IF B02.ALTERNATIV_BT(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV BT  */                   
                                 TEKSTTYPE_U_KODE(J) = 'U517';                  
                                 J    = J + 1                ;                  
                              END;                                              
                                                                                
                              IF B02.ALTERNATIV_ST(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV ST  */                   
                                 TEKSTTYPE_U_KODE(J) = 'U518';                  
                                 J    = J + 1                ;                  
                              END;                                              
                             IF B02.ALTERNATIV_SUM_PENSJON(IND) >0 THEN         
                              DO;                                               
                                 TEKSTTYPE_U_KODE(J) = 'U522';                  
                                 J    = J + 1                ;                  
                              END;                                              
                              TEKSTTYPE_U_KODE(J) = 'U505';                     
                              J    = J + 1                ;                     
                IF B02.PENSJONSTYPE2(IND) ^= 'S'     &                          
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'V' &                   
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'K' THEN                
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U020';                             
                      J    = J + 1                ;                             
                   end;                                                         
                else  /*sammenstØtsberegning*/                                  
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U029';                             
                      J    = J + 1                ;                             
                      TEKSTTYPE_U_KODE(J) = 'U030';                             
                      J    = J + 1                ;                             
                   end;                                                         
                           IF B02.ALDERSP.ST(IND) > 0 THEN                      
                              DO;                                               
                                 TEKSTTYPE_U_KODE(J) = 'U040';                  
                                 J    = J + 1                ;                  
                              END;                                              
                           IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN           
                               DO;                                              
                                  TEKSTTYPE_U_KODE(J) = 'U530';                 
                                  J    = J + 1                ;                 
                               END;                                             
                         END;                                                   
                    END;                                                        
                  ELSE      /*IKKE EØS-BEREGNING*/                              
                    DO;                                                         
                       IF B02.PRO_RATA_BEREGNING(IND) = 'D' THEN                
                         DO; /*NORSK BEREGNING VINNER FORTSATT*/                
                             /* ALTERNATIV 6C  */                               
                             CALL NY_U('U540');                                 
                             CALL NY_U('U511');                                 
                             CALL NY_U('U544');                                 
                             CALL NY_U('U505');                                 
                IF B02.PENSJONSTYPE2(IND) ^= 'S'     &                          
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'V' &                   
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'K' THEN                
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U020';                             
                      J    = J + 1                ;                             
                   end;                                                         
                else  /*sammenstØtsberegning*/                                  
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U029';                             
                      J    = J + 1                ;                             
                      TEKSTTYPE_U_KODE(J) = 'U030';                             
                      J    = J + 1                ;                             
                   end;                                                         
                           IF B02.ALDERSP.ST(IND) > 0 THEN                      
                              DO;                                               
                                 TEKSTTYPE_U_KODE(J) = 'U040';                  
                                 J    = J + 1                ;                  
                              END;                                              
                           IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN           
                               DO;                                              
                                  TEKSTTYPE_U_KODE(J) = 'U530';                 
                                  J    = J + 1                ;                 
                               END;                                             
                         END;                                                   
                       ELSE                                                     
                         DO;                                                    
                          /*HVILKE TEKSTER FÅR VI NÅR VI REGISTRERER            
                            AP-BLANKETT PÅ EN PERSON SOM FRA FØR HAR            
                            NORSK BEREGNING SOM BESTE ALTERNATIV, OG            
                            EØS-ALTERNATIVET NÅ BLIR BEST ?       */            
                         END;                                                   
                    END;                                                        
               END;                                                             
     ELSE                                                                       
     IF TRANS_OPPL_OMR.TRANSTYPE        = 26       THEN                         
           /*TRANSTYPE 26 : KONVERTERT FRA P67 TIL P70*/                        
           IF B01.PRO_RATA_BEREGNING(IND) ^= 'A' THEN                           
              DO; /*NORSK BEREGNING VAR BEST (OG BLIR DERMED BEST)*/            
                    /*ALTERNATIV 4 */                                           
                    TEKSTTYPE_U_KODE(J) = 'U540';                               
                    J    = J + 1                ;                               
                    TEKSTTYPE_U_KODE(J) = 'U511';                               
                    J    = J + 1                ;                               
                    TEKSTTYPE_U_KODE(J) = 'U544';                               
                    J    = J + 1                ;                               
                              TEKSTTYPE_U_KODE(J) = 'U505';                     
                              J    = J + 1                ;                     
                IF B02.PENSJONSTYPE2(IND) ^= 'S'     &                          
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'V' &                   
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'K' THEN                
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U020';                             
                      J    = J + 1                ;                             
                   end;                                                         
                else  /*sammenstØtsberegning*/                                  
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U029';                             
                      J    = J + 1                ;                             
                      TEKSTTYPE_U_KODE(J) = 'U030';                             
                      J    = J + 1                ;                             
                   end;                                                         
                           IF B02.ALDERSP.ST(IND) > 0 THEN                      
                              DO;                                               
                                 TEKSTTYPE_U_KODE(J) = 'U040';                  
                                 J    = J + 1                ;                  
                              END;                                              
                           IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN           
                               DO;                                              
                                  TEKSTTYPE_U_KODE(J) = 'U530';                 
                                  J    = J + 1                ;                 
                               END;                                             
              END;                                                              
           ELSE  /*DET VAR EØS-BEREGNING I B01*/                                
           IF B02.BEREGN_FOLKETRYGD (IND)  = 'N' THEN                           
              DO; /*IKKE RETT TIL NORSK BEREGNING*/                             
                    /*ALTERNATIV 5A*/                                           
                    TEKSTTYPE_U_KODE(J) = 'U540';                               
                    J    = J + 1                ;                               
                    TEKSTTYPE_U_KODE(J) = 'U510';                               
                    J    = J + 1                ;                               
                    TEKSTTYPE_U_KODE(J) = 'U505';                               
                    J    = J + 1                ;                               
                    if b02.EØS_GARANTI(IND) = 'B' !                             
                       b02.EØS_GARANTI(IND) = 'C'    THEN                       
                          TEKSTTYPE_U_KODE(J) = 'U560';                         
                    ELSE                                                        
                          TEKSTTYPE_U_KODE(J) = 'U559';                         
                    J    = J + 1                ;                               
                    IF B02.ALDERSP.ST(IND) > 0 THEN                             
                       DO;                                                      
                          TEKSTTYPE_U_KODE(J) = 'U040';                         
                          J = J + 1;                                            
                       END;                                                     
                 IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN                     
                  DO;                                                           
                    TEKSTTYPE_U_KODE(J) = 'U530';                               
                    J    = J + 1                ;                               
                    TEKSTTYPE_U_KODE(J) = 'U561';                               
                    J    = J + 1                ;                               
                    IF DIV_PARAM_OMR.PÅ_NORSK_FAKTISK(IND) > 20 THEN            
                       TEKSTTYPE_U_KODE(J) = 'U539';                            
                    ELSE                                                        
                       TEKSTTYPE_U_KODE(J) = 'U538';                            
                    J    = J + 1                ;                               
                  END;                                                          
              END;                                                              
           ELSE  /*HAR RETT TIL ET VALG*/                                       
           IF B02.PRO_RATA_BEREGNING(IND)  = 'A' THEN                           
                   /*EØS-ALTERNATIVET VINNER FORTSATT*/                         
              DO;                                                               
                    /*ALTERNATIV 5B*/                                           
                             TEKSTTYPE_U_KODE(J) = 'U540';                      
                             J    = J + 1                ;                      
                             TEKSTTYPE_U_KODE(J) = 'U511';                      
                             J    = J + 1                ;                      
                             TEKSTTYPE_U_KODE(J) = 'U541';                      
                             J    = J + 1                ;                      
                             TEKSTTYPE_U_KODE(J) = 'U512';                      
                             J    = J + 1                ;                      
                              IF B02.ALTERNATIV_GP(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV GP */                    
                                 TEKSTTYPE_U_KODE(J) = 'U514';                  
                                 J    = J + 1                ;                  
                              END;                                              
                                                                                
                              IF B02.ALTERNATIV_TP(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV TP */                    
                                 TEKSTTYPE_U_KODE(J) = 'U515';                  
                                 J    = J + 1                ;                  
                              END;                                              
                                                                                
                              IF B02.ALTERNATIV_ET(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV ET */                    
                                 TEKSTTYPE_U_KODE(J) = 'U516';                  
                                 J    = J + 1                ;                  
                              END;                                              
                                                                                
                              IF B02.ALTERNATIV_BT(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV BT  */                   
                                 TEKSTTYPE_U_KODE(J) = 'U517';                  
                                 J    = J + 1                ;                  
                              END;                                              
                                                                                
                              IF B02.ALTERNATIV_ST(IND) > 0 THEN                
                              DO;  /* SKRIV ALTERNATIV ST  */                   
                                 TEKSTTYPE_U_KODE(J) = 'U518';                  
                                 J    = J + 1                ;                  
                              END;                                              
                             IF B02.ALTERNATIV_SUM_PENSJON(IND) >0 THEN         
                              DO;                                               
                                 TEKSTTYPE_U_KODE(J) = 'U522';                  
                                 J    = J + 1                ;                  
                              END;                                              
                              TEKSTTYPE_U_KODE(J) = 'U505';                     
                              J    = J + 1                ;                     
                              if b02.EØS_GARANTI(IND) = 'B' !                   
                                 b02.EØS_GARANTI(IND) = 'C'    THEN             
                                   TEKSTTYPE_U_KODE(J) = 'U560';                
                              ELSE                                              
                                   TEKSTTYPE_U_KODE(J) = 'U559';                
                              J    = J + 1                ;                     
                              IF B02.ALDERSP.ST(IND) > 0 THEN                   
                                 DO;                                            
                                    TEKSTTYPE_U_KODE(J) = 'U040';               
                                    J = J + 1;                                  
                                 END;                                           
                        IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN              
                           DO;                                                  
                              TEKSTTYPE_U_KODE(J) = 'U530';                     
                              J    = J + 1                ;                     
                              TEKSTTYPE_U_KODE(J) = 'U561';                     
                              J    = J + 1                ;                     
                              IF DIV_PARAM_OMR.PÅ_NORSK_FAKTISK(IND)            
                                          > 20 THEN                             
                                 TEKSTTYPE_U_KODE(J) = 'U539';                  
                              ELSE                                              
                                 TEKSTTYPE_U_KODE(J) = 'U538';                  
                              J    = J + 1                ;                     
                           END;                                                 
              END;                                                              
           ELSE   /*OVERGANG FRA EØS- TIL NORSK BEREGNING*/                     
              DO;                                                               
                    /*ALTERNATIV 5C*/                                           
                 TEKSTTYPE_U_KODE(J) = 'U540';                                  
                 J    = J + 1                ;                                  
                 TEKSTTYPE_U_KODE(J) = 'U511';                                  
                 J    = J + 1                ;                                  
                 TEKSTTYPE_U_KODE(J) = 'U544';                                  
                 J    = J + 1                ;                                  
             IF B02.SUM_YTELSE(IND) = B02.ALTERNATIV_SUM_PENSJON(IND)           
                THEN DO;                                                        
                        CALL NY_U('U593');                                      
                     END;                                                       
             ELSE                                                               
                 CALL NY_U('U513');                                             
                                                                                
                 IF B02.ALTERNATIV_GP(IND) > 0 THEN                             
                    /* SKRIVER UT SUM ALTERNATIV GP OM > 0 */                   
                    CALL NY_U('U514');                                          
                                                                                
                 IF B02.ALTERNATIV_TP(IND) > 0 THEN                             
                    /* SKRIVER UT SUM ALTERNATIV TP OM > 0 */                   
                    CALL NY_U('U515');                                          
                                                                                
                 IF B02.ALTERNATIV_ET(IND) > 0 THEN                             
                    /* SKRIVER UT SUM ALTERNATIV ET OM > 0 */                   
                    CALL NY_U('U516');                                          
                                                                                
                 IF B02.ALTERNATIV_BT(IND) > 0 THEN                             
                    /* SKRIVER UT SUM ALTERNATIV BT OM > 0 */                   
                    CALL NY_U('U517');                                          
                                                                                
                 IF B02.ALTERNATIV_ST(IND) > 0 THEN                             
                    /* SKRIVER UT SUM ALTERNATIV ST OM > 0 */                   
                    CALL NY_U('U518');                                          
                                                                                
                 IF B02.ALTERNATIV_SUM_PENSJON(IND) > 0 THEN                    
                 DO;                                                            
                /* U522 --------------------------------------------- */        
                /* SUM               XXXXXXXX                         */        
                /* -------------------------------------------------- */        
                    TEKSTTYPE_U_KODE(J) = 'U522';                               
                    J    = J + 1                ;                               
                 END;                                                           
                                                                                
                              TEKSTTYPE_U_KODE(J) = 'U505';                     
                              J    = J + 1                ;                     
                                                                                
                IF B02.PENSJONSTYPE2(IND) ^= 'S'     &                          
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'V' &                   
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'K' THEN                
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U020';                             
                      J    = J + 1                ;                             
                   end;                                                         
                else  /*sammenstØtsberegning*/                                  
                   do;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U029';                             
                      J    = J + 1                ;                             
                      TEKSTTYPE_U_KODE(J) = 'U030';                             
                      J    = J + 1                ;                             
                   end;                                                         
                           IF B02.ALDERSP.ST(IND) > 0 THEN                      
                              DO;                                               
                                 TEKSTTYPE_U_KODE(J) = 'U040';                  
                                 J    = J + 1                ;                  
                              END;                                              
                           IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN           
                               DO;                                              
                                  TEKSTTYPE_U_KODE(J) = 'U530';                 
                                  J    = J + 1                ;                 
                               END;                                             
              END;                                                              
     ELSE /* TRANSTYPE VAR IKKE 1, 24 ELLER 26*/                                
        DO;                                                                     
             TEKSTTYPE_U_KODE(J) = 'U540';                                      
             J    = J + 1                ;                                      
             TEKSTTYPE_U_KODE(J) = 'U511';                                      
             J    = J + 1                ;                                      
       IF B02.PRO_RATA_BEREGNING(IND) = 'A' THEN                                
          DO;   /*EØS-ALTERNATIVET VINNER */                                    
             TEKSTTYPE_U_KODE(J) = 'U541';                                      
             J    = J + 1                ;                                      
             TEKSTTYPE_U_KODE(J) = 'U512';                                      
             J    = J + 1                ;                                      
                                                                                
             IF (B02.EØSINFO.ALTERNATIV_GP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_GP(IND)         ) !                     
                (B02.EØSINFO.ALTERNATIV_TP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_TP(IND)         ) THEN                  
                DO;  /* SKRIVER SUM ALTERNATIV GP OG TP BRUTTO*/                
                    TEKSTTYPE_U_KODE(J) = 'U533';                               
                    J    = J + 1                ;                               
                    TEKSTTYPE_U_KODE(J) = 'U534';                               
                    J    = J + 1                ;                               
                    TEKSTTYPE_U_KODE(J) = 'U527';                               
                    J    = J + 1                ;                               
                END;                                                            
             ELSE /*IKKE INNTEKTSREDUSERT */                                    
             DO;                                                                
                IF B02.ALTERNATIV_GP(IND) > 0 THEN                              
                DO;  /* SKRIVER UT SUM ALTERNATIV GP OM > 0 */                  
                   TEKSTTYPE_U_KODE(J) = 'U514';                                
                   J    = J + 1                ;                                
                END;                                                            
                                                                                
                IF B02.ALTERNATIV_TP(IND) > 0 THEN                              
                DO;  /* SKRIV ALTERNATIV TP  */                                 
                   TEKSTTYPE_U_KODE(J) = 'U515';                                
                   J    = J + 1                ;                                
                END;                                                            
                                                                                
                IF B02.ALTERNATIV_ET(IND) > 0 THEN                              
                DO;  /* SKRIV ALTERNATIV ET */                                  
                   TEKSTTYPE_U_KODE(J) = 'U516';                                
                   J    = J + 1                ;                                
                END;                                                            
                                                                                
                IF B02.ALTERNATIV_BT(IND) > 0 THEN                              
                DO;  /* SKRIV ALTERNATIV BT  */                                 
                   TEKSTTYPE_U_KODE(J) = 'U517';                                
                   J    = J + 1                ;                                
                END;                                                            
                                                                                
                IF B02.ALTERNATIV_ST(IND) > 0 THEN                              
                DO;  /* SKRIVER UT SUM ALTERNATIV ST OM > 0 */                  
                   TEKSTTYPE_U_KODE(J) = 'U518';                                
                   J    = J + 1                ;                                
                END;                                                            
                                                                                
                IF B02.ALTERNATIV_SUM_PENSJON(IND) > 0 THEN                     
                DO;                                                             
                /* U522 --------------------------------------------- */        
                /* SUM               XXXXXXXX                         */        
                /* -------------------------------------------------- */        
                   TEKSTTYPE_U_KODE(J) = 'U522';                                
                   J    = J + 1                ;                                
                END;                                                            
             END;                                                               
                TEKSTTYPE_U_KODE(J) = 'U505';                                   
                J    = J + 1                ;                                   
                if b02.EØS_GARANTI(IND) = 'B' !                                 
                   b02.EØS_GARANTI(IND) = 'C'    THEN                           
                      TEKSTTYPE_U_KODE(J) = 'U560';                             
                ELSE                                                            
                      TEKSTTYPE_U_KODE(J) = 'U559';                             
                J    = J + 1                ;                                   
                IF B02.ALDERSP.ST(IND) > 0 THEN                                 
                   DO;                                                          
                      TEKSTTYPE_U_KODE(J) = 'U040';                             
                      J = J + 1;                                                
                   END;                                                         
             IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN                         
              DO;                                                               
                TEKSTTYPE_U_KODE(J) = 'U530';                                   
                J    = J + 1                ;                                   
                TEKSTTYPE_U_KODE(J) = 'U561';                                   
                J    = J + 1                ;                                   
                IF DIV_PARAM_OMR.PÅ_NORSK_FAKTISK(IND) > 20 THEN                
                   TEKSTTYPE_U_KODE(J) = 'U539';                                
                ELSE                                                            
                   TEKSTTYPE_U_KODE(J) = 'U538';                                
                J    = J + 1                ;                                   
             END;                                                               
          END;   /*IF B02.PRO_RATA_BEREGNING = 'A' */                           
       ELSE                                                                     
          DO;  /*NORSK ALTERNATIV VINNER*/                                      
             TEKSTTYPE_U_KODE(J) = 'U544';                                      
             J    = J + 1                ;                                      
             IF B02.SUM_YTELSE(IND) = B02.ALTERNATIV_SUM_PENSJON(IND)           
                THEN DO;                                                        
                        TEKSTTYPE_U_KODE(J) = 'U593';                           
                        J    = J + 1                ;                           
                     END;                                                       
             ELSE    DO;                                                        
                        TEKSTTYPE_U_KODE(J) = 'U513';                           
                        J    = J + 1                ;                           
                     END;                                                       
             IF (B02.EØSINFO.ALTERNATIV_GP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_GP(IND)         ) !                     
                (B02.EØSINFO.ALTERNATIV_TP_BRUTTO(IND) ^=                       
                 B02.EØSINFO.ALTERNATIV_TP(IND)         ) THEN                  
                DO;  /* SKRIVER UT SUM ALTERNATIV GP OG TP BRUTTO*/             
                   TEKSTTYPE_U_KODE(J) = 'U533';                                
                   J    = J + 1                ;                                
                   TEKSTTYPE_U_KODE(J) = 'U534';                                
                   J    = J + 1                ;                                
                   TEKSTTYPE_U_KODE(J) = 'U527';                                
                   J    = J + 1                ;                                
                END;                                                            
             ELSE      /*IKKE INNTEKTS-REDUSERT*/                               
                DO;                                                             
                   IF B02.ALTERNATIV_GP(IND) > 0 THEN                           
                   DO;  /* SKRIVER UT SUM ALTERNATIV GP OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U514';                             
                      J    = J + 1                ;                             
                   END;                                                         
                                                                                
                   IF B02.ALTERNATIV_TP(IND) > 0 THEN                           
                   DO;  /* SKRIVER UT SUM ALTERNATIV TP OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U515';                             
                      J    = J + 1                ;                             
                   END;                                                         
                                                                                
                   IF B02.ALTERNATIV_ET(IND) > 0 THEN                           
                   DO;  /* SKRIVER UT SUM ALTERNATIV ET OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U516';                             
                      J    = J + 1                ;                             
                   END;                                                         
                                                                                
                   IF B02.ALTERNATIV_BT(IND) > 0 THEN                           
                   DO;  /* SKRIVER UT SUM ALTERNATIV BT OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U517';                             
                      J    = J + 1                ;                             
                   END;                                                         
                                                                                
                   IF B02.ALTERNATIV_ST(IND) > 0 THEN                           
                   DO;  /* SKRIVER UT SUM ALTERNATIV ST OM > 0 */               
                      TEKSTTYPE_U_KODE(J) = 'U518';                             
                      J    = J + 1                ;                             
                   END;                                                         
                   IF B02.ALTERNATIV_SUM_PENSJON(IND) > 0 THEN                  
                   DO;                                                          
                /* U522 --------------------------------------------- */        
                /* SUM               XXXXXXXX                         */        
                /* -------------------------------------------------- */        
                      TEKSTTYPE_U_KODE(J) = 'U522';                             
                      J    = J + 1                ;                             
                   END;                                                         
                END;                                                            
                       TEKSTTYPE_U_KODE(J) = 'U505';                            
                       J    = J + 1                ;                            
                IF B02.PENSJONSTYPE2(IND) ^= 'S'     &                          
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'V' &                   
                   DIV_PARAM_OMR.REDUSERT_GP_2G(IND) ^= 'K' THEN                
                   CALL NY_U('U020');                                           
                ELSE  /*sammenstØtsberegning*/                                  
                   DO;                                                          
                      CALL NY_U('U029');                                        
                      CALL NY_U('U030');                                        
                   END;                                                         
                 IF B02.ALDERSP.ST(IND) > 0 THEN                                
                    CALL NY_U('U040');                                          
                 IF  B02.ALDERSP.SPT      (IND) ^= 0   THEN                     
                     CALL NY_U('U530');                                         
             END;                                                               
                                                                                
        END;                                                                    
 END;                                                                           
 END EØS_TEKSTER_UP_AP;                                                         
 /* ----------------------------------------------------------------- */        
 NY_U : PROC (KODE);                                                            
    DCL KODE CHAR (4);                                                          
    TEKSTTYPE_U_KODE(J) = KODE;                                                 
    J                   = J + 1;                                                
 END NY_U;                                                                      
 /* ----------------------------------------------------------------- */        
 END PLASSER_TEKSTTYPE_U_KODE;                                                  
