 /*   SIST ENDRET PÅ PROD   2005.07.14  8.31.50 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2005.07.08 12.38.38 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2004.03.16 13.59.57 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2004.03.12 13.30.30 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2003.02.27 12.27.27 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2002.11.21 13.17.14 AV   JDA2970          */        
 /*   SIST ENDRET PÅ QASS   2001.09.06 10.02.34 AV   SPA2970          */        
 /*   SIST ENDRET PÅ QASS   2001.03.09 12.50.19 AV   JDA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.02.18 14.34.41 AV   JDA7339          */        
 /*   SIST ENDRET PÅ PROD   1999.11.30 12.59.32 AV   JDA7339          */        
 /*       SIST ENDRET 09/06-98 08.32.04 AV   SPA7339                  */        
 /*       SIST ENDRET 26/05-98 09.37.24 AV   RFA9991                  */        
 /* ***************************************************************** */        
 /*               R 0 0 1 0 6 0 3                                     */        
 /* ***************************************************************** */        
 /*IDENTIFIKASJON:                                                    */        
 /* **********************                                            */        
 /*  PROGRAM-IDENT : R0010603  KONTROLL_UP_SØKER   SUBPROGRAM         */        
 /*  PROGRAM-SPRÅK : PLI/CICS                                         */        
 /*  PROGRAMMERER  : JAN-HARALD KRISTENSEN                            */        
 /*  PROGRAMMET BLE LAGET : MAI 1981                                  */        
 /*  ENDRINGERSDATO :                                                 */        
 /*  ENDRINGEN GJELDER:                                               */        
 /*  ENDRINGEN BLE UTFØRT AV :                                        */        
 /*                                                                   */        
 /* ***************************************************************** */        
 /*HENSIKT:                                                           */        
 /* **********                                                        */        
 /*  FORETAR KONTROLL AV GRUNNBLANKETT UP - SØKERDELEN.               */        
 /*  RETURNERER FEIL_FUNNET = '1'B HVIS FEIL, '0'B HVIS RETT          */        
 /*                                                                   */        
 /*                                                                   */        
 /*  ENDRING 22.6.87 AV ERIK:                                         */        
 /*  FORETAR KONTROLL AV TILLEGGSBLANKETT YP.                         */        
 /*  RETURNERER FEIL_FUNNET = '1'B HVIS FEIL, '0'B HVIS RETT          */        
 /*                                                                   */        
 /* ***************************************************************** */        
 /*PROGRAMTILKNYTTING:                                                */        
 /* ********************                                              */        
 /*  PROGRAMMET INCLUDES AV R0010601 - KONTROLL_GRUNNBLANKETT_UP      */        
 /*  ARBEIDSOMRÅDET P0010601 ER INCLUDET I HOVEDPROG                  */        
 /*  BRUK :                                                           */        
 /*  CALL KONTROLL_UP_SØKER(FEIL_I_UP_SØKER);                         */        
 /*  EXEC CICS LINK TIL R0019906 - ER FNR ENDRET ?                    */        
 /*  FØLGENDE FUNKSJONER BRUKES HER, MEN ER INCLUDET I HOVEDPROG :    */        
 /*          R0019901 - F_GYLDIG_DATO                                 */        
 /*          R0019902 - F_KJØNN                                       */        
 /*          R0019903 - F_EK_ALDER                                    */        
 /*          R0019904 - F_GYLDIG_FNR                                  */        
 /*          R0019905 - F_ALDER                                       */        
 /*          R0019910 - F_NUMERISK                                    */        
 /*          R0019912 - F_FELT_PIC_CHAR11                             */        
 /*          R0019964 - F_6MDR                                        */        
 /*          VERIFY   - BUILTIN-FUNCTION                              */        
 /* ***************************************************************** */        
 /*DATASETTOPPLYSNINGER:                                              */        
 /* ***********************                                           */        
 /*   FØDSELSNR-ENDRINGSREG. LESES VED EXEC LINK TIL R0019906.        */        
 /*   TKNR_TAB.LESES VED EXEC CICS READ DATASET.                      */        
 /*                                                                   */        
 /* ***************************************************************** */        
 /*FEILMELDINGER:                                                     */        
 /* *******************                                               */        
 /*   MELDINGSNR LEGGES INN I TRANSAKSJONEN - SAMTIDIG SOM            */        
 /*   FEIL_FUNNET SETTES = '1'B.                                      */        
 /*   HOVEDPROG LEGGER UT TILHØRENDE FEILMELDING PÅ SKJERMBILDET      */        
 /*                                                                   */        
 /* ***************************************************************** */        
 /*                                                                   */        
 /*   MODULEN KONTROLLERER UP_SØKER, OG RETURNERER                    */        
 /*   MED FEIL_FUNNET = '1'B HVIS FEIL, '0'B HVIS RIKTIG              */        
 /*                                                                   */        
 /* ENDRING : 31.7.85 - HL : VI SKAL AKSEPTERE VIRKNINGSDATO 1 MÅNED  */        
 /*                          FREM I TIDEN (F_DAGS_DATO_PLUSS1_ÅM)     */        
 /*                          FEILRAPPORT NR 225.                      */        
 /* ENDRING : 7.8.85  - HL : TRYGDETID BLE REGNET FEIL FOR PERSONER   */        
 /*                          SOM FYLLER 16 ÅR ETTER 1966              */        
 /*                          FEILRAPPORT NR 226.                      */        
 /* ENDRING : 11.9.86 - OG : VI SKAL AKSEPTERE VIRKNINGSDATO 40 DAGER */        
 /*                          FREM I TIDEN (F_40DAGER)                 */        
 /*                          FEILRAPPORT NR 185.                      */        
 /* ENDRING : 17.12.86  BF : UFØRETIDSPUNKT FØR FYLTE 16 ÅR           */        
 /*                          AKSEPTERES IKKE.                         */        
 /*                          FEILRAPPORT NR 435.                      */        
 /*ENDRET: 13.04.88 AV SVERRE LUNDEBY, DATA-UTVIKLING A/S             */        
 /* ******                                                            */        
 /*    INITIERER BRUKERID I FNR_REG MED CICS_IND FØR KONTROLL PÅ      */        
 /*    OM FNR ER ENDRET (R0019906).                                   */        
 /*ENDRET: 31.10.90 AV SVERRE LUNDEBY, DATA-UTVIKLING A/S             */        
 /* ******                                                            */        
 /*    LEGGER INN KRYSS-KONTROLL PÅ PRIMÆR- OG SEKUNDÆR-DIAGNOSE.     */        
 /*    REF.==> KAP.18 DIAGNOSE-KODER.                                 */        
 /* ***************************************************************** */        
 KONTROLL_UP_SØKER:                                                             
   PROC (FEIL_FUNNET);                                                          
   DCL                                                                          
      FEIL_FUNNET     BIT (1);                                                  
   DCL                                                                          
      KEY_BIT                    BIT(32) BASED (KEY_PEKER),                     
      KEY_PEKER                  POINTER,                                       
      TK_RECL                    CHAR (101);                                    
                                                                                
   DCL                                                                          
      01 W01_PRIM                CHAR(6);                                       
   DCL                                                                          
      01 W01_SEKU                CHAR(6);                                       
   DCL                                                                          
      01 W01_DIAG_PRIM DEF W01_PRIM,                                            
         10 FILLER               CHAR(4),                                       
         10 W01_REST_PRIM        CHAR(2);                                       
   DCL                                                                          
      01 W01_DIAG_SEKU DEF W01_SEKU,                                            
         10 FILLER               CHAR(4),                                       
         10 W01_REST_SEKU        CHAR(2);                                       
   DCL                                                                          
      01 W01_DIA_RECL,                                                          
         10 W01_DIA_RECL_KEY         CHAR(6);                                   
   DCL                                                                          
      W_FNR                                     PIC'(11)9';                     
   DCL                                                                          
      1 FNR DEF W_FNR,                                                          
        2 DAG                                   PIC'(2)9',                      
        2 MND                                   PIC'(2)9',                      
        2 AAR                                   PIC'(2)9',                      
        2 ÅRHUNDRE                              PIC'9',                         
        2 REST                                  PIC'(4)9';                      
   DCL                                                                          
      W_FNR13                                   PIC'(13)9';                     
   DCL                                                                          
      1 FNR13 DEF W_FNR13,/* 2000 */                                            
        2 DAG                                   PIC'(2)9',                      
        2 MND                                   PIC'(2)9',                      
        2 AAR                                   PIC'(4)9',                      
        2 ÅRHUNDRE                              PIC'9',                         
        2 REST                                  PIC'(4)9';                      
   DCL                                                                          
      W_FNR_EK                                  PIC'(11)9';                     
   DCL                                                                          
      1 FNR_EK_DEF DEF W_FNR_EK,                                                
        2 DAG                                   PIC'(2)9',                      
        2 MND                                   PIC'(2)9',                      
        2 AAR                                   PIC'(2)9',                      
        2 ÅRHUNDRE                              PIC'9',                         
        2 REST                                  PIC'(4)9';                      
   DCL                                                                          
      TT_E66_ÅM                                 PIC'(4)9';                      
   DCL                                                                          
      ALDER           FIXED DEC (5),                                            
      ALDERSGRENSE    FIXED DEC (5),    /*HL*/                                  
      IÅR             FIXED BIN (15),                                           
      J               FIXED BIN (15),                                           
      TELL            FIXED BIN (15),                                           
      DATO            PIC '(8)9';                                               
   DCL                                                                          
      1 DAGENS_DATO   DEF DATO,                                                 
        2 ÅR          PIC'9999',                                                
        2 MN          PIC'99',                                                  
        2 DG          PIC'99';                                                  
   DCL                                                                          
      DATE            BUILTIN;                                                  
   DCL                                                                          
      DAGENS_DATO_ÅMD  DEF DATO POS(1) PIC'(8)9';                               
                                                                                
 /*  HJELPE DCL FOR Å SNU DATO           */                                     
                                                                                
   DCL                                                                          
      HJ_UFT_ÅMD                             PIC '99999999',/* 2000-3*/         
      UFT_Å DEF HJ_UFT_ÅMD POS(1)            PIC '9999',                        
      UFT_M DEF HJ_UFT_ÅMD POS(5)            PIC '99';                          
                                                                                
                                                                                
   DCL  W603_DIAG                   CHAR (6)    INIT ('      '),                
        W603_D_P DEF W603_DIAG      PIC '(6)9'  POS  ( 1)      ,                
        W603_S12 DEF W603_DIAG      CHAR ( 2)   POS  ( 1)      ,                
        W603_KEY DEF W603_DIAG      CHAR ( 5)   POS  ( 1)      ,                
        W603_S6  DEF W603_DIAG      CHAR ( 1)   POS  ( 6)      ,                
                                                                                
        W603_DIAG_LENGTH     FIXED  BIN  (15)   INIT ( 6)      ,                
        W603_KEY_LENGTH      FIXED  BIN  (15)   INIT ( 5)      ,                
                                                                                
        W603_KAP18                  BIT  ( 1)                  ;                
                                                                                
   DCL                                                                          
      1 FNR_REG,                                                                
        2 FNR1      FIXED DEC(11),                                              
        2 FNR2      FIXED DEC(11),                                              
        2 BRUKERID  CHAR     ( 4);                                              
                                                                                
                                                                                
 /*LOVENDRING MED VIRKNING FRA 1.1.91 SP : */                                   
    DIV_PARAM_OMR.REGN_1291 = ' ';                                              
                                                                                
    FNR_REG.BRUKERID =  DIV_PARAM_OMR.CICS_IND;                                 
    DATO             =  DATO_2000;     ;                                        
    FEIL_FUNNET      =  '0'B           ;                                        
    BO_TKNR          =   UPS.TKNR;                                              
    KEY_PEKER        =  ADDR (UPS.TKNR);                                        
    W_FNR13          = KONV_FNR11_FNR13(UPS.FNR);                               
                                                                                
   IF UPS.VIRK_DATO_ÅMD < 19930800 & (UPS.SIVILSTAND = 'P') THEN                
      DO;                              /* 2000-3 */                             
         FEIL_FUNNET = '1'B;                                                    
         UPS.SIVILSTANDNR = 388;                                                
      END;                                                                      
   IF UPS.VIRK_DATO_ÅMD < 19940100 & (UPS.SIVILSTAND = 'W') THEN                
      DO;                            /* 2000-3 */                               
         FEIL_FUNNET = '1'B;                                                    
         UPS.SIVILSTANDNR = 389;                                                
      END;                                                                      
                                                                                
    W01_PRIM         = UPS.PRIMDIAG;                                            
    W01_SEKU         = UPS.SEKUDIAG;                                            
                                                                                
                                                                                
    IF VERIFY(UPS.ATT_UF,'AU') ^= 0 THEN                                        
                                                                                
       DO;                                                                      
          FEIL_FUNNET  = '1'B;                                                  
          UPS.ATT_UFNR = 268;                                                   
       END;                                                                     
    IF ^F_NUMERISK(F_FELT_PIC_CHAR11(UPS.FNR)) THEN                             
       DO;                                                                      
          FEIL_FUNNET = '1'B;                                                   
          UPS.FNRNR   = 200;                                                    
       END;                                                                     
    ELSE                                                                        
       IF ^F_GYLDIG_FNR(UPS.FNR) THEN                                           
          DO;                                                                   
             FEIL_FUNNET = '1'B;                                                
             UPS.FNRNR   = 1;                                                   
          END;                                                                  
       ELSE                                                                     
          DO;                                                                   
             FNR_REG.FNR1 = UPS.FNR;                                            
             W_FNR        = UPS.FNR;                                            
             EXEC CICS LINK PROGRAM('R0019906') COMMAREA(FNR_REG);              
             IF FNR_REG.FNR2 > 0 THEN                                           
                DO;                                                             
                   UPS.FNRNR   = 203;                                           
                   UPS.FNR_GML = UPS.FNR;                                       
                   UPS.FNR     = FNR_REG.FNR2;                                  
                END;                                                            
          END;                                                                  
    IF UPS.NAVN = (25)' ' THEN                                                  
       DO;                                                                      
          FEIL_FUNNET = '1'B;                                                   
          UPS.NAVNNR  = 2;                                                      
       END;                                                                     
    IF VERIFY(UPS.SPRÅK,'NBE ') ^= 0 THEN                                       
       DO;                                                                      
          FEIL_FUNNET = '1'B;                                                   
          UPS.SPRÅKNR = 6;                                                      
       END;                                                                     
    IF ^ F_NUMERISK(F_FELT_PIC_CHAR4(UPS.TKNR)) THEN                            
       DO;                                                                      
          FEIL_FUNNET = '1'B;                                                   
          UPS.TKNRNR  = 200;                                                    
       END;                                                                     
    ELSE                                                                        
       DO;                                                                      
            EXEC CICS HANDLE CONDITION NOTFND(NOTFND);                          
            EXEC CICS READ DATASET ('TKNRTAB') RIDFLD(KEY_BIT)                  
                                               INTO(TK_RECL);                   
            LEAVE;                                                              
        NOTFND:                                                                 
            FEIL_FUNNET = '1'B;                                                 
            UPS.TKNRNR  = 3;                                                    
       END;                                                                     
                                                                                
    /* ************************************************** */                    
    /* KONTROLL AV ACF2 FOR TILLGANGE TIL TKNR            */                    
    /*                                                    */                    
    /* ************************************************** */                    
    BO_TKNR  = TKNR;                                                            
     CALL ATK_TILGANG_KONTROLL;                                                 
                                                                                
    IF VERIFY(UPS.SIVILSTAND,'GASUEPW') ^= 0 THEN                               
       DO;                                                                      
          FEIL_FUNNET      = '1'B;                                              
          UPS.SIVILSTANDNR = 5;                                                 
       END;                                                                     
                                                                                
    IF ^(UPS.TILL_EK = 'J' ! UPS.TILL_EK = ' ') THEN                            
       DO;                                                                      
          FEIL_FUNNET   ='1'B;                                                  
          UPS.TILL_EKNR = 4;                                                    
       END;                                                                     
                                                                                
  /* ******************************************************** */                
  /* TILLEGG FOR EKTEFELLE SKAL OGSÅ AVVISES HVIS UFØREGRADEN */                
  /* ER UNDER 50 PROSENT.  GJELDER YRKESSKADETILFELLENE.      */                
  /* ERIK 19.1.88.                                            */                
  /* ******************************************************** */                
                                                                                
    IF UPS.UFG < 50 &    UPS.TILL_EK = 'J' THEN                                 
       DO;                                                                      
               FEIL_FUNNET = '1'B;                                              
               UPS.TILL_EKNR = 303;                                             
               UPS.UFGNR     = 999;                                             
       END;                                                                     
                                                                                
  /* ******************************************************** */                
  /* ERIK 19.1.88.                                            */                
  /* ******************************************************** */                
                                                                                
    IF VERIFY(UPS.NORSK_BOSATT,'JN') ^= 0 THEN                                  
       DO;                                                                      
          FEIL_FUNNET        = '1'B;                                            
          UPS.NORSK_BOSATTNR = 8;                                               
       END;                                                                     
    IF UPS.BT_ANT > 12 THEN                                                     
       DO;                                                                      
          FEIL_FUNNET = '1'B;                                                   
          UPS.BT_ANTNR = 7;                                                     
       END;                                                                     
                                                                                
                                                                                
    IF ^(UPS.YSKADE_TILLEGG = 'J' ! UPS.YSKADE_TILLEGG = ' ') THEN              
        DO;                                                                     
                   FEIL_FUNNET   ='1'B;                                         
                   UPS.YSKADE_TILLEGGNR = 300;                                  
        END;                                                                    
                                                                                
                                                                                
  /* DERSOM VP_ÅR1 ER NULL NOEN AV DE ANDRE UTFYLT, NULLES DISSE  */            
                                                                                
    DO J = 1 TO 4 UNTIL(UPS.VP_ÅR(J) = 0 );                                     
       IF UPS.VP_ÅR(J)  = 0      THEN                                           
          DO TELL   = J TO 4;                                                   
             UPS.VP_ÅR(TELL) = 0;                                               
          END;                                                                  
    END;                                                                        
                                                                                
    DO IÅR = 1 TO 4 WHILE (UPS.VP_ÅR(IÅR)  ^= 0 );                              
          IF ^(UPS.VP_ÅR(IÅR)> 1966 & UPS.VP_ÅR(IÅR)<= DAGENS_DATO.ÅR) !        
             UPS.VP_ÅR(IÅR) < (1900 + FNR.AAR + 17)  THEN  /* 2000-3 */         
             DO;                                                                
                FEIL_FUNNET      = '1'B;                                        
                UPS.VP_ÅRNR(IÅR) = 47;                                          
             END;                                                               
    END;                                                                        
                                                                                
    IF ^(UPS.VILKÅR_8_1 = 'J' ! UPS.VILKÅR_8_1 = 'N' !                          
                                              UPS.VILKÅR_8_1 = ' ') THEN        
       DO;                                                                      
          FEIL_FUNNET      = '1'B;                                              
          UPS.VILKÅR_8_1NR = 122;                                               
       END;                                                                     
    IF ^(UPS.VILKÅR_8_4 = 'J' ! UPS.VILKÅR_8_4 = 'N') THEN                      
       DO;                                                                      
          FEIL_FUNNET      = '1'B;                                              
          UPS.VILKÅR_8_4NR = 45;                                                
       END;                                                                     
    IF ^F_NUMERISK(F_FELT_PIC_CHAR3(UPS.UFG)) THEN                              
       DO;                                                                      
          FEIL_FUNNET = '1'B;                                                   
          UPS.UFGNR   = 200;                                                    
       END;                                                                     
    ELSE                                                                        
 /* ********************************************************* */                
 /* HER KOMMER YRKESSKADEPENSJONENE.  ERIK 8.9.87             */                
 /* SKAL GODTA F.O.M 15 %  ALLE HELE UFG GYLDIG JD 0901       */                
 /* ********************************************************* */                
 /* ********************************************************* */                
 /* VI SKAL GODTA BLANK I UFG, DERSOM 'J' I YSKADE_TILLEGG.   */                
 /* TRUDE 14.6.88                                             */                
 /* ********************************************************* */                
                                                                                
        IF (UPS.YSKADE_TILLEGG = 'J') & ^(                                      
            UPS.UFG = 15 ! UPS.UFG = 20 ! UPS.UFG = 25!                         
            UPS.UFG = 30 ! UPS.UFG = 35 ! UPS.UFG = 40!                         
            UPS.UFG = 45 ! UPS.UFG = 50 ! UPS.UFG = 55!                         
            UPS.UFG = 60 ! UPS.UFG = 65 ! UPS.UFG = 70!                         
            UPS.UFG = 75 ! UPS.UFG = 80 ! UPS.UFG = 85!                         
            UPS.UFG = 90 ! UPS.UFG = 95 ! UPS.UFG = 100!                        
                                          UPS.UFG = 0   )  THEN                 
            DO;                                                                 
               FEIL_FUNNET = '1'B;                                              
               UPS.UFGNR   = 350;                                               
            END;                                                                
        ELSE                                                                    
          IF ^(UPS.YSKADE_TILLEGG = 'J') & ^(                                   
            UPS.UFG = 50 ! UPS.UFG = 55 ! UPS.UFG = 60!                         
            UPS.UFG = 65 ! UPS.UFG = 70 ! UPS.UFG = 75!                         
            UPS.UFG = 80 ! UPS.UFG = 85 ! UPS.UFG = 90!                         
                           UPS.UFG = 95 ! UPS.UFG = 100) THEN                   
            DO;                                                                 
               FEIL_FUNNET = '1'B;                                              
               UPS.UFGNR   = 38;                                                
            END;                                                                
    IF ^F_NUMERISK(F_FELT_PIC_CHAR8(UPS.UFT_ÅMD)) THEN                          
       DO;                                                                      
          FEIL_FUNNET  = '1'B;                                                  
          UPS.UFT_ÅMDNR = 200;                                                  
       END;                                                                     
    ELSE                                                                        
       IF ^F_GYLDIG_DATO(UPS.UFT_ÅMD) THEN                                      
          DO;                                                                   
             FEIL_FUNNET  = '1'B;                                               
             UPS.UFT_ÅMDNR = 40;                                                
          END;                                                                  
                                                                                
    IF ^F_NUMERISK(F_FELT_PIC_CHAR7(UPS.INNTEKT_FØR_UP)) THEN                   
       DO;                                                                      
          FEIL_FUNNET        = '1'B;                                            
          UPS.INNTEKT_FØR_UPNR = 200;                                           
       END;                                                                     
                                                                                
    IF UPS.INNTEKT_FØR_UP > 0 & UPS.ATT_UF = 'A' THEN                           
       DO;                                                                      
          FEIL_FUNNET        = '1'B;                                            
          UPS.INNTEKT_FØR_UPNR = 399;   /* JD 02.97 */                          
       END;                                                                     
                                                                                
    IF ^F_NUMERISK(F_FELT_PIC_CHAR7(UPS.PI)) THEN                               
       DO;                                                                      
          FEIL_FUNNET = '1'B;                                                   
          UPS.PINR    = 200;                                                    
       END;                                                                     
                                                                                
    IF ^F_NUMERISK(F_FELT_PIC_CHAR2(UPS.YRKE)) THEN                             
       DO;                                                                      
          FEIL_FUNNET = '1'B;                                                   
          UPS.YRKENR  = 200;                                                    
       END;                                                                     
    ELSE                                                                        
       IF ^ (UPS.YRKE >= 0 & UPS.YRKE <= 19) ! UPS.YRKE = 8 THEN                
          DO;                                                                   
             FEIL_FUNNET = '1'B;                                                
             UPS.YRKENR  = 42;                                                  
          END;                                                                  
                                                                                
    W603_KAP18        = '0'B;                                                   
                                                                                
    IF UPS.PRIMDIAG  ^= '      '  &                                             
       W01_REST_PRIM ^= 'XX'      THEN                                          
       DO;                                                                      
          /*-------------------------------------------------------*/           
          /* SJEKKER OM GYLDIG DIAGNOSE-KODE MOT DIAGNOSE-FILEN    */           
          /* SJEKKER OM PRIMÆRDIAGNOSE ER INNEFOR DE INTERVALLER   */           
          /* SOM KREVER SEK.DIAG FRA KAP.18                        */           
          /*-------------------------------------------------------*/           
                                                                                
          EXEC CICS HANDLE CONDITION         NOTFND (NOTFND1);                  
          EXEC CICS READ DATASET ('DIAGNOS') RIDFLD (UPS.PRIMDIAG)              
                                             INTO   (W01_DIA_RECL);             
                                                                                
          IF VERIFY (UPS.PRIMDIAG , '0123456789')  = 0 THEN                     
             DO;                                                                
                W603_DIAG         =  UPS.PRIMDIAG;                              
                                                                                
                IF (W603_D_P     >=  905000  &                                  
                    W603_D_P     <=  909900   )  !                              
                   (W603_D_P     >=  998000  &                                  
                    W603_D_P     <=  998901   )      THEN                       
                                                                                
                    W603_KAP18    = '1'B;                                       
             END;                                                               
       END;                                                                     
                                                                                
    GOTO DIAG_UT1;                                                              
                                                                                
 NOTFND1:                                                                       
    FEIL_FUNNET        = '1'B;                                                  
    UPS.PRIMDIAGNR     =  43;                                                   
                                                                                
 DIAG_UT1:                                                                      
    IF UPS.SEKUDIAG   ^= '      ' &                                             
       W01_REST_SEKU  ^= 'XX'     THEN                                          
       DO;                                                                      
          W603_DIAG    =  UPS.SEKUDIAG;                                         
                                                                                
          IF W603_KAP18                       THEN                              
             DO;                                                                
                IF (W603_S12 ^=   'E9'     &                                    
                    W603_S12 ^=   'E8'      ) !                                 
                                                                                
                   VERIFY (W603_S6,'123456789') > 0 THEN                        
                   DO;                                                          
                      FEIL_FUNNET    = '1'B;                                    
                      UPS.SEKUDIAGNR =  295;                                    
                   END;                                                         
                ELSE                                                            
                   DO;                                                          
                      /*-----------------------------------------*/             
                      /* OPPSLAG MED SIFFER 1-5 I DIAGNOSE KAP18 */             
                      /*-----------------------------------------*/             
                                                                                
                      EXEC CICS HANDLE  CONDITION   NOTFND (NOTFND2);           
                      EXEC CICS READ    DATASET   ('DIAGNOS' )                  
                                        RIDFLD    ( W603_KEY )                  
                                        INTO      ( W01_DIA_RECL)               
                                        LENGTH    ( W603_DIAG_LENGTH)           
                                        KEYLENGTH ( W603_KEY_LENGTH )           
                                        GENERIC                                 
                                        EQUAL;                                  
                      GOTO DIAG_UT2;                                            
                   END;                                                         
             END;                                                               
          ELSE                                                                  
             DO;                                                                
                /*-----------------------------------------------*/             
                /* PRIM DIAG ULIK KAP18. SJEKKER OM SEKU DIAG =  */             
                /*-----------------------------------------------*/             
                IF W603_S12  =   'E9'     !                                     
                   W603_S12  =   'E8'                THEN                       
                   DO;                                                          
                      FEIL_FUNNET    = '1'B;                                    
                      UPS.SEKUDIAGNR =  296;                                    
                      GOTO DIAG_UT2;                                            
                   END;                                                         
                                                                                
             END;                                                               
                                                                                
          EXEC CICS HANDLE CONDITION NOTFND(NOTFND2);                           
          EXEC CICS READ DATASET ('DIAGNOS') RIDFLD (UPS.SEKUDIAG)              
                                             INTO   (W01_DIA_RECL);             
       END;                                                                     
    ELSE                                                                        
       DO;                                                                      
          /*--------------------------------------------------------*/          
          /* SEKU DIAG IKKE REG. SJEKKER OM PRIM DIAG =  KAP18-KODE */          
          /*--------------------------------------------------------*/          
          IF W603_KAP18                              THEN                       
             DO;                                                                
                FEIL_FUNNET          = '1'B;                                    
                UPS.SEKUDIAGNR       =  297;                                    
             END;                                                               
       END;                                                                     
                                                                                
    GOTO DIAG_UT2;                                                              
                                                                                
 NOTFND2:                                                                       
    FEIL_FUNNET        = '1'B;                                                  
    UPS.SEKUDIAGNR     = 44;                                                    
                                                                                
 DIAG_UT2:                                                                      
                                                                                
    IF ^F_NUMERISK(F_FELT_PIC_CHAR8(UPS.VIRK_DATO_ÅMD)) THEN                    
       DO;                                    /* 2000-3 */                      
          FEIL_FUNNET        = '1'B;                                            
          UPS.VIRK_DATO_ÅMDNR = 200; /* 2000-3 */                               
       END;                                                                     
    ELSE                                                                        
       DO;                                                                      
          IF ^F_GYLDIG_DATO(UPS.VIRK_DATO_ÅMD) THEN   /* 2000-3 */              
             DO;                                                                
                FEIL_FUNNET        = '1'B;                                      
                UPS.VIRK_DATO_ÅMDNR = 9;/* 2000-3 */                            
             END;                                                               
          ELSE                                                                  
             IF UPS.VIRK_DATO_ÅMD < 19670100 THEN    /* 2000-3 */               
                DO;                                                             
                   FEIL_FUNNET        = '1'B;                                   
                   UPS.VIRK_DATO_ÅMDNR = 9;          /* 2000-3 */               
                END;                                                            
                                                                                
 /* LOVENDRING FRA 0191 - UTLAND PÅ NY BLANKETT - HL 30.11.90*/                 
                                                                                
             ELSE                                                               
             IF UPS.VIRK_DATO_ÅMD > 19910000     &    /* 2000-3 */              
                UPS.NORSK_BOSATT = 'N'      THEN                                
                DO;                                                             
                   FEIL_FUNNET        = '1'B;                                   
                   UPS.VIRK_DATO_ÅMDNR = 363;        /* 2000-3 */               
                END;                                                            
       END;                                                                     
                                                                                
    IF F_FELT_PIC_CHAR11(UPS.FNR_EK) ^= (11)'0' THEN                            
       DO;                                                                      
          IF ^F_NUMERISK(F_FELT_PIC_CHAR11(UPS.FNR_EK)) THEN                    
             DO;                                                                
                FEIL_FUNNET  = '1'B;                                            
                UPS.FNR_EKNR = 200;                                             
             END;                                                               
          ELSE                                                                  
          IF ^F_GYLDIG_FNR(UPS.FNR_EK) THEN                                     
             DO;                                                                
                   FEIL_FUNNET  = '1'B;                                         
                   UPS.FNR_EKNR = 1;                                            
             END;                                                               
          ELSE                                                                  
             DO;                                                                
                   FNR_REG.FNR1 = UPS.FNR_EK;                                   
                   EXEC CICS LINK PROGRAM('R0019906') COMMAREA(FNR_REG);        
                   IF FNR_REG.FNR2 > 0 THEN                                     
                      DO;                                                       
                         UPS.FNR_EKNR   = 203;                                  
                         UPS.FNR_GML_EK = UPS.FNR_EK;                           
                         UPS.FNR_EK     = FNR_REG.FNR2;                         
                      END;                                                      
             END;                                                               
          IF UPS.EK_INNT = 'J' THEN                                             
             DO;                                                                
                IF UPS.VIRK_DATO_ÅMD < 19840700 THEN                            
                   DO;                                                          
                      FEIL_FUNNET = '1'B;                                       
                      UPS.VIRK_DATO_ÅMDNR = 273;                                
                   END;                                                         
                ELSE                                                            
                IF  UPS.SIVILSTAND ^= 'G' THEN                                  
                   DO;                                                          
                          FEIL_FUNNET = '1'B;                                   
                          UPS.SIVILSTANDNR = 274;                               
                   END;                                                         
             END;                                                               
          ELSE                                                                  
             IF UPS.EK_INNT  ^= 'N' THEN                                        
                DO;                                                             
                   FEIL_FUNNET = '1'B;                                          
                   UPS.EK_INNTNR = 272;                                         
                END;                                                            
       END;                                                                     
                                                                                
 /* HER SETTES VERDIER INN I MENY_OMR                                 */        
                                                                                
    FØDSNUMMER    = UPS.FNR;                                                    
    VIRKNINGSDATO_ÅMD = UPS.VIRK_DATO_ÅMD; /* 2000-3 */                         
 %SKIP(3);                             /*  */                                   
 /*   KRYSS KONTROLLER       */                                                 
 %SKIP;                                                                         
                                                                                
                                                                                
          HJ_UFT_ÅMD      = UPS.UFT_ÅMD;                                        
          ALDER           = F_ALDER(UPS.FNR,UPS.UFT_ÅMD); /* 2000-3 */          
                                                                                
    IF ^FEIL_FUNNET THEN                                                        
       DO;                                                                      
          HJ_UFT_ÅMD      = UPS.UFT_ÅMD;                                        
          ALDER           = F_ALDER(UPS.FNR,UPS.UFT_ÅMD); /* 2000-3 */          
                                                                                
          IF  UPS.VIRK_DATO_ÅMD > 19920000 &/* 2000-3 */                        
              UPS.UFT_ÅMD      < 19920000     THEN                              
                                                                                
               DIV_PARAM_OMR.REGN_1291 = 'J';                                   
                                                                                
            /* TRUDE 08.07.05  GIKK AN Å REG PI VED ALDER < 17 ÅR */            
          IF UPS.PI     > 0 &                                                   
             ALDER      < 1800 THEN                                             
             DO;                                                                
                FEIL_FUNNET = '1'B;                                             
                UPS.PINR      = 252;                                            
             END;                                                               
                                                                                
          IF UPS.VIRK_DATO_ÅMD > 19910101 THEN                                  
             DO;                                                                
                ALDERSGRENSE = 1601;                                            
                IF ALDER < 1601 THEN                                            
                   DO;                                                          
                      FEIL_FUNNET = '1'B;                                       
                      UPS.UFT_ÅMDNR = 196;                                      
                   END;                                                         
             END;                                                               
          ELSE                                                                  
          IF UPS.VIRK_DATO_ÅMD > 19760000 THEN/* 2000-3 */                      
             DO;                                                                
                ALDERSGRENSE = 1600;                                            
                IF ALDER < 1600 THEN                                            
                   DO;                                                          
                      FEIL_FUNNET = '1'B;                                       
                      UPS.UFT_ÅMDNR = 196;    /* 2000-3 */                      
                   END;                                                         
             END;                                                               
                                                                                
          ELSE                                                                  
             DO;                                                                
                ALDERSGRENSE = 1800;                                            
                IF ALDER < 1800 THEN                                            
                   DO;                                                          
                      FEIL_FUNNET = '1'B;                                       
                      UPS.UFT_ÅMDNR = 197;   /* 2000-3 */                       
                   END;                                                         
             END;                                                               
                                                                                
          IF ALDER ^= ALDERSGRENSE             THEN                             
             IF UPS.UFT_ÅMD > DAGENS_DATO_ÅMD     THEN   /* 2000-3 */           
                DO;                                                             
                   FEIL_FUNNET = '1'B;                                          
                   UPS.UFT_ÅMDNR = 206;                  /* 2000-3 */           
                END;                                                            
                                                                                
             ELSE;                                                              
          ELSE;                                                                 
                                                                                
          ALDER           = F_ALDER(UPS.FNR,UPS.VIRK_DATO_ÅMD);                 
          IF ALDER > 1812 THEN                      /* 2000-3 */                
             UPS.VILKÅR_8_1   = ' ';                                            
          IF F_KJØNN(UPS.FNR) = 'K' THEN                                        
             DO IÅR = 1 TO 2;                                                   
                IF UPS.VP_ÅR(IÅR) > 0 THEN                                      
                   DO;                                                          
                      FEIL_FUNNET      = '1'B;                                  
                      UPS.VP_ÅRNR(IÅR) = 47;                                    
                      UPS.FNRNR        = 999;                                   
                   END;                                                         
             END;                                                               
                                                                                
          IF ^FEIL_FUNNET & UPS.VP_ÅR(1) > 0 & UPS.VP_ÅR(2) > 0 &               
                                       UPS.VP_ÅR(1) = UPS.VP_ÅR(2) THEN         
             DO;                                                                
                FEIL_FUNNET    = '1'B;                                          
                UPS.VP_ÅRNR(1) = 124;                                           
                UPS.VP_ÅRNR(2) = 999;                                           
             END;                                                               
                                                                                
          IF UPS.VIRK_DATO_ÅMD < 19840400 & UPS.ATT_UF = 'A' THEN               
             DO;                             /* 2000-3 */                       
                FEIL_FUNNET = '1'B;                                             
                UPS.VIRK_DATO_ÅMDNR = 269;                                      
                UPS.ATT_UFNR = 999;                                             
             END;                                                               
                                                                                
          IF UPS.VIRK_DATO_ÅMD < 19670100 & UPS.UFG < 100 THEN                  
             DO;                         /* 2000-3*/                            
                FEIL_FUNNET = '1'B;                                             
                UPS.VIRK_DATO_ÅMDNR = 39;                                       
                UPS.UFGNR = 999;                                                
             END;                                                               
          ELSE                                                                  
             IF UPS.UFT_ÅMD > UPS.VIRK_DATO_ÅMD THEN    /* 2000-3 */            
               DO;                                                              
                  FEIL_FUNNET        = '1'B;                                    
                  UPS.UFT_ÅMDNR      = 41;                                      
                  UPS.VIRK_DATO_ÅMDNR = 999;                                    
               END;                                                             
          ELSE                                                                  
             IF ALDER < 1900 & VILKÅR_8_1 = ' ' THEN                            
                DO;                                                             
                      FEIL_FUNNET      = '1'B;                                  
                      UPS.VILKÅR_8_1NR = 46;                                    
                END;                                                            
          ELSE                                                                  
             IF ^ F_6MDR(UPS.VIRK_DATO_ÅMD)   THEN /* 2000-3 */                 
                DO;                                                             
                         FEIL_FUNNET        = '1'B;                             
                                                                                
                         UPS.VIRK_DATO_ÅMDNR = 205;                             
                 END;                                                           
                                                                                
          ELSE                                                                  
          IF UPS.VIRK_DATO_ÅMD < 19760100 & ALDER < 1800 THEN                   
             DO;                                   /* 2000-3 */                 
                FEIL_FUNNET        = '1'B;                                      
                UPS.FNRNR          = 49;                                        
                UPS.VIRK_DATO_ÅMDNR = 999;                                      
             END;                                                               
          ELSE                                                                  
          IF UPS.VIRK_DATO_ÅMD > 19910100 & ALDER < 1601 THEN /*2000-3*/        
                DO;                                                             
                   FEIL_FUNNET        = '1'B;                                   
                   UPS.FNRNR          = 50;                                     
                   UPS.VIRK_DATO_ÅMDNR = 999;                                   
                END;                                                            
          ELSE                                                                  
             IF UPS.VIRK_DATO_ÅMD > 19760000 & ALDER < 1600 THEN                
                DO;                              /* 2000-3 */                   
                   FEIL_FUNNET        = '1'B;                                   
                   UPS.FNRNR          = 50;                                     
                   UPS.VIRK_DATO_ÅMDNR = 999;                                   
                END;                                                            
          ELSE                                                                  
            IF UPS.VIRK_DATO_ÅMD < 19730100 & ALDER >= 7000 THEN                
               DO;                           /* 2000-3 */                       
                      FEIL_FUNNET        = '1'B;                                
                      UPS.FNRNR          = 51;                                  
                      UPS.VIRK_DATO_ÅMDNR = 999;                                
               END;                                                             
                                                                                
                                                                                
          ELSE                                                                  
            IF UPS.VIRK_DATO_ÅMD > 19910000 & ALDER > 6700 THEN                 
               DO;                          /* 2000-3 */                        
                         FEIL_FUNNET        = '1'B;                             
                         UPS.FNRNR          = 52;                               
                       UPS.VIRK_DATO_ÅMDNR = 999;                               
               END;                                                             
          ELSE                                                                  
            IF UPS.VIRK_DATO_ÅMD > 19730000 &                                   
                      UPS.VIRK_DATO_ÅMD < 19910000 & ALDER > 6612 THEN          
                DO;                          /* 2000-3 */                       
                         FEIL_FUNNET        = '1'B;                             
                         UPS.FNRNR          = 52;                               
                         UPS.VIRK_DATO_ÅMDNR = 999;                             
                END;                                                            
          ELSE                                                                  
             IF (UPS.VIRK_DATO_ÅMD < 19710100 &                                 
                 UPS.YSKADE_TILLEGG = 'J') THEN                                 
                DO;                                                             
                   FEIL_FUNNET          = '1'B;                                 
                   UPS.VIRK_DATO_ÅMDNR  = 310;                                  
                   UPS.YSKADE_TILLEGGNR = 999;                                  
                END;                                                            
          ELSE                                                                  
            IF UPS.SIVILSTAND ^= 'P' &                                          
               (UPS.FNR_EK > 0 & F_KJØNN(UPS.FNR)                               
                                       = F_KJØNN(UPS.FNR_EK))THEN               
               DO;                                                              
                            FEIL_FUNNET  = '1'B;                                
                            UPS.FNRNR    = 16;                                  
                            UPS.FNR_EKNR = 999;                                 
                END;                                                            
          ELSE                                                                  
            IF UPS.SIVILSTAND = 'P' &                                           
                   (UPS.FNR_EK > 0 & F_KJØNN(UPS.FNR)                           
                                       ^= F_KJØNN(UPS.FNR_EK))THEN              
               DO;                                                              
                            FEIL_FUNNET  = '1'B;                                
                            UPS.FNRNR    = 392;                                 
                            UPS.FNR_EKNR = 999;                                 
               END;                                                             
          ELSE                                                                  
            IF ^(UPS.SIVILSTAND = 'G' ! UPS.SIVILSTAND = 'A'  !                 
                 UPS.SIVILSTAND = 'W' ! UPS.SIVILSTAND = 'P') &                 
            (UPS.FNR_EK > 0 ! UPS.NAVN_EK ^= (25)' ') THEN                      
               DO;                                                              
                  FEIL_FUNNET = '1'B;                                           
                  UPS.SIVILSTANDNR = 123;                                       
                  UPS.FNR_EKNR = 999;                                           
                  UPS.NAVN_EKNR = 999;                                          
               END;                                                             
          ELSE                                                                  
            IF UPS.FNR_EK > 0 & UPS.NAVN_EK = (25)' ' THEN                      
               DO;                                                              
                  FEIL_FUNNET = '1'B;                                           
                  UPS.NAVN_EKNR = 118;                                          
               END;                                                             
          ELSE                                                                  
            IF UPS.TILL_EK = 'J' THEN                                           
               DO;                                                              
                  IF UPS.NAVN_EK = (25)' ' THEN                                 
                     DO;                                                        
                        FEIL_FUNNET = '1'B;                                     
                        UPS.NAVN_EKNR = 19;                                     
                        UPS.TILL_EKNR = 999;                                    
                     END;                                                       
                  ELSE                                                          
                  IF UPS.FNR_EK = 0 THEN                                        
                     DO;                                                        
                        FEIL_FUNNET = '1'B;                                     
                        UPS.FNR_EKNR = 15;                                      
                        UPS.TILL_EKNR = 999;                                    
                     END;                                                       
                  ELSE                                                          
                  IF ^F_EK_ALDER_GYLDIG(UPS.FNR_EK,UPS.VIRK_DATO_ÅMD)           
                  THEN                                                          
                     DO;                                                        
                        FEIL_FUNNET = '1'B;                                     
                        UPS.FNR_EKNR = 17;                                      
                        UPS.VIRK_DATO_ÅMDNR = 999;                              
                        UPS.TILL_EKNR = 999;                                    
                     END;                                                       
                  ELSE                                                          
                  IF ^(UPS.SIVILSTAND = 'G' ! UPS.SIVILSTAND = 'A') THEN        
                     DO;                                                        
                        FEIL_FUNNET = '1'B;                                     
                        UPS.SIVILSTANDNR = 54;                                  
                        UPS.TILL_EKNR = 999;                                    
                     END;                                                       
              END;                                                              
            ELSE                                                                
               DO;                                                              
               IF (UPS.FNR_EK = 0 ! UPS.NAVN_EK = (25)' ') &                    
               (UPS.SIVILSTAND = 'G' ! UPS.SIVILSTAND = 'A') THEN               
                  DO;                                                           
                     FEIL_FUNNET = '1'B;                                        
                     UPS.FNR_EKNR = 18;                                         
                     UPS.NAVN_EKNR = 999;                                       
                     UPS.SIVILSTANDNR = 999;                                    
                  END;                                                          
               IF (UPS.FNR_EK = 0 ! UPS.NAVN_EK = (25)' ') &                    
               (UPS.SIVILSTAND = 'W') THEN                                      
                  DO;                                                           
                     FEIL_FUNNET = '1'B;                                        
                     UPS.FNR_EKNR = 390;                                        
                     UPS.NAVN_EKNR = 999;                                       
                     UPS.SIVILSTANDNR = 999;                                    
                  END;                                                          
               IF (UPS.FNR_EK = 0 ! UPS.NAVN_EK = (25)' ') &                    
               (UPS.SIVILSTAND = 'P') THEN                                      
                  DO;                                                           
                     FEIL_FUNNET = '1'B;                                        
                     UPS.FNR_EKNR = 391;                                        
                     UPS.NAVN_EKNR = 999;                                       
                     UPS.SIVILSTANDNR = 999;                                    
                  END;                                                          
              END;                                                              
         END;                                                                   
                                                                                
                                                                                
      IF UPS.NORSK_BOSATT = 'J' &                                               
         (UPS.VILKÅR_8_1 = 'J' ! UPS.VILKÅR_8_1 = ' ') THEN                     
         DO;                                                                    
            UPSP.TT_F67 = 1967 - ( FNR13.AAR + 16);                             
            IF (FNR13.AAR + 16) > 1967 THEN /* 2000-3 */                        
               DO;                                                              
                  UPSP.TT_F67 = 0;                                              
                  IF UFT_Å > 1966  &     /* 2000-3 */                           
                     UFT_Å >= (FNR13.AAR + 16) THEN                             
                     DO;                                                        
                                                                                
                        IF UFT_M < FNR.MND          THEN                        
                           DO;                                                  
                              UPSP.TT_E66_Å = UFT_Å -  /* 2000-3*/              
                                        (FNR13.AAR + 17);                       
                              UPSP.TT_E66_M = UFT_M -                           
                                          FNR.MND + 12;                         
                           END;                                                 
                        ELSE                                                    
                                                                                
                            DO;                                                 
                               UPSP.TT_E66_Å = UFT_Å - /* 2000-3 */             
                                         (FNR13.AAR + 16);                      
                               UPSP.TT_E66_M = UFT_M -                          
                                         FNR.MND;                               
                            END;                                                
                                                                                
                                                                                
                    END;                                                        
                 ELSE                                                           
                     DO;                                                        
                        UPSP.TT_E66_Å = 0;                                      
                        UPSP.TT_E66_M = 0;                                      
                     END;                                                       
              END;                                                              
            ELSE                                                                
               IF UFT_Å > 1966    THEN                                          
                  DO;                                                           
                     UPSP.TT_E66_Å = UFT_Å - 1967;                              
                     UPSP.TT_E66_M = UFT_M;                                     
                  END;                                                          
               ELSE                                                             
                   DO;                                                          
                      UPSP.TT_E66_Å = 0;                                        
                           UPSP.TT_E66_M = 0;                                   
                   END;                                                         
         END;                                                                   
   END KONTROLL_UP_SØKER;                                                       
                                                                                
                                                                                
  KONTROLL_YP:                                                                  
    PROC(FEIL_FUNNET);                                                          
                                                                                
   DCL FEIL_FUNNET   BIT(1);                                                    
                                                                                
                                                                                
    IF ^(UPY.VILKÅR_1_2_2A = 'J' ! UPY.VILKÅR_1_2_2A = ' ')                     
       THEN                                                                     
         DO;                                                                    
            FEIL_FUNNET   ='1'B;                                                
            UPY.VILKÅR_1_2_2ANR = 301;                                          
         END;                                                                   
                                                                                
                                                                                
    IF ^(UPY.VILKÅR_1_2_2B = 'J' ! UPY.VILKÅR_1_2_2B = ' ')                     
       THEN                                                                     
         DO;                                                                    
            FEIL_FUNNET   ='1'B;                                                
            UPY.VILKÅR_1_2_2BNR = 302;                                          
         END;                                                                   
                                                                                
    IF ^F_NUMERISK(F_FELT_PIC_CHAR8(UPY.YST_ÅMD)) THEN                          
       DO;                                                                      
          FEIL_FUNNET    = '1'B;                                                
          UPY.YST_ÅMDNR = 200;                                                  
       END;                                                                     
    ELSE                                                                        
       DO;                                                                      
        IF ^F_GYLDIG_DATO(UPY.YST_ÅMD) THEN                                     
           DO;                                                                  
              FEIL_FUNNET    = '1'B;                                            
              UPY.YST_ÅMDNR = 304;                                              
           END;                                                                 
        ELSE                                                                    
           IF UPY.YST_ÅMD  < 19710100 THEN    /* 2000 */                        
              DO;                                                               
                 FEIL_FUNNET    = '1'B;                                         
                 UPY.YST_ÅMDNR = 305;                                           
              END;                                                              
       END;                                                                     
                                                                                
    IF ^(UPY.YSYKDOM = 'J' ! UPY.YSYKDOM = 'N')                                 
       THEN                                                                     
         DO;                                                                    
            FEIL_FUNNET   ='1'B;                                                
            UPY.YSYKDOMNR = 306;                                                
         END;                                                                   
                                                                                
                                                                                
    IF ^F_NUMERISK(F_FELT_PIC_CHAR3(UPY.YUG)) THEN                              
       DO;                                                                      
          FEIL_FUNNET = '1'B;                                                   
          UPY.YUGNR = 200;                                                      
       END;                                                                     
    ELSE                                                                        
                                                                                
                                                                                
       IF UPY.YUG < 15 ! UPY.YUG > 100 THEN                                     
          DO;                                                                   
             FEIL_FUNNET = '1'B;                                                
             UPY.YUGNR = 307;                                                   
          END;                                                                  
                                                                                
 /* ********************************************************* */                
 /* VI SKAL GODTA BLANK I UFG, DERSOM 'J' I YSKADE_TILLEGG.   */                
 /* TRUDE 14.6.88                                             */                
 /* ********************************************************* */                
                                                                                
    /* ELSE                                 */                                  
    /*    IF (UPS.UFG < 50) &               */                                  
    /*       (UPY.YUG ^= UPS.UFG) THEN      */                                  
    /*       DO;                            */                                  
    /*          FEIL_FUNNET = '1'B;         */                                  
    /*          UPY.YUGNR = 311;            */                                  
    /*       END;                           */                                  
                                                                                
                                                                                
                                                                                
    IF ^(UPY.KAP_11_7_UTLØST = 'J' ! UPY.KAP_11_7_UTLØST = ' ')                 
        THEN                                                                    
         DO;                                                                    
            FEIL_FUNNET   ='1'B;                                                
            UPY.KAP_11_7_UTLØSTNR = 308;                                        
         END;                                                                   
                                                                                
                                                                                
    IF VERIFY(UPY.YRKE11,'FMUEVSA') ^= 0 THEN                                   
       DO;                                                                      
          FEIL_FUNNET = '1'B;                                                   
          UPY.YRKE11NR =  309 ;                                                 
       END;                                                                     
                                                                                
    IF ^F_NUMERISK(F_FELT_PIC_CHAR7(UPY.AÅI)) THEN                              
       DO;                                                                      
          FEIL_FUNNET = '1'B;                                                   
          UPY.AÅINR = 200 ;                                                     
       END;                                                                     
                                                                                
    IF F_FELT_PIC_CHAR11(UPY.FNR_EK) ^= (11) '0' THEN                           
       DO;                                                                      
          FEIL_FUNNET         = '1'B;                                           
          UPY.FNR_EKNR        = 315 ;                                           
       END;                                                                     
                                                                                
    IF F_FELT_PIC_CHAR11(UPY.FNR_SAMBOER) ^= (11) '0' THEN                      
       DO;                                                                      
          FEIL_FUNNET         = '1'B;                                           
          UPY.FNR_SAMBOERNR   = 315 ;                                           
       END;                                                                     
                                                                                
    IF F_FELT_PIC_CHAR11(UPY.FNR_Y_BARN) ^= (11) '0' THEN                       
       DO;                                                                      
          FEIL_FUNNET         = '1'B;                                           
          UPY.FNR_Y_BARNNR    =  315 ;                                          
       END;                                                                     
                                                                                
    IF UPY.PLEIEBARN ^= ' '  THEN                                               
       DO;                                                                      
          FEIL_FUNNET         = '1'B;                                           
          UPY.PLEIEBARNNR     = 315 ;                                           
       END;                                                                     
                                                                                
    IF ^FEIL_FUNNET THEN                                                        
       DO;                                                                      
                                                                                
          IF UPY.YST_ÅMD >           /* 2000-3 */                               
                          UPS.VIRK_DATO_ÅMD !                                   
             UPY.YST_ÅMD >                                                      
                           UPS.UFT_ÅMD THEN                                     
             DO;                                                                
                                                                                
  /* ********************************************************** */              
  /* FEIL,YSKADETIDSPUNKTET > VIRK ELLER > UFØRETIDSPUNKTET     */              
  /* PÅ KAP.8 - BLANKETTEN.  ERIK 6.7.87                        */              
  /* ********************************************************** */              
                                                                                
                FEIL_FUNNET    = '1'B;                                          
                UPY.YST_ÅMDNR  =  312 ;                                         
             END;                                                               
                                                                                
                                                                                
          IF UPY.KAP_11_7_UTLØST = 'J' &                                        
             UPY.YUG > 29              THEN                                     
             DO;                                                                
                                                                                
  /* ********************************************************** */              
  /* HVIS JA I ENGANGSUTLØST Y-PENSJON OG GRADEN      ER OVER   */              
  /* 29 PROSENT, SÅ AVVISES BLANKETTEN.                         */              
  /* ********************************************************** */              
                                                                                
                FEIL_FUNNET            = '1'B;                                  
                UPY.KAP_11_7_UTLØSTNR  =  313 ;                                 
                UPY.YUGNR              =  999 ;                                 
             END;                                                               
                                                                                
          IF UPY.KAP_11_7_UTLØST = 'J' &                                        
             UPS.UFG > 29              THEN                                     
             DO;                                                                
                                                                                
  /* ********************************************************** */              
  /* HVIS JA I ENGANGSUTLØST Y-PENSJON OG SAMLET GRAD ER OVER   */              
  /* 29 PROSENT, SÅ AVVISES BLANKETTEN.                         */              
  /* ********************************************************** */              
                                                                                
                FEIL_FUNNET            = '1'B;                                  
                UPY.KAP_11_7_UTLØSTNR  =  313 ;                                 
                UPY.YUGNR              =  999 ;                                 
             END;                                                               
                                                                                
                                                                                
                                                                                
          IF UPY.KAP_11_7_UTLØST = 'J' &                                        
             UPS.BT_ANT > 0            THEN                                     
             DO;                                                                
                                                                                
  /* ********************************************************** */              
  /* HVIS JA I ENGANGSUTLØST Y-PENSJON OG ANTALL BARN > 0 ,     */              
  /* SKAL BLANKETTEN AVVISES.   TRUDE                           */              
  /* ********************************************************** */              
                                                                                
                FEIL_FUNNET            = '1'B;                                  
                UPY.KAP_11_7_UTLØSTNR  =  329 ;                                 
                UPY.YUGNR              =  999 ;                                 
             END;                                                               
          /* HIT TRUDE */                                                       
                                                                                
                                                                                
          IF UPY.YRKE11    = 'F' &                                              
             UPY.AÅI      ^= 9999999 THEN                                       
             DO;                                                                
                                                                                
  /* ********************************************************** */              
  /* KODE F = FISKER.  INNTEKT SKAL IKKE OPPGIS FOR DISSE.      */              
  /* ********************************************************** */              
                                                                                
                FEIL_FUNNET     = '1'B;                                         
                UPY.AÅINR       =  314;                                         
                UPY.YRKE11NR    =  999;                                         
             END;                                                               
          ELSE                                                                  
             IF UPY.YRKE11    = 'A' &                                           
                UPY.AÅI       = 9999999 THEN                                    
                DO;                                                             
                                                                                
  /* ********************************************************** */              
  /* KODE A = ARBEIDSTAKER.  INNTEKT SKAL ALLTID OPPGIS.        */              
  /* ********************************************************** */              
                                                                                
                   FEIL_FUNNET     = '1'B;                                      
                   UPY.AÅINR       =  316;                                      
                   UPY.YRKE11NR    =  999;                                      
                END;                                                            
                                                                                
          IF (UPY.YRKE11    = 'E' !                                             
              UPY.YRKE11    = 'U' !                                             
              UPY.YRKE11    = 'V' !                                             
              UPY.YRKE11    = 'M' !                                             
              UPY.YRKE11    = 'S'   ) &                                         
              UPY.AÅI       = 9999999 THEN                                      
                                                                                
  /* ********************************************************** */              
  /* FOR YRKESKODENE E, U, V, M OG S KAN INNTEKT OPPGIS, MEN    */              
  /* DET ER IKKE NOE KRAV OM DETTE.  JEG ER IMIDLERTID NOE      */              
  /* USIKKER PÅ OM DETTE SKAL GJELDE FOR KODE S.  AVKLARES      */              
  /* SENERE.  ERIK 29.3.88.                                     */              
  /* ********************************************************** */              
                                                                                
             UPY.AÅI       = 0;                                                 
   /*************************************************************/              
   /* DERSOM UFG = 0, FLYTTES YUG INN I FELTET . TRUDE          */              
   /*************************************************************/              
                                                                                
          IF UPS.YSKADE_TILLEGG = 'J' THEN                                      
             DO;                                                                
               IF UPS.UFG      = 0 THEN                                         
                  UPS.UFG      = UPY.YUG;                                       
             END;                                                               
                                                                                
                                                                                
          IF  UPY.YUG  >  UPS.UFG THEN                                          
              DO;                                                               
                                                                                
  /* ********************************************************** */              
  /* UFØREGRADEN I KAP. 8 ER MINDRE ENN Y-UFG.  BLANKETTEN      */              
  /* SKAL FORKASTES.                                            */              
  /* 20.6.88 VI SKAL GODTA BLANK I UFØREGRADEN I KAP 8, DERSOM  */              
  /* 'J' I YSKADETILLEGG. TRUDE. (STJERNET UT  DENNE TEST)      */              
  /* TATT MED IGJEN JD 0197                                     */              
  /* ********************************************************** */              
                                                                                
                 FEIL_FUNNET     = '1'B;                                        
                 UPY.YUGNR       =  317 ;                                       
              END;                                                              
                                                                                
                                                                                
          IF ^(UPY.VILKÅR_1_2_2A   = ' '  !                                     
               UPY.VILKÅR_1_2_2B   = ' '  )  &                                  
               UPS.NORSK_BOSATT = 'J'  THEN                                     
             DO;                                                                
                                                                                
  /* ********************************************************** */              
  /* VILKÅR 1-2-2 ER UTFYLT.  PERSONEN ER DA IKKE BOSATT I      */              
  /* NORGE, MEN UP-BLANKETTEN ER KRYSSET AV MED JA I FELTET     */              
  /* NORSK BOSATT.  BLANKETTEN AVVISES.                         */              
  /* ********************************************************** */              
                                                                                
                FEIL_FUNNET        = '1'B;                                      
                UPY.VILKÅR_1_2_2ANR  = 318 ;                                    
                UPY.VILKÅR_1_2_2BNR  = 999 ;                                    
             END;                                                               
                                                                                
                                                                                
          ELSE                                                                  
             IF ^(UPY.VILKÅR_1_2_2A  = ' '  !                                   
                  UPY.VILKÅR_1_2_2B  = ' ' ) &                                  
                 (UPY.YUG    ^= UPS.UFG)   THEN                                 
                DO;                                                             
                                                                                
  /* ********************************************************** */              
  /* PERSONEN ER IKKE BOSATT I NORGE.  KAP. 8 GRADEN ER UNDER   */              
  /* 50 PROSENT, OG YRKEGRAD OG KAP. 8 GRADEN ER ULIK.          */              
  /* BLANKETTEN SKAL AVVISES.                                   */              
  /* ********************************************************** */              
                                                                                
                   FEIL_FUNNET          = '1'B;                                 
                   UPY.YUGNR            = 324 ;                                 
                   UPY.VILKÅR_1_2_2ANR  = 999 ;                                 
                   UPY.VILKÅR_1_2_2BNR  = 999 ;                                 
                END;                                                            
       END;                                                                     
                                                                                
    END KONTROLL_YP;                                                            
                                                                                
