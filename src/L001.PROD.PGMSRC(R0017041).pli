 /*   SIST ENDRET PÅ PROD   2008.11.05 16.23.44 AV   SPA2990          */        
 /*   SIST ENDRET PÅ PROD   2007.12.21 12.20.20 AV   JDA2990          */        
 /*   SIST ENDRET PÅ PROD   2004.06.18 12.24.24 AV   SPA2970          */        
 /*   SIST ENDRET PÅ TEST   2004.05.03 12.32.14 AV   JDA2970          */        
 /*   SIST ENDRET PÅ QASS   2003.11.19  9.11.45 AV   JDA2970          */        
 /*   SIST ENDRET PÅ TEST   2003.11.19  9.09.29 AV   JDA2970          */        
 /*   SIST ENDRET PÅ QASS   2003.06.26  8.34.02 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2002.04.24 12.44.20 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2002.04.19 12.28.59 AV   JDA2970          */        
 /*   SIST ENDRET PÅ PROD   2001.04.05 10.02.08 AV   JDA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.12.12 14.17.57 AV   JDA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.11.21 14.03.30 AV   JDA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.09.15 11.09.01 AV   HLA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.07.11 13.56.13 AV   JDA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.07.07 13.01.12 AV   JDA7339          */        
 /*   SIST ENDRET PÅ PROD   2000.05.23 13.09.02 AV   JDA7339          */        
 /*       SIST ENDRET 05/05-99 08.12.32 AV   JDA7339                  */        
 /*       SIST ENDRET 05/05-99 08.09.41 AV   JDA7339                  */        
 /*       SIST ENDRET 26/03-99 13.25.34 AV   JDA7339                  */        
 /*       SIST ENDRET 26/02-99 09.13.13 AV   JDA7339                  */        
 /*       SIST ENDRET 18/12-98 12.12.32 AV   JDA7339                  */        
 /*       SIST ENDRET 18/12-98 12.09.21 AV   JDA7339                  */        
 /*       SIST ENDRET 04/05-98 13.15.40 AV   JDA7339                  */        
 /*       SIST ENDRET 11/03-98 12.05.59 AV   JDA7339                  */        
 /* **************************************************************** */         
 /*IDENTIFIKASJON:                                                   */         
 /*    R0017041 - PROSEDYRE I PLI                                    */         
 /*    PROGRAMMERER: JAN, DESEMBER 82                                */         
 /*HENSIKT:                                                          */         
 /*    RUTINEN SETTER INN KODER FOR TEKSTTYPE A I TEKSTTABELLEN      */         
 /*    FOR STØNADSBREV                                               */         
 /*    TEKSTTYPE A FORTELLER HVORFOR STØNADSBREVET ER SKREVET        */         
 /*PROGRAMTILKNYTNING:                                               */         
 /*    KALLES OPP AV : PLASSER_TEKST (PROSEDYRE I R0017001)          */         
 /*                                                                  */         
 /*    INCLUDES I R0017001                                           */         
 /*BRUK:                                                             */         
 /*   CALL PLASSER_TEKSTTYPE_A_KODE(IND)                             */         
 /* **************************************************************** */         
 PLASSER_TEKSTTYPE_A_KODE: PROC(IND,IND_EK);                                    
    DCL                                                                         
        IND_EK                  FIXED BIN (15),                                 
        IND                     FIXED BIN (15),                                 
        ALDER_EK                FIXED DEC (5),                                  
        FIXEDFEM                FIXED DEC (5) INIT(0),                          
        W_EK_FNR13              PIC '(13)9',                                    
        F_NUM13                 PIC '(13)9',                                    
        F_AAR DEF F_NUM13 POS(5)PIC '( 4)9',                                    
        GRUNNBELØPSDATO         PIC '( 8)9',                                    
        VIRKNINGSDATO           PIC '( 8)9',                                    
        FINNT1                  FIXED DEC (5) INIT(0),                          
        FINNT2                  FIXED DEC (5) INIT(0),                          
        FF_EØS1                 BIT (1) ALIGNED,                                
        FF_EØS2                 BIT (1) ALIGNED,                                
        G_FØR                   FIXED DEC (5) INIT(0),                          
        G_NÅ                    FIXED DEC (5) INIT(0);                          
    /* ============================================================== */        
    /* START UNDERMODUL 7041                                          */        
    /* ============================================================== */        
                                                                                
    TEKSTTYPE_A_KODE = '    ';                                                  
    W_EK_FNR13       = KONV_FNR11_FNR13((B02.FNR(IND_EK)));                     
    F_NUM13          = KONV_FNR11_FNR13((B02.FNR(IND)));                        
 /* ALDER_EK    = F_ALDER(W_EK_FNR,TRANS_OPPL_OMR.VIRKNINGSDATO_ÅMD); */        
 ALDER_EK = F_ALDER((B02.FNR(IND_EK)),TRANS_OPPL_OMR.VIRKNINGSDATO_ÅMD);        
    DO I = 1 TO 65                                                              
             UNTIL(PERIODE_START_ÅMD(I) >= B02.VIRK_DATO_ÅMD (IND));            
    END;                                                                        
                                                                                
    /* 051199 MH: GRUNNBELØPSDATO LÅ INNE MED 01 VIRK HAR 00      */            
    GRUNNBELØPSDATO= PERIODE_START_ÅMD(I) - 1;                                  
    VIRKNINGSDATO  = B02.VIRK_DATO_ÅMD(IND);                                    
    FINNT1         = B01.ETTEPENS.FORVENTET(IND);                               
    FINNT2         = B02.ETTEPENS.FORVENTET(IND);                               
    IF B01.G_DATO_ÅMD(IND) > 0 THEN                                             
       DO;  /* DETTE ER JUKS OG BEDRAG FOR Å LURE SYSTEMET */                   
          CALL RULL_FORVENTET(B02.G_DATO_ÅMD(IND),                              
                              B01.G_DATO_ÅMD(IND),                              
                              B02.ETTEPENS.FORVENTET(IND));                     
          FIXEDFEM = B02.ETTEPENS.FORVENTET(IND);                               
          B02.ETTEPENS.FORVENTET(IND) = FINNT2;                                 
       END; /* DETTE ER JUKS OG BEDRAG FOR Å LURE SYSTEMET */                   
    /* FF_EØS STÅR FOR FRADRAG F ETTER EØS REGLER */                            
    IF B01.INNT_PRØVET_EØS_PENS(IND_EK) = 'J' THEN                              
       FF_EØS1 = '1'B;                                                          
    ELSE                                                                        
       FF_EØS1 = '0'B;                                                          
    IF B02.INNT_PRØVET_EØS_PENS(IND_EK) = 'J' THEN                              
       FF_EØS2 = '1'B;                                                          
    ELSE                                                                        
       FF_EØS2 = '0'B;                                                          
                                                                                
    IF (IND > 2      !                                                          
        IND = SB_IND )   THEN                                                   
       SELECT (TRANS_OPPL_OMR.TRANSTYPE);                                       
                                                                                
 /* ***************************************************************** */        
 /* TEKST A SKRIVES PGA REGISTRERT GRUNNBLANKETT                      */        
 /* ***************************************************************** */        
                                                                                
                                                                                
         WHEN(1)                                                                
            DO;                                                                 
 /* ***************************************************************** */        
 /* GRUNNBLANKETT - SØKNAD OM ALDERSPENSJON                           */        
 /* A510 : OPPTJENINGSTIDEN ER ØKET OG PENSJONEN ER ØKET              */        
 /* A511 : OPPTJENINGSTIDEN ER ØKET MEN PENSJONEN ER IKKE ØKET        */        
 /* PRO_RATA_BEREGNING = A : EØS-BEREGNING VED KONVERTERING UP->AP    */        
 /* PRO_RATA_BEREGNING = B : NORSK BER.    VED KONVERTERING UP->AP    */        
 /* PRO_RATA_BEREGNING = C : NORSK BEREGNING - DET VAR 'A' FØR        */        
 /* PRO_RATA_BEREGNING = D : NORSK BEREGNING - SOM VAR 'B' FØR        */        
 /* ***************************************************************** */        
                                                                                
                IF B02.PRO_RATA_BEREGNING(IND) ^= ' '     THEN                  
                   DO;                                                          
                      IF  B01.PRO_RATA_BEREGNING(IND) ^=                        
                          B02.PRO_RATA_BEREGNING(IND)        THEN               
                           TEKSTTYPE_A_KODE = 'A510';                           
                      ELSE                                                      
                      IF  B02.PRO_RATA_BEREGNING(IND) = 'J'  THEN               
                          TEKSTTYPE_A_KODE = 'A001'; /*200009*/                 
                      ELSE                                                      
                           TEKSTTYPE_A_KODE = 'A511';                           
                   END;                                                         
                ELSE                                                            
                          TEKSTTYPE_A_KODE = 'A001';                            
            END;                                                                
 /*AFP*/ WHEN(40)                                                               
 /*AFP*/    DO;  /* GRUNNBLANKETT AFP */                                        
               IF (B02.PENSJONSTYPE1(IND) = 'K'         ) &                     
                  (DIV_PARAM_OMR.AP_KODE_AEY(IND) = 'W' !                       
                   DIV_PARAM_OMR.AP_KODE_AEY(IND) = 'P' ) THEN                  
                  TEKSTTYPE_A_KODE = 'A202';                                    
                ELSE                                                            
                IF (B01.PENSJONSTYPE2(IND) ^= ' '   &                           
                    B01.PENSJONSTYPE2(IND) ^= 'N' ) &                           
                   (B02.PENSJONSTYPE3(IND)  = 'S'   &                           
                    B02.PENSJONSTYPE2(IND)  = 'N' ) THEN                        
                  /* TEST A250 JD 09.93 */                                      
                       TEKSTTYPE_A_KODE = 'A250';                               
                ELSE                                                            
         /* TEST A218 JD 10.97 */                                               
         /* SUM YTELSE ENDRET TIL IND_EK 1297 JD */                             
                IF (B01.SUM_YTELSE(IND_EK) ^=                                   
                    B02.SUM_YTELSE(IND_EK)        ) &                           
                   (B02.PENSJONSTYPE2(IND)  = 'S'   &                           
                    B02.PENSJONSTYPE2(IND_EK) = 'P' ) THEN                      
                       TEKSTTYPE_A_KODE = 'A018';                               
                ELSE                                                            
                       TEKSTTYPE_A_KODE = 'A201';                               
            END;                                                                
                                                                                
         WHEN(6)                                                                
                                                                                
            DO;  /* WHEN TRANSTYPE = 6 */                                       
 /* ***************************************************************** */        
 /* EK-TILL. ENDRES P.G.A INNTEKTSPRØVET PENSJON FRA ET ANNET EØS-LAND*/        
 /* (12.98 JD)                                                        */        
 /* ***************************************************************** */        
                                                                                
              IF (B01.INNT_PRØVET_EØS_PENS(IND) ^= 'J'   &                      
                  B02.INNT_PRØVET_EØS_PENS(IND)  = 'J')  &                      
                 (B01.ALDERSP.ET(IND) + B01.UFØRPENS.ET(IND) = 0 &              
                  B01.PENSJONSTYPE2(IND)               = 'F'     &              
                  B02.ALDERSP.ET(IND) + B02.UFØRPENS.ET(IND) > 0) THEN          
                       TEKSTTYPE_A_KODE = 'A501';                               
              ELSE                                                              
              IF (B01.INNT_PRØVET_EØS_PENS(IND) ^= 'J'   &                      
                  B02.INNT_PRØVET_EØS_PENS(IND)  = 'J')  &                      
                 (B01.ALDERSP.ET(IND) + B01.UFØRPENS.ET(IND) > 0 &              
                  B02.ALDERSP.ET(IND) + B02.UFØRPENS.ET(IND) > 0) THEN          
                       TEKSTTYPE_A_KODE = 'A502';                               
              ELSE                                                              
              IF (B01.INNT_PRØVET_EØS_PENS(IND)  = 'J'   &                      
                  B02.INNT_PRØVET_EØS_PENS(IND) ^= 'J')  &                      
                 (B01.ALDERSP.ET(IND) + B01.UFØRPENS.ET(IND) > 0 &              
                  B02.ALDERSP.ET(IND) + B02.UFØRPENS.ET(IND) > 0) THEN          
                       TEKSTTYPE_A_KODE = 'A503';                               
              ELSE                                                              
              IF (B01.INNT_PRØVET_EØS_PENS(IND)  = 'J'   &                      
                  B02.INNT_PRØVET_EØS_PENS(IND) ^= 'J')  &                      
                 (B01.ALDERSP.ET(IND) + B01.UFØRPENS.ET(IND) > 0 &              
                  B02.ALDERSP.ET(IND) + B02.UFØRPENS.ET(IND) = 0) THEN          
                       TEKSTTYPE_A_KODE = 'A504';                               
              ELSE                                                              
 /* ***************************************************************** */        
 /* FORHØYET SÆRTILLEGG FOR PENSJONISTER MED FORS. EK OVER 60 ÅR      */        
 /* ***************************************************************** */        
                                                                                
     /* JFA 3.3. OG 14.6.2000  NY VERSJON NEDENFOR    */                        
     /*        IF (B02.PENSJONSTYPE2(IND) = 'F'     &                           
                  (B02.ALDERSP.ST   (IND) > 0       !                           
                   B02.UFØRPENS.ST  (IND) > 0  )    &                           
                 ((B02.VIRK_DATO_ÅMD (IND) = 19890400   &                       
                   ALDER_EK               >= 6000)  !                           
                  (B02.VIRK_DATO_ÅMD (IND) > 19890400   &                       
                   ALDER_EK                = 6000))) THEN                       
                          TEKSTTYPE_A_KODE = 'A110';                            
               ELSE                            */                               
                                                                                
               IF ( B02.PENSJONSTYPE2(IND) = 'F'             &                  
                   (B02.ALDERSP.ST   (IND)    +                                 
                    B02.UFØRPENS.ST  (IND)    >  0)          &                  
                                                                                
                  ((ALDER_EK        = 6000                   &                  
                    B02.VIRK_DATO_ÅMD (IND) >= 19890300      &                  
                    B02.VIRK_DATO_ÅMD (IND) <  19910000  )   !                  
                   (ALDER_EK        = 6001                   &                  
                    B02.VIRK_DATO_ÅMD (IND) >  19910000  ))) THEN               
                          TEKSTTYPE_A_KODE = 'A110';                            
               ELSE                                                             
                                                                                
                                                                                
 /* ***************************************************************** */        
 /* GRUNNBLANKETT - SØKNAD OM FORSØRGINGSTILLEGG                      */        
 /* ***************************************************************** */        
                                                                                
               IF B01.ALDERSP.ET(IND) = 0 &                                     
                  B01.GARANTITILLEGG_EK(IND) = 0 &                              
                  B01.UFØRPENS.ET(IND) = 0 THEN                                 
                  DO;  /* HAR IKKE EKTEFELLETILLEGG FRA FØR */                  
                     IF B01.ANTALL_BARN(IND) = 0 THEN                           
                        DO; /* HAR IKKE BARNETILLEGG FRA FøR */                 
                           IF B02.ALDERSP.ET(IND) > 0 !                         
                              B02.GARANTITILLEGG_EK( IND) > 0 !                 
                              B02.UFØRPENS.ET(IND) > 0 THEN                     
                              DO;  /* ER TILSTÅTT EKTETFELLETILLEGG */          
                                 IF B02.ANTALL_BARN(IND) > 0 &                  
                                   (B02.YRKEPENS.BT(IND) > 0   !                
                                    B02.UFØRPENS.BT(IND) > 0   !                
                                    B02.ALDERSP .BT(IND) > 0   !                
                                    B02.GARANTITILLEGG_BARN(IND) > 0 !          
                                    B02.FORSI.BT_SÆRBARN(IND) > 0) THEN         
                                    /* OGSÅ TILSTÅTT BARNETILLEGG */            
                                    TEKSTTYPE_A_KODE = 'A021';                  
                                 ELSE                                           
                                    /* IKKE TILSTÅTT BARNETILLEGG */            
                                    TEKSTTYPE_A_KODE = 'A019';                  
                              END; /* ER TILSTÅTT EKTETFELLETILLEGG */          
                           ELSE  /* IKKE TILSTÅTT EKTEFELLETILLEGG */           
                                 IF B02.ANTALL_BARN(IND) > 0 &                  
                                   (B02.YRKEPENS.BT(IND) > 0   !                
                                    B02.UFØRPENS.BT(IND) > 0   !                
                                    B02.ALDERSP .BT(IND) > 0   !                
                                    B02.GARANTITILLEGG_BARN(IND) > 0 !          
                                    B02.FORSI.BT_SÆRBARN(IND) > 0) THEN         
                                        TEKSTTYPE_A_KODE = 'A020';              
                        END;/* HAR IKKE BARNETILLEGG FRA FøR */                 
                     ELSE                                                       
                        DO;                                                     
                                                                                
 /* ***************************************************************** */        
 /* HAR FORSØRGINGSTI_ÅMDLLEGG FOR BARN FRA FØR                       */        
 /* ***************************************************************** */        
                                                                                
                           IF B02.ALDERSP.ET(IND) > 0 !                         
                              B02.GARANTITILLEGG_EK( IND) > 0 !                 
                              B02.UFØRPENS.ET(IND) > 0 THEN                     
                              DO;                                               
                                                                                
 /* ***************************************************************** */        
 /* ER TILSTÅTT EKTEFELLE-TILLEGG                                     */        
 /* ***************************************************************** */        
                                                                                
                                 IF B02.ANTALL_BARN(IND) > 0 &                  
                                   (B02.YRKEPENS.BT(IND) > 0   !                
                                    B02.UFØRPENS.BT(IND) > 0   !                
                                    B02.ALDERSP .BT(IND) > 0   !                
                                    B02.GARANTITILLEGG_BARN(IND) > 0 !          
                                    B02.FORSI.BT_SÆRBARN(IND) > 0) THEN         
                                 IF B02.ANTALL_BARN(IND) >                      
                                    B01.ANTALL_BARN(IND) THEN                   
                                                                                
 /* ***************************************************************** */        
 /* ER TILSTÅTT BARNETILLEGG FOR FLERE BARN                           */        
 /* ***************************************************************** */        
                                                                                
                                        TEKSTTYPE_A_KODE = 'A021';              
                                 ELSE                                           
                                        TEKSTTYPE_A_KODE = 'A019';              
                              END;                                              
                           ELSE                                                 
                                                                                
 /* ***************************************************************** */        
 /* VI ANTAR DET ER TILSTÅTT BARNETILLEGG FOR FLERE BARN              */        
 /* ***************************************************************** */        
                                                                                
                                 IF B02.ANTALL_BARN(IND) > 0 &                  
                                   (B02.YRKEPENS.BT(IND) > 0   !                
                                    B02.UFØRPENS.BT(IND) > 0   !                
                                    B02.ALDERSP .BT(IND) > 0   !                
                                    B02.GARANTITILLEGG_BARN(IND) > 0 !          
                                    B02.FORSI.BT_SÆRBARN(IND) > 0) THEN         
                                        TEKSTTYPE_A_KODE = 'A020';              
                        END;                                                    
                  END;                                                          
               ELSE                                                             
                  DO;  /* SØKEREN HAR EKTEFELLETILLEGG FRA FØR */               
                     IF (B02.ALDERSP.ET(IND)        = 0 &                       
                         B02.GARANTITILLEGG_EK(IND) = 0 &                       
                         B02.UFØRPENS.ET(IND)       = 0 ) THEN                  
                        /* EKTEFELLETILLEGGET ER BORTFALT */                    
                        TEKSTTYPE_A_KODE = 'A022';                              
                     ELSE                                                       
                     IF B02.ANTALL_BARN(IND) > 0 &                              
                       (B02.YRKEPENS.BT(IND) > 0   !                            
                        B02.UFØRPENS.BT(IND) > 0   !                            
                        B02.ALDERSP .BT(IND) > 0   !                            
                        B02.GARANTITILLEGG_BARN(IND) > 0 !                      
                        B02.FORSI.BT_SÆRBARN(IND) > 0) THEN                     
                       IF B02.ANTALL_BARN(IND) >                                
                          B01.ANTALL_BARN(IND) THEN                             
                          /* DU FÅR FORSØRGINGSTILLEGG FOR X BARN */            
                          TEKSTTYPE_A_KODE = 'A020';                            
                  /* ELSE */                                                    
                                                                                
 /* ***************************************************************** */        
 /* KAN IKKE FINNE NOEN ENDRING, OG SIER DERFOR AT DET ER TILSTÅTT    */        
 /* EKTEFELLETILLEGG   (FJERNET JFR FEILRAPP 449 J.D 05.02.87)        */        
 /* ***************************************************************** */        
                                                                                
                           /*           TEKSTTYPE_A_KODE = 'A019'  */           
                  END;                                                          
                                                                                
 /* ***************************************************************** */        
 /* NÅR DET REGISTRERES F7 BLANKETT DER BARE INNTEKT ENDRES SKAL      */        
 /* TEKST A115 SKRIVES (JD 09.09.91 )                                 */        
 /* ***************************************************************** */        
                                                                                
              IF  B01.ANTALL_BARN (IND) = B02.ANTALL_BARN (IND) &               
                 (B01.PENSJONSTYPE2(IND) =                                      
                  B02.PENSJONSTYPE2(IND))                       &               
                 (B01.PENSJONSINNTEKT_EK(IND)                                   
               +  B01.PENSJONSINNTEKT(IND)                                      
               +  B01.ARBEIDSINNTEKT_EK(IND)                                    
               +  B01.ARBEIDSINNTEKT(IND))   ^=                                 
                 (B02.PENSJONSINNTEKT_EK(IND)                                   
               +  B02.PENSJONSINNTEKT(IND)                                      
               +  B02.ARBEIDSINNTEKT_EK(IND)                                    
               +  B02.ARBEIDSINNTEKT(IND))     THEN                             
                                        TEKSTTYPE_A_KODE = 'A115';              
                                                                                
                                                                                
 /* ***************************************************************** */        
 /* TEKST A121 SKRIVES NÅR DET ER GARANTITILLEGG OG VIRK-DATO = 9105  */        
 /*                     JD 06.02.95 )                                 */        
 /* ***************************************************************** */        
                                                                                
              IF  B02.VIRK_DATO_ÅMD(IND) = 19910500 &                           
                 (B02.FORSI.GARANTITILLEGG_EK(IND)                              
               +  B02.FORSI.GARANTITILLEGG_BARN(IND)                            
               +  B02.FORSI.BT_SÆRBARN         (IND)                            
               +  B02.UFØRPENS.BT              (IND)                            
               +  B02.UFØRPENS.ET              (IND)                            
               +  B02.YRKEPENS.BT              (IND)                            
               +  B02.YRKEPENS.ET              (IND)                            
               +  B02.ALDERSP.BT              (IND)                             
               +  B02.ALDERSP.ET               (IND)                            
               +  B02.FORSI.GARANTITILLEGG_SÆRBARN(IND) > 0 )  THEN             
                                        TEKSTTYPE_A_KODE = 'A121';              
                                                                                
                                                                                
 /* ***************************************************************** */        
 /* NÅR UP OG F7 REGISTRERES PÅ SAMME DAG MED SAMME VIRK-DATO SKAL    */        
 /* TEKST A002 SKRIVES (JD 03.09.91 )                                 */        
 /* ***************************************************************** */        
                                                                                
                                                                                
              IF (B01.VIRK_DATO_ÅMD(IND) = B02.VIRK_DATO_ÅMD(IND) &             
                  W_HENDELSE.VERSJON ^= 001                     &               
                  B02.PENSJONSTYPE1(IND) = 'U')                 &               
                 (B01.ANTALL_BARN(IND) ^= B02.ANTALL_BARN (IND) !               
                  B01.UFØRPENS.ET(IND) + B01.YRKEPENS.ET (IND) ^=               
                  B02.UFØRPENS.ET(IND) + B02.YRKEPENS.ET (IND)  !               
                  B01.GARANTITILLEGG_SÆRBARN(IND) ^=                            
                  B02.GARANTITILLEGG_SÆRBARN(IND)               !               
                  B01.GARANTITILLEGG_BARN(IND) ^=                               
                  B02.GARANTITILLEGG_BARN(IND)                  !               
                  B01.GARANTITILLEGG_EK  (IND) ^=                               
                  B02.GARANTITILLEGG_EK  (IND)                  !               
                  B01.BT_SÆRBARN(IND) ^=                                        
                  B02.BT_SÆRBARN(IND)                           !               
                  B01.PENSJONSINNTEKT_EK(IND) ^=                                
                  B02.PENSJONSINNTEKT_EK(IND)                   !               
                  B01.PENSJONSINNTEKT(IND) ^=                                   
                  B02.PENSJONSINNTEKT(IND)                      !               
                  B01.ARBEIDSINNTEKT_EK(IND) ^=                                 
                  B02.ARBEIDSINNTEKT_EK(IND)                    !               
                  B01.ARBEIDSINNTEKT(IND) ^=                                    
                  B02.ARBEIDSINNTEKT(IND))      THEN                            
                                        TEKSTTYPE_A_KODE = 'A002';              
                                                                                
 /* ***************************************************************** */        
 /* NÅR YP OG F7 REGISTRERES PÅ SAMME DAG MED SAMME VIRK-DATO SKAL    */        
 /* TEKST A301 SKRIVES (JD 01.04.93 )                                 */        
 /* ***************************************************************** */        
                                                                                
              IF (B01.VIRK_DATO_ÅMD(IND) = B02.VIRK_DATO_ÅMD(IND) &             
                  W_HENDELSE.VERSJON ^= 001                     &               
                  B02.PENSJONSTYPE1(IND) = 'Y')                 &               
                 (B01.ANTALL_BARN(IND) ^= B02.ANTALL_BARN (IND) !               
                  B01.UFØRPENS.ET(IND) + B01.YRKEPENS.ET (IND) ^=               
                  B02.UFØRPENS.ET(IND) + B02.YRKEPENS.ET (IND)  !               
                  B01.GARANTITILLEGG_SÆRBARN(IND) ^=                            
                  B02.GARANTITILLEGG_SÆRBARN(IND)               !               
                  B01.GARANTITILLEGG_BARN(IND) ^=                               
                  B02.GARANTITILLEGG_BARN(IND)                  !               
                  B01.GARANTITILLEGG_EK  (IND) ^=                               
                  B02.GARANTITILLEGG_EK  (IND)                  !               
                  B01.BT_SÆRBARN(IND) ^=                                        
                  B02.BT_SÆRBARN(IND)                           !               
                  B01.PENSJONSINNTEKT_EK(IND) ^=                                
                  B02.PENSJONSINNTEKT_EK(IND)                   !               
                  B01.PENSJONSINNTEKT(IND) ^=                                   
                  B02.PENSJONSINNTEKT(IND)                      !               
                  B01.ARBEIDSINNTEKT_EK(IND) ^=                                 
                  B02.ARBEIDSINNTEKT_EK(IND)                    !               
                  B01.ARBEIDSINNTEKT(IND) ^=                                    
                  B02.ARBEIDSINNTEKT(IND))      THEN                            
                                        TEKSTTYPE_A_KODE = 'A301';              
                                                                                
 /* ***************************************************************** */        
 /* NÅR YPAOG F7 REGISTRERES PÅ SAMME DAG MED SAMME VIRK-DATO SKAL    */        
 /* TEKST A401 SKRIVES (JD    04.99 )                                 */        
 /* ***************************************************************** */        
                                                                                
              IF (B01.VIRK_DATO_ÅMD(IND) = B02.VIRK_DATO_ÅMD(IND) &             
                  W_HENDELSE.VERSJON ^= 001                     &               
                  B02.PENSJONSTYPE1(IND) = 'Y'                  &               
                  B02.PENSJONSTYPE3(IND) = 'A')                 &               
                 (B01.ANTALL_BARN(IND) ^= B02.ANTALL_BARN (IND) !               
                  B01.UFØRPENS.ET(IND) + B01.YRKEPENS.ET (IND) ^=               
                  B02.UFØRPENS.ET(IND) + B02.YRKEPENS.ET (IND)  !               
                  B01.GARANTITILLEGG_SÆRBARN(IND) ^=                            
                  B02.GARANTITILLEGG_SÆRBARN(IND)               !               
                  B01.GARANTITILLEGG_BARN(IND) ^=                               
                  B02.GARANTITILLEGG_BARN(IND)                  !               
                  B01.GARANTITILLEGG_EK  (IND) ^=                               
                  B02.GARANTITILLEGG_EK  (IND)                  !               
                  B01.BT_SÆRBARN(IND) ^=                                        
                  B02.BT_SÆRBARN(IND)                           !               
                  B01.PENSJONSINNTEKT_EK(IND) ^=                                
                  B02.PENSJONSINNTEKT_EK(IND)                   !               
                  B01.PENSJONSINNTEKT(IND) ^=                                   
                  B02.PENSJONSINNTEKT(IND)                      !               
                  B01.ARBEIDSINNTEKT_EK(IND) ^=                                 
                  B02.ARBEIDSINNTEKT_EK(IND)                    !               
                  B01.ARBEIDSINNTEKT(IND) ^=                                    
                  B02.ARBEIDSINNTEKT(IND))      THEN                            
                                        TEKSTTYPE_A_KODE = 'A401';              
 /* ***************************************************************** */        
 /* NÅR AP OG F7 REGISTRERES PÅ SAMME DAG MED SAMME VIRK-DATO SKAL    */        
 /* TEKST A001 SKRIVES (JD 03.10.91 )                                 */        
 /* ***************************************************************** */        
                                                                                
              IF (B01.VIRK_DATO_ÅMD(IND) = B02.VIRK_DATO_ÅMD(IND) &             
                  W_HENDELSE.VERSJON ^= 001                     &               
                  B02.PENSJONSTYPE1(IND) = 'A')                 &               
                 (B01.ANTALL_BARN(IND) ^= B02.ANTALL_BARN (IND) !               
                  B01.ALDERSP.ET(IND)  ^=                                       
                  B02.ALDERSP.ET(IND)                          !                
                  B01.GARANTITILLEGG_SÆRBARN(IND) ^=                            
                  B02.GARANTITILLEGG_SÆRBARN(IND)               !               
                  B01.GARANTITILLEGG_BARN(IND) ^=                               
                  B02.GARANTITILLEGG_BARN(IND)                  !               
                  B01.GARANTITILLEGG_EK  (IND) ^=                               
                  B02.GARANTITILLEGG_EK  (IND)                  !               
                  B01.BT_SÆRBARN(IND) ^=                                        
                  B02.BT_SÆRBARN(IND)                           !               
                  B01.PENSJONSINNTEKT_EK(IND) ^=                                
                  B02.PENSJONSINNTEKT_EK(IND)                   !               
                  B01.PENSJONSINNTEKT(IND) ^=                                   
                  B02.PENSJONSINNTEKT(IND)                      !               
                  B01.ARBEIDSINNTEKT_EK(IND) ^=                                 
                  B02.ARBEIDSINNTEKT_EK(IND)                    !               
                  B01.ARBEIDSINNTEKT(IND) ^=                                    
                  B02.ARBEIDSINNTEKT(IND))      THEN                            
                                        TEKSTTYPE_A_KODE = 'A001';              
                                                                                
 /* ***************************************************************** */        
 /* NÅR OPPHØR EK-TILL(O2) OG F7 REGISTRERES SAMME DAG MED SAMME VIRK-*/        
 /* DATO SKAL TEKST A045 SKRIVES (JD 10.10.91 )                                 
 /* ***************************************************************** */        
    /* JFA 14.2.2000    */                                                      
              IF (B01.VIRK_DATO_ÅMD(IND) ^= B02.VIRK_DATO_ÅMD(IND) &            
                  W_HENDELSE.VERSJON ^= 001                     &               
                  B02.PENSJONSTYPE1(IND) = 'U' )                &               
                 (B01.UFØRPENS.ET(IND) + B01.YRKEPENS.ET (IND) > 0 &            
                  B02.UFØRPENS.ET(IND) + B02.YRKEPENS.ET (IND) = 0) /* !        
                  B01.PENSJONSINNTEKT_EK(IND) ^=                                
                  B02.PENSJONSINNTEKT_EK(IND)                   !               
                  B01.ARBEIDSINNTEKT_EK(IND) ^=                                 
                  B02.ARBEIDSINNTEKT_EK(IND)                    &               
                  B02.PENSJONSTYPE2(IND) = 'P'                  &               
                  B01.PENSJONSTYPE2(IND) = 'F'   */  THEN                       
   /* 11.5.00 JFA TEST SKAL VÆRE 045 */ TEKSTTYPE_A_KODE = 'A045';              
                                                                                
    /* JFA TATT BORT STJERNA 11.2.2000                                          
              IF (B01.VIRK_DATO_ÅMD(IND) ^= B02.VIRK_DATO_ÅMD(IND) &            
                  W_HENDELSE.VERSJON ^= 001                     &               
                  B02.PENSJONSTYPE2(IND) = 'P'            &                     
                  B01.PENSJONSTYPE2(IND) = 'F'  )    THEN                       
                                        TEKSTTYPE_A_KODE = 'A045';  */          
                                                                                
 /* ***************************************************************** */        
 /* NÅR AFP   F7 REGISTRERES PÅ SAMME DAG MED SAMME VIRK-DATO SKAL    */        
 /* TEKST A201 SKRIVES (JD 17.09.93 )                                 */        
 /* ***************************************************************** */        
                                                                                
              IF B01.VIRK_DATO_ÅMD(IND) = B02.VIRK_DATO_ÅMD(IND) &              
                  W_HENDELSE.VERSJON ^= 001                     &               
                  B02.PENSJONSTYPE1(IND) = 'K'            THEN                  
                  IF (DIV_PARAM_OMR.AP_KODE_AEY(IND) = 'W' !                    
                      DIV_PARAM_OMR.AP_KODE_AEY(IND) = 'P' ) THEN               
                     TEKSTTYPE_A_KODE = 'A202';                                 
                  ELSE                                                          
                       TEKSTTYPE_A_KODE = 'A201';                               
                                                                                
            END; /* WHEN TRANSTYPE = 6 */                                       
                                                                                
                                                                                
         WHEN(2)                                                                
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* GRUNNBLANKETT - SØKNAD OM UFØREPENSJON                            */        
 /* ***************************************************************** */        
                                                                                
               IF (B02.PENSJONSTYPE1(IND) = 'Y') &                              
                  (B02.PENSJONSTYPE3(IND) = 'A') &                              
                  (B02.YRKEPENS.YUG(IND) = B02.UFØRPENS.UFG(IND)) THEN          
                      TEKSTTYPE_A_KODE = 'A401';                                
               ELSE                                                             
               IF B02.PENSJONSTYPE1(IND) = 'Y' &                                
                  B02.PENSJONSTYPE3(IND) = 'A' THEN                             
                      TEKSTTYPE_A_KODE = 'A602';                                
               ELSE                                                             
               IF B02.PENSJONSTYPE1(IND) = 'Y' &                                
                  B02.PENSJONSTYPE3(IND) = ' ' THEN                             
                      TEKSTTYPE_A_KODE = 'A301';                                
               ELSE                                                             
               IF (B01.UFØRPENS.UFG(IND) = 0)        !                          
                      (B01.STATUS_KODE_HIST(IND)  = 'X') !                      
                       (B01.STATUS_KODE_HIST(IND)  = 'O')       THEN            
                   IF B02.PENSJONSTYPE1(IND) = 'U' !                            
                      B02.PENSJONSTYPE3(IND) = 'U'    THEN                      
                                                                                
                       TEKSTTYPE_A_KODE = 'A002';                               
                   ELSE                                                         
                       TEKSTTYPE_A_KODE = 'A301';                               
                ELSE                                                            
                                                                                
                IF B01.UFØRPENS.UFG(IND) <                                      
                   B02.UFØRPENS.UFG(IND)  &                                     
                   B01.PENSJONSTYPE3(IND) ^= 'A' THEN                           
                                                                                
                   TEKSTTYPE_A_KODE = 'A023';                                   
                                                                                
                ELSE                                                            
                                                                                
                IF B01.UFØRPENS.UFG(IND) >                                      
                   B02.UFØRPENS.UFG(IND)  &                                     
                   B01.PENSJONSTYPE3(IND) ^= 'A' THEN                           
                                                                                
                   TEKSTTYPE_A_KODE = 'A031';                                   
                                                                                
               ELSE                                                             
               IF (B02.PENSJONSTYPE1(IND) = 'Y') &                              
                  (B01.YRKEPENS.YUG(IND) ^= 0) &                                
                  (B02.YRKEPENS.YUG(IND) > B01.YRKEPENS.YUG(IND)) THEN          
                      TEKSTTYPE_A_KODE = 'A323';                                
               ELSE                                                             
               IF (B02.PENSJONSTYPE1(IND) = 'Y') &                              
                  (B01.YRKEPENS.YPT(IND) ^= 0) &                                
                  (B01.YRKEPENS.YPT(IND) ^= B02.YRKEPENS.YPT(IND))              
                  THEN                                                          
                     TEKSTTYPE_A_KODE = 'A330';                                 
               ELSE                                                             
               IF B02.PENSJONSTYPE1(IND) = 'Y' &                                
                  B02.PENSJONSTYPE3(IND) = ' ' THEN                             
                      TEKSTTYPE_A_KODE = 'A301';                                
               ELSE                                                             
                                                                                
                  TEKSTTYPE_A_KODE = 'A002';                                    
            END;                                                                
         WHEN(3)                                                                
            DO;  /* GRUNNBLANKETT ETTERLATTEPENSJON */                          
               IF ((B01.UFØRPENS.GP    (IND) +                                  
                   B01.UFØRPENS.TP    (IND) +                                   
                   B01.ALDERSP.GP     (IND) +                                   
                   B01.ALDERSP.TP     (IND)) = 0)         !                     
                       (B01.STATUS_KODE_HIST(IND)  = 'X') !                     
                       (B01.STATUS_KODE_HIST(IND)  = 'O')       THEN            
                                                                                
                  DO;  /* HAR IKKJE YTELSE FRA FØR      */                      
                     IF B02.PENSJONSTYPE2(IND) = 'O' THEN                       
                        DO;  /* MOTTAR OVERGANGSSTØNAD */                       
                           IF (B02.SIVILSTAND(IND) = 'E' !                      
                               B02.SIVILSTAND(IND) = 'U' ) THEN                 
                              IF B02.DØD_AV_YRKESSKADE(IND) = 'E' THEN          
                                 TEKSTTYPE_A_KODE = 'A305';                     
                              ELSE                                              
                                 TEKSTTYPE_A_KODE = 'A009';                     
                           ELSE                                                 
                              DO;  /* IKKE SIVILSTAND E ! U */                  
                                 IF B02.TP_PROSENT(IND) > 0 THEN                
                                    DO;  /* TP_PROSENT > 0 */                   
                                       IF B02.HJEMMEL_10_8                      
                                                       (IND) = 'J' THEN         
                                          TEKSTTYPE_A_KODE = 'A090';            
                                       ELSE                                     
                                          TEKSTTYPE_A_KODE = 'A010';            
                                       IF B02.ETTEPENS.HJEMMEL_10_8             
                                                       (IND) = 'J' &            
                                          B02.DØD_AV_YRKESSKADE                 
                                                       (IND) = 'E' THEN         
                                          TEKSTTYPE_A_KODE = 'A390';            
                                    END; /* TP_PROSENT > 0 */                   
                                 ELSE                                           
                                    DO;  /* TP_PROSENT = 0 */                   
                                       IF B02.ETTEPENS.HJEMMEL_10_8             
                                                       (IND) = 'J' &            
                                          B02.DØD_AV_YRKESSKADE                 
                                                       (IND) = 'E' THEN         
                                             TEKSTTYPE_A_KODE = 'A312';         
                                                                                
                                       IF B02.ETTEPENS.HJEMMEL_10_8             
                                                       (IND) = 'J' &            
                                          B02.DØD_AV_YRKESSKADE                 
                                                       (IND) = ' ' THEN         
                                                                                
                                          TEKSTTYPE_A_KODE = 'A012';            
                                                                                
                                       IF B02.ETTEPENS.HJEMMEL_10_8             
                                                       (IND) = 'N' &            
                                          B02.DØD_AV_YRKESSKADE                 
                                                       (IND) = ' ' THEN         
                                                                                
                                          TEKSTTYPE_A_KODE = 'A011';            
                                                                                
                                    END; /* TP_PROSENT = 0 */                   
                             END; /* IKKE SIVILSTAND E ! U */                   
                        END;  /* MOTTAR OVERGANGSSTØNAD */                      
                     ELSE                                                       
                        DO;  /* MOTTAR PENSJON */                               
                           IF B02.SIVILSTAND(IND) = 'E'  !                      
                              B02.SIVILSTAND(IND) = 'U' THEN                    
                              IF B02.DØD_AV_YRKESSKADE(IND) = 'E' !             
                                 B02.DØD_AV_YRKESSKADE(IND) = 'Y' THEN          
                                 TEKSTTYPE_A_KODE = 'A306';                     
                              ELSE                                              
                                 TEKSTTYPE_A_KODE = 'A003';                     
                           ELSE                                                 
                              DO;  /* IKKE SIVILSTAND E ! U */                  
                                 IF B02.TP_PROSENT(IND) > 0 THEN                
                                    DO;  /* TP_PROSENT > 0 */                   
                                       IF B02.ETTEPENS.HJEMMEL_10_8             
                                          (IND) = 'J' THEN                      
                                          IF B02.DØD_AV_YRKESSKADE              
                                             (IND) = 'J' THEN                   
                                             TEKSTTYPE_A_KODE = 'A389';         
                                          ELSE                                  
                                             TEKSTTYPE_A_KODE = 'A089';         
                                       ELSE                                     
                                         IF B02.TP_BRUTTO(IND) > 0 THEN         
                                             TEKSTTYPE_A_KODE = 'A005';         
                                          ELSE                                  
                                             TEKSTTYPE_A_KODE = 'A006';         
                                    END; /* TP_PROSENT > 0 */                   
                                 ELSE                                           
                                    DO;  /* TP_PROSENT = 0 */                   
                                       IF B02.ETTEPENS.HJEMMEL_10_8             
                                                       (IND) = 'J' &            
                                          B02.DØD_AV_YRKESSKADE                 
                                                       (IND) = 'E' THEN         
                                                                                
                                             TEKSTTYPE_A_KODE = 'A317';         
                                                                                
                                       IF B02.ETTEPENS.HJEMMEL_10_8             
                                                       (IND) = 'J' &            
                                          B02.DØD_AV_YRKESSKADE                 
                                                       (IND) = ' ' THEN         
                                                                                
                                          TEKSTTYPE_A_KODE = 'A007';            
                                                                                
                                       IF B02.ETTEPENS.HJEMMEL_10_8             
                                                       (IND) = 'N' &            
                                          B02.DØD_AV_YRKESSKADE                 
                                                       (IND) = ' ' THEN         
                                                                                
                                          TEKSTTYPE_A_KODE = 'A006';            
                                                                                
                                    END; /* TP_PROSENT = 0 */                   
                             END;  /* IKKE SIVILSTAND E ! U */                  
                                                                                
                           IF B02.SUM_YTELSE(IND) = 0 THEN                      
                              IF B01.SUM_YTELSE(IND)  = 42   THEN               
                                     TEKSTTYPE_A_KODE = 'A108';                 
                              ELSE                                              
                                     TEKSTTYPE_A_KODE = 'A015';                 
                        END; /* MOTTAR PENSJON */                               
                  END; /* HAR IKKJE YTELSE FRA FØR      */                      
               ELSE                                                             
                  DO;  /* HAR YTELSE FRA FØR */                                 
                     IF B02.SUM_YTELSE(IND) >                                   
                        (B02.UFØRPENS.GP    (IND) +                             
                         B02.UFØRPENS.TP    (IND) +                             
                         B02.UFØRPENS.KT    (IND) +                             
                         B02.UFØRPENS.ST    (IND) +                             
                         B02.UFØRPENS.BT    (IND) +                             
                         B02.UFØRPENS.ÅFT   (IND) +                             
                         B02.ALDERSP.GP     (IND) +                             
                         B02.ALDERSP.VT_GP  (IND) +                             
                         B02.ALDERSP.TP     (IND) +                             
                         B02.ALDERSP.VT_TP  (IND) +                             
                         B02.ALDERSP.KT     (IND) +                             
                         B02.ALDERSP.ST     (IND) +                             
                         B02.ALDERSP.BT     (IND))     &                        
                        (B02.ALDERSP.ST     (IND) +                             
                         B02.ETTEPENS.ST    (IND) +                             
                         B02.UFØRPENS.ST    (IND))  = 0  &                      
                         B02.SIVILSTAND     (IND)   = 'S' THEN                  
                        TEKSTTYPE_A_KODE = 'A016';                              
                     ELSE                                                       
                        IF B02.SUM_YTELSE(IND) >                                
                           (B02.UFØRPENS.GP    (IND) +                          
                            B02.UFØRPENS.TP    (IND) +                          
                            B02.UFØRPENS.KT    (IND) +                          
                            B02.UFØRPENS.ST    (IND) +                          
                            B02.UFØRPENS.BT    (IND) +                          
    /* JFA 15.6.00  */     B02.FORSI.BT_SÆRBARN(IND) +                          
                            B02.UFØRPENS.ÅFT   (IND) +                          
                            B02.ALDERSP.GP     (IND) +                          
                            B02.ALDERSP.VT_GP  (IND) +                          
                            B02.ALDERSP.TP     (IND) +                          
                            B02.ALDERSP.VT_TP  (IND) +                          
                            B02.ALDERSP.KT     (IND) +                          
                            B02.ALDERSP.ST     (IND) +                          
                            B02.ALDERSP.BT     (IND))     &                     
                           (B02.ALDERSP.ST     (IND) +                          
                            B02.ETTEPENS.ST    (IND) +                          
                            B02.UFØRPENS.ST    (IND))  = 0  &                   
                            B02.SIVILSTAND     (IND)   = 'E' THEN               
                                                                                
                        /* SUM YTELSE ER STØRRE ENN  AP ELLER UP   */           
                        /* DVS. PERSONEN FÅR TILLEGG ETTER AVDØDE  */           
                                                                                
                               TEKSTTYPE_A_KODE = 'A053';                       
                     ELSE                                                       
   /* JFA 15.5.00 - DØDSFALLET FØRER IKKE TIL ENDRINGER            */           
                        IF  B02.SIVILSTAND     (IND)   = 'E'    !               
                            B02.SIVILSTAND     (IND)   = 'S'    &               
                            B02.PENSJONSTYPE2(IND) = 'E'        &               
                                                                                
                            B02.ETTEPENS.TP_BRUTTO  (IND) > 0   &               
                                                                                
                           (B02.UFØRPENS.ST    (IND) +                          
                            B02.ETTEPENS.ST    (IND) +                          
                            B02.ALDERSP.ST     (IND)   )  > 0  THEN             
                                                                                
                            TEKSTTYPE_A_KODE = 'A093';                          
   /* HIT 15.5.00 + 15.6.2000  */                                               
                                                                                
                        ELSE                                                    
                                                                                
                        /* SUM YTELSE ER IKKE STØRRE ENN  AP ELLER UP */        
                        /* DVS. PERSONEN FÅR IKKE TILLEGG ETTER AVDØDE*/        
                                                                                
                           TEKSTTYPE_A_KODE = 'A052';                           
                                                                                
                                                                                
                        IF B02.SUM_YTELSE(IND) >                                
                           (B02.UFØRPENS.GP    (IND) +                          
                            B02.UFØRPENS.TP    (IND) +                          
                            B02.UFØRPENS.KT    (IND) +                          
                            B02.UFØRPENS.ST    (IND) +                          
                            B02.UFØRPENS.BT    (IND) +                          
                            B02.UFØRPENS.ÅFT   (IND) +                          
                            B02.YRKEPENS.GP    (IND) +                          
                            B02.YRKEPENS.BT    (IND) +                          
                            B02.YRKEPENS.TP    (IND) +                          
                            B02.ALDERSP.GP     (IND) +                          
                            B02.ALDERSP.VT_GP  (IND) +                          
                            B02.ALDERSP.TP     (IND) +                          
                            B02.ALDERSP.VT_TP  (IND) +                          
                            B02.ALDERSP.KT     (IND) +                          
                            B02.ALDERSP.ST     (IND) +                          
                            B02.ALDERSP.BT     (IND))     &                     
                           (B02.ALDERSP.ST     (IND) +                          
                            B02.ETTEPENS.ST    (IND) +                          
                            B02.UFØRPENS.ST    (IND))  = 0  &                   
                            B02.PENSJONSTYPE1  (IND) = 'Y'   &                  
                            B02.SIVILSTAND     (IND)   = 'E' THEN               
                                                                                
                        /* SUM YTELSE ER STØRRE ENN  AP ELLER UP   */           
                        /* DVS. PERSONEN FÅR TILLEGG ETTER AVDØDE  */           
                                                                                
                           TEKSTTYPE_A_KODE = 'A353';                           
                        ELSE                                                    
                           IF B02.PENSJONSTYPE1(IND) = 'Y' THEN                 
                              TEKSTTYPE_A_KODE = 'A352';                        
               /* ATTFOERING YP */                                              
                        IF B02.SUM_YTELSE(IND) >                                
                           (B02.UFØRPENS.GP    (IND) +                          
                            B02.UFØRPENS.TP    (IND) +                          
                            B02.UFØRPENS.KT    (IND) +                          
                            B02.UFØRPENS.ST    (IND) +                          
                            B02.UFØRPENS.BT    (IND) +                          
                            B02.UFØRPENS.ÅFT   (IND) +                          
                            B02.YRKEPENS.GP    (IND) +                          
                            B02.YRKEPENS.BT    (IND) +                          
                            B02.YRKEPENS.TP    (IND) +                          
                            B02.ALDERSP.GP     (IND) +                          
                            B02.ALDERSP.VT_GP  (IND) +                          
                            B02.ALDERSP.TP     (IND) +                          
                            B02.ALDERSP.VT_TP  (IND) +                          
                            B02.ALDERSP.KT     (IND) +                          
                            B02.ALDERSP.ST     (IND) +                          
                            B02.ALDERSP.BT     (IND))     &                     
                           (B02.ALDERSP.ST     (IND) +                          
                            B02.ETTEPENS.ST    (IND) +                          
                            B02.UFØRPENS.ST    (IND))  = 0  &                   
                           (B02.PENSJONSTYPE1  (IND) = 'Y'   &                  
                            B02.PENSJONSTYPE3  (IND) = 'A')  &                  
                            B02.SIVILSTAND     (IND)   = 'E' THEN               
                                                                                
                        /* SUM YTELSE ER STØRRE ENN  AP ELLER UP   */           
                        /* DVS. PERSONEN FÅR TILLEGG ETTER AVDØDE  */           
                                                                                
                           TEKSTTYPE_A_KODE = 'A453';                           
                        ELSE                                                    
                           IF B02.PENSJONSTYPE1(IND) = 'Y' &                    
                              B02.PENSJONSTYPE3(IND) = 'A' THEN                 
                              TEKSTTYPE_A_KODE = 'A452';                        
                  END;                                                          
                  /*   PENSJON FRA FØR              */                          
               IF (B01.PENSJONSTYPE1(IND) = 'E' &                               
                   B02.PENSJONSTYPE1(IND) = 'E' ) &                             
                  (B01.TT_NORDISK_FAKT_MND(IND_EK) ^=                           
                   B02.TT_NORDISK_FAKT_MND(IND_EK) !                            
                   B01.PÅ_NORDISK_FAKT(IND_EK) ^=                               
                   B02.PÅ_NORDISK_FAKT(IND_EK)     ) THEN                       
                  TEKSTTYPE_A_KODE = 'A536';                                    
            END; /* GRUNNBLANKETT ETTERLATTEPENSJON */                          
         WHEN(4)                                                                
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* GRUNNBLANKETT - SØKNAD OM BARNEPENSJON EN FORELDER DØD            */        
 /* ***************************************************************** */        
                                                                                
              IF  B01.PENSJONSTYPE1(IND) = 'N'  &                               
                  B02.PENSJONSTYPE1(IND) = 'N'  &                               
                  B01.ANTALL_BARN(IND)   <                                      
                  B02.ANTALL_BARN(IND)              THEN                        
                                                                                
                                     TEKSTTYPE_A_KODE = 'A024';                 
              ELSE                                                              
                                     TEKSTTYPE_A_KODE = 'A014';                 
            END;                                                                
                                                                                
         WHEN(5)                                                                
                                                                                
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* GRUNNBLANKETT - SØKNAD OM BARNEPENSJON BEGGE FORELDRE DØD         */        
 /* ***************************************************************** */        
                                                                                
              IF  B01.PENSJONSTYPE1(IND) = 'B'  &                               
                  B02.PENSJONSTYPE1(IND) = 'B'  &                               
                  B01.ANTALL_BARN(IND)   <                                      
                  B02.ANTALL_BARN(IND)              THEN                        
                                                                                
                                     TEKSTTYPE_A_KODE = 'A024';                 
              ELSE                                                              
                                     TEKSTTYPE_A_KODE = 'A092';                 
            END;                                                                
         WHEN(7)                                                                
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* GRUNNBLANKETT - UNG UFØR FØR 1.1.67       J.D 08.89               */        
 /* ***************************************************************** */        
                                                                                
               IF B02.TP_GAR_KODE(IND) ='E' THEN                                
                  DO;                                                           
                     IF (F_AAR > 1924 & F_AAR < 1945 ) &                        
                         B02.VIRK_DATO_ÅMD(IND) = 19910100 THEN                 
                             TEKSTTYPE_A_KODE = 'A113';                         
                     ELSE                                                       
                             TEKSTTYPE_A_KODE = 'A067';                         
                                                                                
                     IF (F_AAR > 1925 & F_AAR < 1945 ) &                        
                         B02.VIRK_DATO_ÅMD(IND) =19920100 THEN                  
                             TEKSTTYPE_A_KODE = 'A118';                         
                                                                                
                     IF (F_AAR > 1925 & F_AAR < 1943 ) &                        
                         B02.VIRK_DATO_ÅMD(IND) = 19920500 THEN                 
                             TEKSTTYPE_A_KODE = 'A119';                         
                                                                                
                     IF (F_AAR > 1930 & F_AAR < 1943 ) &                        
                         B02.VIRK_DATO_ÅMD(IND) = 970500 THEN                   
                             TEKSTTYPE_A_KODE = 'A124';                         
                  END;                                                          
            END;                                                                
         WHEN(34)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* GRUNNBLANKETT - SØKNAD OM ETTERLATT FAMILEPLEIER                  */        
 /* ***************************************************************** */        
                                                                                
               IF B02.PENSJONSTYPE2(IND) = 'P' THEN                             
                                        TEKSTTYPE_A_KODE = 'A008';              
               ELSE                                                             
                                        TEKSTTYPE_A_KODE = 'A013';              
            END;                                                                
         WHEN(8)                                                                
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* ENDRING - FAI OG ELLER APD ER ENDRET                              */        
 /* ***************************************************************** */        
                                                                                
               IF B02.PENSJONSTYPE1(IND) = 'K'  THEN                            
                  DO;                                                           
                     IF B02.ALDERSP.UTTAKSDATO_ÅMD(IND) > 19920000 THEN         
                                        TEKSTTYPE_A_KODE = 'A117';              
                     ELSE                                                       
                        IF B02.ALDERSP.FAI(IND) ^=                              
                           B01.ALDERSP.FAI(IND)   THEN                          
                                        TEKSTTYPE_A_KODE = 'A230';              
                        ELSE                                                    
                                        TEKSTTYPE_A_KODE = 'A229';              
                  END;                                                          
               ELSE                                                             
                  DO;                                                           
                     IF F_AAR             >  1924 THEN                          
                                        TEKSTTYPE_A_KODE = 'A117';              
                     ELSE                                                       
                        IF B02.ALDERSP.FAI(IND) ^=                              
                           B01.ALDERSP.FAI(IND)   THEN                          
                                        TEKSTTYPE_A_KODE = 'A030';              
                        ELSE                                                    
                                        TEKSTTYPE_A_KODE = 'A029';              
                  END;                                                          
            END;                                                                
         WHEN(9)                                                                
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* ENDRING - UFØREGRADEN ER ENDRET                                   */        
 /* ***************************************************************** */        
                                                                                
                  IF B01.UFØRPENS.UFG(IND) = B02.UFØRPENS.UFG(IND)   &          
                     B01.YRKEPENS.YUG(IND)^= B02.YRKEPENS.YUG(IND) THEN         
                     TEKSTTYPE_A_KODE = 'A331';                                 
                  ELSE                                                          
                  IF B01.UFØRPENS.UFG(IND)^= B02.UFØRPENS.UFG(IND) THEN         
                     TEKSTTYPE_A_KODE = 'A031';                                 
            END;                                                                
         WHEN(10)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* NÅR UP OG F7 REGISTRERES PÅ SAMME DAG MED SAMME VIRK-DATO SKAL    */        
 /* TEKST A002 SKRIVES (JD 03.03.94 )                                 */        
 /* NÅR YP OG F7 REGISTRERES PÅ SAMME DAG MED SAMME VIRK-DATO SKAL    */        
 /* TEKST A301 SKRIVES (JD 03.03.94 )                                 */        
 /* NÅR AP OG F7 REGISTRERES PÅ SAMME DAG MED SAMME VIRK-DATO SKAL    */        
 /* TEKST A001 SKRIVES (JD 03.03.94 )                                 */        
 /* ***************************************************************** */        
                                                                                
              IF B02.RED_GP_3_2_5(IND) = 'J'       &                            
                 B01.RED_GP_3_2_5(IND) ^= 'J'      THEN                         
                 TEKSTTYPE_A_KODE = 'A129';                                     
              ELSE /*200309 HL - GP ENDRES PGA EKTEFELLE/SAMBO*/                
              IF B02.GP_REDUKSJON_KODE(IND)  ^=                                 
                 B01.GP_REDUKSJON_KODE(IND)        THEN                         
                 TEKSTTYPE_A_KODE = 'A079';                                     
              ELSE                                                              
              IF  W_HENDELSE.VERSJON ^= 001                     &               
                  B02.PENSJONSTYPE1(IND) = 'U'   THEN                           
                                        TEKSTTYPE_A_KODE = 'A002';              
              ELSE                                                              
              IF  W_HENDELSE.VERSJON ^= 001                     &               
                  B02.PENSJONSTYPE1(IND) = 'Y'   THEN                           
                                        TEKSTTYPE_A_KODE = 'A301';              
              ELSE                                                              
              IF  W_HENDELSE.VERSJON ^= 001                     &               
                  B02.PENSJONSTYPE1(IND) = 'A'   THEN                           
                                        TEKSTTYPE_A_KODE = 'A001';              
              ELSE                                                              
              IF  B02.VIRK_DATO_ÅMD(IND) = 19970100             &               
               B02.ALDERSP.GP(IND) > B02.ALDERSP.AP_GP_NETTO(IND)               
                                                          THEN                  
                                        TEKSTTYPE_A_KODE = 'A125';              
              ELSE                                                              
                 TEKSTTYPE_A_KODE = 'A079';                                     
            END;                                                                
         WHEN(11)                                                               
            DO;  /* ENDRING - ETTERLATT  */                                     
               /* MARTIN ENDRA 1299 IFBM EØS INNTEKTSPRØVING */                 
               IF (VIRKNINGSDATO = GRUNNBELØPSDATO) THEN                        
                  DO;  /* G REGULERING PÅ VIRK FOR ENDRINGSBLANKETT */          
                     IF (FINNT1 = FIXEDFEM) THEN                                
                        DO;  /* INNTEKTEN ER KUN RULLERT */                     
                           IF (FF_EØS1 = FF_EØS2) THEN                          
                              /* A/V-112 ---------------------------- */        
                              /* G REGULERT INNTEKTEN ER DEN SAMME    */        
                              /* ------------------------------------ */        
                              TEKSTTYPE_A_KODE = 'A112';                        
                           ELSE                                                 
                              IF (FF_EØS2) THEN                                 
                                 /* A/V-520 ------------------------- */        
                                 /* G ENDRA. DET ER TATT HENSYN TIL   */        
                                 /* AT DE MOTTAR INNTEKTSPRØVET EØS P */        
                                 /* FRA ANNET EØS LAND                */        
                                 /* --------------------------------- */        
                                 TEKSTTYPE_A_KODE = 'A520';                     
                              ELSE                                              
                                 /* A/V-521 ------------------------- */        
                                 /* G ENDRA. IKKE LENGER INNTEKTSTP.  */        
                                 /* ETTER EØSRELENE                   */        
                                 /* --------------------------------- */        
                                 TEKSTTYPE_A_KODE = 'A521';                     
                        END; /* INNTEKTEN ER KUN RULLERT */                     
                     ELSE                                                       
                        DO;  /* INNTEKTEN ER FORANDRET */                       
                           IF (B02.PENSJONSTYPE2(IND) ^= 'O') THEN              
                              /* PENSJON ETTER AVDØDE */                        
                              IF (FF_EØS1 = FF_EØS2 ) THEN                      
                                 /* A/V-530 ------------------------- */        
                                 /* P ENDRA - FEI & G ENDRA           */        
                                 /* --------------------------------- */        
                                 TEKSTTYPE_A_KODE = 'A530';                     
                              ELSE                                              
                                 IF (FF_EØS2) THEN                              
                                    /* A/V-531 ---------------------- */        
                                    /* FEI & G   ENDRA. OGSÅ HENSYN   */        
                                    /* TIL EØS REGLER                 */        
                                    /* ------------------------------ */        
                                    TEKSTTYPE_A_KODE = 'A531';                  
                                 ELSE                                           
                                    /* A/V-532 ---------------------- */        
                                    /* FEI & G   ENDRA. BEREGNET      */        
                                    /* ETTER FOLKETRYGDENS REGLER     */        
                                    /* ------------------------------ */        
                                     TEKSTTYPE_A_KODE = 'A532';                 
                              /* SLUTT PENSJON ETTER AVDØDE */                  
                           ELSE                                                 
                              /* OVERGANGSSTØNAD */                             
                              IF (FF_EØS1 = FF_EØS2) THEN                       
                                 /* A/V-533 ------------------------- */        
                                 /* OVERGANSSST. ENDRA FEI & G  ENDRA */        
                                 /* --------------------------------- */        
                                 TEKSTTYPE_A_KODE = 'A533';                     
                              ELSE                                              
                                 IF (FF_EØS2) THEN                              
                                    /* A/V-534 ---------------------- */        
                                    /* INNTEKTEN ENDRA. OGSÅ HENSYN   */        
                                    /* TIL EØS REGLER                 */        
                                    /* ------------------------------ */        
                                    TEKSTTYPE_A_KODE = 'A534';                  
                                 ELSE                                           
                                    /* A/V-535 ---------------------- */        
                                    /* INNTEKTEN ENDRA. BEREGNET      */        
                                    /* ETTER FOLKETRYGDENS REGLER     */        
                                    /* ------------------------------ */        
                                    TEKSTTYPE_A_KODE = 'A535';                  
                              /* OVERGANGSSTØNAD */                             
                        END; /* INNTEKTEN ER FORANDRET */                       
                  END; /* G REGULERING OG ENDRING SAMME VIRK */                 
               ELSE                                                             
                  DO;  /* IKKE BÅDE G REGULERING PÅ DENNE VIRK */               
                     IF (FF_EØS1 = FF_EØS2) THEN                                
                        IF B02.PENSJONSTYPE2(IND) ^= 'O' THEN                   
                           /* A/V-032 ------------------------------- */        
                           /* P ENDRA - FEI ENDRA                     */        
                           /* --------------------------------------- */        
                           TEKSTTYPE_A_KODE = 'A032';                           
                        ELSE                                                    
                           /* A/V-034 ------------------------------- */        
                           /* O ENDRA - FEI ENDRA                     */        
                           /* --------------------------------------- */        
                           TEKSTTYPE_A_KODE = 'A034';                           
                     ELSE                                                       
                        IF (FINNT1 = FIXEDFEM) THEN                             
                           /* INNTEKTEN ER - UFORANDRA */                       
                           IF (FF_EØS2) THEN                                    
                              IF B02.PENSJONSTYPE2(IND) ^= 'O' THEN             
                                 /* A/V-526 ------------------------- */        
                                 /* P ENDRA - MOTTAR INNTEKTSPRØVET   */        
                                 /* --------------------------------- */        
                                 TEKSTTYPE_A_KODE = 'A526';                     
                              ELSE                                              
                                 /* A/V-528 ------------------------- */        
                                 /* O ENDRA - MOTTAR INNTEKTSPRØVET   */        
                                 /* --------------------------------- */        
                                 TEKSTTYPE_A_KODE = 'A528';                     
                           ELSE                                                 
                              IF B02.PENSJONSTYPE2(IND) ^= 'O' THEN             
                                 /* A/V-527 ------------------------- */        
                                 /* P ENDRA - MOTTAR IKKE INNT.PR.    */        
                                 /* --------------------------------- */        
                                 TEKSTTYPE_A_KODE = 'A527';                     
                              ELSE                                              
                                 /* A/V-529 ------------------------- */        
                                 /* O ENDRA - MOTTAR IKKE INNT. PR.   */        
                                 /* --------------------------------- */        
                                 TEKSTTYPE_A_KODE = 'A529';                     
                           /* INNTEKTEN ER - UFORANDRA */                       
                        ELSE                                                    
                           /* INNTEKTEN ER JUSTERT */                           
                           IF (FF_EØS2) THEN                                    
                              IF B02.PENSJONSTYPE2(IND) ^= 'O' THEN             
                                 /* A/V-522 ------------------------- */        
                                 /* P ENDRA - BLIR EØS, NY INNTEKT    */        
                                 /* --------------------------------- */        
                                 TEKSTTYPE_A_KODE = 'A522';                     
                              ELSE                                              
                                 /* A/V-524 ------------------------- */        
                                 /* O ENDRA - BLIR EØS, NY INNTEKT    */        
                                 /* --------------------------------- */        
                                 TEKSTTYPE_A_KODE = 'A524';                     
                           ELSE                                                 
                              IF B02.PENSJONSTYPE2(IND) ^= 'O' THEN             
                                 /* A/V-523 ------------------------- */        
                                 /* P ENDRA - VAR EØS, NY INNTEKT     */        
                                 /* --------------------------------- */        
                                 TEKSTTYPE_A_KODE = 'A523';                     
                              ELSE                                              
                                 /* A/V-525 ------------------------- */        
                                 /* O ENDRA - VAR EØS, NY INNTEKT     */        
                                 /* --------------------------------- */        
                                 TEKSTTYPE_A_KODE = 'A525';                     
                  END; /* IKKE BÅDE G REDULERING OG SAMME VIRK */               
               /* MARTIN ENDRA 1299 IFBM EØS INNTEKTSPRØVING */                 
                                                                                
               IF B02.SIVILSTAND(IND) = 'S'     THEN                            
                  IF B02.ETTEPENS.TP_PROSENT(IND) = 0 &                         
                     B01.ETTEPENS.TP_PROSENT(IND) > 0 THEN                      
                     TEKSTTYPE_A_KODE = 'A037';                                 
                  ELSE                                                          
                  IF B02.ETTEPENS.TP_PROSENT(IND) ^=                            
                     B01.ETTEPENS.TP_PROSENT(IND)  THEN                         
                     TEKSTTYPE_A_KODE = 'A036';                                 
                                                                                
               IF TEKSTTYPE_A_KODE = '    ' THEN                                
                  IF B02.VIRK_DATO_ÅMD(IND) = 19900100 &                        
                     B02.ETTEPENS.ST       (IND) >                              
                     B01.ETTEPENS.ST       (IND)        THEN                    
                     TEKSTTYPE_A_KODE = 'A111';                                 
                                                                                
            END;                                                                
         WHEN(12)                                                               
            DO;                                                                 
              /* R344: FLYTTET FRA LOOP 191203 MARTIN */                        
              TEKSTTYPE_A_KODE = 'A040';                                        
 /* ***************************************************************** */        
 /* ENDRING AV SIVILSTAND - PENSJONISTER HAR FLYTTET FRA HVERANDRE    */        
 /* ***************************************************************** */        
                                                                                
              DO J = 3 TO 14 WHILE(B02.FNR(J) > 0);                             
                                                                                
                 DO K = 1 TO 13 WHILE (B02.FNR_TILKN(IND,K) > 0);               
                                                                                
                    IF B02.FNR(J) = B02.FNR_TILKN(IND,K) THEN                   
                                                                                
                      DO;                                                       
                         IF B02.PENSJONSTYPE2(J) = 'R' &                        
                            B02.PENSJONSTYPE2(IND_EK) = 'M' THEN                
                                TEKSTTYPE_A_KODE = 'A075';                      
              /* R344    ELSE                                                   
                                TEKSTTYPE_A_KODE = 'A040'; */                   
                         K = 13;                                                
                      END;                                                      
                 END;                                                           
              END;                                                              
            END;                                                                
         WHEN(13)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* ENDRING AV SIVILSTAND - PENSJONISTER HAR FLYTTET SAMMEN IGJEN     */        
 /* ***************************************************************** */        
                                                                                
                  TEKSTTYPE_A_KODE = 'A042';                                    
            END;                                                                
         WHEN(14)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* ENDRING AV SIVILSTAND - PENSJONISTER ER MELDT SKILT               */        
 /* OPPHØR SAMBOER (A040) LAGT INN 03.2001  J.D                       */        
 /* ***************************************************************** */        
                                                                                
               IF B01.SIVILSTAND(IND) = 'V'  THEN                               
                  TEKSTTYPE_A_KODE = 'A147';                                    
               ELSE                                                             
                  TEKSTTYPE_A_KODE = 'A039';                                    
            END;                                                                
         WHEN(15)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* ENDRING AV SIVILSTAND - PENSJONIST M/EKTEFELLETILLEGG MELDT SKILT */        
 /* ***************************************************************** */        
                                                                                
                  TEKSTTYPE_A_KODE = 'A038';                                    
            END;                                                                
         WHEN(16)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* ENDRING AV SIVILSTAND - PENSJONISTER ER MELDT GIFT (W,P 12.93 JD  */        
 /* ***************************************************************** */        
                                                                                
                  IF B02.SIVILSTAND(IND) = 'G' THEN                             
                     TEKSTTYPE_A_KODE = 'A041';                                 
                  ELSE                                                          
                  IF B02.SIVILSTAND(IND) = 'P' THEN                             
                     TEKSTTYPE_A_KODE = 'A141';                                 
                  ELSE                                                          
                     TEKSTTYPE_A_KODE = 'A142';                                 
            END;                                                                
         WHEN(32)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* ENDRING AV SIVILSTAND - PENSJONISTER ER MELDT GIFT,               */        
 /* ETTERLATTERETTIGHETER OPPHØRER  ( W OG P LAGT INN 12.93 J.D       */        
 /* ***************************************************************** */        
                                                                                
               IF B02.PENSJONSTYPE1(IND) = 'A' THEN                             
                  DO;                                                           
                     IF B02.SIVILSTAND(IND) = 'G' THEN                          
                                   TEKSTTYPE_A_KODE = 'A044';                   
                     ELSE                                                       
                     IF B02.SIVILSTAND(IND) = 'P' THEN                          
                                   TEKSTTYPE_A_KODE = 'A144';                   
                     ELSE                                                       
                                   TEKSTTYPE_A_KODE = 'A154';                   
                  END;                                                          
               ELSE                                                             
                  DO;                                                           
                     IF B02.SIVILSTAND(IND) = 'G' THEN                          
                                   TEKSTTYPE_A_KODE = 'A043';                   
                     ELSE                                                       
                     IF B02.SIVILSTAND(IND) = 'P' THEN                          
                                   TEKSTTYPE_A_KODE = 'A143';                   
                     ELSE                                                       
                                   TEKSTTYPE_A_KODE = 'A153';                   
                  END;                                                          
            END;                                                                
         WHEN(17)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* DØDSMELDING - FORSØRGINGSTI_ÅMDLLEGG ER FJERNET P.G.A EKTEFELLEN ER         
 /* MELDT DØD                                                         */        
 /* ***************************************************************** */        
                                                                                
               TEKSTTYPE_A_KODE = 'A055';                                       
            END;                                                                
         WHEN(27)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* ENDRING AV SATSENE FOR SÆRTILLEGG FRA 01.01.95                    */        
 /* ENDRING AV REGLENE FOR BEREGNING AV TP   01.92                    */        
 /*                                                                   */        
 /* ***************************************************************** */        
                                                                                
                IF B02.STATUS.G_DATO_ÅMD(IND) = 19950100 &                      
 /* JFA 4.4.2000 TILFØYD YTTERLIGERE TESTER FØR TEKSTKODE A127        */        
                                                                                
                   (B02.UFØRPENS.ET(IND) + B02.YRKEPENS.ET (IND) +              
                    B02.UFØRPENS.BT(IND) + B02.YRKEPENS.BT (IND) +              
                    B02.GARANTITILLEGG_SÆRBARN(IND) +                           
                    B02.GARANTITILLEGG_BARN(IND)    +                           
                    B02.GARANTITILLEGG_EK  (IND)    +                           
                    B02.BT_SÆRBARN(IND)             +                           
                   B02.ALDERSP.ET(IND) + B02.ALDERSP.BT(IND) ) > 0 THEN         
                                          TEKSTTYPE_A_KODE = 'A127';            
                                                                                
                IF B02.STATUS.G_DATO_ÅMD(IND) = 19950100 &                      
 /* JFA 4.4.2000 TILFØYD YTTERLIGERE TESTER FØR TEKSTKODE A122        */        
                                                                                
                  (B02.UFØRPENS.ET(IND) + B02.YRKEPENS.ET (IND) +               
                   B02.UFØRPENS.BT(IND) + B02.YRKEPENS.BT (IND) +               
                   B02.GARANTITILLEGG_SÆRBARN(IND) +                            
                   B02.GARANTITILLEGG_BARN(IND)    +                            
                   B02.GARANTITILLEGG_EK  (IND)    +                            
                   B02.BT_SÆRBARN(IND)             +                            
                  B02.ALDERSP.ET(IND) + B02.ALDERSP.BT(IND) )  = 0 THEN         
                                          TEKSTTYPE_A_KODE = 'A122';            
 /* HIT 4.4.2000  */                                                            
                                                                                
                IF TRANS_OPPL_OMR.VIRKNINGSDATO_ÅMD = 19920100 &                
                  (B01.YRKEPENS.TP (IND)                                        
                 + B01.UFØRPENS.TP (IND)                                        
                 + B01.ETTEPENS.TP_NETTO(IND)                                   
                 + B01.ALDERSP.AP_TP_NETTO(IND)) =                              
                  (B02.YRKEPENS.TP (IND)                                        
                 + B02.UFØRPENS.TP (IND)                                        
                 + B02.ETTEPENS.TP_NETTO(IND)                                   
                 + B02.ALDERSP.AP_TP_NETTO(IND)) THEN                           
                   TEKSTTYPE_A_KODE = 'A123';                                   
 /* ***************************************************************** */        
 /* ENDRING AV SATSENE FOR BARNETILL. FRA 01.05.02 (30 TIL 40%) JD    */        
 /* ***************************************************************** */        
                IF TRANS_OPPL_OMR.VIRKNINGSDATO_ÅMD = 20020500 &                
                  (B02.YRKEPENS.BT (IND)                                        
                 + B02.UFØRPENS.BT (IND)                                        
                 + B02.ALDERSP.BT  (IND)                                        
                 + B02.FORSI.BT_SÆRBARN(IND) > 0) THEN                          
                   TEKSTTYPE_A_KODE = 'A159';                                   
            END;                                                                
         WHEN(47)                                                               
            DO;  /* REDUSERT BARNETILLEGG ENDRES TIL FULLT */                   
               IF B02.PENSJONSTYPE1(IND_EK) ='D' THEN                           
                  TEKSTTYPE_A_KODE = 'A077';                                    
               ELSE                                                             
                  TEKSTTYPE_A_KODE = 'A076';                                    
            END; /* REDUSERT BARNETILLEGG ENDRES TIL FULLT */                   
         WHEN(48)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* EKTEFELLES INNT ER ENDRA MED DEN FØLGE AT BARNETILLEGG ENDRES     */        
 /* ***************************************************************** */        
                                                                                
               IF B02.PENSJONSTYPE2(IND_EK) ='U' THEN                           
                  TEKSTTYPE_A_KODE = 'A033';                                    
               ELSE                                                             
                  TEKSTTYPE_A_KODE = 'A035';                                    
            END;                                                                
         WHEN(18)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* DØDSMELDING - PENSJONEN ER OMREGNET P.G.A EKTEFELLEN ER MELDT DØD */        
 /* ***************************************************************** */        
                                                                                
               IF B02.PENSJONSTYPE2(IND)      = 'E' &                           
                  (B02.ALDERSP.ST     (IND) +                                   
                   B02.UFØRPENS.ST    (IND))  = 0   &                           
                  B02.ETTEPENS.TP_NETTO(IND)  > 0   &                           
                  B02.SIVILSTAND       (IND)  = 'S' THEN                        
                                   TEKSTTYPE_A_KODE = 'A016';                   
               ELSE                                                             
                  IF B02.PENSJONSTYPE2(IND)      = 'E' &                        
                     (B02.ALDERSP.ST     (IND) +                                
                      B02.UFØRPENS.ST    (IND))  = 0   &                        
                      B02.ETTEPENS.TP_NETTO(IND)  > 0   &                       
                      B02.SIVILSTAND       (IND)  = 'E' THEN                    
                                   TEKSTTYPE_A_KODE = 'A053';                   
                  ELSE                                                          
                                   TEKSTTYPE_A_KODE = 'A052';                   
            END;                                                                
         WHEN(19)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* DØDSMELDING - FORSØRGINGSTI_ÅMDLLEGGET ER FJERNET ELLER REDUSERTPGA         
 /* ET BARN ER MELDT DØD                                             */         
 /* ******************************************************************/         
                                                                                
                  TEKSTTYPE_A_KODE = 'A054';                                    
            END;                                                                
         WHEN(37)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* DØDSMELDING - BARNEPENSJONEN ER OMREGNET PGA ET BARN ER MELDT DØD*/         
 /* ******************************************************************/         
                                                                                
                  TEKSTTYPE_A_KODE = 'A050';                                    
            END;                                                                
         WHEN(20)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* OPPHØR - FORSØRGINGSTI_ÅMDLLEGG OPPHØRER                         */         
 /* ******************************************************************/         
                                                                                
                IF (B01.ALDERSP.ET(IND) > 0 !                                   
                    B01.GARANTITILLEGG_EK(IND) > 0 !                            
                    B01.UFØRPENS.ET(IND) > 0 ) &                                
                   (B02.ALDERSP.ET(IND) = 0 &                                   
                    B02.GARANTITILLEGG_EK(IND) = 0 &                            
                    B02.UFØRPENS.ET(IND) = 0 ) !                                
                   (B01.PENSJONSTYPE2(IND) = 'F'  &                             
                    B02.PENSJONSTYPE2(IND) ^= 'F') THEN                         
                    DO;                                                         
                       TEKSTTYPE_A_KODE = 'A045';                               
                       IF B01.STATUS.ANTALL_BARN(IND) >                         
                          B02.STATUS.ANTALL_BARN(IND) THEN                      
                                     TEKSTTYPE_A_KODE = 'A047';                 
                    END;                                                        
                ELSE                                                            
                                     TEKSTTYPE_A_KODE = 'A046';                 
            END;                                                                
         WHEN(21)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* OPPHØR - DELVIS OPPHØR AV EGEN YTELSE                            */         
 /* ******************************************************************/         
                                                                                
               IF B02.PENSJONSTYPE1(IND) = 'B' !                                
                  B02.PENSJONSTYPE1(IND) = 'N' THEN                             
                  DO;                                                           
                     IF B01.ETTEBARN.KT(IND) > 0 &                              
                        B02.ETTEBARN.KT(IND) = 0  THEN                          
                                     TEKSTTYPE_A_KODE = 'A051';                 
                  END;                                                          
               ELSE                                                             
                  DO;                                                           
                     IF B01.PENSJONSTYPE1(IND) = 'U' &                          
                        B02.PENSJONSTYPE1(IND) = 'E' THEN                       
                        DO;                                                     
                           IF B02.SIVILSTAND(IND) = 'S' THEN                    
                                     TEKSTTYPE_A_KODE = 'A048';                 
                           ELSE                                                 
                                     TEKSTTYPE_A_KODE = 'A049';                 
                        END;                                                    
                    IF (B01.PENSJONSTYPE1(IND) = 'U' !                          
                        B01.PENSJONSTYPE1(IND) = 'Y' ) &                        
                       (B01.DØD_AV_YRKESSKADE(IND) = 'E' &                      
                        B02.PENSJONSTYPE1(IND) = 'E') THEN                      
                        DO;                                                     
                                     TEKSTTYPE_A_KODE = 'A349';                 
                        END;                                                    
                    IF (B01.PENSJONSTYPE1(IND) = 'U' !                          
                        B01.PENSJONSTYPE1(IND) = 'Y' ) &                        
                       (B01.PENSJONSTYPE3(IND) = 'A' ) &                        
                       (B01.DØD_AV_YRKESSKADE(IND) = 'E' &                      
                        B02.PENSJONSTYPE1(IND) = 'E') THEN                      
                        DO;                                                     
                                     TEKSTTYPE_A_KODE = 'A449';                 
                        END;                                                    
                  END;                                                          
            END;                                                                
         WHEN(35)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* OPPHØR - BARNEPENSJONEN ER OMREGNET PGA ET BARN ER OPPHØRT       */         
 /* ******************************************************************/         
                                                                                
                  TEKSTTYPE_A_KODE = 'A050';                                    
            END;                                                                
         WHEN(54)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* OPPHØR - PENSJONEN OPPHØRER SOM FØLGE AV DØDSFALLET              */         
 /* ******************************************************************/         
                                                                                
                  TEKSTTYPE_A_KODE = 'A105';                                    
            END;                                                                
         WHEN(55)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* OPPHØR - PENSJONEN OPPHØRER                                      */         
 /* ******************************************************************/         
                                                                                
                  TEKSTTYPE_A_KODE = 'A106';                                    
            END;                                                                
         WHEN(36)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* DØDSMELDING - PENSJONEN ER OMREGNET PGA EKTEFELLE ER OPPHØRT SOM */         
 /* PENSJONIST                                                       */         
 /* ******************************************************************/         
                                                                                
                  TEKSTTYPE_A_KODE = 'A056';                                    
            END;                                                                
         WHEN(22)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* INNTEKTSRAPPORT - NY EGEN INNTEKT  (YRKE-TP LAGT INN 3.91 JD)    */         
 /* ******************************************************************/         
                IF DIV_PERIODE.AP_TRANSTYPE_SPART(IND) = 22  THEN               
                   TEKSTTYPE_A_KODE = 'A131';                                   
                ELSE                                                            
                            IF (B02.ALDERSP.TP(IND) +                           
                                B02.YRKEPENS.TP(IND) +                          
                                B02.UFØRPENS.TP(IND)) = 0 THEN                  
                                     TEKSTTYPE_A_KODE = 'A096';                 
                            ELSE                                                
                                     TEKSTTYPE_A_KODE = 'A100';                 
            END;                                                                
         WHEN(23)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* INNTEKTSRAPPORT - NY INNTEKT PÅ AVDØDE                           */         
 /* ******************************************************************/         
                                                                                
                                     TEKSTTYPE_A_KODE = 'A101';                 
            END;                                                                
         WHEN(43)                                                               
            DO;  /* INNTEKTSRAPPORT ERSTATTER FIKTIVT POENGTALL 66 ÅR*/         
               IF (B02.ALDERSP.TP(IND) +                                        
                   B02.UFØRPENS.TP(IND)) = 0 THEN                               
                  TEKSTTYPE_A_KODE = 'A096';                                    
               ELSE                                                             
                  TEKSTTYPE_A_KODE = 'A102';                                    
            END; /* INNTEKTSRAPPORT ERSTATTER FIKTIVT POENGTALL 66 ÅR*/         
         WHEN(44)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* INNTEKTSRAPPORT - INNTEKT ERSTATTER FIKTIVT POENGTALL FOR DET ÅR */         
 /* PENSJONISTEN FYLLER 69 ÅR                                        */         
 /* ******************************************************************/         
                                                                                
                            IF (B02.ALDERSP.TP(IND) +                           
                                B02.UFØRPENS.TP(IND)) = 0 THEN                  
                                     TEKSTTYPE_A_KODE = 'A096';                 
                              ELSE                                              
                                     TEKSTTYPE_A_KODE = 'A103';                 
            END;                                                                
         WHEN(45)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* FNR ENDRING                                                      */         
 /* ******************************************************************/         
                                                                                
                  TEKSTTYPE_A_KODE = 'A078';                                    
            END;                                                                
         WHEN(24)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* KONVERTERING - KONVERTERT FRA UP TIL AP-P67                      */         
 /* ******************************************************************/         
                                                                                
                                                                                
                  TEKSTTYPE_A_KODE = 'A065';                                    
                                                                                
                                                                                
            END;                                                                
         WHEN(49)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* KONVERTERING - KONVERTERT FRA AFP TIL AP-P67                     */         
 /* ******************************************************************/         
                                                                                
                  TEKSTTYPE_A_KODE = 'A265';                                    
            END;                                                                
         WHEN(25)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* KONVERTERING - KONVERTERT FRA EP TIL AP-P67                      */         
 /* ******************************************************************/         
                                                                                
                  TEKSTTYPE_A_KODE = 'A066';                                    
            END;                                                                
         WHEN(33)                                                               
            DO;                                                                 
                                                                                
 /* ******************************************************************/         
 /* KONVERTERING - KONVERTERT FRA EF TIL AP-P67                      */         
 /* ******************************************************************/         
                                                                                
                  TEKSTTYPE_A_KODE = 'A157';                                    
            END;                                                                
         WHEN(41)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* KONVERTERING - KONVERTERT FRA ETTERLATT UP TIL ETTERLATT AP67     */        
 /* ***************************************************************** */        
                                                                                
                  TEKSTTYPE_A_KODE = 'A065';                                    
            END;                                                                
         WHEN(42)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* KONVERTERING - KONVERTERT FRA BP/UP TIL UP                        */        
 /* ***************************************************************** */        
                                                                                
                  TEKSTTYPE_A_KODE = 'A072';                                    
            END;                                                                
         WHEN(26)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* KONVERTERING - KONVERTERT FRA AP_P67 TIL AP_P70                   */        
 /* ***************************************************************** */        
                                                                                
                                                                                
                     IF B01.ALDERSP.APD(IND) <                                  
                        B02.ALDERSP.APD(IND) THEN                               
                                        TEKSTTYPE_A_KODE = 'A069';              
                     ELSE                                                       
                        IF B02.STATUS.VIRK_DATO_ÅMD(IND) =                      
                           B02.STATUS.G_DATO_ÅMD  (IND)   THEN                  
                           IF B02.ALDERSP.PÅ      (IND) >                       
                              B02.ALDERSP.VT_PÅ   (IND)   THEN                  
                                        TEKSTTYPE_A_KODE = 'A068';              
                           ELSE                                                 
                                        TEKSTTYPE_A_KODE = 'A079';              
                        ELSE                                                    
                                        TEKSTTYPE_A_KODE = 'A068';              
                                                                                
                                                                                
            END;                                                                
         WHEN(28)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* AUTO-OPPHØR - OPPHØR AV FORSØRGINGSTILLEGG                        */        
 /* ***************************************************************** */        
                                                                                
                  IF (B01.ALDERSP.ET(IND) > 0 !                                 
                    B01.GARANTITILLEGG_EK(IND) > 0 !                            
                      B01.UFØRPENS.ET(IND) > 0) &                               
                     (B02.UFØRPENS.ET(IND) = 0  &                               
                    B02.GARANTITILLEGG_EK(IND) = 0 &                            
                      B02.ALDERSP.ET(IND)  = 0) &                               
                     B01.ANTALL_BARN(IND) = B02.ANTALL_BARN(IND) THEN           
                                     TEKSTTYPE_A_KODE = 'A070';                 
  /* JFA 11.5.00 */                                                             
                  ELSE                                                          
                  IF B02.ANTALL_BARN(IND) > 0  &                                
                     B01.ANTALL_BARN(IND) > B02.ANTALL_BARN(IND)  &             
                    (B01.YRKEPENS.BT(IND)          +                            
                     B01.UFØRPENS.BT(IND)          +                            
                     B01.ALDERSP .BT(IND)          +                            
                     B01.GARANTITILLEGG_BARN(IND)  +                            
                     B01.FORSI.BT_SÆRBARN(IND)      )  >  0   &                 
                    (B02.YRKEPENS.BT(IND)          +                            
                     B02.UFØRPENS.BT(IND)          +                            
                     B02.ALDERSP .BT(IND)          +                            
                     B02.GARANTITILLEGG_BARN(IND)  +                            
                     B02.FORSI.BT_SÆRBARN(IND)      )  =  0  THEN               
  /* HIT 11.5.00 */          TEKSTTYPE_A_KODE          = 'A128';                
                                                                                
                  ELSE                                                          
                  IF B01.ANTALL_BARN(IND) > B02.ANTALL_BARN(IND) THEN           
                                     TEKSTTYPE_A_KODE = 'A071';                 
                  ELSE                                                          
                                     TEKSTTYPE_A_KODE = 'A018';                 
            END;                                                                
         WHEN(29)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* AUTO-OPPHØR - OPPHØR AV BARNEPENSJON                              */        
 /* ***************************************************************** */        
                                                                                
                  IF B02.PENSJONSTYPE1(IND) = 'N' THEN                          
                                     TEKSTTYPE_A_KODE = 'A073';                 
                  ELSE                                                          
                                     TEKSTTYPE_A_KODE = 'A074';                 
                  IF B02.DØD_AV_YRKESSKADE(IND) = 'E' THEN                      
                                     TEKSTTYPE_A_KODE = 'A307';                 
            END;                                                                
                                                                                
                                                                                
         WHEN(30)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* AUTO-NY-BEREGNING - UNG UFØR FÅR 2.50 POENG FRA 1.5.87            */        
 /* ***************************************************************** */        
                                                                                
                   TEKSTTYPE_A_KODE = 'A107';                                   
            END;                                                                
                                                                                
                                                                                
         WHEN(95)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* AUTO-NY-BEREGNING - FRADRAG FRAMTIDIG ARB INNT 010102             */        
 /* ***************************************************************** */        
                                                                                
                   TEKSTTYPE_A_KODE = 'A158';                                   
            END;                                                                
         WHEN(89)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* AUTO-NY-BEREGNING - AVKORTING AV PENS FOR PERS UNDER 68 010108    */        
 /* ***************************************************************** */        
                                                                                
                   TEKSTTYPE_A_KODE = 'A160';                                   
            END;                                                                
                                                                                
                                                                                
         WHEN(92)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* AUTO-NY-BEREGNING - GP PROSENTEN ØKER FRA 1.5.03 / 1.5.04         */        
 /* ***************************************************************** */        
                                                                                
                   TEKSTTYPE_A_KODE = 'A181';                                   
            END;                                                                
         WHEN(93)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* AUTO-NY-BEREGNING - BARNETILL ØKES FRA 30 TIL 40 PROSENT 01052002 */        
 /* ***************************************************************** */        
                                                                                
                   TEKSTTYPE_A_KODE = 'A159';                                   
            END;                                                                
         WHEN(31)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* AUTO-NY-BEREGNING - UNG UFØR FÅR BEREGNET TP NÅR 20 ÅR FYLLES     */        
 /* TEST PAA BARNEPENSJON LAGT INN MARS 98 AV JD                      */        
 /* ***************************************************************** */        
                                                                                
                                                                                
                 IF B02.PENSJONSTYPE1(IND) = 'N'  THEN                          
                    TEKSTTYPE_A_KODE = 'A014';                                  
                 ELSE                                                           
                   TEKSTTYPE_A_KODE = 'A067';                                   
            END;                                                                
                                                                                
                                                                                
         WHEN(39)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* AUTOBEREGNING - UNG UFØR FÅR 3.00 POENG FRA 1.5.88 3.3 FRA 1.5.91 */        
 /* 3.5 fra 1 mai 2008  (j.d 06.2008)                                 */        
 /* ***************************************************************** */        
                                                                                
                 IF B02.VIRK_DATO_ÅMD(IND) > 20080499    THEN                   
                    TEKSTTYPE_A_KODE = 'A148';                                  
                  ELSE                                                          
                     IF B02.VIRK_DATO_ÅMD(IND) = 19910500    THEN               
                        TEKSTTYPE_A_KODE = 'A114';                              
                     ELSE                                                       
                        TEKSTTYPE_A_KODE = 'A109';                              
            END;                                                                
                                                                                
         WHEN(96)                                                               
            DO;  /* NY REDUKSJON PGA FAI TIDL. AFP'ERE 1.1.2001 */              
               TEKSTTYPE_A_KODE = 'A146';                                       
            END; /* NY REDUKSJON PGA FAI TIDL. AFP'ERE 1.1.2001 */              
         WHEN(97)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* VERNEPLIKTÅR FOR KVINNER FRA 1.7.2 000                            */        
 /* ***************************************************************** */        
                                                                                
                   TEKSTTYPE_A_KODE = 'A145';                                   
            END;                                                                
                                                                                
         WHEN(99)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* (NY 5.6.92 JD) NYE REGLER BEREGNING AV FORSøRGINGSTILLEGG         */        
 /* ***************************************************************** */        
                                                                                
                   TEKSTTYPE_A_KODE = 'A120';                                   
            END;                                                                
                                                                                
         WHEN(46)                                                               
            DO;                                                                 
                                                                                
 /* ***************************************************************** */        
 /* TEKSTER FOR OMSORGSPOENG - A155 = EGNE POENG                      */        
 /*                            A156 = AVDØDES POENG                   */        
 /* ***************************************************************** */        
                                                                                
                 IF B02.TP_BRUTTO(IND) >                                        
                    B01.TP_BRUTTO(IND)           THEN                           
                    TEKSTTYPE_A_KODE = 'A156';                                  
                 ELSE                                                           
                   TEKSTTYPE_A_KODE = 'A155';                                   
            END;                                                                
         OTHERWISE;                                                             
                                                                                
      END;                                                                      
   ELSE                                                                         
                                                                                
      IF IND = EKT_IND       THEN                                               
         DO;  /* IND = EKT_IND */                                               
            IF (TRANS_OPPL_OMR.TRANSTYPE = 92) THEN                             
               /* GP PROSENT OG G-REGULERING */                                 
               TEKSTTYPE_A_KODE = 'A181';                                       
            ELSE                                                                
            IF (TRANS_OPPL_OMR.TRANSTYPE = 12) THEN                             
               /* R344 - FLYTTER FRA HVERANDRE */                               
               TEKSTTYPE_A_KODE = 'A040';                                       
            ELSE                                                                
            IF (TRANS_OPPL_OMR.TRANSTYPE = 13) THEN                             
               /* FLYTTER SAMMEN */                                             
               TEKSTTYPE_A_KODE = 'A042';                                       
            ELSE                                                                
            IF (TRANS_OPPL_OMR.TRANSTYPE = 14) THEN                             
               DO; /* SKILLSMISSE TO PENSJONISTER */                            
                  IF  B01.SIVILSTAND(IND) = 'V'  THEN                           
                     TEKSTTYPE_A_KODE = 'A147';                                 
                  ELSE                                                          
                     TEKSTTYPE_A_KODE = 'A039';                                 
               END; /* SKILSMISSE TO PENSJONISTER */                            
            ELSE                                                                
            IF TRANS_OPPL_OMR.TRANSTYPE = 27     THEN                           
               /* SATSOMMREGNING */                                             
               TEKSTTYPE_A_KODE = 'A079';                                       
            ELSE                                                                
               DO; /* IKKE TRANSTYPE 12 ! 13 ! 14 ! 27 ! 92 */                  
                                                                                
                  IF B01.SUM_YTELSE(SB_IND) = 0   THEN                          
                     DO;  /* SUM YTELSE SB_IND = 0 */                           
                        IF B02.SUM_YTELSE(SB_IND) > 0  &                        
                           B02.PENSJONSTYPE1(EKT_IND) = 'K' THEN                
                           DO;                                                  
                              IF B02.UTTAKSDATO_ÅMD(SB_IND) =                   
                                 B02.UTTAKSDATO_ÅMD(EKT_IND) THEN               
                                 TEKSTTYPE_A_KODE = 'A201';                     
                              ELSE                                              
                                 TEKSTTYPE_A_KODE = 'A018';                     
                           END;                                                 
                        ELSE                                                    
                                                                                
                                                                                
 /* ***************************************************************** */        
 /* NÅR 2 U3(EK/SAMBOERE)REG PÅ SAMME DAG MED SAMME VIRK-DATO SKAL    */        
 /* TEKST A002 SKRIVES (JD 16.12.98 )                                 */        
 /* ***************************************************************** */        
                                                                                
                            IF B01.VIRK_DATO_ÅMD(SB_IND) =                      
                               B02.VIRK_DATO_ÅMD(SB_IND) &                      
                               W_HENDELSE.VERSJON ^= 001 &                      
                               B02.PENSJONSTYPE1(SB_IND) = 'U' THEN             
                                     TEKSTTYPE_A_KODE = 'A002';                 
                            ELSE                                                
 /* ***************************************************************** */        
 /* NÅR AFP OG ALDERSP   REG PÅ SAMME DAG MED SAMME VIRK-DATO SKAL    */        
 /* TEKST A002 SKRIVES (JD 25.01.99 )                                 */        
 /* ***************************************************************** */        
                                                                                
                            IF B02.UTTAKSDATO_ÅMD(SB_IND) =                     
                               B02.UTTAKSDATO_ÅMD(EKT_IND) &                    
                               W_HENDELSE.VERSJON ^= 001   &                    
                               B02.PENSJONSTYPE1(SB_IND) = 'A'   THEN           
                                     TEKSTTYPE_A_KODE = 'A001';                 
                                                                                
   /*                       ELSE                                                
                            IF B02.VIRK_DATO_ÅMD(SB_IND)  =                     
                               B02.VIRK_DATO_ÅMD(EKT_IND) &                     
                               W_HENDELSE.VERSJON ^= 001    THEN                
  /* JFA 8.2.2000              IF B02.PENSJONSTYPE1(EKT_IND) = 'A' THEN         
                                   TEKSTTYPE_A_KODE = 'A001';                   
  TATT BORT MIDLERTIDIG        IF B02.PENSJONSTYPE1(EKT_IND) = 'U' THEN         
  10.7.00 JFA                      TEKSTTYPE_A_KODE = 'A002'; */                
                                                                                
  /*                        ELSE                                                
                            IF B02.SUM_YTELSE(SB_IND) > 0     &                 
  /* JFA 17.4.2000             B02.VIRK_DATO_ÅMD(SB_IND)  =                     
     TATT BORT 11.7.00         B02.VIRK_DATO_ÅMD(EKT_IND)     &                 
                               W_HENDELSE.VERSJON ^= 001      &                 
                               B02.PENSJONSTYPE1(SB_IND)  = 'A' THEN            
                                  TEKSTTYPE_A_KODE = 'A001';    */              
                                                                                
                            ELSE                                                
                            IF B02.SUM_YTELSE(SB_IND) > 0  &                    
                               B02.PENSJONSTYPE1(SB_IND) ^= 'K' THEN            
                                                                                
                              TEKSTTYPE_A_KODE = 'A018';                        
                                                                                
                            ELSE                                                
                                                                                
                              TEKSTTYPE_A_KODE = 'A079';                        
                     END; /* SUM YTELSE SB_IND = 0 */                           
                  ELSE                                                          
                     DO;  /* SUM YTELSE SB_IND > 0 */                           
                        IF TRANS_OPPL_OMR.TRANSTYPE = 22  !                     
                           TRANS_OPPL_OMR.TRANSTYPE = 43  !                     
                           TRANS_OPPL_OMR.TRANSTYPE = 44      THEN              
                                                                                
                           TEKSTTYPE_A_KODE = 'A097';                           
                        ELSE                                                    
                                                                                
 /* ***************************************************************** */        
 /* TEKST A181 LAGT INN VED G-DATO 0503               (JD 06.2003)    */        
 /* ***************************************************************** */        
                                                                                
                         IF (B02.G_DATO_ÅMD   (SB_IND) = 20030500 &             
                              TRANS_OPPL_OMR.VIRKNINGSDATO_ÅMD                  
                                                     < 20030600 &               
                             B02.GP_REDUKSJON_KODE(SB_IND) ^= ' ' )             
                             THEN                                               
                                  TEKSTTYPE_A_KODE = 'A181';                    
                                                                                
 /* ***************************************************************** */        
 /* TEKST A181 LAGT INN VED G-DATO 0504               (MH 02.2004)    */        
 /* ***************************************************************** */        
                         ELSE                                                   
                         IF (B02.G_DATO_ÅMD   (SB_IND) = 20040500 &             
                             TRANS_OPPL_OMR.VIRKNINGSDATO_ÅMD                   
                                                     < 20040500 &               
                             B02.GP_REDUKSJON_KODE(SB_IND) ^= ' ' )             
                               THEN                                             
                                     TEKSTTYPE_A_KODE = 'A181';                 
                                                                                
 /* ***************************************************************** */        
 /* NÅR 2 U3(EK/SAMBOERE)REG PÅ SAMME DAG MED SAMME VIRK-DATO SKAL    */        
 /* TEKST A002 SKRIVES (JD 16.12.98 )                                 */        
 /* ***************************************************************** */        
                                                                                
                         ELSE                                                   
                         IF B01.VIRK_DATO_ÅMD(SB_IND) =                         
                            B02.VIRK_DATO_ÅMD(SB_IND) &                         
                            W_HENDELSE.VERSJON ^= 001 &                         
                            B02.PENSJONSTYPE1(SB_IND) = 'U' THEN                
                                  TEKSTTYPE_A_KODE = 'A002';                    
                         ELSE                                                   
                         IF B02.SUM_YTELSE(SB_IND) > 0 THEN                     
                                 TEKSTTYPE_A_KODE = 'A097';                     
                         ELSE                                                   
                         IF TRANS_OPPL_OMR.TRANSTYPE = 18 THEN                  
                             IF B02.PENSJONSTYPE2(SB_IND) = 'E' &               
                                 (B02.ALDERSP.ST (SB_IND) +                     
                                  B02.UFØRPENS.ST(SB_IND)) = 0  &               
                                B02.ETTEPENS.TP_NETTO(SB_IND) > 0 &             
                                  B02.SIVILSTAND(SB_IND) = 'E' THEN             
                                  TEKSTTYPE_A_KODE = 'A053';                    
                              ELSE                                              
                                  TEKSTTYPE_A_KODE = 'A052';                    
                          ELSE                                                  
                              TEKSTTYPE_A_KODE = 'A056';                        
                     END; /* SUM YTELSE SB_IND > 0 */                           
               END;/* IKKE TRANSTYPE 12 ! 13 ! 14 ! 27 ! 92 */                  
         END; /* IND = EKT_IND */                                               
                                                                                
                                                                                
 /* ***************************************************************** */        
 /* GRUNNBLANKETT - SJEKK OM GRBLANKETTENS BRUK SOM ENDRINGSMELDING   */        
 /* (FLYTTET TIL UTLANDET ELLER ENDRING AV TRYGDETID                  */        
 /* ***************************************************************** */        
                                                                                
  IF B02.STATUS.VIRK_DATO_ÅMD(IND) > 0 &                                        
     B01.STATUS.VIRK_DATO_ÅMD(IND) > 0 &                                        
     B01.PENSJONSTYPE1(IND)       =                                             
     B02.PENSJONSTYPE1(IND)           &                                         
     IND    =  SB_IND                 &                                         
     (TRANS_OPPL_OMR.TRANSTYPE    < 6 !                                         
      TRANS_OPPL_OMR.TRANSTYPE    = 34)       THEN                              
    DO;                                                                         
      IF (B01.BOSATT(IND) = 0  &                                                
          B02.BOSATT(IND) > 0)     THEN                                         
          DO;                                                                   
                                                                                
 /* ***************************************************************** */        
 /* PERSONEN HAR FLYTTET TIL UTLANDET                                 */        
 /* ***************************************************************** */        
                                                                                
             SELECT (B02.PENSJONSTYPE1(IND));                                   
                WHEN('A')                                                       
                   DO;                                                          
                                                                                
 /* ***************************************************************** */        
 /* ALDERSPENSJON                                                     */        
 /* ***************************************************************** */        
                                                                                
                       IF B02.ALDERSP.KT(IND) = 0 &                             
                          B01.ALDERSP.KT(IND) > 0 THEN                          
                                      TEKSTTYPE_A_KODE = 'A025';                
                       ELSE                                                     
                          IF B02.SUM_YTELSE(IND) <                              
                             B01.SUM_YTELSE(IND) THEN                           
                                      TEKSTTYPE_A_KODE = 'A026';                
                   END;                                                         
                WHEN('U')                                                       
                   DO;                                                          
                                                                                
 /* ***************************************************************** */        
 /* UFØREPENSJON                                                      */        
 /* ***************************************************************** */        
                                                                                
                       IF B02.UFØRPENS.KT(IND) = 0 &                            
                          B01.UFØRPENS.KT(IND) > 0 THEN                         
                                      TEKSTTYPE_A_KODE = 'A025';                
                       ELSE                                                     
                          IF B02.SUM_YTELSE(IND) <                              
                             B01.SUM_YTELSE(IND) THEN                           
                                      TEKSTTYPE_A_KODE = 'A026';                
                   END;                                                         
                WHEN('E','J')                                                   
                   DO;                                                          
                                                                                
 /* ***************************************************************** */        
 /* ETTERLATT PENSJON OG ETTERLATT FAMILIEPLEIER                      */        
 /* ***************************************************************** */        
                                                                                
                       IF B02.ETTEPENS.KT(IND) = 0 &                            
                          B01.ETTEPENS.KT(IND) > 0 THEN                         
                                      TEKSTTYPE_A_KODE = 'A025';                
                       ELSE                                                     
                          IF B02.SUM_YTELSE(IND) <                              
                             B01.SUM_YTELSE(IND) THEN                           
                                      TEKSTTYPE_A_KODE = 'A026';                
                   END;                                                         
                WHEN('N','B')                                                   
                   DO;                                                          
                                                                                
 /* ***************************************************************** */        
 /* ETTERLATT BARNEPENSJON                                            */        
 /* ***************************************************************** */        
                                                                                
                       IF B02.ETTEBARN.KT(IND) = 0 &                            
                          B01.ETTEBARN.KT(IND) > 0 THEN                         
                                      TEKSTTYPE_A_KODE = 'A025';                
                       ELSE                                                     
                          IF B02.SUM_YTELSE(IND) <                              
                             B01.SUM_YTELSE(IND) THEN                           
                                      TEKSTTYPE_A_KODE = 'A026';                
                    END;                                                        
                                                                                
                 OTHERWISE;                                                     
                                                                                
             END; /* SELECT */                                                  
          END;                                                                  
      ELSE                                                                      
         IF TEKSTTYPE_A_KODE = '    '  THEN                                     
          DO;                                                                   
             IF (B02.TT_ANV(IND) ^=                                             
                 B01.TT_ANV(IND))       &                                       
                 B01.TT_ANV(IND) > 0    &                                       
                (B01.UFØRPENS.UFG(IND)  =                                       
                 B02.UFØRPENS.UFG(IND)) &                                       
                 B01.SUM_YTELSE(IND) ^= 0    &                                  
                (B02.TT_ANV(IND) < 40 !                                         
                 B01.TT_ANV(IND) < 40) THEN                                     
                 DO;                                                            
                                                                                
 /* ***************************************************************** */        
 /* PENSJONEN ER FORANDRET PGA TRYGDETID                              */        
 /* ***************************************************************** */        
                                                                                
                    IF B01.TT_ANV(IND) >                                        
                       B02.TT_ANV(IND) THEN                                     
                                       TEKSTTYPE_A_KODE = 'A027';               
                    ELSE                                                        
                                       TEKSTTYPE_A_KODE = 'A028';               
                 END;                                                           
          END;                                                                  
    END;                                                                        
                                                                                
 IF TEKSTTYPE_A_KODE = 'A079' &                                                 
    B02.STATUS.G_DATO_ÅMD(IND) = 19950100 &                                     
 /* JFA 6.4.2000 TILFØYD YTTERLIGERE TESTER FØR TEKSTKODE A127        */        
                                                                                
  (B02.UFØRPENS.ET(IND) + B02.YRKEPENS.ET (IND) +                               
   B02.UFØRPENS.BT(IND) + B02.YRKEPENS.BT (IND) +                               
   B02.GARANTITILLEGG_SÆRBARN(IND) +                                            
   B02.GARANTITILLEGG_BARN(IND)    +                                            
   B02.GARANTITILLEGG_EK  (IND)    +                                            
   B02.BT_SÆRBARN(IND)             +                                            
   B02.ALDERSP.ET(IND) + B02.ALDERSP.BT(IND) ) > 0 THEN                         
                                          TEKSTTYPE_A_KODE = 'A127';            
 IF TEKSTTYPE_A_KODE = 'A079' &                                                 
    B02.STATUS.G_DATO_ÅMD(IND) = 19950100 &                                     
 /* JFA 6.4.2000 TILFØYD YTTERLIGERE TESTER FØR TEKSTKODE A122        */        
                                                                                
  (B02.UFØRPENS.ET(IND) + B02.YRKEPENS.ET (IND) +                               
   B02.UFØRPENS.BT(IND) + B02.YRKEPENS.BT (IND) +                               
   B02.GARANTITILLEGG_SÆRBARN(IND) +                                            
   B02.GARANTITILLEGG_BARN(IND)    +                                            
   B02.GARANTITILLEGG_EK  (IND)    +                                            
   B02.BT_SÆRBARN(IND)             +                                            
   B02.ALDERSP.ET(IND) + B02.ALDERSP.BT(IND) )  = 0 THEN                        
                                          TEKSTTYPE_A_KODE = 'A122';            
 /* HIT 6.4.2000  */                                                            
                                                                                
 /* JFA 19.4.2000   -   TATT BORT 11.7.2000                                     
  IF ( TEKSTTYPE_A_KODE = 'A018'  &                                             
       B02.VIRK_DATO_ÅMD(IND)  =                                                
       B02.VIRK_DATO_ÅMD(IND_EK)  &                                             
       W_HENDELSE.VERSJON ^= 001  &                                             
       B02.PENSJONSTYPE1(IND)  = 'A' ) THEN                                     
        TEKSTTYPE_A_KODE = 'A001';                */                            
                                                                                
                                                                                
  IF TEKSTTYPE_A_KODE = '    ' &                                                
     B02.STATUS.PENSJONSTYPE2(IND) = 'O' THEN                                   
                               TEKSTTYPE_A_KODE = 'A091';                       
  IF TEKSTTYPE_A_KODE = '    ' THEN                                             
                               TEKSTTYPE_A_KODE = 'A079';                       
                                                                                
 /* ***************************************************************** */        
 /* HVIS PTYPE3 = 'A' ENDRES TEKSTKODE TIL Å GJELDE ATTFØRING         */        
 /* ***************************************************************** */        
                                                                                
  IF (B02.STATUS.PENSJONSTYPE3(IND)   = 'A')   &                                
     (B02.STATUS.PENSJONSTYPE1(IND)  ^= 'Y')   &                                
     (TEKSTTYPE_A_KODE ^= 'A122' &                                              
      TEKSTTYPE_A_KODE ^= 'A121' &                                              
      TEKSTTYPE_A_KODE ^= 'A123' &                                              
      TEKSTTYPE_A_KODE ^= 'A155' &                                              
      TEKSTTYPE_A_KODE ^= 'A159')    THEN                                       
     DO;                                                                        
        SUBSTR(TEKSTTYPE_A_KODE,2,1) = '6';                                     
     END;                                                                       
  IF B02.STATUS.PENSJONSTYPE3(IND)   = 'A'   &                                  
     TEKSTTYPE_A_KODE  = 'A121'  THEN                                           
     TEKSTTYPE_A_KODE  = 'A721' ;                                               
      /* KODE A755 LAGT INN 03.2001 JD */                                       
  IF B02.STATUS.PENSJONSTYPE3(IND)   = 'A'   &                                  
     TEKSTTYPE_A_KODE  = 'A155'  THEN                                           
     TEKSTTYPE_A_KODE  = 'A755' ;                                               
      /* KODE A759 LAGT INN 2003 JD (R105) */                                   
  IF B02.STATUS.PENSJONSTYPE3(IND)   = 'A'   &                                  
     TEKSTTYPE_A_KODE  = 'A159'  THEN                                           
     TEKSTTYPE_A_KODE  = 'A759' ;                                               
                                                                                
   END PLASSER_TEKSTTYPE_A_KODE;                                                
                                                                                
